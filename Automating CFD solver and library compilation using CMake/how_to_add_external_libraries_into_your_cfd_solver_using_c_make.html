<!-- How to add external libraries into your CFD solver using CMake -->
<!-- https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-add-external-libraries-into-your-cfd-solver-using-cmake/ -->

<!-- wp:paragraph -->
<p>After having reviewed how to compile your own library with CMake in the previous article, including what steps to take so that other people can consume your library in their project, we reverse the role in this article and look at how we can use someone else's library in our project. In the process, we will look at three different ways how we can bring dependencies into our project. These include manually compiling and installing libraries, asking CMake to handle dependencies for us, and finally, using a package manager.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>By the end of this article, you will have a comprehensive understanding of how to handle dependency management with CMake and how to bring in any library you want to use in your own project with ease. Spare yourself long hours debugging compiler instructions, linker errors, and painful hacks to get dependencies into your project and use the tools provided in this article. Your future self will thank you for it in the long run, honestly!</p>
<!-- /wp:paragraph -->

<!-- wp:block {"ref":2490} /-->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>Download</strong>: <a href="https://cfd.university/download/build-systems-part-5/?tmstv=1718603356&amp;v=3813" title="">Build-Systems-Part-5</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="automating-cfd-solver-and-library-compilation-using-cmake"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":8,"blockClientId":"8f27ab73-1491-484a-bf68-9694d78e094a","content":"Introduction","level":2,"anchor":"aioseo-introduction","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":14,"blockClientId":"37bd341e-801e-45e9-be7c-e315a82e3d0f","content":"Working with Imath: A library for vector-matrix manipulations","level":2,"anchor":"aioseo-working-with-imath-a-library-for-vector-matrix-manipulations","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":25,"blockClientId":"81324115-eeed-45ed-8ff3-68e32bd1969d","content":"Project structure","level":3,"anchor":"aioseo-project-structure","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":29,"blockClientId":"9a9e3896-47bc-47d4-b84e-7ecf04a23689","content":"The classic way: find_package()","level":3,"anchor":"aioseo-the-classic-way-find_package","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":35,"blockClientId":"9bde55d8-4faa-4956-935f-7db105c59183","content":"Compiling and installing Imath manually","level":4,"anchor":"aioseo-compiling-and-installing-imath-manually","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":51,"blockClientId":"d10db8a9-c7a2-46b7-85aa-91e0e1ef34f0","content":"Using Imath in our project","level":4,"anchor":"aioseo-using-imath-in-our-project","order":5,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":68,"blockClientId":"a414e3e9-ee35-47df-b14e-523966b46ef3","content":"Wow, hang on, a dynamic library on Windows without any pre-processor definitions?","level":4,"anchor":"aioseo-wow-hang-on-a-dynamic-library-on-windows-without-any-preprocessor-defines","order":6,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":82,"blockClientId":"9988c859-78e1-4b4c-b2bf-19b09e83f802","content":"The modern way: FetchContent","level":3,"anchor":"aioseo-the-modern-way-fetchcontent","order":7,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":87,"blockClientId":"8276c9d3-f3d9-47d2-ba24-30478d8bfb5e","content":"Modifying our CMakeLists.txt file","level":4,"anchor":"aioseo-modifying-our-cmakelists-txt-file","order":8,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":110,"blockClientId":"4d9360f4-5edb-4371-87e6-9d5c03171e07","content":"The gold standard: Using a package manager (Conan, not its mentally insane brother, vcpkg!)","level":3,"anchor":"aioseo-the-preferred-way-using-a-package-manager","order":9,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":120,"blockClientId":"b233bf7f-f801-4682-9934-e87fd39bacf2","content":"The (unmodified?) CMake build script","level":4,"anchor":"aioseo-the-unmodified-cmake-build-script","order":10,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":124,"blockClientId":"abee7391-461f-42d1-8b41-fe50ce526249","content":"Input files for Conan","level":4,"anchor":"aioseo-input-files-for-conan","order":11,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":130,"blockClientId":"163b111a-0006-4a22-bcc9-d3f82bb25fb3","content":"Command line instruction to marry CMake with Conan (the most beautiful day of your and my life (don't tell my wife ...))","level":4,"anchor":"aioseo-command-line-instruction-to-marry-cmake-with-conan-the-most-beautiful-day-of-your-and-my-life-dont-tell-my-wife","order":12,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]}]},{"id":169,"blockClientId":"2508d0b4-4122-4ff3-b5ff-4ee7e9acddf5","content":"Summary","level":2,"anchor":"aioseo-summary","order":13,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-introduction">Introduction</a></li><li><a href="#aioseo-working-with-imath-a-library-for-vector-matrix-manipulations">Working with Imath: A library for vector-matrix manipulations</a><ul><li><a href="#aioseo-project-structure">Project structure</a></li><li><a href="#aioseo-the-classic-way-find_package">The classic way: find_package()</a><ul><li><a href="#aioseo-compiling-and-installing-imath-manually">Compiling and installing Imath manually</a></li><li><a href="#aioseo-using-imath-in-our-project">Using Imath in our project</a></li><li><a href="#aioseo-wow-hang-on-a-dynamic-library-on-windows-without-any-preprocessor-defines">Wow, hang on, a dynamic library on Windows without any pre-processor definitions?</a></li></ul></li><li><a href="#aioseo-the-modern-way-fetchcontent">The modern way: FetchContent</a><ul><li><a href="#aioseo-modifying-our-cmakelists-txt-file">Modifying our CMakeLists.txt file</a></li></ul></li><li><a href="#aioseo-the-preferred-way-using-a-package-manager">The gold standard: Using a package manager (Conan, not its mentally insane brother, vcpkg!)</a><ul><li><a href="#aioseo-the-unmodified-cmake-build-script">The (unmodified?) CMake build script</a></li><li><a href="#aioseo-input-files-for-conan">Input files for Conan</a></li><li><a href="#aioseo-command-line-instruction-to-marry-cmake-with-conan-the-most-beautiful-day-of-your-and-my-life-dont-tell-my-wife">Command line instruction to marry CMake with Conan (the most beautiful day of your and my life (don&#x27;t tell my wife ...))</a></li></ul></li></ul></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-introduction">Introduction</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In our <a href="https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-compile-install-and-use-custom-libraries-with-cmake" target="_blank" rel="noopener" title="">previous article</a>, we looked at how to compile either a static or dynamic library and then what steps we need to take to install a library so that it exposes important information to other projects if they want to use this compiled library. We also looked at the small changes we need to make to get header-only libraries to work (i.e. installing header files only, no compilation required).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then used that library in another project to show how we can consume our generated libraries as an end-user. If you followed all the steps in this series up until now, you are in a perfect position to <a href="https://www.modularmanagement.com/blog/software-modularity" target="_blank" rel="noopener" title="">modularise your C++ software projects</a>, which essentially means breaking up your code into smaller units. If we write a CFD solver, for example, we may want to separate the mesh reading from the discretisation, have another module on reading input files, one for turbulence modelling, and so on, you get the idea.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, in this article, I want to look at CMake's approach to handling external dependencies. We have looked briefly at <code>find_package()</code>, which allowed us to find our compiled and installed library. You may remember from the previous article that we had to provide the location for CMake where to find the package first (at least if it is in a non-standard path), which can result in an error if not specified. But even if you do specify the path, not all libraries may expose the necessary files for CMake to find all required files (headers and libraries).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, we look at increasingly more self-contained options, starting with a mechanism where CMake is responsible for downloading an external project, compiling it, and making it available for our current project. This is great, but comes with some additional brittle features. This will then bring us to what I would consider the gold standard of dependency management with CMake: using a package manager to download and compile libraries and passing that information to CMake so we are guaranteed to find any dependency.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We'll explore how to integrate an external library, not one written by ourselves, to showcase how to work with real dependencies (and what potential pitfalls you can come across using either of these methods). So, with these introductory thoughts out of the way, let us jump straight in and develop some code and build scripts to quench that CMake thirst!</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-working-with-imath-a-library-for-vector-matrix-manipulations">Working with Imath: A library for vector-matrix manipulations</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I want to start by looking at the library that we will work with, Imath. I have chosen a particularly simple library that only takes a few minutes to learn, but it is powerful enough to write a somewhat meaningful, CFD-related example to showcase why this may be a library that we would consider in a practical situation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sidenote: In reality, I would use <a href="https://eigen.tuxfamily.org/" target="_blank" rel="noopener" title="">Eigen</a> for the example that I am about to introduce, which offers all the same functionality as Imath, and then a few (quite a few) more. Eigen is a header-only library and thus not really suitable if we want to show how to work with compiled libraries (more challenging than header-only libraries).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So what can Imath do for us? It is a specialised library to perform vector matrix modifications, most notably, performing vector-matrix multiplications for geometric transformations. If you have ever implemented 3D graphics, you know what I mean. And for those who have never touched 3D graphics, let's just say that going from an object to what is presented on screen requires a lot of matrix-matrix multiplication to transform the geometry into different view spaces. If you are intrigued, then get lost in <a href="https://learnopengl.com/Getting-started/Coordinate-Systems" target="_blank" rel="noopener" title="">this rabbit hole</a>. (Honestly, I love OpenGL and 3D programming!)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But let's imagine a more realistic application. Let's say we want to implement moving mesh capabilities into our CFD solver. Then, we may want to be able to rotate some mesh elements around a specific axis. A simple program that would achieve that is given below, using Imath as the underlying library:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;Imath/ImathMatrix.h\u003e\n#include \u0026lt;Imath/ImathVec.h\u003e\n#include \u0026lt;iostream\u003e\n#include \u0026lt;numbers\u003e\n\nint\nmain() {\n  // Vertices of a triangle\n  Imath::V3f v1(1.0, 0.0, 0.0);\n  Imath::V3f v2(1.0, 1.0, 0.0);\n  Imath::V3f v3(2.0, 0.0, 0.0);\n\n  // Rotation matrix\n  Imath::M44f m;\n  m.makeIdentity();\n  m.rotate(Imath::V3f(0.0, 0.0, std::numbers::pi/2.0));\n\n  // Rotated vertices\n  Imath::V3f v1Rotated, v2Rotated, v3Rotated;\n  m.multVecMatrix(v1, v1Rotated);\n  m.multVecMatrix(v2, v2Rotated);\n  m.multVecMatrix(v3, v3Rotated);\n\n  // Print rotated vertices\n  std::cout \u0026lt;\u0026lt; \u0022v1Rotated: \u0022 \u0026lt;\u0026lt; v1Rotated \u0026lt;\u0026lt; std::endl;\n  std::cout \u0026lt;\u0026lt; \u0022v2Rotated: \u0022 \u0026lt;\u0026lt; v2Rotated \u0026lt;\u0026lt; std::endl;\n  std::cout \u0026lt;\u0026lt; \u0022v3Rotated: \u0022 \u0026lt;\u0026lt; v3Rotated \u0026lt;\u0026lt; std::endl;\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;Imath/ImathMatrix.h\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;Imath/ImathVec.h\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;numbers\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Vertices of a triangle\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::V3f \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ev1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::V3f \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ev2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::V3f \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ev3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Rotation matrix\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::M44f m;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003em\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emakeIdentity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003em\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erotate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eV3f\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enumbers\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::pi/\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Rotated vertices\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eImath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::V3f v1Rotated, v2Rotated, v3Rotated;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003em\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emultVecMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(v1, v1Rotated);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003em\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emultVecMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(v2, v2Rotated);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003em\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emultVecMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(v3, v3Rotated);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Print rotated vertices\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;v1Rotated: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; v1Rotated \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;v2Rotated: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; v2Rotated \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;v3Rotated: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; v3Rotated \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":30,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>#include &lt;Imath/ImathMatrix.h>
#include &lt;Imath/ImathVec.h>
#include &lt;iostream>
#include &lt;numbers>

int
main() {
  // Vertices of a triangle
  Imath::V3f v1(1.0, 0.0, 0.0);
  Imath::V3f v2(1.0, 1.0, 0.0);
  Imath::V3f v3(2.0, 0.0, 0.0);

  // Rotation matrix
  Imath::M44f m;
  m.makeIdentity();
  m.rotate(Imath::V3f(0.0, 0.0, std::numbers::pi/2.0));

  // Rotated vertices
  Imath::V3f v1Rotated, v2Rotated, v3Rotated;
  m.multVecMatrix(v1, v1Rotated);
  m.multVecMatrix(v2, v2Rotated);
  m.multVecMatrix(v3, v3Rotated);

  // Print rotated vertices
  std::cout &lt;&lt; "v1Rotated: " &lt;&lt; v1Rotated &lt;&lt; std::endl;
  std::cout &lt;&lt; "v2Rotated: " &lt;&lt; v2Rotated &lt;&lt; std::endl;
  std::cout &lt;&lt; "v3Rotated: " &lt;&lt; v3Rotated &lt;&lt; std::endl;

  return 0;
}</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;Imath/ImathMatrix.h&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;Imath/ImathVec.h&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;numbers&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span></span>
<span class="line"><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // Vertices of a triangle</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::V3f </span><span style="color: #DCDCAA">v1</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">1.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::V3f </span><span style="color: #DCDCAA">v2</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">1.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::V3f </span><span style="color: #DCDCAA">v3</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // Rotation matrix</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::M44f m;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">m</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">makeIdentity</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">m</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">rotate</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">V3f</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">, </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">numbers</span><span style="color: #D4D4D4">::pi/</span><span style="color: #B5CEA8">2.0</span><span style="color: #D4D4D4">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // Rotated vertices</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">Imath</span><span style="color: #D4D4D4">::V3f v1Rotated, v2Rotated, v3Rotated;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">m</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">multVecMatrix</span><span style="color: #D4D4D4">(v1, v1Rotated);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">m</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">multVecMatrix</span><span style="color: #D4D4D4">(v2, v2Rotated);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">m</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">multVecMatrix</span><span style="color: #D4D4D4">(v3, v3Rotated);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // Print rotated vertices</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;v1Rotated: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; v1Rotated &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;v2Rotated: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; v2Rotated &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;v3Rotated: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; v3Rotated &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Here, we define some dummy vertices to form a triangle on lines 9-11 using a float-based 3D vector (<code>V3f)</code>, and then we construct a 4x4 transformation matrix on line 14, which we set to the identity matrix on line 15. Line 16 then applies the rotation we want to achieve. In this case, I want to rotate everything around the z-axis (third entry to the vector) by [katex]\pi/2[/katex] (radians), which is equivalent to [katex]90^\circ[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Our transformation matrix (rotation only, but we could have also applied scaling and translation) is now set, and I have shown below what we want to achieve using a small animation:</p>
<!-- /wp:paragraph -->

<!-- wp:video {"id":3820} -->
<figure class="wp-block-video"><video controls src="https://cfd.university/wp-content/uploads/2024/06/rotation.mp4"></video></figure>
<!-- /wp:video -->

<!-- wp:paragraph -->
<p>We can see here that we may have some form of circular mesh, and we are rotating around the origin (by [katex]90^\circ[/katex]). We can see vertices 1-3 defined with a red, green, and blue vertex, respectively, which correspond to the vertices we defined in the C++ file above, i.e. on lines 9-11.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The rotation is carried out on lines 19-22 and the results are printed to the console on lines 25-27. That's it, no rocket science, just a simple rotational transformation. We will see now how we can can use the various methods in CMake to find the Imath library and make it available to the above-shown code.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-project-structure">Project structure</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's quickly review how the project is structured before we look at the various methods of finding and managing dependencies. The project that we will work with looks like the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"root\n├── build/\n├── CMakeLists.txt\n├── main.cpp\n└── (conanfile.txt) // only for conan projects","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eroot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── build/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── CMakeLists.txt\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── main.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── (conanfile.txt) // only for conan projects\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>root
├── build/
├── CMakeLists.txt
├── main.cpp
└── (conanfile.txt) // only for conan projects</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">root</span></span>
<span class="line"><span style="color: #D4D4D4">├── build/</span></span>
<span class="line"><span style="color: #D4D4D4">├── CMakeLists.txt</span></span>
<span class="line"><span style="color: #D4D4D4">├── main.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">└── (conanfile.txt) // only for conan projects</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We have our root-level <code>build/</code> folder as is customary with CMake. Then, we have the <code>CMakeLists.txt</code> file, which will find the Imath library for us and then compile our <code>main.cpp</code> file, which will link against Imath. The <code>main.cpp</code> file is the one we looked at in the previous section. There is one additional file called <code>conanfile.txt</code>, which is required by Conan if we want to use this package manager. We will come back to this file at the end when looking at package manager integration with CMake.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-classic-way-find_package">The classic way: find_package()</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The first approach I want to look at is the one I would label the classical approach. I say classic, by which I mean providing dependencies ourselves. This means we have to download, compile, and install libraries ourselves and then tell CMake where to find them. We have looked at this manual process in detail when <a href="https://cfd.university/learn/how-to-compile-write-and-use-cfd-libraries-in-c/how-to-integrate-external-cfd-libraries-in-your-code/#aioseo-case-study-compiling-the-cgns-library" target="_blank" rel="noopener" title="">we compiled the CGNS library from scratch</a>. We saw that the CGNS library requires some additional dependencies (zlib and HDF5) before we can compile the CGNS library itself, and the process can quickly become time-consuming.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But let's say that is what we want to do. From a learning perspective, this is certainly the best approach, as you likely get errors eventually with CMake and have to troubleshoot them. Case in point: try to do it with the CGNS library, and you won't succeed. The issue is that the CGNS library does not provide the required <code>*.cmake</code> files, so CMake won't be able to find the library easily. Of course, we could always hack our CMake file and provide hardcoded paths to libraries and header files, but that's a bad solution.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Returning to our <code>CMakeLists.txt</code> file, the content is provided below:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake_minimum_required(VERSION 3.23)\n\nproject(\n  ImathTest\n  VERSION 1.0\n  LANGUAGES CXX\n)\n\n# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\nset(CMAKE_CXX_STANDARD 20)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\nfind_package(Imath REQUIRED)\n\n# Add an executable and provide the source file directly.\nadd_executable(${CMAKE_PROJECT_NAME} main.cpp)\n\n# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\ntarget_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ecmake_minimum_required\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(VERSION 3.23)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eproject\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ImathTest\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  VERSION 1.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  LANGUAGES CXX\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD 20)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD_REQUIRED \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eON\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efind_package\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(Imath REQUIRED)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Add an executable and provide the source file directly.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eadd_executable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e main.cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etarget_link_libraries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE Imath::Imath)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cmake","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake_minimum_required(VERSION 3.23)

project(
  ImathTest
  VERSION 1.0
  LANGUAGES CXX
)

# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found
find_package(Imath REQUIRED)

# Add an executable and provide the source file directly.
add_executable(${CMAKE_PROJECT_NAME} main.cpp)

# Make sure you link your executable with your library. Notice the namespace that we defined earlier.
target_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">cmake_minimum_required</span><span style="color: #D4D4D4">(VERSION 3.23)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">project</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">  ImathTest</span></span>
<span class="line"><span style="color: #D4D4D4">  VERSION 1.0</span></span>
<span class="line"><span style="color: #D4D4D4">  LANGUAGES CXX</span></span>
<span class="line"><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD 20)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD_REQUIRED </span><span style="color: #569CD6">ON</span><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found</span></span>
<span class="line"><span style="color: #569CD6">find_package</span><span style="color: #D4D4D4">(Imath REQUIRED)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Add an executable and provide the source file directly.</span></span>
<span class="line"><span style="color: #569CD6">add_executable</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> main.cpp)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Make sure you link your executable with your library. Notice the namespace that we defined earlier.</span></span>
<span class="line"><span style="color: #569CD6">target_link_libraries</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE Imath::Imath)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Since we rotate by [katex]\pi/2[/katex] (radians), we need to enable the C++ 2020 standard, as Pi was only added then to the C++ standard! (there were always ways to get it into your code by either approximating it, hardcoding the first digits, or using PI from C-headers). We require that Imath be available on line 14; otherwise, the compilation will be aborted. Then, we first create our test program based on the <code>main.cpp</code> file on line 17, which gets linked against Imath on line 20.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-compiling-and-installing-imath-manually">Compiling and installing Imath manually</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have looked at the steps in detail how to compile and install a library by now, i.e. see, for example, <a href="https://cfd.university/learn/how-to-compile-write-and-use-cfd-libraries-in-c/how-to-integrate-external-cfd-libraries-in-your-code/#aioseo-case-study-compiling-the-cgns-library">how to build the CGNS library from scratch</a> or the previous article where we<a href="https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-compile-install-and-use-custom-libraries-with-cmake#aioseo-command-line-instructions" target="_blank" rel="noopener" title=""> compiled and installed our own small test library</a>. Look at these articles if you need a refresher, we will quickly walk through how to do this for the Imath library in this section.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>First, head over the the <a href="https://github.com/AcademySoftwareFoundation/Imath" target="_blank" rel="noopener" title="">Imath github repository</a>. I'll be working with version 3.1.11, which you can download from <a href="https://github.com/AcademySoftwareFoundation/Imath/releases/tag/v3.1.11" target="_blank" rel="noopener" title="">their release page</a> if you want to use the exact same version as me (though as long as you use any version start with 3.x.x, you should be fine).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Download the source code as either a <code>*.zip</code> or <code>*.tar.gz</code> format and extract it somewhere on your PC (it doesn't matter where, as we will specify an install directory later). Open a terminal and change into the Imath root-level directory. Create a <code>build/</code> folder, and change into it. Then, we can compile the library with the following commands:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake -DCMAKE_BUILD_TYPE=Debug -G Ninja ..","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_BUILD_TYPE=Debug\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-G\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eNinja\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e..\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake -DCMAKE_BUILD_TYPE=Debug -G Ninja ..</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_BUILD_TYPE=Debug</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-G</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Ninja</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">..</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>You can, of course, use any other generator than Ninja or simply omit the <code>-G Ninja</code> option to use the native build system of your platform. With our project configured, we can build it:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dbuild . \u002d\u002dconfig Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dconfig\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eDebug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --build . --config Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--config</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Hopefully, we didn't encounter any issues. If that is the case, we should now have the library available to us. If you want to verify that, change into the <code>bin/</code> folder, (<code>build/bin/</code>) and execute the <code>ImathTest.exe</code> file (<code>ImathTest</code> on UNIX). It will run some tests, and if no errors are found, we should be confident that the library is correctly built.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The next step is to make it available by installing it on our system. For testing, I like to use the <code>C:\temp</code> directory on Windows, or <code>~/temp</code> on Unix, which will be in my user's home directory. To do so, write either</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dinstall . \u002d\u002dprefix C:\\temp \u002d\u002dconfig Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dinstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dprefix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eC:\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\t\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eemp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dconfig\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eDebug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --install . --prefix C:\temp --config Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--prefix</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">C:</span><span style="color: #D7BA7D">\t</span><span style="color: #CE9178">emp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--config</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on Windows, or</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dinstall . \u002d\u002dprefix ~/temp \u002d\u002dconfig Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dinstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dprefix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/temp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dconfig\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eDebug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --install . --prefix ~/temp --config Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--prefix</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/temp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--config</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on UNIX. You are allowed to change the folders where you want to install the library to, you have my blessing! Make sure that the folder you have specified does now indeed contain the <code>lib/</code> and <code>include/</code> folders, which contain the required library and header files. It is also a good idea to check that you have the <code>lib/cmake/&lt;lib-name&gt;</code> folder available (here <code>&lt;lib-name&gt;=Imath</code>), which itself should contain at least the <code>&lt;lib-name&gt;Config.cmake</code> and <code>&lt;lib-name&gt;Targets.cmake</code> files. This indicates that we ought to find this library later, with <code>find_package()</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you do the same for the CGNS library, you'll notice that the <code>cgnsConfig.cmake</code> file is missing, indicating that the library developers did not provide this for us during the installation step. This means we do not stand any chance of using <code>find_package()</code> to locate the CGNS library, without having to do some modifications (or hacks) to our <code>CMakeLists.txt</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Also note that I am building in debug mode here, as I am planning to link this later with my project with will be compiled in debug mode as well. For UNIX, it doesn't matter if the library is compiled as either debug or release, but on Windows, we do have to differentiate between the two, otherwise we get linker errors, <a href="https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-compile-install-and-use-custom-libraries-with-cmake#aioseo-command-line-instructions" target="_blank" rel="noopener" title="">as explored in the previous article</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We now have Imath available and can continue to consume it in our own library. Let's see how we can do that.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-using-imath-in-our-project">Using Imath in our project</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>First, let's change into the root-level directory of our project on the console. Then, go into the build folder as indicated in the project structure above. To compile our current project, simply run the following command:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=C:\\temp -G Ninja ..","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_BUILD_TYPE=Debug\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_INSTALL_PREFIX=C:\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\t\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eemp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-G\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eNinja\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e..\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=C:\temp -G Ninja ..</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_BUILD_TYPE=Debug</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_INSTALL_PREFIX=C:</span><span style="color: #D7BA7D">\t</span><span style="color: #569CD6">emp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-G</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Ninja</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">..</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Notice that we have to specify where Imath is located. We do that by specifying the root level directory with the <code>CMAKE_INSTALL_PREFIX</code> variable. In my case, I have the library installed in the <code>C:\temp\lib</code> directory, and the header files located in <code>C:\temp\include</code>, as we specified <code>C:\temp</code> as the installation prefix earlier. On UNIX, you would have to change this directory to something more UNIX-like, for example:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=~/temp -G Ninja ..","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_BUILD_TYPE=Debug\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_INSTALL_PREFIX=\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e~\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e/temp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-G\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eNinja\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e..\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=~/temp -G Ninja ..</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_BUILD_TYPE=Debug</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_INSTALL_PREFIX=</span><span style="color: #D4D4D4">~</span><span style="color: #569CD6">/temp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-G</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Ninja</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">..</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>where the library is now located in the <code>temp/</code> directory within the user's home directory. In either case I use Ninja, simply because it is likely the fasted build tool out there, but also because it works cross-platform and I like to use the same tools across different platform if I have a choice. But feel free to use your favourite generator.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once the configuration is done and CMake hasn't complained about Imath not being available, then we can go ahead and build our project with the following command:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dbuild . \u002d\u002dconfig Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dconfig\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eDebug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --build . --config Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--config</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>To test the executable that we have generated, run the executable directly within the <code>build/</code> directory, i.e.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\ImathTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eImathTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>.\ImathTest.exe</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">.\</span><span style="color: #DCDCAA">ImathTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on Windows and</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./ImathTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./ImathTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>./ImathTest</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./ImathTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on UNIX. If you used MSBuild on Windows or Xcode on macOS, these executables will be located within <code>build/Debug/</code>, so change directories before running the executable.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you do, you will see the following output printed to the console:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"v1Rotated: (-4.37114e-08 1 0)\nv2Rotated: (-1 1 0)\nv3Rotated: (-8.74228e-08 2 0)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ev1Rotated: (-4.37114e-08 1 0)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ev2Rotated: (-1 1 0)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ev3Rotated: (-8.74228e-08 2 0)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>v1Rotated: (-4.37114e-08 1 0)
v2Rotated: (-1 1 0)
v3Rotated: (-8.74228e-08 2 0)</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">v1Rotated: (-4.37114e-08 1 0)</span></span>
<span class="line"><span style="color: #D4D4D4">v2Rotated: (-1 1 0)</span></span>
<span class="line"><span style="color: #D4D4D4">v3Rotated: (-8.74228e-08 2 0)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Looking at the animation above, we can indeed verify that the coordinates are correct (the x value of the first and third vertex being essentially zero).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You may run into trouble if you are on Windows, as the library is built as a shared (dynamic) library. If that is the case, you may need to copy the <code>*.dll</code> file from <code>C:\temp\bin</code> into your <code>build/</code> directory, or wherever the <code>ImathTest.exe</code> file is located. In my case it isn't located in the same folder as the executable, and <a href="https://www.quora.com/Why-does-the-Windows-DLL-file-need-to-be-on-an-executable-folder-Why-doesnt-the-system-use-the-one-in-the-lib-folder-like-Linux-does-with-so-shared-libraries" target="_blank" rel="noopener" title="">it should not work</a>. However, we are talking about Windows here, so anything is possible.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-wow-hang-on-a-dynamic-library-on-windows-without-any-preprocessor-defines">Wow, hang on, a dynamic library on Windows without any pre-processor definitions?</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>As much as <a href="https://cfd.university/" target="_blank" rel="noopener" title="">cfd.university</a> is a place about learning how to code specific CFD aspects, it also doubles as a personal journal where I document how Microsoft is slowly shipping away at my sanity (in the quest of supporting cross-platform compilations). Especially when it comes to working with shared libraries on Windows. The astute reader will remember the <a href="https://cfd.university/learn/how-to-compile-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-compiling-and-testing/#aioseo-dynamic-library-build-script" target="_blank" rel="noopener" title="">dreaded article #17</a>, where it all started.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the <a href="https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-compile-install-and-use-custom-libraries-with-cmake#aioseo-cmake-build-scripts" target="_blank" rel="noopener" title="">previous article</a>, we got the shared (dynamic) library to work by specifying the compiler pre-processor directive <code>COMPILEDLL</code> (i.e. see the <code>CMakeLists.txt</code> file, line 27 in the linked article). This ensured that each function was prepended with <code>__declspec(dllexport)</code>. We then also defined the same pre-processor directive in the <a href="https://cfd.university/learn/automating-cfd-solver-and-library-compilation-using-cmake/how-to-compile-install-and-use-custom-libraries-with-cmake#aioseo-source" target="_blank" rel="noopener" title="">test application</a>, which resulted in each function being correctly prepended with the <code>__declspec(dllimport)</code> statement. We got our shared library to work this way.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, when we linked against Imath, it was also building a shared (dynamic) library on Windows, and if you look in its source code, specifically into <code>&lt;Imath-root&gt;/src/Imath/ImathExport.h</code>, you'll find this wonderful code:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#if defined(IMATH_DLL)\n\n// when building Imath as a DLL for Windows, we have to control the\n// typical DLL export / import things. Luckily, the typeinfo is all\n// automatic there, so only have to deal with symbols, except Windows\n// has some weirdness with DLLs and extern const, so we have to\n// provide a macro to handle that.\n\n#  if defined(IMATH_EXPORTS)\n#    define IMATH_EXPORT __declspec(dllexport)\n#    define IMATH_EXPORT_CONST extern __declspec(dllexport)\n#  else\n#    define IMATH_EXPORT __declspec(dllimport)\n#    define IMATH_EXPORT_CONST extern __declspec(dllimport)\n#  endif\n\n#else\n\n// ... \n\n#endif // IMATH_DLL","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(IMATH_DLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// when building Imath as a DLL for Windows, we have to control the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// typical DLL export / import things. Luckily, the typeinfo is all\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// automatic there, so only have to deal with symbols, except Windows\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// has some weirdness with DLLs and extern const, so we have to\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// provide a macro to handle that.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(IMATH_EXPORTS)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e IMATH_EXPORT __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e IMATH_EXPORT_CONST extern __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e IMATH_EXPORT __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e IMATH_EXPORT_CONST extern __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// ... \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // IMATH_DLL\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":21,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>#if defined(IMATH_DLL)

// when building Imath as a DLL for Windows, we have to control the
// typical DLL export / import things. Luckily, the typeinfo is all
// automatic there, so only have to deal with symbols, except Windows
// has some weirdness with DLLs and extern const, so we have to
// provide a macro to handle that.

#  if defined(IMATH_EXPORTS)
#    define IMATH_EXPORT __declspec(dllexport)
#    define IMATH_EXPORT_CONST extern __declspec(dllexport)
#  else
#    define IMATH_EXPORT __declspec(dllimport)
#    define IMATH_EXPORT_CONST extern __declspec(dllimport)
#  endif

#else

// ... 

#endif // IMATH_DLL</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(IMATH_DLL)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// when building Imath as a DLL for Windows, we have to control the</span></span>
<span class="line"><span style="color: #6A9955">// typical DLL export / import things. Luckily, the typeinfo is all</span></span>
<span class="line"><span style="color: #6A9955">// automatic there, so only have to deal with symbols, except Windows</span></span>
<span class="line"><span style="color: #6A9955">// has some weirdness with DLLs and extern const, so we have to</span></span>
<span class="line"><span style="color: #6A9955">// provide a macro to handle that.</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#  if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(IMATH_EXPORTS)</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> IMATH_EXPORT __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> IMATH_EXPORT_CONST extern __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">#  else</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> IMATH_EXPORT __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> IMATH_EXPORT_CONST extern __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">#  endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// ... </span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#endif</span><span style="color: #6A9955"> // IMATH_DLL</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>It's good to see that it is not just me who finds it weird. You see that if the <code>IMATH_DLL</code> is defined, then we set the <code>IMATH_EXPORT</code> macro to either <code>__declspec(dllexport)</code> or <code>__declspec(dllimport)</code>. The only thing we need to do is to define the <code>IMATH_EXPORTS</code> (notice the s at the end) when building the library to get the <code>dllexport</code> behaviour otherwise, we'll default to <code>dllimport</code>, which is the correct behaviour. But how was this correctly called? We never specified <code>IMATH_DLL</code>, so how did the library know?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, this is where a bit of CMake magic comes in. If we have a look into the <code>&lt;Imath-root&gt;/config/LibraryDefine.cmake</code> file, we can see the following code (I've shortened it here to concentrate on the important bits):</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"function(IMATH_DEFINE_LIBRARY libname)\n  \n  # ...\n  \n  set(objlib ${libname})\n  add_library(${objlib}\n    ${IMATH_CURLIB_HEADERS}\n    ${IMATH_CURLIB_SOURCES})\n\n  if(IMATH_CURLIB_PRIV_EXPORT AND BUILD_SHARED_LIBS)\n    target_compile_definitions(${objlib} PRIVATE ${IMATH_CURLIB_PRIV_EXPORT})\n    if(WIN32)\n      target_compile_definitions(${objlib} PUBLIC IMATH_DLL)\n    endif()\n  endif()\n  \n  # ...\n\nendfunction()","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efunction\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(IMATH_DEFINE_LIBRARY libname)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  set\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(objlib \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${libname}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  add_library\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${objlib}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${IMATH_CURLIB_HEADERS}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${IMATH_CURLIB_SOURCES}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  if\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(IMATH_CURLIB_PRIV_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eAND\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eBUILD_SHARED_LIBS\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    target_compile_definitions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${objlib}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${IMATH_CURLIB_PRIV_EXPORT}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    if\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(WIN32)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e      target_compile_definitions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${objlib}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PUBLIC IMATH_DLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    endif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  endif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eendfunction\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cmake","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":19,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>function(IMATH_DEFINE_LIBRARY libname)
  
  # ...
  
  set(objlib ${libname})
  add_library(${objlib}
    ${IMATH_CURLIB_HEADERS}
    ${IMATH_CURLIB_SOURCES})

  if(IMATH_CURLIB_PRIV_EXPORT AND BUILD_SHARED_LIBS)
    target_compile_definitions(${objlib} PRIVATE ${IMATH_CURLIB_PRIV_EXPORT})
    if(WIN32)
      target_compile_definitions(${objlib} PUBLIC IMATH_DLL)
    endif()
  endif()
  
  # ...

endfunction()</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4">(IMATH_DEFINE_LIBRARY libname)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># ...</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #569CD6">  set</span><span style="color: #D4D4D4">(objlib </span><span style="color: #569CD6">${libname}</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #569CD6">  add_library</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${objlib}</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">${IMATH_CURLIB_HEADERS}</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">${IMATH_CURLIB_SOURCES}</span><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">  if</span><span style="color: #D4D4D4">(IMATH_CURLIB_PRIV_EXPORT </span><span style="color: #569CD6">AND</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">BUILD_SHARED_LIBS</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #569CD6">    target_compile_definitions</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${objlib}</span><span style="color: #D4D4D4"> PRIVATE </span><span style="color: #569CD6">${IMATH_CURLIB_PRIV_EXPORT}</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #569CD6">    if</span><span style="color: #D4D4D4">(WIN32)</span></span>
<span class="line"><span style="color: #569CD6">      target_compile_definitions</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${objlib}</span><span style="color: #D4D4D4"> PUBLIC IMATH_DLL)</span></span>
<span class="line"><span style="color: #569CD6">    endif</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #569CD6">  endif</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955"># ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">endfunction</span><span style="color: #D4D4D4">()</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we create the library on lines 6-8, and then we check if we are building a shared library on line 10. If so, we further check if we are on Windows on line 12, and if this is also the case, we add some target_compile_definitions() to our library. We did something very similar with our complex number library in the previous article, where we had a similar statement, which was</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"if(${ENABLE_SHARED})\n  add_library(${CMAKE_PROJECT_NAME} SHARED)\n\n  if (MSVC)\n    target_compile_definitions(${CMAKE_PROJECT_NAME} PRIVATE COMPILEDLL)\n  endif()\n  \nelse()\n  add_library(${CMAKE_PROJECT_NAME} STATIC)\n\n  if (MSVC)\n    target_compile_definitions(${CMAKE_PROJECT_NAME} PRIVATE COMPILELIB)\n  endif()\n  \nendif()","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${ENABLE_SHARED}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  add_library\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e SHARED)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  if\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (MSVC)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    target_compile_definitions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE COMPILEDLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  endif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  add_library\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e STATIC)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  if\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (MSVC)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    target_compile_definitions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE COMPILELIB)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  endif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eendif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cmake","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":15,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>if(${ENABLE_SHARED})
  add_library(${CMAKE_PROJECT_NAME} SHARED)

  if (MSVC)
    target_compile_definitions(${CMAKE_PROJECT_NAME} PRIVATE COMPILEDLL)
  endif()
  
else()
  add_library(${CMAKE_PROJECT_NAME} STATIC)

  if (MSVC)
    target_compile_definitions(${CMAKE_PROJECT_NAME} PRIVATE COMPILELIB)
  endif()
  
endif()</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">if</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${ENABLE_SHARED}</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #569CD6">  add_library</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> SHARED)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">  if</span><span style="color: #D4D4D4"> (MSVC)</span></span>
<span class="line"><span style="color: #569CD6">    target_compile_definitions</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE COMPILEDLL)</span></span>
<span class="line"><span style="color: #569CD6">  endif</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #569CD6">else</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #569CD6">  add_library</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> STATIC)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">  if</span><span style="color: #D4D4D4"> (MSVC)</span></span>
<span class="line"><span style="color: #569CD6">    target_compile_definitions</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE COMPILELIB)</span></span>
<span class="line"><span style="color: #569CD6">  endif</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #569CD6">endif</span><span style="color: #D4D4D4">()</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we check if the library is shared on the first line and then create the shared library on line 2. We check if we are using Microsoft's <code>cl.exe</code> compiler (which, of course, is named MSVC, why wouldn't it be), and then add the <code>COMPILEDLL</code> statement. If it is not a shared library, then we are building a static library and add the <code>COMPILELIB</code> statement instead on line 12 for the static library defined on line 9.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The difference between our complex number example and Imath is that we used <code>target_compile_definitions(name PRIVATE ...)</code>, whereas Imath used <code>target_compile_definitions(name PUBLIC ...)</code>. You may remember an earlier discussion we had on <code>PRIVATE</code> and <code>PUBLIC</code>, where we said that everything set to <code>PRIVATE</code> will only be visible to our current target. In this case, we define <code>COMPILEDLL</code> as <code>PRIVATE</code>, and so only our complex number library will know about it. If we use this library, we need to set it up again.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>PUBLIC</code>, on the other hand, will pass on any definitions to other projects that use a specific target. So, in the case of Imath, it defines <code>IMATH_DLL</code> as <code>PUBLIC</code>, and so when we are using Imath in our project, we will also get the <code>IMATH_DLL</code> definition, without ever having to set it. If you are shipping your library for other people to use, then this is what you want to do. Define all pre-processor directives they need as <code>PUBLIC</code>, people will thank you later for it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So why did I not do it? Well, the honest answer is, it was an oversight on my side. I set it to <code>PRIVATE</code>, because I usually only export headers, but overlooked that we can do that with pre-processor directives as well. However, I think this is not really an issue (otherwise, I would have simply changed the previous article), and, in fact, there is educational value in setting this twice. CMake hides all of this complexity from us, if we instruct it to do so, but having to specify this manually in the consuming project means that we don't lose sight of this Windows-only issue.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-modern-way-fetchcontent">The modern way: FetchContent</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's step back for a moment and think about what we have done in the previous section. We manually went to Imath's website to download the source code (in some form of a zip archive), extract it, open a console, change into the build/ folder, compile the library and make it available to other projects by installing it into a specific location.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>All we really need is the URL from where to retrieve the source code. The rest of the steps are pretty much the same for all CMake projects (apart from setting some project-specific options). So why not automate this entire process? Well, that is what the developers of CMake thought as well, and they gave us two options, not just one, to deal with this. These are <a href="https://cmake.org/cmake/help/latest/module/ExternalProject.html#module:ExternalProject" target="_blank" rel="noopener" title="">ExternalProject</a> and <a href="https://cmake.org/cmake/help/latest/module/FetchContent.html" target="_blank" rel="noopener" title="">FetchContent</a>, both of which offer functionality that we can implement directly into our CMake scripts. The differences between the two are detailed below:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>ExternalProject</strong>: This allows you to download and compile a third-party project (library, executable) which can have any build script (it does not have to be CMake). After it is compiled, it will be available for the current project to use. It is downloaded and compiled during the configuration step, meaning that your external project and current project can have different configurations (debug or release), which may cause issues on Windows.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>FetchContent</strong>: This is very similar to <a href="https://cmake.org/cmake/help/latest/module/ExternalProject.html#module:ExternalProject" target="_blank" rel="noopener" title="">ExternalProject</a>, but it assumes that the build script is CMake (though there are ways around it). If that is the case, it can be integrated much better with the current project. It still downloads and compiles the project alongside your own project. However, it does all of that during the build step, not the configuration. Project settings that are common are shared among your project and the fetched one, meaning that if you specify a debug build, the fetched project will also compile in debug mode, and the same is true for release builds.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>So <a href="https://cmake.org/cmake/help/latest/module/FetchContent.html" target="_blank" rel="noopener" title="">FetchContent</a> allows us to bring in dependencies and delegate the task of resolving all internal linkages to libraries, as well as finding header include directories to CMake. On paper, this is great, in practice, I have lost a lot of time with trying to get FetchContent to work, but I am jumping ahead of myself. I'll get to some of the shortcomings in a bit. First, let's inspect our <code>CMakeLists.txt</code> file first!</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-modifying-our-cmakelists-txt-file">Modifying our CMakeLists.txt file</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Compared to the previous example, we have to make some modifications in our build script. Have a look through it and then we discuss the changes necessary below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake_minimum_required(VERSION 3.23)\n\nproject(\n  ImathTest\n  VERSION 1.0\n  LANGUAGES CXX\n)\n\n# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\nset(CMAKE_CXX_STANDARD 20)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n# First, require that FetchContent is available\ninclude(FetchContent)\n\n# Declare the location from where to download Imath\nFetchContent_Declare(Imath\n  GIT_REPOSITORY https://github.com/AcademySoftwareFoundation/Imath.git\n  GIT_TAG        v3.1.11\n)\n\n# Compile Imath and make it available for current project\nFetchContent_MakeAvailable(Imath)\n\n# Get some information about Imath, such as its compilation directory\nFetchContent_GetProperties(Imath)\n\n# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\nfind_package(Imath REQUIRED)\n\n# Add an executable and provide the source file directly.\nadd_executable(${CMAKE_PROJECT_NAME} main.cpp)\n\n# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\ntarget_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)\n\n# Fix: CMake can't find Imath headers, as not properly set in IMath's CMake file. Include it manually here ...\ntarget_include_directories(${CMAKE_PROJECT_NAME} PRIVATE \u0022${imath_SOURCE_DIR}/src\u0022)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ecmake_minimum_required\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(VERSION 3.23)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eproject\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ImathTest\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  VERSION 1.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  LANGUAGES CXX\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD 20)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD_REQUIRED \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eON\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# First, require that FetchContent is available\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003einclude\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(FetchContent)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Declare the location from where to download Imath\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eFetchContent_Declare(Imath\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  GIT_REPOSITORY https://github.com/AcademySoftwareFoundation/Imath.git\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  GIT_TAG        v3.1.11\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Compile Imath and make it available for current project\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eFetchContent_MakeAvailable(Imath)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Get some information about Imath, such as its compilation directory\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eFetchContent_GetProperties(Imath)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efind_package\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(Imath REQUIRED)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Add an executable and provide the source file directly.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eadd_executable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e main.cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etarget_link_libraries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE Imath::Imath)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Fix: CMake can\u0026#39;t find Imath headers, as not properly set in IMath\u0026#39;s CMake file. Include it manually here ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etarget_include_directories\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;${imath_SOURCE_DIR}/src\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cmake","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":38,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake_minimum_required(VERSION 3.23)

project(
  ImathTest
  VERSION 1.0
  LANGUAGES CXX
)

# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# First, require that FetchContent is available
include(FetchContent)

# Declare the location from where to download Imath
FetchContent_Declare(Imath
  GIT_REPOSITORY https://github.com/AcademySoftwareFoundation/Imath.git
  GIT_TAG        v3.1.11
)

# Compile Imath and make it available for current project
FetchContent_MakeAvailable(Imath)

# Get some information about Imath, such as its compilation directory
FetchContent_GetProperties(Imath)

# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found
find_package(Imath REQUIRED)

# Add an executable and provide the source file directly.
add_executable(${CMAKE_PROJECT_NAME} main.cpp)

# Make sure you link your executable with your library. Notice the namespace that we defined earlier.
target_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)

# Fix: CMake can't find Imath headers, as not properly set in IMath's CMake file. Include it manually here ...
target_include_directories(${CMAKE_PROJECT_NAME} PRIVATE "${imath_SOURCE_DIR}/src")</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">cmake_minimum_required</span><span style="color: #D4D4D4">(VERSION 3.23)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">project</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">  ImathTest</span></span>
<span class="line"><span style="color: #D4D4D4">  VERSION 1.0</span></span>
<span class="line"><span style="color: #D4D4D4">  LANGUAGES CXX</span></span>
<span class="line"><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD 20)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD_REQUIRED </span><span style="color: #569CD6">ON</span><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># First, require that FetchContent is available</span></span>
<span class="line"><span style="color: #569CD6">include</span><span style="color: #D4D4D4">(FetchContent)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Declare the location from where to download Imath</span></span>
<span class="line"><span style="color: #D4D4D4">FetchContent_Declare(Imath</span></span>
<span class="line"><span style="color: #D4D4D4">  GIT_REPOSITORY https://github.com/AcademySoftwareFoundation/Imath.git</span></span>
<span class="line"><span style="color: #D4D4D4">  GIT_TAG        v3.1.11</span></span>
<span class="line"><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Compile Imath and make it available for current project</span></span>
<span class="line"><span style="color: #D4D4D4">FetchContent_MakeAvailable(Imath)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Get some information about Imath, such as its compilation directory</span></span>
<span class="line"><span style="color: #D4D4D4">FetchContent_GetProperties(Imath)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found</span></span>
<span class="line"><span style="color: #569CD6">find_package</span><span style="color: #D4D4D4">(Imath REQUIRED)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Add an executable and provide the source file directly.</span></span>
<span class="line"><span style="color: #569CD6">add_executable</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> main.cpp)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Make sure you link your executable with your library. Notice the namespace that we defined earlier.</span></span>
<span class="line"><span style="color: #569CD6">target_link_libraries</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE Imath::Imath)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Fix: CMake can&#39;t find Imath headers, as not properly set in IMath&#39;s CMake file. Include it manually here ...</span></span>
<span class="line"><span style="color: #569CD6">target_include_directories</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE </span><span style="color: #CE9178">&quot;${imath_SOURCE_DIR}/src&quot;</span><span style="color: #D4D4D4">)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The bulk of the <code>CMakeLists.txt</code> is the same, but lines 13-26 were added to deal with finding the Imath library online and making it available to the current project. If we want to make FetchContent available in our project, we first need to include it, as done on line 14. This will make calls to the FetchContent API available.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then use the <code>FetchContent_Declare</code> on line 17 (you have to admire CMake's inconsistent usage of <a href="https://www.pluralsight.com/blog/software-development/programming-naming-conventions-explained" target="_blank" rel="noopener" title="">naming conventions</a>, <code>FetchContent_Declare</code> uses both Pascal case and (capitalised) snake case, while other calls like <code>add_executable()</code> on line 32, use pure snake case. Software engineering at its best!). The arguments are a target name, so we can refer to it later (line 17, here <code>Imath</code>), and then we simply specify the GitHub repository, along with the version we want to download.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The call to <code>FetchContent_MakeAvailable()</code> (seriously, I feel compelled to write a strongly worded letter to the makers of CMake. Is it just me or is this naming abomination inducing anxiety for you, too?) is responsible (for anxiety, but also) for compiling the project during the build stage. And in theory, that's it. All you need is a call to <code>FetchContent_Declare()</code> and <code>FetchContent_MakeAvailable()</code> (and perhaps to your doctor), to get dependencies into your project. But you see, life isn't that simple.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you tried to only use these two statements, which the CMake documentation promises you is all you need, then you run into trouble. Depending on which version of the library you use, you get different error messages, but they are all related to the same underlying issue. The problem is that CMake can't find the path to the header files (i.e. the include path). As a result, the project won't be able to be compiled.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, we have to manually hack this into the CMake build script, and this is what we do on line 26. By calling <code>FetchContent_GetProperties()</code>, we expose a few variables from the fetched project that we can use in our own project. One of these variables is <code>imath_SOURCE_DIR</code>, which will point to the Imath root folder, which was downloaded and extracted as part of the <code>FetchContent_MakeAvailable()</code> call. We use this information to include the directory with all header files on line 38 for the current project, i.e. <code>imath_SOURCE_DIR/src/Imath</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With this call, our project can be compiled again. Let's see how we can do that. If you have downloaded the source code at the top of this article, change into the <code>FetchContent/build/</code> folder. Then, simply execute this following line (and use your favourite build tool if Ninja is not for you):</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake -DCMAKE_BUILD_TYPE=Debug -G Ninja ..","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_BUILD_TYPE=Debug\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-G\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eNinja\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e..\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake -DCMAKE_BUILD_TYPE=Debug -G Ninja ..</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_BUILD_TYPE=Debug</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-G</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Ninja</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">..</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Then, we go ahead and build the project as usual:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dbuild .","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --build .</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>You will notice that the build now requires slightly longer compared to the previous section, since we are building the Imath library now along with our own project. Once this is done, we can execute the tests again using</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\ImathTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eImathTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>.\ImathTest.exe</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">.\</span><span style="color: #DCDCAA">ImathTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on Windows, and</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./ImathTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./ImathTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>./ImathTest</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./ImathTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on UNIX. Happy days, it is working (hopefully), and we can now automatically handle all dependencies, without any issues, right? Well, I mentioned earlier that there are some issues with the FetchContent API (and for that matter, with ExternalProject as well), let me elaborate.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I have used FetchContent extensively on a project where I was developing a graphical user interface to do some geometry clean-up tasks. This software was reading in a <code>*.stl</code> file and my goal was to split it into separate sections so that I could apply separate boundary conditions to separate collection of triangles in OpenFOAM's mesh generator snappyHexMesh. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The project required a graphical user interface library (I used <a href="https://www.wxwidgets.org/" target="_blank" rel="noopener" title="">wxWidgets</a>), as well as OpenGL, to display 3D graphics on the screen, which I could embed into a wxWidgets window. OpenGL was already on my system, but interfacing it required a few more libraries like GLM (for mathematical operations, very similar to what Imath is doing) and <a href="https://glew.sourceforge.net/" target="_blank" rel="noopener" title="">GLEW</a> (communicating with the OpenGL layer itself), which I attempted to include, as best as possible, with FetchContent and ExternalProject.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Long story short, for simple libraries, FetchContent works like a charm; for anything more complicated, you'll start hacking solutions into your CMake files that are brittle and likely break regardless. I was able to come up with a solution that took a good two weeks to test and validate, only to find out six months later that it did not work anymore, even though I didn't change my CMake version nor any version of the dependencies I was downloading. It's one of many <a href="https://en.wikipedia.org/wiki/Heisenbug" target="_blank" rel="noopener" title="">Heisenbugs</a> I produced over the years.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the end, I replaced that with a custom python script which was handling the downloading, compiling, and installing of the dependencies. it is working to this day without issues.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The other issue is complex dependencies. Take the <a href="https://cgns.github.io/" target="_blank" rel="noopener" title="">CGNS library</a>, for example. If you want to be a CFD engineer of the 21st century, you'll likely want to use it with HDF5 as the underlying compression algorithm. HDF5 requires zlib, in return, and so if you want to built the CGNS library, you first need to build HDF5, and to build HDF5, you first need to build zlib. This rat tail of dependencies is something FetchContent probably can handle, but I wasn't able to get it to work, and I have tried it a few times years ago (perhaps it has changed now).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>While the idea of having someone else handle your dependencies is great, ExternalProject and FetchContent do not live up to that expectation for me. I am not saying that these tools aren't mature enough; they are quite decent, but they are brittle and difficult to use for a wide range of dependencies. As a result, I would not recommend using it, but it is good to be aware on a conceptual level, at least, of what these two methods can do. Instead, I would recommend using a package manager, and this is what we will look into next.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-preferred-way-using-a-package-manager">The gold standard: Using a package manager (Conan, not its mentally insane brother, vcpkg!)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We did <a href="https://cfd.university/learn/how-to-compile-write-and-use-cfd-libraries-in-c/how-to-handle-c-libraries-with-a-package-manager/#aioseo-using-a-package-manager" target="_blank" rel="noopener" title="">look at package managers</a> a while ago, and we had a brief look at how to use them to build dependencies. In our example, we looked at the CGNS library. At that point, though, I have not talked about CMake yet, so some of the details may have gone over your head. I'll summarise the steps here again.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There are two reasons why I prefer using a package manager for C++, and Conan in particular. Conan is one of the larger package managers and has receipts for pretty much any library out there. Given that users can contribute Conan recipes to build their own library, chances are that the library you want to build already has a Conan recipe available.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Some libraries, though, just can't be built with Conan. I call that the PETSc test. PETSc is a very powerful and capable library to solve linear systems of the form [katex]\mathbf{Ax}=\mathbf{b}[/katex]. It has tons of linear algebra solvers, preconditioners, and native support for parallel processing using MPI, which makes it a great tool to drop into your CFD solver. The only issue is, it compiles on UNIX platforms only, there isn't any support for Windows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Before you jump in my face, yes, I know, you can use it on Windows with mingw. But then I would argue, you can also use it on Windows using the Windows Subsystem for Linux (WSL). Mingw is based on UNIX tools and not a native Windows solution, so when I say there is no support for Windows, I mean native support using Microsoft's compilers.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Consequently, Conan does not list PETSc, as it is difficult to build on different platforms. This also means, however, that if something is available on Conan, then chances are high that you can use it on any operating system, and you don't lock yourself into a UNIX-only situation, as many CFD developers do.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Of course, dependency management also becomes as simple as specifying which library you want Conan to download for you and then use it. The best part, though, about Conan is that it will check your system and hardware architecture. If the library has already been built for this platform and hardware, Conan will simply download the compiled version instead of downloading the source code and compiling it from scratch. This saves on compilation time and is a huge advantage.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once Conan is done and has collected all dependencies, it exposes those to CMake through a toolchain file. What is a toolchain in CMake? Loosely speaking, a toolchain contains information about all the tools we need to develop a project. At a minimum, we need a compiler and a linker. However, when we depend on other libraries, these become part of the toolchain, and Conan will write the path, the header files, the library itself, and the name of the library, as well as any other necessary information, into a toolchain file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we then use the toolchain during the compilation, CMake knows where to find all of this information. In general, we always need a toolchain when using CMake, but usually, we just use the default one provided by CMake, i.e. CMake will guess where to find the compiler and linker (e.g. <code>/usr/bin/</code> on most UNIX platforms) and as long as they are available, we don't have to provide a toolchain explicitly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you think about it, this is very similar to what we did two sections ago, where we provided an explicit directory to CMake to search for header files and libraries, i.e. by specifying <code>-DCMAKE_PREFIX_PATH=C:\temp</code> or <code>-DCMAKE_PREFIX_PATH=~/temp</code> during the configuration stage. CMake was then looking by itself for the required compiler and linker, and combined with the provided directory, had all the informaton required to build our project. A toolchain just collects all of that information and we just have tell CMake to use that toolchain file. Let's see how we can achieve this.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-the-unmodified-cmake-build-script">The (unmodified?) CMake build script</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Yes, that's right, we don't have to change anything about our CMake build script. Since Conan version 2 and onwards, we have used the aforementioned toolchain technique. In version 1, we needed to include a few additional settings in our CMake file, meaning that Conan-specific instructions were included in our build script, even if we didn't plan on using Conan. Using the toolchain option allows us to write a clean build script. For completeness, the <code>CMakeLists.txt</code> file is given below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake_minimum_required(VERSION 3.23)\n\nproject(\n  ImathTest\n  VERSION 1.0\n  LANGUAGES CXX\n)\n\n# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\nset(CMAKE_CXX_STANDARD 20)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\nfind_package(Imath REQUIRED)\n\n# Add an executable and provide the source file directly.\nadd_executable(${CMAKE_PROJECT_NAME} main.cpp)\n\n# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\ntarget_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ecmake_minimum_required\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(VERSION 3.23)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eproject\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ImathTest\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  VERSION 1.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  LANGUAGES CXX\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD 20)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eset\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(CMAKE_CXX_STANDARD_REQUIRED \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eON\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efind_package\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(Imath REQUIRED)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Add an executable and provide the source file directly.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eadd_executable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e main.cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# Make sure you link your executable with your library. Notice the namespace that we defined earlier.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etarget_link_libraries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e${CMAKE_PROJECT_NAME}\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e PRIVATE Imath::Imath)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cmake","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake_minimum_required(VERSION 3.23)

project(
  ImathTest
  VERSION 1.0
  LANGUAGES CXX
)

# Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found
find_package(Imath REQUIRED)

# Add an executable and provide the source file directly.
add_executable(${CMAKE_PROJECT_NAME} main.cpp)

# Make sure you link your executable with your library. Notice the namespace that we defined earlier.
target_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE Imath::Imath)</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">cmake_minimum_required</span><span style="color: #D4D4D4">(VERSION 3.23)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">project</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">  ImathTest</span></span>
<span class="line"><span style="color: #D4D4D4">  VERSION 1.0</span></span>
<span class="line"><span style="color: #D4D4D4">  LANGUAGES CXX</span></span>
<span class="line"><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Set the C++ standard to C++20 (required to get pi, honestly, C++ added pi only in the year 2020 ...)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD 20)</span></span>
<span class="line"><span style="color: #569CD6">set</span><span style="color: #D4D4D4">(CMAKE_CXX_STANDARD_REQUIRED </span><span style="color: #569CD6">ON</span><span style="color: #D4D4D4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Find packages will search for a specific library. CMake will fail if the package is REQUIRED but not found</span></span>
<span class="line"><span style="color: #569CD6">find_package</span><span style="color: #D4D4D4">(Imath REQUIRED)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Add an executable and provide the source file directly.</span></span>
<span class="line"><span style="color: #569CD6">add_executable</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> main.cpp)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># Make sure you link your executable with your library. Notice the namespace that we defined earlier.</span></span>
<span class="line"><span style="color: #569CD6">target_link_libraries</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">${CMAKE_PROJECT_NAME}</span><span style="color: #D4D4D4"> PRIVATE Imath::Imath)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>As you can see for yourself, it is exactly the same as in the section where we manually provided the location to our library and so we can treat both Conan and CMake as either separate entities or combine them, without having to modify any code/instructions.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-input-files-for-conan">Input files for Conan</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>What we have to do, though, is to provide a so-called <code>conanfile.txt</code>. This file collects all the libraries, including their version, that we want to build and have made available for our current project. In our example, this file will look like the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"[requires]\nimath/3.1.11\n\n[generators]\nCMakeDeps\nCMakeToolchain","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[requires]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eimath/3.1.11\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[generators]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eCMakeDeps\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eCMakeToolchain\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>[requires]
imath/3.1.11

[generators]
CMakeDeps
CMakeToolchain</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">[requires]</span></span>
<span class="line"><span style="color: #D4D4D4">imath/3.1.11</span></span>
<span class="line"><span style="color: #D4D4D4"></span></span>
<span class="line"><span style="color: #D4D4D4">[generators]</span></span>
<span class="line"><span style="color: #D4D4D4">CMakeDeps</span></span>
<span class="line"><span style="color: #D4D4D4">CMakeToolchain</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we say that the library Imath, version 3.1.11, is <code>required</code>. This means Conan will download and build (if necessary) this library and then create the files specified by the <code>generators</code>, where the <code>CMakeToolchain</code> in particular, is of interest. This is all; we just dealt with our dependency! But how do you know the library is available? Well, Conan comes with a corresponding website called Conan Center. It is like GitHub, where you can upload Conan recipes to build libraries (or, well, download them if you want to use them in your own project).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you search for Imath on Conan Center, you will get some instructions, including what to put into your <code>conanfile.txt</code>. It is pretty self-explanatory, and Conan gives you additional instructions for how to use Conan from the command line to get this dependency, as well as how to change your CMake file and what headers to include in your project! Give it a try and see the results for yourself. Conan Center provides a decent search algorithm as well, so you can search for features as well, and Conan will return libraries that have these implemented.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, searching for the keywords <em>linear library solver preconditioning</em> returns both Eigen and Armadillo as available libraries, and we can see that both of them have the features we need, and both of them work on Windows. Happy days! We no longer need PETSc! (Eigen is a header-only library, as these don't get compiled, they'll always work on all platforms, including Windows).</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-command-line-instruction-to-marry-cmake-with-conan-the-most-beautiful-day-of-your-and-my-life-dont-tell-my-wife">Command line instruction to marry CMake with Conan (the most beautiful day of your and my life (don't tell my wife ...))</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The first thing we need to do is to make Conan available. It is written in Python, and thus, we need Python available on our system. Python has its own package manager, called pip, and we use pip to install Conan on our system. Pip may not be installed by default if you install Python, but you can instruct Python to install it with</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"py -m ensurepip \u002d\u002dupgrade","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epy\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-m\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eensurepip\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dupgrade\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>py -m ensurepip --upgrade</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">py</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ensurepip</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--upgrade</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on Windows, and</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"python3 -m ensurepip \u002d\u002dupgrade","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epython3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-m\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eensurepip\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dupgrade\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>python3 -m ensurepip --upgrade</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">python3</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">ensurepip</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--upgrade</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>on UNIX. For additional information, see the <a href="https://pip.pypa.io/en/stable/installation/" target="_blank" rel="noopener" title="">pip documentation</a> (it is not rocket science; I trust you can handle it). Once pip is available, use it to get Conan:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"py -m pip install conan","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epy\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-m\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003epip\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003einstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003econan\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>py -m pip install conan</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">py</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">pip</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">conan</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>This command is for Windows, again, for UNIX, use the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"python3 -m pip install conan","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epython3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-m\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003epip\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003einstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003econan\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>python3 -m pip install conan</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">python3</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-m</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">pip</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">conan</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Now, we need to detect our default profile (which will be sufficient for now). The profile details which operating system you are running, whether you want to build it in release or debug mode, your hardware architecture, and so on. You can find details in the <a href="https://docs.conan.io/2/reference/config_files/profiles.html" target="_blank" rel="noopener" title="">Conan documentation</a>. This information is then used by Conan to check if a compiled library for your build type, hardware, and operating system already exists. If that is the case, Conan can simply download it as mentioned earlier, there is no need to compile t first.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To create a default profile, run the following command</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"conan profile detect \u002d\u002dforce","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003econan\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eprofile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003edetect\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dforce\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>conan profile detect --force</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">conan</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">profile</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">detect</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--force</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>This will give us some sensible default settings. On Windows, for example, this is what I am getting as my default profile:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"[settings]\narch=x86_64\nbuild_type=Release\ncompiler=msvc\ncompiler.cppstd=20\ncompiler.runtime=dynamic\ncompiler.version=193\nos=Windows","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[settings]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003earch=x86_64\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild_type=Release\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler=msvc\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.cppstd=20\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.runtime=dynamic\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.version=193\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eos=Windows\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":8,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>[settings]
arch=x86_64
build_type=Release
compiler=msvc
compiler.cppstd=20
compiler.runtime=dynamic
compiler.version=193
os=Windows</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">[settings]</span></span>
<span class="line"><span style="color: #D4D4D4">arch=x86_64</span></span>
<span class="line"><span style="color: #D4D4D4">build_type=Release</span></span>
<span class="line"><span style="color: #D4D4D4">compiler=msvc</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.cppstd=20</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.runtime=dynamic</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.version=193</span></span>
<span class="line"><span style="color: #D4D4D4">os=Windows</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Conan will now use that information whenever it needs it. For completeness, running conan on WSL (i.e. Ubuntu on Windows) gives me the following information:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"[settings]\narch=x86_64\nbuild_type=Release\ncompiler=gcc\ncompiler.cppstd=gnu20\ncompiler.libcxx=libstdc++11\ncompiler.version=11\nos=Linux","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[settings]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003earch=x86_64\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild_type=Release\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler=gcc\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.cppstd=gnu20\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.libcxx=libstdc++11\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecompiler.version=11\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eos=Linux\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":8,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>[settings]
arch=x86_64
build_type=Release
compiler=gcc
compiler.cppstd=gnu20
compiler.libcxx=libstdc++11
compiler.version=11
os=Linux</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">[settings]</span></span>
<span class="line"><span style="color: #D4D4D4">arch=x86_64</span></span>
<span class="line"><span style="color: #D4D4D4">build_type=Release</span></span>
<span class="line"><span style="color: #D4D4D4">compiler=gcc</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.cppstd=gnu20</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.libcxx=libstdc++11</span></span>
<span class="line"><span style="color: #D4D4D4">compiler.version=11</span></span>
<span class="line"><span style="color: #D4D4D4">os=Linux</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Slightly different, but again, these are just default values Conan will use during compilation if need be. We can now start to think about different profiles, i.e. we may want to create a developer profile, where we build everything in debug mode, and a release profile to optimise our build for performance.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's make one change to the default profile to see how we can modify it. All profiles are located in your home directory (i.e. <code>C:\Users\&lt;username&gt;\</code> on Windows and <code>/home/&lt;username&gt;/</code> on UNIX). Here, you have a hidden folder called <code>.conan2/</code>, where you have a <code>profiles/</code> folder. All profiles that you want to use are stored here. In my case, the default profile I just created is at <code>C:\Users\tom\.conan2\profiles\default</code> on Windows, and <code>/home/tom/.conan2/profiles/default</code> on UNIX.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we open that file, we see the same content as above. I want to tell Conan that my preferred generator in CMake is Ninja. Otherwise, it will assume I use the default generator for my platform (which is MSBuild on Windows and Makefiles on Linux). We can see from <a href="https://docs.conan.io/2/examples/tools/cmake/cmake_toolchain/use_different_toolchain_generator.html" target="_blank" rel="noopener" title="">Conan's documentation</a> that we need to add the following section at the end of the file.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"[conf]\ntools.cmake.cmaketoolchain:generator=Ninja","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[conf]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003etools.cmake.cmaketoolchain:generator=Ninja\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>[conf]
tools.cmake.cmaketoolchain:generator=Ninja</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">[conf]</span></span>
<span class="line"><span style="color: #D4D4D4">tools.cmake.cmaketoolchain:generator=Ninja</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>If you don't have Ninja installed or you are happy with the default generator, then you can skip this step. If you want to create a new profile, simply copy the <code>default</code> profile and make changes as you need. You can see a <a href="https://docs.conan.io/2/reference/config_files/profiles.html" target="_blank" rel="noopener" title="">full list of supported sections and options</a> in the documentation that you can set in your profiles.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With a profile in place (you only have to do this once after installing Conan, not every time you plan on running Conan), we can open a console, change into the Conan folder provided in the download at the beginning of this article, and then install all required dependencies (here just Imath). We use the following command for that:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"conan install . \u002d\u002doutput-folder=build \u002d\u002dbuild=missing \u002d\u002dsettings=build_type=Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003econan\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003einstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002doutput-folder=build\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild=missing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dsettings=build_type=Debug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>conan install . --output-folder=build --build=missing --settings=build_type=Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">conan</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--output-folder=build</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build=missing</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--settings=build_type=Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We instruct Conan to install our dependencies (which will include a built step if required) and to look for the <code>conanfile.txt</code> in the current directory (indicated by the dot (<code>.</code>)) We tell it to store all dependencies in the <code>build/</code> folder, and only to build dependencies if they are not available as precompiled binaries. We are also overwritting here some settings from our default profile, just to show that we can. Alternatively, you can copy the <code>default</code> profile, change the <code>build_type</code> to <code>Debug</code>, and then use that profile instead.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's assume that we have such a profile, which we have called <code>dev</code>, then we can use it during the Conan install step as</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"conan install . -pr=dev \u002d\u002doutput-folder=build \u002d\u002dbuild=missing \u002d\u002dsettings=build_type=Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003econan\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003einstall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-pr=dev\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002doutput-folder=build\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild=missing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dsettings=build_type=Debug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>conan install . -pr=dev --output-folder=build --build=missing --settings=build_type=Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">conan</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">install</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-pr=dev</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--output-folder=build</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build=missing</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--settings=build_type=Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Running <code>conan install -h</code>, by the way, shows all the options we can specify, and this will provide us with all the options that we can pass on to the <code>install</code> step. This works for other sections as well, i.e. we can also do <code>conan profile -h</code>, which will show us the relevant help section for the <code>profile</code> command.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once all dependencies are installed and put into our <code>build/</code> folder, we can change into the <code>build/</code> folder in our console, and then execute the CMake configuration step using the following command:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_TOOLCHAIN_FILE=\u0022conan_toolchain.cmake\u0022 -G Ninja ..","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_BUILD_TYPE=Debug\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DCMAKE_TOOLCHAIN_FILE=\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;conan_toolchain.cmake\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-G\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eNinja\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e..\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_TOOLCHAIN_FILE="conan_toolchain.cmake" -G Ninja ..</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_BUILD_TYPE=Debug</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DCMAKE_TOOLCHAIN_FILE=</span><span style="color: #CE9178">&quot;conan_toolchain.cmake&quot;</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-G</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Ninja</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">..</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Notice that we now specify the toolchain file <code>conan_toolchain.cmake</code>, which was generated by Conan as an output and which is located in the <code>build/</code> folder. If you look through this file, you'll notice that it essentially provides the path to where to find the library, with some additional compiler and linker flags that are hardware and platform-specific (potentially). Your <code>conan_toolchain.cmake</code> file may be located in a subdirectory, conan likes to change things from release to release. Adapat your path accordingly in the command above. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you specified the CMake generator to be Ninja in your Conan profile, then you must specify it here as well with the <code>-G Ninja</code> flag, otherwise you likely run into trouble, as Conan has written its toolchain file assuming Ninja will be used. On Windows, for example, the default build system (MSBuild) has a different build layout compared to Ninja, i.e. these are incompatible, and if you omit <code>-G Ninja</code> here and MSBuild is used instead, you will get an error.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you are not sure, then simply remove the <code>[conf]</code> section from your Conan profile (if you have added that as shown in the step above). Do not provide a generator during the CMake configurations tep, i.e. remove the <code>-G Ninja</code> instruction, and then, both Conan and CMake will correctly guess the right build tool on your system and use it correctly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To build our test project, run</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cmake \u002d\u002dbuild . \u002d\u002dconfig Debug","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecmake\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u002d\u002dconfig\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eDebug\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>cmake --build . --config Debug</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cmake</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">--config</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">Debug</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>which should make the test executables available. On Windows, verify this by running</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\ImathTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eImathTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>.\ImathTest.exe</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">.\</span><span style="color: #DCDCAA">ImathTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>or, if you are on UNIX, execute</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./ImathTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./ImathTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"seeMoreCollapse":false,"seeMoreCollapseString":"","highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","copyButtonUseTextarea":true,"useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><textarea class="code-block-pro-copy-button-textarea" aria-hidden="true" readonly>./ImathTest</textarea><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./ImathTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>You should be seeing the same output as with the previous two approaches using the native <code>find_package()</code> and <code>FetchContent_Declare|MakeAvailable()</code> commands.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have taken your skills on how to handle dependencies with CMake to the next level by first considering how to use the primitive approach of managing dependencies yourself (i.e. manually downloading, compiling and installing dependencies) and then looking at more advanced approaches by letting CMake (using FetchContent) or Conan manage all dependencies for you.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this day and age, we have technologies available to handle all of our dependency management needs, and I would strongly recommend that you at least try to use Conan for one of your projects. Dependency management has never felt that great, it is the same feeling switching from a normal keyboard to a mechanical one, the typing just feels that much different (and better!).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This article, together with the previous one, really exposes how to efficiently and effectively deal with dependencies, be it writing your own libraries and making these available to others (previous article), or, using someone elses libraries in your project (current article). From today, you have no good excuse not to use someone elses library and isntead of reinventing the wheel, see if someone has not already provided a library for what you want to achieve, and then just use it, your productivity will increase significantly as a result, I guarantee it!</p>
<!-- /wp:paragraph -->