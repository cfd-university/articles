<!-- wp:paragraph -->
<p>In this article, we look at the last remaining topic in our series on software testing; Mocking. This aspect plays a a very big role in the testing of web and mobile applications, but not so much for console applications such as CFD solvers. However, there are specific use cases where mocking can help us avoid writing brittle and slow tests, and we will look at some specific cases where we may want to use mocking instead of using actual production code.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We exemplify mocking by writing a quick project in which we read some input parameter files but instead of reading actual files from disk during the test, which can be rather slow, we replace the function to read a file from disk with a mock. Since we have already used Google Test (gtest) in previous examples, we stick with this testing framework, which happens to have a mocking framework included (called gmock). We will see how simple and quickly we can write a mocked interface and create expected behaviours for these mocks with our example.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>By the end of this article, we will have gone through a real mocking example and have seen how to integrate that into our unit testing workflow. We also discuss where mocking may be useful in terms of testing CFD applications and you should be sensibilised as to when you may want to use mocking in your own projects.</p>
<!-- /wp:paragraph -->

<!-- wp:block {"ref":2490} /-->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>Download</strong>: <a href="https://cfd.university/download/software-testing-part-5/?tmstv=1712896972" title="">Software-Testing-Part-5.zip</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="the-complete-guide-to-software-testing-for-cfd-applications"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this articles</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":9,"blockClientId":"620ee9c1-3d18-469a-bb7c-46105dd89227","content":"Introduction to mocking","level":2,"anchor":"aioseo-introduction-to-mocking","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":16,"blockClientId":"3eb3b0bd-cc9e-43d7-99c0-c5e8a099d819","content":"Preparing code for mocking","level":3,"anchor":"aioseo-preparing-code-for-mocking","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":19,"blockClientId":"108fbaa8-bcbe-40ee-ab43-d380f743547b","content":"Example: Mocking the reading of parameter files","level":2,"anchor":"aioseo-example-mocking-parameter-reading","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":21,"blockClientId":"714aa271-4c89-4643-82a8-ce73a59513c6","content":"Prerequisites: The JSON file format","level":3,"anchor":"aioseo-prerequisites-nlohmannjson-library","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":29,"blockClientId":"f638765f-21db-42be-8255-618ea40fbb1c","content":"Reading JSON files in C++ with the nlohmann::json library","level":4,"anchor":"aioseo-reading-json-files-in-c-with-the-c-nlohmannjson-library","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":33,"blockClientId":"f82ed581-0e1a-4dea-a009-256e44cb8561","content":"Project structure and build files","level":3,"anchor":"aioseo-project-structure-and-build-files","order":5,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":43,"blockClientId":"ab1dbac1-df3a-4a9b-b1b7-db57d52fdd0b","content":"Parameter reading files","level":3,"anchor":"aioseo-parameter-reading-files","order":6,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":45,"blockClientId":"4064601d-6c76-45df-830c-094e439ebf81","content":"Parameter file reading base class","level":4,"anchor":"aioseo-interface","order":7,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":48,"blockClientId":"7f0e2d34-b821-4f37-aff0-bcd764b80d16","content":"JSON-based parameter file reading","level":4,"anchor":"aioseo-json-based-parameter-file-reading","order":8,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":53,"blockClientId":"09b0840d-0b9d-4ae3-9491-ebf489d79ef0","content":"Testing parameter file reading with gmock","level":3,"anchor":"aioseo-testing-parameter-file-reading-with-gmock","order":9,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":56,"blockClientId":"71849b4c-fd1f-4622-915b-621a75ff4cea","content":"Mocking the parameter file reading interface","level":4,"anchor":"aioseo-mocking-the-parameter-file-reading-interface","order":10,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":63,"blockClientId":"98ec70cd-8dda-4faa-a444-77e09081e975","content":"Writing a unit test using the mocked parameter file reading implementation","level":4,"anchor":"aioseo-writing-a-unit-test-with-mocking","order":11,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":73,"blockClientId":"73f642dd-699b-437f-b72f-3ff527109e7d","content":"Test output","level":3,"anchor":"aioseo-test-output","order":12,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":77,"blockClientId":"38013bf0-5251-4af1-b4cd-cc6847536fb0","content":"Summary","level":2,"anchor":"aioseo-summary","order":13,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-introduction-to-mocking">Introduction to mocking</a><ul><li><a href="#aioseo-preparing-code-for-mocking">Preparing code for mocking</a></li></ul></li><li><a href="#aioseo-example-mocking-parameter-reading">Example: Mocking the reading of parameter files</a><ul><li><a href="#aioseo-prerequisites-nlohmannjson-library">Prerequisites: The JSON file format</a><ul><li><a href="#aioseo-reading-json-files-in-c-with-the-c-nlohmannjson-library">Reading JSON files in C++ with the nlohmann::json library</a></li></ul></li><li><a href="#aioseo-project-structure-and-build-files">Project structure and build files</a></li><li><a href="#aioseo-parameter-reading-files">Parameter reading files</a><ul><li><a href="#aioseo-interface">Parameter file reading base class</a></li><li><a href="#aioseo-json-based-parameter-file-reading">JSON-based parameter file reading</a></li></ul></li><li><a href="#aioseo-testing-parameter-file-reading-with-gmock">Testing parameter file reading with gmock</a><ul><li><a href="#aioseo-mocking-the-parameter-file-reading-interface">Mocking the parameter file reading interface</a></li><li><a href="#aioseo-writing-a-unit-test-with-mocking">Writing a unit test using the mocked parameter file reading implementation</a></li></ul></li><li><a href="#aioseo-test-output">Test output</a></li></ul></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-introduction-to-mocking">Introduction to mocking</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Up until this point, we have taken a deep dive into testing and used Google's<a href="https://google.github.io/googletest/primer.html" target="_blank" rel="noopener" title=""> gtest testing framework</a> to write our <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-get-started-with-software-testing-for-cfd-codes" target="_blank" rel="noopener" title="">unit, integration, and system tests</a>. We have applied this to our <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c" target="_blank" rel="noopener" title="">linear algebra solver</a> and <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns" target="_blank" rel="noopener" title="">mesh reading library</a> to write these tests with and without <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-test-a-cgns-based-mesh-reading-library-using-gtest#aioseo-introducing-test-fixtures" target="_blank" rel="noopener" title="">test fixtures</a>, all while following the <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/the-test-driven-development-for-writing-bug-free-cfd-code" target="_blank" rel="noopener" title="">test-driven development</a> approach.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What we have learned thus far is sufficient to test pretty much any project and there will be rarely any cases that will be difficult to test. However, <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-get-started-with-software-testing-for-cfd-codes#aioseo-" target="_blank" rel="noopener" title="">when we first started to talk about testing</a>, I mentioned that mocking is a way of replacing external dependencies. Classical examples are interaction with a graphical user interface or external dependencies such as web requests and accessing a database.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I also mentioned that there are two different kinds of testing approaches, the <em>classical school</em> and the London school of unit testing. In the classical approach, we test our code without replacing dependencies with mocks, whereas in the London school approach, we replace all external dependencies which are mutable by mocks. Mutable here means any dependencies whose internal state can change. We used the example of the matrix-vector multiplication where we may want to mock the vector class. The values (internal state) of the vector can change, and thus it is mutable.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, even if we want to stick with the classical approach and don't want to replace dependencies (be it internal or external) with mocks, there are still good examples where we may want to consider mocking. A list of possible examples is given below:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>File reading</strong>: Depending on the file type and the complexity of reading from it, input and output operations may become excessively slow. If we have to go through a few of these files in our test base, then executing tests will become rather slow. If we compare the time it took to run our <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-test-a-cgns-based-mesh-reading-library-using-gtest#aioseo-test-execution" target="_blank" rel="noopener" title="">mesh reading unit tests</a> and our <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-test-a-linear-algebra-solver-library-using-gtest#aioseo-test-execution" target="_blank" rel="noopener" title="">linear algebra solver unit, integration, and system test</a> combined, the mesh reading tests took 243 milliseconds, vs. the 1 millisecond of the linear algebra solver library tests. Thus, the mesh file reading has a clear overhead in this test.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>Random number generators</strong>: If we want to include code that relies on random numbers, such as a <a href="https://www.sciencedirect.com/science/article/abs/pii/S0045793009001601?via%3Dihub" target="_blank" rel="noopener" title="">synthetic turbulence generator for inlet boundary conditions for large eddy simulations</a> (LES), then we probably want to have some way of influencing the way the random numbers are generated. We need this to be able to repeatedly test our code that does not involve any random behaviour.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>Hardware dependencies</strong>: CFD applications are notoriously CPU-intensive and as a result, parallel computing is a must for any serious 3D solver. Testing and parallel computing bring their own challenges. For example, we may want to include <a href="https://developer.nvidia.com/cuda-toolkit" target="_blank" rel="noopener" title="">GPU computing using CUDA</a>, but what if the test is run on a computer that doesn't have a GPU? If a test fails because the hardware is not available, our tests become brittle and don't test the code but rather the hardware that is available. Mocking hardware dependencies is a good idea in this case.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>Solver components</strong>: Related to the file reading example provided above, mocking entire solver components may become necessary to save time. Let's assume we do mesh generation as part of our solver. Even generating a small mesh may take a few seconds, depending on the complexity of our mesh generator. If we want to write an integration test that calculates mesh quality metrics based on a generated mesh, we may not want to wait for a few seconds just to perform a calculation that takes milliseconds. Mocking components can be lucrative in this case.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>So we can see that there are good examples where we want to mock dependencies. So let's have a look at the prerequisite of mocking, how do we prepare our code to make use of mocking?</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-preparing-code-for-mocking">Preparing code for mocking</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>There is pretty much just one prerequisite and that is that you have to have a <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/handling-inheritance-in-c" target="_blank" rel="noopener" title="">class hierarchy</a>, i.e. you need to have a base class (sometimes we also refer to it as an interface), from which other classes inherit. Take our CGNS library as an example, we had the mesh reading base class, from which we inherited both a structured and unstructured mesh reading class. Or, in the case of our linear algebra solver library, we create a solver base class from which we inherited to create the conjugate gradient class.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The idea here is that we inherit from this base class and then tell our mocking framework which functions exist and which ones we want to potentially <code>override</code>, and then later in the test code, we create an object from this mocked class where we then specify what these mocked classes ought to return. This sounds overly complicated, so let's jump straight in and look at an example where we can discuss the nuances of mocking more easily.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-example-mocking-parameter-reading">Example: Mocking the reading of parameter files</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I want to look at a proper example that is not too complicated to follow and look at something new and fresh. We have been looking at the mesh reading and linear algebra solver library extensively and while there is a good potential to mock something in either case, I wanted to come up with a fresh example and look at something we may want to implement into our solver later: parameter reading from an input file.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-prerequisites-nlohmannjson-library">Prerequisites: The JSON file format</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>When it comes to parameter reading, there are countless file types and bespoke solutions available that allow us to read data from disk into our solver. I want to look at a somewhat non-native C++ solution, which is however widely used in pretty much every other programming language. I am talking about the Javascript Object Notation, os <a href="https://en.wikipedia.org/wiki/JSON" target="_blank" rel="noopener" title="">JSON</a> file format.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>JSON files follow the notation we would use in Javascript to define classes. They just turn out to be very useful and straightforward to understand and so the file type itself has been widely adopted for parameter files. Other popular choices are <a href="https://en.wikipedia.org/wiki/YAML" target="_blank" rel="noopener" title="">YAML</a> and <a href="https://en.wikipedia.org/wiki/TOML" target="_blank" rel="noopener" title="">TOML</a>, which look more or less similar to JSON and are used in other parts of programming. We have come across TOML files already when we looked at Conan - the C++ package manager - and YAML files will cross our path later when we discuss <a href="https://www.infoworld.com/article/3271126/what-is-cicd-continuous-integration-and-continuous-delivery-explained.html">continuous integration and delivery</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You won't find many CFD solvers using either JSON, TAML, or TOML files, and I think the reason is that CFD developers quite often seem to be disconnected from the rest of the software engineering world. Pretty much everyone else working in the broad field of software engineering uses JSON, YAML, and TOML on a daily basis, so I think we need to move on as well and learn at least one of these file formats.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we wanted to store a few inputs in a JSON file, we would have to define the file first, so let's look at an example:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"{\n  \u0022meshing\u0022: {\n    \u0022file\u0022: \u0022structured2D.cgns\u0022\n  },\n  \u0022solver\u0022: {\n    \u0022inner_iterations\u0022: 20,\n    \u0022outer_iterations\u0022: 2000,\n    \u0022CFL\u0022: 0.5,\n    \u0022residual_threshold\u0022: {\n      \u0022pressure\u0022: 1e-10,\n      \u0022velocity\u0022: 1e-10\n    },\n    \u0022underrelaxation\u0022: [0.3, 0.7, 0.7],\n    \u0022turbulence\u0022: {\n      \u0022model\u0022: \u0022k-epsilon\u0022,\n      \u0022sigma\u0022: 1.0\n    }\n  },\n  \u0022write_output\u0022: true\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;meshing\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;file\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;structured2D.cgns\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;solver\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;inner_iterations\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;outer_iterations\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;CFL\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.5\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;residual_threshold\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;pressure\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1e-10\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;velocity\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1e-10\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;underrelaxation\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: [\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.7\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.7\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;turbulence\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;model\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;k-epsilon\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;sigma\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e\u0026quot;write_output\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e: \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"json","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="{
  &quot;meshing&quot;: {
    &quot;file&quot;: &quot;structured2D.cgns&quot;
  },
  &quot;solver&quot;: {
    &quot;inner_iterations&quot;: 20,
    &quot;outer_iterations&quot;: 2000,
    &quot;CFL&quot;: 0.5,
    &quot;residual_threshold&quot;: {
      &quot;pressure&quot;: 1e-10,
      &quot;velocity&quot;: 1e-10
    },
    &quot;underrelaxation&quot;: [0.3, 0.7, 0.7],
    &quot;turbulence&quot;: {
      &quot;model&quot;: &quot;k-epsilon&quot;,
      &quot;sigma&quot;: 1.0
    }
  },
  &quot;write_output&quot;: true
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">{</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">&quot;meshing&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;file&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">&quot;structured2D.cgns&quot;</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">&quot;solver&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;inner_iterations&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;outer_iterations&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">2000</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;CFL&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">0.5</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;residual_threshold&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">&quot;pressure&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1e-10</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">&quot;velocity&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1e-10</span></span>
<span class="line"><span style="color: #D4D4D4">    },</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;underrelaxation&quot;</span><span style="color: #D4D4D4">: [</span><span style="color: #B5CEA8">0.3</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.7</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0.7</span><span style="color: #D4D4D4">],</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;turbulence&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">&quot;model&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">&quot;k-epsilon&quot;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">&quot;sigma&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #B5CEA8">1.0</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">&quot;write_output&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Each JSON file starts with opening and closing curly braces (i.e. <code>{}</code>). Then, we simply define key/value pairs, where the key is given as a string, and the value can be anything between a string (line 15), a boolean (line 19), a sub-dictionary (lines 2-4, 5-18, 9-12, and 14-17), an integer (line 6), a floating point (line 8), or an array of values (line 13). Each key/value pair has to be ended with a comma unless it is the last entry within the JSON file or sub-dictionary (e.g. see lines 11, 16, and 19). And this is a JSON file explained in one paragraph, congratulations, you are a JSON expert now.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So we see how we can easily write a JSON file, but how about reading it? Well, if it has this nice structure, it would be easy to develop a class that parses a JSON file and returns the key/value pairs to us, but luckily, we don't have to reinvent the wheel and can use off-the-shelve solutions.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-json-files-in-c-with-the-c-nlohmannjson-library">Reading JSON files in C++ with the nlohmann::json library</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>When it comes to reading JSON files in C++, <a href="https://github.com/nlohmann/json" target="_blank" rel="noopener" title="">Niels Lohmann's JSON library</a> is pretty much what you want to be using, which is among the most popular libraries used for C++. The beauty of it is that it is a single header file that you need to throw into your project and you have access to the library, i.e. it is a single-file <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries/#aioseo-header-only-libraries" target="_blank" rel="noopener" title="">header-only library</a>. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, if you head over to the <a href="https://github.com/nlohmann/json/releases" target="_blank" rel="noopener" title="">latest release</a>, and scroll down to the Assets section (at the bottom of the release notes), you will find a file called <code>json.hpp</code>. If you can't be bothered, then use <a href="https://github.com/nlohmann/json/releases/download/v3.11.3/json.hpp" target="_blank" rel="noopener" title="">this link</a> to download it directly, but this will be for a specific library version (but to be fair, the core of the library doesn't change).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I have put all my libraries into <code>C:\libraries\</code> and <code>~/libs</code> on Windows and UNIX, respectively, and all header files live inside the <code>include</code> directory. If you look at example codes using the <code>nlohmann::json</code> library, it is common that the header file is located in a directory called <code>nlohmann</code>, and so I will follow that convention. This means that my <code>json.hpp</code> file is located in <code>C:\libraries\include\nlohmann\json.hpp</code> on Windows and <code>~/libs/include/nlohmann/json.hpp</code> on UNIX. If you want to use my build scripts, then you will need the same file structure.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-project-structure-and-build-files">Project structure and build files</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I don't want this to be a very long section, so I have decided to discuss the project structure together with the build scripts for Windows and UNIX.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The project structure for this discussion is shown below, where we have a parameter reading base class in the <code>src/</code> directory, from which we derive a variant that implements a certain interface using JSON files as the parameter files (we could have also interfaces for YAML, TOML, and even txt files if we wanted).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then, we provide our usual <code>tests/unit</code> directory to unit test the parameter file reading. You see that we have a file called <code>testParameterReadingJson.cpp</code> which will be the actual test code we compile, but also a file called <code>parameterReadingJsonMock.hpp</code>, where we mock the JSON file reading interface and we will see below how this is done.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"root\n├── src\n│   ├── parameterReadingBase.hpp\n│   └── parameterReadingJson.hpp\n├── tests\n│   ├── unit\n│   │   ├── parameterReadingJsonMock.hpp\n│   │   └── testParameterReadingJson.cpp\n│   └── mainTest.cpp\n├── buildAndRun.ps1\n└── buildAndRun.sh","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eroot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── src\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── parameterReadingBase.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── parameterReadingJson.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── tests\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── unit\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── parameterReadingJsonMock.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── testParameterReadingJson.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── mainTest.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.ps1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── buildAndRun.sh\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":11,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="root
├── src
│   ├── parameterReadingBase.hpp
│   └── parameterReadingJson.hpp
├── tests
│   ├── unit
│   │   ├── parameterReadingJsonMock.hpp
│   │   └── testParameterReadingJson.cpp
│   └── mainTest.cpp
├── buildAndRun.ps1
└── buildAndRun.sh" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">root</span></span>
<span class="line"><span style="color: #D4D4D4">├── src</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── parameterReadingBase.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── parameterReadingJson.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">├── tests</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── unit</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── parameterReadingJsonMock.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── testParameterReadingJson.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── mainTest.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.ps1</span></span>
<span class="line"><span style="color: #D4D4D4">└── buildAndRun.sh</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>In order to build our project, which essentially consists now of only the <code>mainTest.cpp</code> and <code>testParamterReadingJson.cpp</code> files (all other files are header files), we would build this simple project on Windows using the following build script:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"# clean up before building\nRemove-Item .\\build -Force -Recurse\nNew-Item -Name \u0022build\u0022 -ItemType \u0022directory\u0022\n\n# compile source files into object files\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c .\\tests\\unit\\testParameterReadingJson.cpp /Fo\u0022.\\build\\testParameterReadingJson.obj\u0022\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c .\\tests\\mainTest.cpp /Fo\u0022.\\build\\mainTest.obj\u0022\n\n# link object files\ncl.exe /nologo /EHsc /std:c++20 .\\build\\mainTest.obj .\\build\\testParameterReadingJson.obj /Fe\u0022.\\build\\parameterReadingTest.exe\u0022 /link /MACHINE:x64 /LIBPATH:\u0022C:\\libraries\\lib\u0022 gtest.lib gmock.lib\n\n# execute the test\n.\\build\\parameterReadingTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# clean up before building\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRemove-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build -Force -Recurse\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eNew-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Name \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;build\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -ItemType \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;directory\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c .\\tests\\unit\\testParameterReadingJson.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\testParameterReadingJson.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c .\\tests\\mainTest.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\mainTest.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build\\mainTest.obj .\\build\\testParameterReadingJson.obj /Fe\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\parameterReadingTest.exe\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /link /MACHINE:x64 /LIBPATH:\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\lib\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e gtest.lib gmock.lib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# execute the test\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\build\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eparameterReadingTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="# clean up before building
Remove-Item .\build -Force -Recurse
New-Item -Name &quot;build&quot; -ItemType &quot;directory&quot;

# compile source files into object files
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c .\tests\unit\testParameterReadingJson.cpp /Fo&quot;.\build\testParameterReadingJson.obj&quot;
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c .\tests\mainTest.cpp /Fo&quot;.\build\mainTest.obj&quot;

# link object files
cl.exe /nologo /EHsc /std:c++20 .\build\mainTest.obj .\build\testParameterReadingJson.obj /Fe&quot;.\build\parameterReadingTest.exe&quot; /link /MACHINE:x64 /LIBPATH:&quot;C:\libraries\lib&quot; gtest.lib gmock.lib

# execute the test
.\build\parameterReadingTest.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955"># clean up before building</span></span>
<span class="line"><span style="color: #DCDCAA">Remove-Item</span><span style="color: #D4D4D4"> .\build -Force -Recurse</span></span>
<span class="line"><span style="color: #DCDCAA">New-Item</span><span style="color: #D4D4D4"> -Name </span><span style="color: #CE9178">&quot;build&quot;</span><span style="color: #D4D4D4"> -ItemType </span><span style="color: #CE9178">&quot;directory&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object files</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c .\tests\unit\testParameterReadingJson.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\testParameterReadingJson.obj&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c .\tests\mainTest.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\mainTest.obj&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> .\build\mainTest.obj .\build\testParameterReadingJson.obj /Fe</span><span style="color: #CE9178">&quot;.\build\parameterReadingTest.exe&quot;</span><span style="color: #D4D4D4"> /link /MACHINE:x64 /LIBPATH:</span><span style="color: #CE9178">&quot;C:\libraries\lib&quot;</span><span style="color: #D4D4D4"> gtest.lib gmock.lib</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># execute the test</span></span>
<span class="line"><span style="color: #D4D4D4">.\build\</span><span style="color: #DCDCAA">parameterReadingTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>And on UNIX we would use the following bash script:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile\ng++ -c -g -O0 -std=c++20 -Wall -Wextra -I. -I ~/libs/include ./tests/unit/testParameterReadingJson.cpp -o ./build/testParameterReadingJson.o\ng++ -c -g -O0 -std=c++20 -Wall -Wextra -I. -I ~/libs/include ./tests/mainTest.cpp -o ./build/mainTest.o\n\n# link\ng++ -o build/parameterReadingTest ./build/mainTest.o ./build/testParameterReadingJson.o -L ~/libs/lib -lgtest -lgmock\n\n# run\n./build/parameterReadingTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./tests/unit/testParameterReadingJson.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/testParameterReadingJson.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./tests/mainTest.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/mainTest.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/parameterReadingTest\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/mainTest.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/testParameterReadingJson.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-L\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/lib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lgtest\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lgmock\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/parameterReadingTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile
g++ -c -g -O0 -std=c++20 -Wall -Wextra -I. -I ~/libs/include ./tests/unit/testParameterReadingJson.cpp -o ./build/testParameterReadingJson.o
g++ -c -g -O0 -std=c++20 -Wall -Wextra -I. -I ~/libs/include ./tests/mainTest.cpp -o ./build/mainTest.o

# link
g++ -o build/parameterReadingTest ./build/mainTest.o ./build/testParameterReadingJson.o -L ~/libs/lib -lgtest -lgmock

# run
./build/parameterReadingTest" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./tests/unit/testParameterReadingJson.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/testParameterReadingJson.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./tests/mainTest.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/mainTest.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/parameterReadingTest</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/mainTest.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/testParameterReadingJson.o</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-L</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/lib</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lgtest</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lgmock</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run</span></span>
<span class="line"><span style="color: #DCDCAA">./build/parameterReadingTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>By now, these probably look very familiar, i.e. we first compile both source files and then link them against the <code>gtest</code> library, but you will also notice that we have to link against <code>gmock</code> in both cases (line 10 for the PowerShell script and line 11 for the bash script). The remaining part of the build scripts follow very similar structures compared to what we saw in previous examples.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-parameter-reading-files">Parameter reading files</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>OK, so let's discuss the parameter file reading then. In this example, I really want to focus on mocking, so we will not write a fully-fledged parameter file reading implementation. Instead, we concentrate on the essentials and only provide an interface for file reading, but, for example, we don't implement any error checking, in case there is a typo in the input file, for example.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-interface">Parameter file reading base class</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The interface for the file reading class is given below. It consists of a <code>default</code> constructor and destructor, as well as a <code>read()</code> function, which is a <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/handling-inheritance-in-c/#aioseo-a-strict-interface-definition-using-pure-virtual-functions" target="_blank" rel="noopener" title="">pure virtual function</a> which needs to be implemented by any class deriving from this interface (including a mocked class). We also use a <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/templates-in-c-boost-your-cfd-solver-performance/" target="_blank" rel="noopener" title="">template parameter</a> on line 5, which we first store on line 8 and we use this on line 11 as the return type of the <code>read()</code> function. Since we potentially want to support different file types like JSON, YAML, or TOML, we need to allow to return different types from the <code>read()</code> function, hence the template parameter.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#include \u0026lt;filesystem\u003e\n\ntemplate \u0026lt;typename StorageType\u003e\nclass ParameterReaderBase {\npublic:\n  using FileType = StorageType;\n  ParameterReaderBase() = default;\n  virtual ~ParameterReaderBase() = default;\n  virtual FileType read(std::filesystem::path file) = 0;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eStorageType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eFileType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eStorageType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edefault\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e~ParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edefault\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eFileType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eread\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":12,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#include &lt;filesystem&gt;

template &lt;typename StorageType&gt;
class ParameterReaderBase {
public:
  using FileType = StorageType;
  ParameterReaderBase() = default;
  virtual ~ParameterReaderBase() = default;
  virtual FileType read(std::filesystem::path file) = 0;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4"> &lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">StorageType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ParameterReaderBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">FileType</span><span style="color: #D4D4D4"> = </span><span style="color: #4EC9B0">StorageType</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ParameterReaderBase</span><span style="color: #D4D4D4">() = </span><span style="color: #569CD6">default</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">~ParameterReaderBase</span><span style="color: #D4D4D4">() = </span><span style="color: #569CD6">default</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">FileType</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">read</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">file</span><span style="color: #D4D4D4">) = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-json-based-parameter-file-reading">JSON-based parameter file reading</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>For the JSON-based parameter reading class implementation, we first have to include the library for the JSON library which we do on line 6. We also include the parameter reading base definition on line 8 and a few C++ standard headers on lines 3-4 that we will need here.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 10, we define our JSON-based parameter reading class, which inherits from the base class. We can see that we specify here the template parameter to be of type <code>nlohmann::json</code>, i.e. this will be a JSON file. We then provide an implementation for the <code>read()</code> function, and you also see that we define everything in header files, rather than separating code into header and source files. When working with templates, it is easier to stick everything into header files, but we will look at that issue later when dealing with more templates and how to get around this issue.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>read()</code> function implementation is rather straightforward (5 lines in total), i.e. we first create a JSON variable on line 13, and then prepare to read a JSON file on line 14. We then stream all of the content from the input file into the JSON variable and close the file afterwards. That's all, we return the JSON file on line 17 and can now proceed to use it in our code. This is likely all the JSON code you ever need to interact with the <code>nlohmann::json</code> library, see, it wasn't that difficult.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;fstream\u003e\n\n#include \u0022nlohmann/json.hpp\u0022\n\n#include \u0022src/parameterReaderBase.hpp\u0022\n\nclass ParameterReaderJson : public ParameterReaderBase\u0026lt;nlohmann::json\u003e {\npublic:\n  ParameterReaderBase::FileType read(std::filesystem::path file) override {\n    nlohmann::json jsonFile;\n    std::ifstream inputFile(file);\n    inputFile \u003e\u003e jsonFile;\n    inputFile.close();\n    return jsonFile;\n  }\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;fstream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;nlohmann/json.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;src/parameterReaderBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderJson\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enlohmann\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ejson\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eFileType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eread\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enlohmann\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::json jsonFile;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::ifstream \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003einputFile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(file);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    inputFile \u0026gt;\u0026gt; jsonFile;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003einputFile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eclose\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e jsonFile;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":19,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#include &lt;filesystem&gt;
#include &lt;fstream&gt;

#include &quot;nlohmann/json.hpp&quot;

#include &quot;src/parameterReaderBase.hpp&quot;

class ParameterReaderJson : public ParameterReaderBase&lt;nlohmann::json&gt; {
public:
  ParameterReaderBase::FileType read(std::filesystem::path file) override {
    nlohmann::json jsonFile;
    std::ifstream inputFile(file);
    inputFile &gt;&gt; jsonFile;
    inputFile.close();
    return jsonFile;
  }
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;fstream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;nlohmann/json.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;src/parameterReaderBase.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ParameterReaderJson</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ParameterReaderBase</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">nlohmann</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">json</span><span style="color: #D4D4D4">&gt; {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">ParameterReaderBase</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">FileType</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">read</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">file</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">nlohmann</span><span style="color: #D4D4D4">::json jsonFile;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::ifstream </span><span style="color: #DCDCAA">inputFile</span><span style="color: #D4D4D4">(file);</span></span>
<span class="line"><span style="color: #D4D4D4">    inputFile &gt;&gt; jsonFile;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">inputFile</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">close</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> jsonFile;</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-testing-parameter-file-reading-with-gmock">Testing parameter file reading with gmock</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>OK, so we have seen how we can create a simple parameter reading interface using the JSON file format. But let's assume that we have written a test for this file reading and realised that we spent a lot of time in our unit test on file input and output. Let's also assume that our application is writing a lot of these JSON files and unit testing now becomes a very painful task as executing our tests takes tens of seconds and thus we may feel discouraged running our tests frequently.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To avoid the costly file reading, we decided to mock this using gmock, so let's see how mocking is here to save the day. I would recommend looking through the next example first to get an idea, and then afterwards to to read (or at least browse) through the <a href="https://google.github.io/googletest/gmock_for_dummies.html" target="_blank" rel="noopener" title="">mocking documentation</a>. It is not a long read and it will give you an idea of what else you can do with mocking. What we look at below will cover most cases, but there are a few more things you can do with mocking, so it is worthwhile to look into the documentation.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-mocking-the-parameter-file-reading-interface">Mocking the parameter file reading interface</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Our mocking implementation starts similar to our JSON parameter reading class definition, with the appropriate includes at the top. We also include the <code>gmock/gmock.h</code> header file here to have access to Google's mocking framework. We derive from the interface again on line 11 and again specify that the template parameter here should be <code>nlohmann::json</code>. Since we are storing that template parameter in the base class as we saw previously, we can later use that template parameter using the <code>ParameterReaderBase::FileType</code> syntax.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The mocking happens on line 13 and essentially just tells the framework which function needs to be mocked. We don't specify here what happens if we actually call this method, that is something we have to set up during the test. When we declare the class, we just have to provide information on which function of the class should be mocked.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Since the <code>read()</code> function as declared as a pure virtual function, we need to provide an implementation for it (or, in this case, a mock), and we see this on line 13. The syntax is as follows: each function can be decomposed into <code>returnType functionName(functionArgument1, functionArgument2, ...) trailingArguments</code>. What you do now, is take this function signature, put commas between each of these arguments (keeping the parenthesis for the function arguments, and also introducing parenthesis for the trailing arguments), and put that into the <code>MOCK_METHOD()</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This would result in <code>MOCK_METHOD(returnType, functionName, (functionArgument1, functionArgument2, ...), (trailingArguments));</code> And that's it. We see this executed on line 13. If we had more arguments as the trailing arguments, for example, <code>const final override</code>, then we would specify this as <code>(const, final, override)</code>. The reason we have to chop this up using commas and parenthesis is that gmock uses C++ macro syntax in the background to extract information here, which needs to be separated by commas.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;fstream\u003e\n\n#include \u0022nlohmann/json.hpp\u0022\n#include \u0022gmock/gmock.h\u0022\n\n#include \u0022src/parameterReaderBase.hpp\u0022\n\nclass ParameterReaderJsonMock : public ParameterReaderBase\u0026lt;nlohmann::json\u003e {\n public:\n  MOCK_METHOD(ParameterReaderBase::FileType, read, (std::filesystem::path), (override));\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;fstream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;nlohmann/json.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;gmock/gmock.h\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;src/parameterReaderBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderJsonMock\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enlohmann\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ejson\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eMOCK_METHOD\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eParameterReaderBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eFileType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eread\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, (\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path), (override));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#include &lt;filesystem&gt;
#include &lt;fstream&gt;

#include &quot;nlohmann/json.hpp&quot;
#include &quot;gmock/gmock.h&quot;

#include &quot;src/parameterReaderBase.hpp&quot;

class ParameterReaderJsonMock : public ParameterReaderBase&lt;nlohmann::json&gt; {
 public:
  MOCK_METHOD(ParameterReaderBase::FileType, read, (std::filesystem::path), (override));
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;fstream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;nlohmann/json.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;gmock/gmock.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;src/parameterReaderBase.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ParameterReaderJsonMock</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ParameterReaderBase</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">nlohmann</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">json</span><span style="color: #D4D4D4">&gt; {</span></span>
<span class="line"><span style="color: #D4D4D4"> </span><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">MOCK_METHOD</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">ParameterReaderBase</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">FileType</span><span style="color: #D4D4D4">, </span><span style="color: #4EC9B0">read</span><span style="color: #D4D4D4">, (</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path), (override));</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Once we have provided the mocked interface, we can now create a mocked object in tests and then specify what the expected behaviour is when we call the <code>read()</code> function. Instead of reading a file from disk now, we can simply specify what we would expect this operation to return and use that instead. Let's look at the test code then to see this in action.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-writing-a-unit-test-with-mocking">Writing a unit test using the mocked parameter file reading implementation</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We will only look at a single test here. We could also test the JSON-based parameter reading class, but I wanted to look at the mocking specifically and there would be nothing interesting (or new) about testing the JSON parameter reading.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p> Below, then, is the test code within the <code>tests/unit/testParameterReadingJson.cpp</code> file. It imports the mocked interface on line 6 and then uses that in the test starting from line 8.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We structure our test into the standard Arrange, Act, Assert section, although we differentiate between variable and mock set-up in the arrange section. We first create a parameter reading object on line 10, which derives from the mocked class implementation we provided above. We also set up a JSON object on lines 11-14, that we would expect our parameter reading to return and we use this on line 17, where we set up our mock.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Line 17 is where mocking starts, this is where we specify what we expect a call to the <code>read()</code> function would produce. The syntax is as follows: first, we specify which variable we want to set up the mocking behaviour for (in this case, the <code>parameterReadingMock</code> variable). Secondly, we specify the function and all of its arguments to which we expect a call will be made (we can see this call on line 20 in the act section). This <code>EXPECT_CALL()</code> function is then followed by what is expected to happen.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In our case, we expect that a call to the <code>read()</code> function will return only once (this is most often the case and indicated by the <code>WillOnce()</code> function name) and, we specifically say what it will return, in this case, the <code>expectedJsonFile</code> we set up on lines 11-14. So, if we make a call to <code>read()</code> now on line 20, <code>gmock</code> will now check what this function should do or return and based on what we have provided on line 17, it will do exactly that.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 23, we check that the JSON parameter we receive within the <code>inputFile</code> is now equivalent to the <code>expectedJsonFile</code>. I also provide some additional statements on lines 24-25, these are not technically required but show you how you would use a JSON file now. For example, the get the number of iterations specified within the JSON file, we would use the <code>inputFile["iterations"]</code> syntax and we can see that JSOn files are stored as <code>std::map</code>s in C++. So if you feel comfortable with <code>std::map</code>s, then working with JSON files will be straightforward.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;filesystem\u003e\n\n#include \u0022gtest/gtest.h\u0022\n#include \u0022gmock/gmock.h\u0022\n\n#include \u0022tests/unit/parameterReadingJsonMock.hpp\u0022\n\nTEST(ParameterReadingJson, ReadJsonFileMock) {\n  // Arrange inputs\n  ParameterReaderJsonMock parameterReadingMock;\n  nlohmann::json expectedJsonFile = {\n    {\u0022iterations\u0022, 100},\n    {\u0022turbulence_model\u0022, \u0022Spalart-Allmaras\u0022}   \n  };\n\n  // Arrange mocks\n  EXPECT_CALL(parameterReadingMock, read(std::filesystem::path(\u0022input.json\u0022))).WillOnce(::testing::Return(expectedJsonFile));\n  \n  // Act\n  auto inputFile = parameterReadingMock.read(std::filesystem::path(\u0022input.json\u0022));\n\n  // Assert\n  ASSERT_EQ(inputFile, expectedJsonFile);\n  ASSERT_EQ(inputFile[\u0022iterations\u0022], 100);\n  ASSERT_EQ(inputFile[\u0022turbulence_model\u0022], \u0022Spalart-Allmaras\u0022);\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;gtest/gtest.h\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;gmock/gmock.h\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;tests/unit/parameterReadingJsonMock.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eTEST\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(ParameterReadingJson, ReadJsonFileMock) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Arrange inputs\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ParameterReaderJsonMock parameterReadingMock;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enlohmann\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::json expectedJsonFile = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    {\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;iterations\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e100\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    {\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;turbulence_model\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Spalart-Allmaras\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}   \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Arrange mocks\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eEXPECT_CALL\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(parameterReadingMock, \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eread\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;input.json\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e))).\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eWillOnce\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003etesting\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(expectedJsonFile));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Act\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e inputFile = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eparameterReadingMock\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eread\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;input.json\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // Assert\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eASSERT_EQ\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(inputFile, expectedJsonFile);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eASSERT_EQ\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003einputFile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;iterations\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e], \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e100\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eASSERT_EQ\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003einputFile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;turbulence_model\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e], \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Spalart-Allmaras\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":26,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;filesystem&gt;

#include &quot;gtest/gtest.h&quot;
#include &quot;gmock/gmock.h&quot;

#include &quot;tests/unit/parameterReadingJsonMock.hpp&quot;

TEST(ParameterReadingJson, ReadJsonFileMock) {
  // Arrange inputs
  ParameterReaderJsonMock parameterReadingMock;
  nlohmann::json expectedJsonFile = {
    {&quot;iterations&quot;, 100},
    {&quot;turbulence_model&quot;, &quot;Spalart-Allmaras&quot;}   
  };

  // Arrange mocks
  EXPECT_CALL(parameterReadingMock, read(std::filesystem::path(&quot;input.json&quot;))).WillOnce(::testing::Return(expectedJsonFile));
  
  // Act
  auto inputFile = parameterReadingMock.read(std::filesystem::path(&quot;input.json&quot;));

  // Assert
  ASSERT_EQ(inputFile, expectedJsonFile);
  ASSERT_EQ(inputFile[&quot;iterations&quot;], 100);
  ASSERT_EQ(inputFile[&quot;turbulence_model&quot;], &quot;Spalart-Allmaras&quot;);
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;gtest/gtest.h&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;gmock/gmock.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;tests/unit/parameterReadingJsonMock.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">TEST</span><span style="color: #D4D4D4">(ParameterReadingJson, ReadJsonFileMock) {</span></span>
<span class="line"><span style="color: #6A9955">  // Arrange inputs</span></span>
<span class="line"><span style="color: #D4D4D4">  ParameterReaderJsonMock parameterReadingMock;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">nlohmann</span><span style="color: #D4D4D4">::json expectedJsonFile = {</span></span>
<span class="line"><span style="color: #D4D4D4">    {</span><span style="color: #CE9178">&quot;iterations&quot;</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">100</span><span style="color: #D4D4D4">},</span></span>
<span class="line"><span style="color: #D4D4D4">    {</span><span style="color: #CE9178">&quot;turbulence_model&quot;</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;Spalart-Allmaras&quot;</span><span style="color: #D4D4D4">}   </span></span>
<span class="line"><span style="color: #D4D4D4">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // Arrange mocks</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">EXPECT_CALL</span><span style="color: #D4D4D4">(parameterReadingMock, </span><span style="color: #DCDCAA">read</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">path</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;input.json&quot;</span><span style="color: #D4D4D4">))).</span><span style="color: #DCDCAA">WillOnce</span><span style="color: #D4D4D4">(::</span><span style="color: #4EC9B0">testing</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">Return</span><span style="color: #D4D4D4">(expectedJsonFile));</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // Act</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> inputFile = </span><span style="color: #9CDCFE">parameterReadingMock</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">read</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">path</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;input.json&quot;</span><span style="color: #D4D4D4">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // Assert</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ASSERT_EQ</span><span style="color: #D4D4D4">(inputFile, expectedJsonFile);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ASSERT_EQ</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">inputFile</span><span style="color: #D4D4D4">[</span><span style="color: #CE9178">&quot;iterations&quot;</span><span style="color: #D4D4D4">], </span><span style="color: #B5CEA8">100</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ASSERT_EQ</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">inputFile</span><span style="color: #D4D4D4">[</span><span style="color: #CE9178">&quot;turbulence_model&quot;</span><span style="color: #D4D4D4">], </span><span style="color: #CE9178">&quot;Spalart-Allmaras&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>One thing which may look a bit odd is the <code>::testing::Return</code> statement on line 17. All of gtests's and gmock's code live inside the <code>testing</code> namespace. The leading <code>::</code> in front of <code>::testing</code> means that this is referring to the global namespace. You can remove the leading <code>::</code>, i.e. <code>testing::Return</code> but the convention with gtest is that we refer to the global namespace, just in case you have defined a namespace somewhere else called <code>testing</code> as well. This avoids namespace clashes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Suffice to say, the <code>::testing::Return</code> or <code>testing::Return</code> statement is used to indicate what should be returned by the function. I just mention it here because, in most of the documentation, you will see simply a <code>Return</code> written instead of <code>::testing::Return</code>. To get around this, the documentation uses a <code>using ::testing::Return</code> statement at the top of the file, but I like my code to be verbose and readable, so I usually include the namespaces where I access a variable or function from that namespace.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-test-output">Test output</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The testing output is perhaps not very interesting, but for completeness, it is given below. We just run a single test and we see that the test is passing, so our mocking has worked correctly. We never read any file from disk but still have a test passing, and since all variables were defined in main memory, rather than anything needing to be read from the hard disk (i.e. a JSON file), we see that the actual unit test took less than a millisecond.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You can try to implement the JSON-based parameter reading test and see how it compares, how much time do we save using mocking? In this case, probably not a lot, but in the case of the <a href="https://cfd.university/learn/the-complete-guide-to-software-testing-for-cfd-applications/how-to-test-a-cgns-based-mesh-reading-library-using-gtest#aioseo-test-execution" target="_blank" rel="noopener" title="">mesh reading library</a>, we saw that there was a quite large overhead for reading files from disk, so it may be a good idea to consider mocking even for these simple types of grids we were dealing with.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"[==========] Running 1 test from 1 test suite.\n[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] Global test environment set-up.\n[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] 1 test from ParameterReadingJson\n[ RUN      ] ParameterReadingJson.ReadJsonFile\n[       OK ] ParameterReadingJson.ReadJsonFile (0 ms)\n[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] 1 test from ParameterReadingJson (0 ms total)\n\n[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] Global test environment tear-down\n[==========] 1 test from 1 test suite ran. (2 ms total)\n[  PASSED  ] 1 test.","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[==========] Running 1 test from 1 test suite.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] Global test environment set-up.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] 1 test from ParameterReadingJson\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[ RUN      ] ParameterReadingJson.ReadJsonFile\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[       OK ] ParameterReadingJson.ReadJsonFile (0 ms)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] 1 test from ParameterReadingJson (0 ms total)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d\u002d] Global test environment tear-down\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[==========] 1 test from 1 test suite ran. (2 ms total)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[  PASSED  ] 1 test.\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":10,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from ParameterReadingJson
[ RUN      ] ParameterReadingJson.ReadJsonFile
[       OK ] ParameterReadingJson.ReadJsonFile (0 ms)
[----------] 1 test from ParameterReadingJson (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (2 ms total)
[  PASSED  ] 1 test." style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">[==========] Running 1 test from 1 test suite.</span></span>
<span class="line"><span style="color: #D4D4D4">[----------] Global test environment set-up.</span></span>
<span class="line"><span style="color: #D4D4D4">[----------] 1 test from ParameterReadingJson</span></span>
<span class="line"><span style="color: #D4D4D4">[ RUN      ] ParameterReadingJson.ReadJsonFile</span></span>
<span class="line"><span style="color: #D4D4D4">[       OK ] ParameterReadingJson.ReadJsonFile (0 ms)</span></span>
<span class="line"><span style="color: #D4D4D4">[----------] 1 test from ParameterReadingJson (0 ms total)</span></span>
<span class="line"><span style="color: #D4D4D4"></span></span>
<span class="line"><span style="color: #D4D4D4">[----------] Global test environment tear-down</span></span>
<span class="line"><span style="color: #D4D4D4">[==========] 1 test from 1 test suite ran. (2 ms total)</span></span>
<span class="line"><span style="color: #D4D4D4">[  PASSED  ] 1 test.</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>So then, this completes our brief look at mocking as well. As I have mentioned in the opening paragraph, mocking is not of high importance when we write CFD applications, it can be useful but apart from some very specific cases. We can get away without having to resort to mocking, unless we want to speed up some unit tests, in which case, we would use mocking for convenience but not out of necessity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Mocking plays a much bigger role in web development (mocking web requests and testing websites, yes, websites are also unit tested, see the popular <a href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Django/Testing" target="_blank" rel="noopener" title="">Django python framework</a>, for example) and mobile development, and less so for classical console applications. But we have seen how to use it now and can recognise use cases where mocking may be beneficial.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, you have seen pretty much all there is to testing with gtest and gmock and in the last remaining article of this series, we will look at test coverage, an area that allows us to check how much of our code was actually tested by our unit, integration, and system tests. We'll leave that for the next article. </p>
<!-- /wp:paragraph -->