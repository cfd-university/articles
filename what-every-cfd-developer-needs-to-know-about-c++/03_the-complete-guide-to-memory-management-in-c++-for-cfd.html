<!-- wp:paragraph -->
<p>Memory management is crucial in C++; it determines how quickly (or slowly) our code will execute. Poor memory management will destroy any advantage you gain by using a compiled language such as C++ and it is entirely possible that a slower, interpreted language will perform better here (see also the article on <a href="https://cfd.university/software-engineering/choosing-the-right-programming-language-for-cfd-applications/" target="_blank" rel="noopener" title="Compiled vs. Interpreted languages">Compiled vs. Interpreted languages</a>). However, memory management is really not that difficult and we only need to understand a few basic concepts. C++ leaves memory management entirely up to us (we will later see that using the standard template library will actually take a fair bit, if not all, of that responsibility away from us), so knowing how it works, we can use that to our advantage to write performant code. This article will explore the role of memory in C++ (and programming in general, for that matter) and will equip you with the knowledge you need to master efficient memory management.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="what-every-cfd-developer-needs-to-know-about-c"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":5,"blockClientId":"9278246b-893c-4b6b-90ea-996ce9742942","content":"The Stack and the Heap","level":2,"anchor":"aioseo-something","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":32,"blockClientId":"fbc49f2b-9070-473d-ba83-82292a469dbd","content":"Call by Value and Reference","level":2,"anchor":"aioseo-call-by-value-and-reference","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":41,"blockClientId":"ceabe9ff-8ac3-4724-b071-a55a9af08f30","content":"Memory caches","level":2,"anchor":"aioseo-memory-caches","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":54,"blockClientId":"8e45dfe3-ad7a-4966-beb6-af82f5dcf42e","content":"The roofline memory model","level":2,"anchor":"aioseo-the-roofline-memory-model","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":60,"blockClientId":"a78a3f53-2c83-4b6d-bd6e-cfc1bb2ad676","content":"Summary","level":2,"anchor":"aioseo-summary","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-something">The Stack and the Heap</a></li><li><a href="#aioseo-call-by-value-and-reference">Call by Value and Reference</a></li><li><a href="#aioseo-memory-caches">Memory caches</a></li><li><a href="#aioseo-the-roofline-memory-model">The roofline memory model</a></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-something">The Stack and the Heap</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I'd say understanding memory in C++ and then knowing how to manage it is probably about 50\% of the language. Well, not in terms of keywords and features, but in terms of knowing how to get around things. I would recommend the article on <a href="https://people.freebsd.org/~lstewart/articles/cpumemory.pdf" target="_blank" rel="noopener" title="">What Every Programmer Should Know About Memory</a> by Ulrich Drepper, but it is a 114-page document, and it has been on my reading list for years, so I wouldn't expect you to read it in full either. Be that as it may, understanding the basics of memory is important, and we should have a shared understanding before we move on, otherwise certain concepts will not make sense at all.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's start with the two most important building blocks of memory, the <i>stack</i> and the <i>heap</i>. When you run your application, it will have access to your random access memory (RAM), and this is split into these two regions. The stack is relatively small when compared to the heap but of the order of 8 Megabytes or so (it will vary based on the operating system's settings, and you can change that, but there is typically no need for that). The heap takes up as much space as it wants on your RAM, or rather, as much as is available, there is no limit to it. What is the difference? Well, the stack is small and fast and the heap is large and a bit slower. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you want to have an analogy, think about parking a car. You have two options, either you park in a multi-storey car park or you use a valet parking service. If you use the multi-storey car park, you know exactly where you are parked. You know the level and, if we assume each parking box is marked, you know the location on that level as well. This means finding your car is fast. If you use a valet parking service, you hand over your car, and it will be parked somewhere, but you have no idea where, all you get is a number or ticket, which you can use to retrieve your car. So you have no idea where the car is, but you have a mechanism by which you can obtain your car back (i.e. showing your ticket). We can probably agree that, on average, using a multi-story car park will be faster to locate your car, compared to valet parking. In this analogy, the multi-story car park is our stack, and the valet parking service is our heap.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So the stack is a small island of memory where we can retrieve data from quickly, but we are limited in how much space we have available and how much data we can store there. The heap, on the other hand, is vast, and we can store large amounts of data. However, if we wanted to retrieve it, we first need to find it via a reference and this takes a bit longer.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So when should we use the stack and the heap? We use the heap for our largest data arrays, that is coordinates like x, y, and z, solution arrays for velocity, pressure, temperature, etc., and anything else that has the potential to grow in size. For example, you may only be concerned, for now, with small 2D simulations, however, you should even then put all of the above-mentioned arrays on the heap to avoid a stack overflow (a scenario when your data grows too much on the stack that there is no more space available). Everything else goes on the stack.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We said the stack is small, but that is only true in comparison to the heap, it can still store a good amount of data. Typically, the stack holds information that we frequently access, in the context of CFD, these are our solver settings like the number of iterations, the time-step size, CFL number, and the list goes on. So if a variable holds a single value (like a number, a string, or a Boolean), then put it on the stack, but if the variable holds several values of the same type, i.e. an array of numbers, strings, Booleans, etc., then it should go on the heap, in general.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If this sounds overwhelming, don't worry, even if you have no idea about the stack and heap, as long as you use the standard template library (which we will cover shortly), you pretty much use the stack and the heap correctly automatically. But let's look at some code to see how we can use each of them.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;string\u003e\n\nint main() {\n  // variables allocated on the stack\n  int         a_stack = 27;\n  float       b_stack = 2.71;\n  double      c_stack = 3.14;\n  bool        d_stack = true;\n  std::string e_stack(\u0022some text\u0022);\n  \n  // same variables, now allocated on the heap\n  int         *a_heap = new int[1];\n  float       *b_heap = new float[1];\n  double      *c_heap = new double[1];\n  bool        *d_heap = new bool[1];\n  std::string *e_heap = new std::string[1];\n  \n  // memory has been allocated on heap, now assign values\n  *a_heap = 27;\n  *b_heap = 2.71;\n  *c_heap = 3.14;\n  *d_heap = true;\n  *e_heap = \u0022some text\u0022;\n  \n  // we used the heap, we have to manually clean up after ourselves\n  delete [] a_heap;\n  delete [] b_heap;\n  delete [] c_heap;\n  delete [] d_heap;\n  delete [] e_heap;\n  \n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;string\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // variables allocated on the stack\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e         a_stack = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e27\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efloat\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e       b_stack = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.71\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      c_stack = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3.14\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ebool\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        d_stack = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etrue\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ee_stack\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;some text\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // same variables, now allocated on the heap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e         *a_heap = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efloat\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e       *b_heap = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efloat\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      *c_heap = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ebool\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        *d_heap = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003ebool\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string *e_heap = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // memory has been allocated on heap, now assign values\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  *a_heap = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e27\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  *b_heap = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.71\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  *c_heap = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3.14\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  *d_heap = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etrue\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  *e_heap = \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;some text\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // we used the heap, we have to manually clean up after ourselves\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e a_heap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e b_heap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e c_heap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e d_heap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e e_heap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":14.953125,"highestLineNumber":33,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;string&gt;

int main() {
  // variables allocated on the stack
  int         a_stack = 27;
  float       b_stack = 2.71;
  double      c_stack = 3.14;
  bool        d_stack = true;
  std::string e_stack(&quot;some text&quot;);
  
  // same variables, now allocated on the heap
  int         *a_heap = new int[1];
  float       *b_heap = new float[1];
  double      *c_heap = new double[1];
  bool        *d_heap = new bool[1];
  std::string *e_heap = new std::string[1];
  
  // memory has been allocated on heap, now assign values
  *a_heap = 27;
  *b_heap = 2.71;
  *c_heap = 3.14;
  *d_heap = true;
  *e_heap = &quot;some text&quot;;
  
  // we used the heap, we have to manually clean up after ourselves
  delete [] a_heap;
  delete [] b_heap;
  delete [] c_heap;
  delete [] d_heap;
  delete [] e_heap;
  
  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;string&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // variables allocated on the stack</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">         a_stack = </span><span style="color: #B5CEA8">27</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">float</span><span style="color: #D4D4D4">       b_stack = </span><span style="color: #B5CEA8">2.71</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">      c_stack = </span><span style="color: #B5CEA8">3.14</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">bool</span><span style="color: #D4D4D4">        d_stack = </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string </span><span style="color: #DCDCAA">e_stack</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;some text&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // same variables, now allocated on the heap</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">         *a_heap = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">float</span><span style="color: #D4D4D4">       *b_heap = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">float</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">      *c_heap = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">bool</span><span style="color: #D4D4D4">        *d_heap = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">bool</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string *e_heap = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #9CDCFE">string</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // memory has been allocated on heap, now assign values</span></span>
<span class="line"><span style="color: #D4D4D4">  *a_heap = </span><span style="color: #B5CEA8">27</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  *b_heap = </span><span style="color: #B5CEA8">2.71</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  *c_heap = </span><span style="color: #B5CEA8">3.14</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  *d_heap = </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  *e_heap = </span><span style="color: #CE9178">&quot;some text&quot;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // we used the heap, we have to manually clean up after ourselves</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> a_heap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> b_heap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> c_heap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> d_heap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> e_heap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>On lines 5-9, we allocate variables on the stack and on lines 12-16 on the heap. We notice that we first have to allocate memory on the heap (using the <code>new</code> keyword). This will return a memory address (think about it as a parking box for our valet parking system), and we store this memory address in a pointer, indicated by the leading asterisk, i.e. <code>*a_heap</code>. If we were to print the value of <code>a_heap</code>, i.e. <code>std::cout &lt;&lt; a_heap &lt;&lt; std::endl;</code> (don't forget <code>#include &lt;iostream&gt;</code> to use <code>std::cout</code> and <code>std::endl</code>), then we get a memory address back which may look something like <code>0x22cb2b0</code>. This is a hexadecimal number, we can <a href="https://www.unitconverters.net/numbers/hexadecimal-to-base-10.htm" target="_blank" rel="noopener" title="">convert it</a> to base 10 (if you want to follow along, you have to remove the leading <code>0x</code>, which is just C++ telling us this is a hexadecimal number). If you do that, you get <code>36483760</code>, i.e. the <code>36483760</code>th location in our memory, roughly speaking. You see where the name random in RAM comes from now (in fact, if you run the code above, it is highly unlikely that you'll get the same memory as me!). We can use this memory address to locate it, and then assign values to it. We do that on lines 19-23, i.e. first by finding the value that is stored in the memory location (done through something called pointer dereferencing, this is done by putting the leading asterisk, i.e. <code>*</code>, in-front of our pointer) and then by assigning a value to that specific memory address.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you understand this, then you understand pretty much everything there is to pointers, a concept that is typically very confusing and frustrating when you are starting out with C++. Returning to our valet parking system analogy, when we drop off our car, we get a number or receipt. This number or receipt will have no meaning to us, i.e. it will not state where the car is actually parked and we can't use it to retrieve the car ourselves. However, if we show our number or receipt to the person getting our car, they will be able to <em>dereference</em> the location of our car (and get it for us) based on that number or receipt. A pointer is nothing else, just an intermediary between you, the programmer, and your memory.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Whenever we use the heap, we have to clean up after ourselves. This is related to the general concept of <em>garbage collection</em>, and C++ is one language where garbage collection is not done automatically for us. Python is an example of a language where we don't have to think about memory and data on the heap is automatically deleted for us, at the cost of a slight runtime overhead. In other words, every time we make a call to the <code>new</code> operator, we have to have a matching call to the <code>delete</code> operator, otherwise we are going to leak memory and this can lead to nasty bugs that are difficult to track down. We can see that we do call the <code>delete</code> operator on lines 26-30 in our example above.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Why is heap memory then so important? Well, the above example does not really give it the credit it deserves, the heap only becomes important for larger objects as alluded to before (i.e. arrays of coordinates, solutions, etc.). Let's look at another example.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;iostream\u003e\n\nint main() {\n  // parameters go on the stack\n  double domainStart = 0.0;\n  double domainEnd = 1.0;\n  int numberOfCells = 1000;\n  double spacing = (domainEnd - domainStart) / numberOfCells;\n\n  // large arrays go on the heap\n  double *xCoordinate = new double[numberOfCells];\n\n  // assign values\n  for (int i = 0; i \u0026lt; numberOfCells; ++i) {\n    // calculate the center (centroid) position in x\n    xCoordinate[i] = spacing * i + spacing / 2.0;\n    // or, we could have also used\n    // *(xCoordinate + i) = spacing * i + spacing / 2.0;\n  }\n\n  std::cout \u0026lt;\u0026lt; *(xCoordinate+0) \u0026lt;\u0026lt; std::endl; // prints 0.0005\n  std::cout \u0026lt;\u0026lt; *(xCoordinate+1) \u0026lt;\u0026lt; std::endl; // prints 0.0015\n  std::cout \u0026lt;\u0026lt; *(xCoordinate+2) \u0026lt;\u0026lt; std::endl; // prints 0.0025\n\n  std::cout \u0026lt;\u0026lt; xCoordinate[0] \u0026lt;\u0026lt; std::endl; // prints 0.0005\n  std::cout \u0026lt;\u0026lt; xCoordinate[1] \u0026lt;\u0026lt; std::endl; // prints 0.0015\n  std::cout \u0026lt;\u0026lt; xCoordinate[2] \u0026lt;\u0026lt; std::endl; // prints 0.0025\n\n  // clean up the heap\n  delete [] xCoordinate;\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // parameters go on the stack\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e domainStart = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e domainEnd = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfCells = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e spacing = (domainEnd - domainStart) / numberOfCells;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // large arrays go on the heap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e *xCoordinate = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[numberOfCells];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // assign values\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; numberOfCells; ++i) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // calculate the center (centroid) position in x\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i] = spacing * i + spacing / \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // or, we could have also used\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // *(xCoordinate + i) = spacing * i + spacing / 2.0;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; *(xCoordinate+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0005\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; *(xCoordinate+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0015\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; *(xCoordinate+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0025\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0005\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0015\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // prints 0.0025\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // clean up the heap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e xCoordinate;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":14.953125,"highestLineNumber":33,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;iostream&gt;

int main() {
  // parameters go on the stack
  double domainStart = 0.0;
  double domainEnd = 1.0;
  int numberOfCells = 1000;
  double spacing = (domainEnd - domainStart) / numberOfCells;

  // large arrays go on the heap
  double *xCoordinate = new double[numberOfCells];

  // assign values
  for (int i = 0; i &lt; numberOfCells; ++i) {
    // calculate the center (centroid) position in x
    xCoordinate[i] = spacing * i + spacing / 2.0;
    // or, we could have also used
    // *(xCoordinate + i) = spacing * i + spacing / 2.0;
  }

  std::cout &lt;&lt; *(xCoordinate+0) &lt;&lt; std::endl; // prints 0.0005
  std::cout &lt;&lt; *(xCoordinate+1) &lt;&lt; std::endl; // prints 0.0015
  std::cout &lt;&lt; *(xCoordinate+2) &lt;&lt; std::endl; // prints 0.0025

  std::cout &lt;&lt; xCoordinate[0] &lt;&lt; std::endl; // prints 0.0005
  std::cout &lt;&lt; xCoordinate[1] &lt;&lt; std::endl; // prints 0.0015
  std::cout &lt;&lt; xCoordinate[2] &lt;&lt; std::endl; // prints 0.0025

  // clean up the heap
  delete [] xCoordinate;

  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // parameters go on the stack</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> domainStart = </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> domainEnd = </span><span style="color: #B5CEA8">1.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfCells = </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> spacing = (domainEnd - domainStart) / numberOfCells;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // large arrays go on the heap</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> *xCoordinate = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">[numberOfCells];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // assign values</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; numberOfCells; ++i) {</span></span>
<span class="line"><span style="color: #6A9955">    // calculate the center (centroid) position in x</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[i] = spacing * i + spacing / </span><span style="color: #B5CEA8">2.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #6A9955">    // or, we could have also used</span></span>
<span class="line"><span style="color: #6A9955">    // *(xCoordinate + i) = spacing * i + spacing / 2.0;</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; *(xCoordinate+</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0005</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; *(xCoordinate+</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0015</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; *(xCoordinate+</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">) &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0025</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0005</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0015</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span><span style="color: #6A9955"> // prints 0.0025</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // clean up the heap</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> xCoordinate;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>In this example, we are now storing several values in our pointer called <code>xCoordinate</code>, to be precise, the pointer now points to 1000 elements. If we are using more than one element, then we can simply access it with an extended pointer dereferencing technique of the form </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>*(pointer + offset)</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>where the offset is an integer and describes which element of the array we want to access. On line 18, it is shown how to use this new dereferencing technique to assign values and then on lines 21-23 how to print values. Because this looks clumsy, supposedly, C++ provides us with a different notation, and we can use the square brackets to directly access the data of the array at a specific location, as shown on line 16 for assigning values and lines 25-27 for retrieving data. On line 30, we clean up after ourselves again, but only values stored on the heap, not the stack (see lines 5-8, we don't need to delete them).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's look at the memory management in this case and add a few lines. Specifically, on line 28, put the following code</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"std::cout \u0026lt;\u0026lt; \u0026amp;xCoordinate[0] \u0026lt;\u0026lt; std::endl;\nstd::cout \u0026lt;\u0026lt; \u0026amp;xCoordinate[1] \u0026lt;\u0026lt; std::endl;\nstd::cout \u0026lt;\u0026lt; \u0026amp;xCoordinate[2] \u0026lt;\u0026lt; std::endl;\nstd::cout \u0026lt;\u0026lt; sizeof(double) \u0026lt;\u0026lt; std::endl;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003esizeof\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":7.65625,"highestLineNumber":4,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="std::cout &lt;&lt; &amp;xCoordinate[0] &lt;&lt; std::endl;
std::cout &lt;&lt; &amp;xCoordinate[1] &lt;&lt; std::endl;
std::cout &lt;&lt; &amp;xCoordinate[2] &lt;&lt; std::endl;
std::cout &lt;&lt; sizeof(double) &lt;&lt; std::endl;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; &amp;</span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; &amp;</span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; &amp;</span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #569CD6">sizeof</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">) &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We are now using the so-called <em>address-of</em> operator, i.e. <code>&amp;</code>. This operator will now print the memory location where we store our variables. Also, we print the size of a double, which should be 8 (bytes), unless you have a very exotic PC. If you look at the output of the first 3 print statements, you may get something like <code>0x10422b0</code>, <code>0x10422b8</code>, and <code>0x10422c0</code>. The last print statement returns 8 on my machine, i.e. as mentioned above, a double is 8 bytes large. Translating the hexadecimal numbers into base 10 results in <code>17048240</code>, <code>17048248</code>, and <code>17048256</code>, i.e. there is an offset of 8 between each number. From this, we can see that while the first address (location) may be random, all subsequent memory locations are contiguous in memory, i.e. array values which are next to each other are laid out next to each other in memory as well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And this also explains, really, why the first value is random. When you request to store an array of 1000 doubles, as we do in this case, your system has to check where it can place 1000 doubles next to each other in memory. It looks for the first place where there is sufficient memory available, and then it will lock this memory range for your application, and it will use it to store your doubles there. Keep in mind that you have not just your application, but also other applications and the operating system running at the same time, and each application is using the heap, so the system has to provide access to memory for all applications at the same time, hence your memory address is random, because your memory allocation is dynamic and changes over time, based on the other applications and your operating system.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, I want to be very clear about the examples above though, they are just that, examples to help us understand the concept of the heap and stack. However, in this day and age, <strong>you should never use the</strong> <code>new</code> <strong>and</strong> <code>delete</code> <strong>keyword yourself, unless you have very specific reasons to do so</strong>! Why is that? Well, the examples above are simplified, more complex codes will have more complex memory management requirements, and you are running the risk of introducing unwanted memory leaks and subsequently, some bugs, and these are typically difficult to track down and cost time to fix. C++ provides us with smart pointers, which handle memory management for us, and we will look at them later in more detail.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, more to the point, we don't want to use the <code>new</code> and <code>delete</code> keyword because it is not really C++-like, at least in the example shown above (and this is a typical use case). C++ provides us with so-called containers (more on them later as well), and these will handle memory for us automatically, without having to worry about the storage location. These containers are optimised for speed and memory usage, so we should make every effort to use them whenever we can.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>One of these containers is called <code>vector</code> and this container stores all its entries on the heap for us. It takes care of memory allocation and garbage collection. The same example shown above can be achieved in a much simpler form with the <code>vector</code> container, as shown in the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;iostream\u003e\n#include \u0026lt;vector\u003e\nint main() {\n  // parameters go on the stack\n  double domainStart = 0.0;\n  double domainEnd = 1.0;\n  int numberOfCells = 1000;\n  double spacing = (domainEnd - domainStart) / numberOfCells;\n\n  // large arrays go on the heap\n  std::vector\u0026lt;double\u003e xCoordinate(numberOfCells);\n\n  for (int i = 0; i \u0026lt; numberOfCells; ++i) {\n    xCoordinate[i] = spacing * i + spacing / 2.0;\n  }\n\n  std::cout \u0026lt;\u0026lt; xCoordinate[0] \u0026lt;\u0026lt; std::endl;\n  std::cout \u0026lt;\u0026lt; xCoordinate[1] \u0026lt;\u0026lt; std::endl;\n  std::cout \u0026lt;\u0026lt; xCoordinate[2] \u0026lt;\u0026lt; std::endl;\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;vector\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // parameters go on the stack\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e domainStart = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e domainEnd = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfCells = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e spacing = (domainEnd - domainStart) / numberOfCells;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // large arrays go on the heap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCells);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; numberOfCells; ++i) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i] = spacing * i + spacing / \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003exCoordinate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":14.59375,"highestLineNumber":22,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;iostream&gt;
#include &lt;vector&gt;
int main() {
  // parameters go on the stack
  double domainStart = 0.0;
  double domainEnd = 1.0;
  int numberOfCells = 1000;
  double spacing = (domainEnd - domainStart) / numberOfCells;

  // large arrays go on the heap
  std::vector&lt;double&gt; xCoordinate(numberOfCells);

  for (int i = 0; i &lt; numberOfCells; ++i) {
    xCoordinate[i] = spacing * i + spacing / 2.0;
  }

  std::cout &lt;&lt; xCoordinate[0] &lt;&lt; std::endl;
  std::cout &lt;&lt; xCoordinate[1] &lt;&lt; std::endl;
  std::cout &lt;&lt; xCoordinate[2] &lt;&lt; std::endl;

  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;vector&gt;</span></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // parameters go on the stack</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> domainStart = </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> domainEnd = </span><span style="color: #B5CEA8">1.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfCells = </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> spacing = (domainEnd - domainStart) / numberOfCells;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // large arrays go on the heap</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt; </span><span style="color: #DCDCAA">xCoordinate</span><span style="color: #D4D4D4">(numberOfCells);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; numberOfCells; ++i) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[i] = spacing * i + spacing / </span><span style="color: #B5CEA8">2.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">xCoordinate</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Notice how the only change we had to make was to include the <code>vector</code> header on line 2 and then change the variable declaration on line 11. We were able to get rid of the <code>delete</code> keyword, as the <code>vector</code> class handles all memory for us. Using a vector feels just like working with a pointer in terms of assigning values and accessing them, except that the <code>vector</code> class has many more features that we can use (but which we are skipping over here for brevity). We will come back to the containers later and see what the <code>vector</code> container can do for us.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-call-by-value-and-reference">Call by Value and Reference</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Another related concept that you need to master is the two phrases: <em>call by value</em> and <em>call by reference</em>, if you are starting out with C++, you will come across these terms eventually, they may make little to no sense but with your new knowledge on memory management these should become clear now. Let's jump straight into an example to see both cases.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;iostream\u003e\n#include \u0026lt;vector\u003e\n\nvoid someFunctionCallByValue(std::vector\u0026lt;double\u003e x) {\n  std::cout \u0026lt;\u0026lt; \u0022Call by value, address: \u0022 \u0026lt;\u0026lt; \u0026amp;x[0] \u0026lt;\u0026lt; std::endl;\n}\n\nvoid someFunctionCallByReference(std::vector\u0026lt;double\u003e \u0026amp;x) {\n  std::cout \u0026lt;\u0026lt; \u0022Call by reference, address: \u0022 \u0026lt;\u0026lt; \u0026amp;x[0] \u0026lt;\u0026lt; std::endl;\n}\n\nint main() {\n  int numberOfCells = 1000;\n  std::vector\u0026lt;double\u003e x(numberOfCells);\n\n  std::cout \u0026lt;\u0026lt; \u0022original memory location: \u0022 \u0026lt;\u0026lt; \u0026amp;x[0] \u0026lt;\u0026lt; std::endl;\n\n  someFunctionCallByValue(x);\n  someFunctionCallByReference(x);\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;vector\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esomeFunctionCallByValue\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Call by value, address: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esomeFunctionCallByReference\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Call by reference, address: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfCells = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCells);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;original memory location: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esomeFunctionCallByValue\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(x);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esomeFunctionCallByReference\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(x);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":14.59375,"highestLineNumber":22,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;iostream&gt;
#include &lt;vector&gt;

void someFunctionCallByValue(std::vector&lt;double&gt; x) {
  std::cout &lt;&lt; &quot;Call by value, address: &quot; &lt;&lt; &amp;x[0] &lt;&lt; std::endl;
}

void someFunctionCallByReference(std::vector&lt;double&gt; &amp;x) {
  std::cout &lt;&lt; &quot;Call by reference, address: &quot; &lt;&lt; &amp;x[0] &lt;&lt; std::endl;
}

int main() {
  int numberOfCells = 1000;
  std::vector&lt;double&gt; x(numberOfCells);

  std::cout &lt;&lt; &quot;original memory location: &quot; &lt;&lt; &amp;x[0] &lt;&lt; std::endl;

  someFunctionCallByValue(x);
  someFunctionCallByReference(x);

  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;vector&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">someFunctionCallByValue</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt; </span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;Call by value, address: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; &amp;</span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">someFunctionCallByReference</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt; </span><span style="color: #569CD6">&amp;</span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;Call by reference, address: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; &amp;</span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfCells = </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt; </span><span style="color: #DCDCAA">x</span><span style="color: #D4D4D4">(numberOfCells);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;original memory location: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; &amp;</span><span style="color: #9CDCFE">x</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">someFunctionCallByValue</span><span style="color: #D4D4D4">(x);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">someFunctionCallByReference</span><span style="color: #D4D4D4">(x);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>What we are doing here, is to create some vector <code>x</code> on line 14 which we then pass to two separate functions. One is call by value, and one is call by reference. How can you tell? The call by reference version accepts one function argument, but this is prefixed with the <em>address-of</em> operator, i.e. <code>&amp;</code> on line 8. If you run the above code, a possible output could be the following:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>original memory location: 0x6252b0</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>Call by value, address: 0x628210</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>Call by reference, address: 0x6252b0</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Notice how the original memory location (for the first element in the vector) and the memory location within the call by reference function are the same. However, in the call by value function, it is different. This really tells us all we need; if we pass a variable to a function by reference, that is, if we prefix it with the <code>&amp;</code> operator within the function signature, then we will simply pass the memory (of the first element) to the function. Since the memory is laid out contiguously, and we know the size of the vector (this is one of the properties the vector class can tell us), we can then access all the other elements in the vector. If we do not use the <em>address-of</em> operator, i.e. if we do not prefix our variables with the <code>&amp;</code> operator (see function signature on line 4), then we simply pass a copy of that variable to the function.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We obviously want to avoid copying large amounts of data between functions, and so using call by reference allows you to keep your memory footprint to a minimum. In general terms, if your variable is located on the heap, you want to pass it by reference to functions, if your variable is located on the stack, passing by value is a good default choice. There are good reasons to deviate from this advice from time to time, depending on your problem, though in most cases you should be fine if you follow this approach.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-memory-caches">Memory caches</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The last concept I want to talk about is caches. If you ever bought a PC and tried to decipher what hardware it has, you'll likely read about the CPU and looked at the clock speed and number of cores. These days, CPUs typically have around 4-6 cores, each with a clock speed of around 3 GHz. A value 3 GHz, or 3·10<sup>9</sup> Hz, means that you can execute 3·10<sup>9</sup> instructions on each core per second. Each instruction is counted in clock cycles, and your CPU (or core) gets to do exactly one thing per clock cycle. A CPU works by repeating the following 3 stages: fetch, decode, and execute, each consuming 1 clock cycle. During the fetch stage, the CPU is simply retrieving an instruction of what it should do, this could be adding numbers together, reading memory, writing something to a file, etc. The decode stage will then actually check what needs to be done. The execute stage will then perform the task, and this cycle then repeats.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For CFD applications, most of the time is spent on processing a large amount of data. We either add, subtract, multiply, or divide values from arrays or matrices, which means we need to know which operation to perform (this is what the fetch and decode stage will tell us). Additionally, we need to know which numbers to add together, i.e., at which location within the array we should manipulate data. So we also need to have data available to each core before we can do anything.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Memory is brought into the CPU through a memory hierarchy. On the CPU itself, you have registers, of which you only have a handful. Memory is not loaded into the registers directly from your main memory, but rather through the hierarchy I alluded to above. Next to the registers, you have your level 1, or L1 cache. This one is significantly larger than your registers. To give you some idea, in your registers, you may be able to hold about 8 variables with a double data type, while your L1 cache can hold somewhere between 4096 and 8192 doubles, typically. Next, you have a level 2 and level 3 (or L2 and L3) cache, each increasing in size, and finally, you have your main memory or RAM followed by your hard disk. This concept is also shown in the picture below and taken from <a href="https://cs61.seas.harvard.edu/site/2018/Storage2/" target="_blank" rel="noopener" title="">here</a>:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":1588,"width":"663px","height":"375px","sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2023/10/storage-hierarchy.png" alt="" class="wp-image-1588" style="width:663px;height:375px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The smaller the storage capacity of your caches, the faster they can serve memory to your CPU. When your CPU needs data, it will first check if that is available in the registers. If not, it will check the L1 cache and load data from there if it exists. This is then known as a cache hit. If the L1 cache does not contain the data you need (this is called a cache miss), it will be requested from the L2 cache and, if it doesn't exist there, from the L3 cache. If the L3 cache does not have the data, it is loaded from memory (RAM), where it is guaranteed to exist, otherwise, your application will terminate ungracefully. This is also the reason why you need to have sufficient RAM to run simulations, as everything is stored here, e.g. your mesh, and your solution data, until you dump it to your hard disk. If you don't have enough space here, you simply can't run your simulations (and will likely get a segmentation-fault type of message, indicating that due to memory issues, your simulation could not run).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Theoretically, you can use your hard disk as RAM. With hard disks in the region of Terrabytes, this would be very lucrative. In fact, if you use a UNIX distribution such as Ubuntu, you get asked at the installation stage if you want to set up a swap space, which is essentially allocating some portion of your hard disk that can be used as RAM. If you are using an older solid-state drive, we can see that it can take around 3 milliseconds to access data. Compare that with the 62.9 nanoseconds, and you quickly see why you don't want to use your hard disk as RAM. If you use your hard disk as RAM, you will increase your computational times by a factor of approximately 48 times (3ms / 62.9 ns). </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So why are we spending this much time on the CPU and its caches? Because CFD applications are memory-hungry applications, and we need to manage that efficiently. Consider the following two scenarios:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// loop 1, loop order: i, j, k\nfor (int i = 0; i \u0026lt; 1000; ++i)\n  for (int j = 0; j \u0026lt; 1000; ++j)\n    for (int k = 0; k \u0026lt; 1000; ++k)\n      mat[i][j][k] = ... // actually not important","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// loop 1, loop order: i, j, k\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++i)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e j = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; j \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++j)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e k = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; k \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++k)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emat\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i][j][k] = ...\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // actually not important\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":7.640625,"highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// loop 1, loop order: i, j, k
for (int i = 0; i &lt; 1000; ++i)
  for (int j = 0; j &lt; 1000; ++j)
    for (int k = 0; k &lt; 1000; ++k)
      mat[i][j][k] = ... // actually not important" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// loop 1, loop order: i, j, k</span></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++i)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> j = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; j &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++j)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> k = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; k &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++k)</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">mat</span><span style="color: #D4D4D4">[i][j][k] = ...</span><span style="color: #6A9955"> // actually not important</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>and</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// loop 2, loop order: k, j, i\nfor (int k = 0; k \u0026lt; 1000; ++k)\n  for (int j = 0; j \u0026lt; 1000; ++j)\n    for (int i = 0; i \u0026lt; 1000; ++i)\n      mat[i][j][k] = ... // actually not important","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// loop 2, loop order: k, j, i\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e k = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; k \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++k)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e j = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; j \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++j)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++i)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emat\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i][j][k] = ...\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // actually not important\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"lineNumbersWidth":7.640625,"highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// loop 2, loop order: k, j, i
for (int k = 0; k &lt; 1000; ++k)
  for (int j = 0; j &lt; 1000; ++j)
    for (int i = 0; i &lt; 1000; ++i)
      mat[i][j][k] = ... // actually not important" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// loop 2, loop order: k, j, i</span></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> k = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; k &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++k)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> j = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; j &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++j)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++i)</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">mat</span><span style="color: #D4D4D4">[i][j][k] = ...</span><span style="color: #6A9955"> // actually not important</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Which of these two loops will perform faster? The first one will, why? In C/C++, memory is laid out in memory in such a way that if you have more than one dimension in your array (here we have a three-dimensional array), the last dimension (here the third, i.e. values accessed by <code>k</code>) are closest together. Whenever you load memory, you bring in a so-called cache line, which is not just one value of your array but a number of values which are next to each other in the array. So, when we then proceed to load data, we actually get more than we asked for (when you update one register, all the other registers are updated as well and memory that is close to each other is loaded into the other registers).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we loop over that data and we ensure that we loop in such a way that the third index is changing fastest, i.e., it is the last loop, not the first as in the second loop example, then we benefit from the already loaded data, and we have a lot fewer cache misses. To give you an idea, loading in memory from the L1 cache into the registers takes about 2-3 clock cycles, loading memory from L2 into L1 about 10 clock cycles, and from L3 into L2 about 20-30 clock cycles. If we keep in mind that the calculation we want to perform, i.e., adding or multiplying numbers together, actually only takes 1 clock cycle, we really want to make sure that memory access is optimised in our code.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-the-roofline-memory-model">The roofline memory model</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Most people will not know about caches, and this is fine, but we as CFD developers need to understand memory at least in its basics, and now you do. Here is another little secret; most applications are actually memory-bound, i.e. if you were to measure the performance of your application (typically done in GFLOPS, or, (giga) floating-point operations per second, i.e. how many floating-point operations are you able to do per second), you wouldn't be operating at the maximum clock speed of your CPU but rather be limited by the amount of memory you are loading. This is also illustrated in the figure below (taken from <a href="https://en.wikipedia.org/wiki/Roofline_model#/media/File:Example_of_a_Roofline_model.svg" target="_blank" rel="noopener" title="here">here</a>) and due to the shape of this graph, it is referred to as the <a href="https://en.wikipedia.org/wiki/Roofline_model">roofline model</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1585,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://cfd.university/wp-content/uploads/2023/10/roofline_model-1024x446.png" alt="" class="wp-image-1585"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>In this figure, we can see that we only get peak performance if we have sufficient (floating-point) operations per second (FLOPS) for each byte that we load, in other words, we want to maximize the number of FLOPS and minimize the amount of memory that is loaded, and one way of doing this is to avoid cache misses where possible (but you can't avoid cache misses altogether, at some point you have to load new data into your caches, you just want to minimise where you can).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The good news is, there aren't that many places where we can mess up our memory pipeline, and the compiler is doing a good job in optimising most memory deficiencies in our code for us automatically. For example, going back to the two loops we looked at above, if you were to compile the code with optimisation turned on, you would likely get the same performance with the same amount of cache misses. Why? Because the compiler is trying to optimise your code to reduce cache misses, and in this case, it is easy to do by just changing the order of the loop. It will only do that, however, if it can guarantee that it will not change the outcome of your program. If there is just a slight doubt, the compiler will not make any changes, and so more complex loops will be more difficult to optimise, hence it is a good idea to ensure we are doing our best to help the compiler do its job.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>By now, you may start to see why using a compiled language is a real advantage. It is doing all sorts of memory optimisation in the background by rewriting our code that is not necessarily readable but performant. We keep our readable code but just have to pay a slight cost by waiting for the compiler to do its job. For smaller application, that cost is barely noticeable, but once your code has 10 000 - 100 000 lines of code, you really start to feel the pain, waiting for minutes for the compilation. But there are ways around that, by compiling your code into smaller chunks and then linking all of these together, so this is not necessarily a hard limitation. Interpreted languages such as Python do not provide us with any mechanism whatsoever to optimise our code when it is executed. The best we can do is to use a package that is implemented in C or C++ and compiled into machine code. This allows us to get fast performance but this also means that we are limited to the syntax the package provides us. This is not necessarily a limitation, but certainly worth keeping in mind.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This is really all there is on memory, in a nutshell. Of course, we have skimmed over some details here and you can look make any topic arbitrarily more complex, but you should have a good overview of the matter now. If you are intrigued and want to know more, I can only recommend the book by Georg Hager and Gerhard Wellein: <a href="https://www.routledge.com/Introduction-to-High-Performance-Computing-for-Scientists-and-Engineers/Hager-Wellein/p/book/9781439811924" target="_blank" rel="noopener" title="">Introduction to High-Performance Computing for Scientists and Engineers</a>. There is a lot of information in this book, which takes a more practical and applied focus, but you only really need to read the first three chapters. Everything afterwards deals with parallelisation and how to make this more efficient, but that is somewhat of a more advanced paradigm we don't have to worry about for now (but I'm sure we will circle back to this in the future)</p>
<!-- /wp:paragraph -->