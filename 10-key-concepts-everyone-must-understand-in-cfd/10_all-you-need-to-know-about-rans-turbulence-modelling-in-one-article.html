<!-- wp:heading {"level":1} -->
<h1 class="wp-block-heading">All you need to know about RANS turbulence modelling in one article</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In today's article, we will be finally looking at the pinnacle of CFD: Reynolds-averaged Navier-Stokes (RANS) turbulence modelling. If you have ever wondered not just what RANS is, but also how it works under the hood, then this article is for you. RANS turbulence modelling is so instrumental that no one can really claim to know how to use CFD if they have no clue about RANS turbulence modelling.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this article, I will take the time we need to go through the concept and derive the equations I find most helpful. There will be derivations here you won't find elsewhere, and some derivations are based on Prandtl's original work (which, as best as I can see, is only available in German). There is a lot of detail here, but I promise you, after you have gone through this article, you will know exactly what goes into a RANS turbulence model and how to create one yourself.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In fact, I'll prove it to you at the end of this article, where we will be developing a brand-spanking new RANS model ourselves; the STUPID model (you'll see later why I have come up with this name).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, I would usually say, put on the kettle, you'll need it. But for this blockbuster feature-length article, you will need more than that. Perhaps popcorn? I don't know. Whatever gets you going, bring that. And with that, let's get started.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="10-key-concepts-everyone-must-understand-in-cfd"]
<!-- /wp:shortcode -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[TOC]
<!-- /wp:shortcode -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Introduction</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's take stock of what we have achieved thus far. We started our journey into turbulence two articles ago, when we talked about <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-origin-of-turbulence-and-direct-numerical-simulations-dns/" target="_blank" rel="noopener" title="">Direct Numerical Simulations (DNS)</a>. We looked at how turbulence is generated, both from a physical and mathematical point of view, and then we looked at the requirements to fully resolve all turbulent scales using DNS.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We saw that a full DNS takes computational times that most of us cannot afford. We need access to a capable high-performance computing (HPC) cluster that allows us to run on thousands of cores, just for a single simulation. While this has its merit for academic research, we said that this approach was limited to very simple geometries, and it will remain so for the foreseeable future.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To soften the grid and time-step requirements, we introduced <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/" target="_blank" rel="noopener" title="">Large Eddy Simulations (LES)</a>. This involved a local filtering process, where the filtering can be thought of as computing a local space-averaged flow field. This local averaging removes all the high-frequency turbulent eddies, allowing us to use a computational grid that is far less demanding to solve on compared to a DNS grid. The downside is that we have to model the unresolved flow field, and various models exist with their own advantages and disadvantages.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>While LES requires far fewer resources compared to DNS, it is a relative comparison. DNS requires an extraordinary effort, from a resource point of view, and so LES still requires resources that most of us cannot afford. We are still talking hundreds of cores, if not more, to get a single simulation going. While for both DNS and LES, the resources present a challenge, once we have access to them, it turns out that resources do not represent the bottleneck in our simulations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After using a sufficiently large number of cores (CPUs if you want, though strictly speaking, cores and CPUs are different, but let's ignore this fact for the moment), we will not see an improvement in the speedup of our simulation. At that point, we have reached peak performance. What is really holding us back here is the need to solve the flow in an unsteady manner.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Consider a domain of 40 million cells for a LES simulation. Let's say we use 512 cores to solve this problem, and it takes about 2 days to finish the simulation. Then, we may double the number of cores to 1024, and now it only takes 1 day of simulation time. At some point, we reach an optimum, i.e. we cannot add more cores and expect a similar decrease in computational time.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's say that 1024 cores is the optimum, meaning that if we use more than 1024 cores, it would take longer than 1 day to finish the simulation. For the sake of argument, let's assume that the entire simulation will resolve the flow for about 2 seconds. Once the simulation is done, we carry out some post-processing and realise that we are missing some important low frequencies. We need to resolve at least 20 seconds of flow time.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, we need to run an additional 18 seconds of simulated flow time. If it takes one day to run 2 seconds of flow time, then we need to add 9 additional days of flow time. Instead of running just 1 day, we are now running the simulation for 10 days. This is the main problem with DNS and LES; the amount of time required to resolve turbulence is directly proportional to how long we need to simulate for in time. If we double the amount of flow time we want to resolve, our simulation time will double, no matter how many cores we throw at the problem.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we really want to make some significant gains in computational time, we need to try to remove the unsteady feature of turbulence. This is exactly what the Reynolds-averaged Navier-Stokes (RANS) approach is trying to achieve by solving the flow for time-averaged, mean flow quantities. In this article, we will explore what RANS is and how it works.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">The fully turbulent Reynolds-averaged Navier-Stokes (RANS) equations</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have actually already derived the full RANS equations in the article on the origin of turbulence and DNS, when we looked at <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-origin-of-turbulence-and-direct-numerical-simulations-dns/#aioseo-how-is-turbulence-generated" target="_blank" rel="noopener" title="">how turbulence is generated in a mathematical sense.</a>. Let's summarise the equations here, but feel free to go through the derivation in the above-linked article, to make sure these equations fell familiar.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's look at a turbulent signal first. If we perform an experiment and we measure the velocity (or any other flow quantity) within a turbulent region, we will obtain a seemingly chaotic and randomly fluctuating signal, such as the one shown in the figure below.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5282,"width":"600px","sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2025/04/U_velocity_signal.png" alt="This figure depicts a time series of a velocity signal, showing that it has a mean value and a fluctuating velocity component that fluctuates around the mean value." class="wp-image-5282" style="width:600px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Reynolds showed that we can always decompose a signal like this into its mean ([katex]\bar{u}[/katex]) and fluctuating ([katex]u'[/katex]) component. Thus, any instantaneous signal will be the sum of the two. For the velocity field shown above, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\mathbf{U}}_\text{instantaneous}=\underbrace{\bar{\mathbf{u}}}_\text{mean} + \underbrace{\mathbf{u'}}_\text{fluctuation}\tag{1}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can do this for any flow component, not just the velocity. To generalise this Reynolds decomposition of the velocity field, we can also write this with the generic variable [katex]\phi[/katex], which results in [katex]\phi=\bar{\phi} + \phi'[/katex]. Looking at the figure above, we can define the mean flow component [katex]\bar{\phi}[/katex] (or [katex]\bar{\mathbf{u}}[/katex]) as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\bar{\phi}=\frac{1}{T}\int_0^T\phi(t)\mathrm{d}t\tag{2}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we perform an experiment, we will have a time series of discrete values of [katex]\phi[/katex] at specific points in time. We can then numerically evaluate the integral above by using the following approximation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\bar{\phi}\approx\frac{1}{T}\sum_{i=0}^{N_T}\phi_i\Delta t\tag{3}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If the time step [katex]\Delta t[/katex] is constant, we can further simplify this to</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\bar{\phi}\approx\frac{1}{N_T}\sum_{i=0}^{N_T}\phi_i\tag{4}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is just summing up all values within our time series of [katex]\phi[/katex] and then dividing it by the number of samples we used to create the average.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Returning to the above figure of the Reynolds decomposition, we can see that the velocity fluctuates around the mean value. Thus, if we remove the mean value, we would expect that the average of the fluctuating velocity component (or [katex]\phi'[/katex], in general) will fluctuate around a zero-mean value. We can express this, again, in integral form as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\phi'=\frac{1}{T}\int_0^T\phi'(t)\mathrm{d}t=0\tag{5}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Decomposing the flow field into its mean and fluctuating field is the first step in deriving suitable equations we can use for steady state turbulence calculations. We see that the mean (time-averaged) flow field [katex]\bar{\phi}[/katex] appears in our Reynolds decomposition, so eventually, we want to be solving for this quantity. To do that, we need to insert the Reynolds decomposition [katex]\phi=\bar{\phi} + \phi'[/katex] into our governing equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's consider an incompressible flow for the sake of argument. The momentum equation is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \mathbf{U}}{\partial t} + (\mathbf{U}\cdot \nabla)\mathbf{U}=-\frac{1}{\rho}\nabla P+ \nu \nabla^2 \mathbf{U}\tag{6}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, the capital letters [katex]\mathbf{U}[/katex] and [katex]P[/katex] indicate that this momentum equation is formulated for the instantaneous flow field. It will be easier to see what the Reynolds decomposition will do to our equations if we consider just a 1D scalar version of our momentum equation. The 1D scalar equation of the momentum equation is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial U}{\partial t}+ U\frac{\partial U}{\partial x}=-\frac{1}{\rho}\frac{\partial P}{\partial x} + \nu\frac{\partial^2 U}{\partial x^2}\tag{7}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This equation is written in so-called non-conservative form. The non-conservative form splits the non-linear term into [katex]U(\partial U/\partial x)[/katex], whereas the conservative form writes both components of [katex]U[/katex] into the derivative, i.e. the conservative form of the non-linear term would be [katex]\partial UU/\partial x[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the article on <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/how-to-solve-incompressible-and-compressible-flows-in-cfd/#aioseo-primitive-vs-conserved-variable-formulations" target="_blank" rel="noopener" title="">compressible vs. incompressible flows</a>, we looked at the difference between the conservative and non-conservative (also called the primitive variable formulation) description. I showed that for incompressible flows, there is no (mathematical) difference between the conservative and non-conservative description, and so we can simply switch between the two.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But, for compressible flows, this is not the case, and the equations are different between the conservative and non-conservative (primitive variable) formulation. I showed a simple discretised equation in conservative and non-conservative form in the above-linked article, and how the non-conservative description yields incorrect results for flows with discontinuities (i.e. shock waves). Thus, while we can choose whichever form we prefer for incompressible flows, we prefer the conservative form for compressible flows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, let us write the above shown non-conservative 1D momentum equation in conservative form (only the advective non-linear term will change):</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial U}{\partial t}+ \frac{\partial UU}{\partial x}=-\frac{1}{\rho}\frac{\partial P}{\partial x} + \nu\frac{\partial^2 U}{\partial x^2}\tag{8}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>At this point, since the momentum equation is written for the instantaneous velocity ([katex]U[/katex]) and pressure ([katex]P[/katex]) field, we can insert Reynolds decomposition for the velocity and pressure. This results in the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial (\bar{u}+u')}{\partial t}+ \frac{\partial (\bar{u}+u')(\bar{u}+u')}{\partial x}=-\frac{1}{\rho}\frac{\partial (\bar{p}+p')}{\partial x} + \nu\frac{\partial^2 (\bar{u}+u')}{\partial x^2}\tag{9}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This equation is exact, i.e. we have just changed how the velocity and pressure field are expressed in the momentum equations. But we can't solve this equation. It requires knowledge of what the fluctuating velocities and pressures are, but we are not interested in them. Our goal is to derive a momentum equation that is formulated in terms of average quantities, i.e. [katex]\bar{u}[/katex] and [katex]\bar{p}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, how do we get rid of the fluctuating velocity and pressure field? Well, if we were to take a time-average of these equations, we know that the fluctuating component is defined as having a zero mean value if it is integrated over time. Thus, by taking the time-averaged form, we hope to eliminate the fluctuating part. So let's do this, where I indicate the time-average with [katex]\overline{(\cdot)}[/katex] (i.e. a line over the parenthesis we saw in the previous momentum equation)</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')}}{\partial t}+ \frac{\partial \overline{(\bar{u}+u')(\bar{u}+u')}}{\partial x}=-\frac{1}{\rho}\frac{\partial \overline{(\bar{p}+p')}}{\partial x} + \nu\frac{\partial^2 \overline{(\bar{u}+u')}}{\partial x^2}
\tag{10}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's focus on the individual velocity and pressure field. We can write the time-average of these quantities as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{(\bar{u}+u')}=\underbrace{\overline{\bar{u}}}_{=\bar{u}}+\underbrace{\overline{u'}}_{=0}=\bar{u}+0=\bar{u}\\[1em]
\overline{(\bar{p}+p')}=\underbrace{\overline{\bar{p}}}_{=\bar{p}}+\underbrace{\overline{p'}}_{=0}=\bar{p}+0=\bar{p}
\tag{11}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we have a mean value (which is just a single value, i.e. not a time series with many values for either [katex]u[/katex] or [katex]p[/katex]), if we take the mean (time-average) of this value, we just get the same mean value back. For example, let's look at [katex]\overline{\bar{u}}[/katex]. We said that the mean value is approximated as (assuming a constant time step [katex]\Delta t[/katex] here):</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\bar{u}\approx\frac{1}{N_T}\sum_{i=0}^{N_T}u_i\tag{12}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we take an average of this single value now again (where we have [katex]N_T=1[/katex] now), then we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\bar{u}}=\frac{1}{N_T}\sum_{i=0}^{1}\bar{u}_i=\frac{1}{1}\bar{u}=\bar{u}\tag{13}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, the mean of a mean value is simply the mean value itself. This is great, as this means taking the time-average of the 1D momentum equation does not change the mean flow values. Even better, looking at the velocity and pressure field in Eq.(11), we see that the fluctuating component [katex]u'[/katex] and [katex]p'[/katex] are zero. So by taking the time average of the momentum equation, we retain the already existing time-averaged values for the velocity and pressure, and remove their fluctuating component. Excellent, job done, right?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If only fluid mechanics were that simple ... Our Momentum equations are non-linear, and it is this non-linearity that is the root of all evil (or pure pleasure?!) in fluid dynamics. Shock waves and turbulence are a direct consequence of this non-linearity, and there are countless PhD theses on just how to best treat this non-linear term (including yours truly).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After all, if we liked a simple life where everything is linear, we would have stayed with structural mechanics, right? But that is for ... (insert whichever word you find ends this sentence best).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, let's face the music and see what happens with the non-linear term then. Since the non-linear term is written as [katex]\partial UU/\partial x[/katex], inserting the Reynolds decomposition results in [katex]\partial [(\bar{u}+u')(\bar{u}+u')]/\partial x[/katex]. We have to multiply out the parentheses, which is done in the following:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{(\bar{u}+u')}\overline{(\bar{u}+u')}=\underbrace{\overline{\bar{u}\bar{u}}}_{=\bar{u}\bar{u}}+\underbrace{\overline{\bar{u}u'}}_{=\bar{u}\cdot 0=0} +\underbrace{\overline{u'\bar{u}}}_{0\cdot \bar{u}=0} +\underbrace{\overline{u'u'}}_{\ne 0}\tag{14}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The mean of a mean value, as already discussed, remains the same. Multiplying the mean value by the time-averaged fluctuating velocity component is also zero, since the time average of the fluctuating component is zero. However, if we multiply the fluctuating components together and then take the time average, we get a non-zero value. Why? Well, I provided a detailed discussion of that in the article on the origin of turbulence and <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-origin-of-turbulence-and-direct-numerical-simulations-dns/#aioseo-how-is-turbulence-generated" target="_blank" rel="noopener" title="">how it is generated in a mathematical sense</a>. If you want to know why, then take a little detour, I'll wait here.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Are you back? Good, then let's continue.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can now write the non-linear term as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial\overline{(\bar{u}+u')}\overline{(\bar{u}+u')}}{\partial x}=\frac{\partial \bar{u}\bar{u}}{\partial x} + \frac{\partial \overline{u'u'}}{\partial x}
\tag{15}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Inserting Eq.(11) and Eq.(15) into our instantaneous, 1D momentum equation, we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')}}{\partial t}+ \frac{\partial \overline{(\bar{u}+u')(\bar{u}+u')}}{\partial x}=-\frac{1}{\rho}\frac{\partial \overline{(\bar{p}+p')}}{\partial x} + \nu\frac{\partial^2 \overline{(\bar{u}+u')}}{\partial x^2}\\[1em]
\frac{\partial \bar{u}}{\partial t}+ \frac{\partial \bar{u}\bar{u}}{\partial x}+\frac{\partial \overline{u'u'}}{\partial x}=-\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x} + \nu\frac{\partial^2 \bar{u}}{\partial x^2}\tag{16}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>It is common practice to place the additional derivative of the time-averaged fluctuating velocity components on the right-hand side, which is written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \bar{u}}{\partial t}+ \frac{\partial \bar{u}\bar{u}}{\partial x}=-\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x} + \nu\frac{\partial^2 \bar{u}}{\partial x^2} - \frac{\partial \overline{u'u'}}{\partial x}\tag{17}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we now introduce the substitution [katex]\tau^{RANS}=-\overline{u'u'}[/katex], then our momentum equation becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \bar{u}}{\partial t}+ \frac{\partial \bar{u}\bar{u}}{\partial x}=-\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x} + \nu\frac{\partial^2 \bar{u}}{\partial x^2} +\frac{\partial \tau^{RANS}}{\partial x}
\tag{18}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\tau^{RANS}[/katex] is known as the Reynolds stress tensor. In our case, since we are dealing with the 1D version of the momentum equation, it is simply a scalar value, i.e. [katex]\tau^{RANS}=-\overline{u'u'}[/katex]. But, in 3D, the Reynolds stress tensor becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=-\overline{\mathbf{u}'\mathbf{u}'}=\begin{bmatrix}
-\overline{u'u'} & -\overline{u'v'} & -\overline{u'w'}\\[1em]
-\overline{v'u'} & -\overline{v'v'} & -\overline{v'w'} \\[1em]
-\overline{w'u'} & -\overline{w'v'} & -\overline{w'w'}
\end{bmatrix}\tag{19}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>You can find the derivation of this tensor as well in my article <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-origin-of-turbulence-and-direct-numerical-simulations-dns/#aioseo-direct-numerical-simulations-dns" target="_blank" rel="noopener" title="">on the origin of turbulence</a>. For completeness, you may also find the Reynolds stress tensor defined as [katex]\tau^{RANS}=-\rho\overline{u'u'}[/katex] in the literature, which is achieved by multiplying the momentum equation by the density [katex]\rho[/katex]. In this case, [katex]\tau^{RANS}[/katex] becomes</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=-\rho\overline{\mathbf{u}'\mathbf{u}'}=-\rho\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'}\\[1em]
\overline{v'u'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{w'u'} & \overline{w'v'} & \overline{w'w'}
\end{bmatrix}
\tag{20}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The corresponding momentum equation becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\rho\frac{\partial \bar{u}}{\partial t}+ \rho\frac{\partial \bar{u}\bar{u}}{\partial x}=\frac{\partial \bar{p}}{\partial x} + \mu\frac{\partial^2 \bar{u}}{\partial x^2} +\frac{\partial \tau^{RANS}}{\partial x}\tag{21}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Not that when we multiply the momentum equation by the density [katex]\rho[/katex], the kinematic viscosity [katex]\nu[/katex] now becomes the dynamic viscosity [katex]\mu[/katex], as we have the relation [katex]\nu=\rho\mu[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is the equation we are solving when we deal with RANS turbulence modelling. It is rather common to solve the RANS equation in steady state mode, in which case the time derivative vanishes. In this case, the RANS momentum equation becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \bar{u}\bar{u}}{\partial x}=-\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x} + \nu\frac{\partial^2 \bar{u}}{\partial x^2} +\frac{\partial \tau^{RANS}}{\partial x}\\[1em]
\rho\frac{\partial \bar{u}\bar{u}}{\partial x}=\frac{\partial \bar{p}}{\partial x} + \mu\frac{\partial^2 \bar{u}}{\partial x^2} +\frac{\partial \tau^{RANS}}{\partial x}\tag{22}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Having said that, we can solve the equation in an unsteady flow as well, in which case we retain the time derivative, and we call this unsteady RANS, or URANS.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We have looked at the equation thus far only in 1D form for simplicity, but we could also write it in the general 3D form. They are just longer, and given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\rho\frac{\partial \bar{u}\bar{u}}{\partial x} +
\rho\frac{\partial \bar{v}\bar{u}}{\partial y} +
\rho\frac{\partial \bar{w}\bar{u}}{\partial z}
=-\frac{\partial \bar{p}}{\partial x} +
\mu\frac{\partial^2 \bar{u}}{\partial x^2} +
\mu\frac{\partial^2 \bar{u}}{\partial y^2} +
\mu\frac{\partial^2 \bar{u}}{\partial z^2} -
\rho\frac{\partial \overline{u'u'}}{\partial x} -
\rho\frac{\partial \overline{v'u'}}{\partial y} -
\rho\frac{\partial \overline{w'u'}}{\partial z} \\[1em]
\rho\frac{\partial \bar{v}}{\partial t}+ 
\rho\frac{\partial \bar{u}\bar{v}}{\partial x} +
\rho\frac{\partial \bar{v}\bar{v}}{\partial y} +
\rho\frac{\partial \bar{w}\bar{v}}{\partial z}
=-\frac{\partial \bar{p}}{\partial y} + 
\mu\frac{\partial^2 \bar{v}}{\partial x^2} +
\mu\frac{\partial^2 \bar{v}}{\partial y^2} +
\mu\frac{\partial^2 \bar{v}}{\partial z^2} -
\rho\frac{\partial \overline{u'v'}}{\partial x} -
\rho\frac{\partial \overline{v'v'}}{\partial y} -
\rho\frac{\partial \overline{w'v'}}{\partial z}\\[1em]
\rho\frac{\partial \bar{w}}{\partial t}+ 
\rho\frac{\partial \bar{u}\bar{w}}{\partial x} +
\rho\frac{\partial \bar{v}\bar{w}}{\partial y} +
\rho\frac{\partial \bar{w}\bar{w}}{\partial z}
=-\frac{\partial \bar{p}}{\partial z} + 
\mu\frac{\partial^2 \bar{w}}{\partial x^2} +
\mu\frac{\partial^2 \bar{w}}{\partial y^2} +
\mu\frac{\partial^2 \bar{w}}{\partial z^2} -
\rho\frac{\partial \overline{u'w'}}{\partial x} -
\rho\frac{\partial \overline{v'w'}}{\partial y} -
\rho\frac{\partial \overline{w'w'}}{\partial z}\tag{23}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>You can see how each line in the Reynolds stress tensor [katex]\tau^{RANS}[/katex] in Eq.(20) appears in the three separate momentum equations for [katex]\bar{u}[/katex], [katex]\bar{v}[/katex], and [katex]\bar{w}[/katex] on the right-hand side.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, I want to sensibilise you to one point that is entirely ignored in the literature (well, I have seen it in a few places, but this is not common knowledge, even amongst so-called <em>CFD experts</em>).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In my article on Large Eddy Simulations (LES), I derived the LES momentum equations, which are not time-averaged but space-averaged. We called the equations that came out the <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-the-filtered-navier-stokes-equations" target="_blank" rel="noopener" title="">filtered Navier-Stokes equations</a>. The filtered Navier-Stokes equations were given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{\mathbf{u}}}{\partial t} + \frac{\partial \bar{\mathbf{u}}\bar{\mathbf{u}}}{\partial \mathbf{x}} = -\frac{1}{\rho}\frac{\partial\overline{p}}{\partial \mathbf{x}} + \nu\frac{\partial^2 \overline{\mathbf{u}}}{\partial \mathbf{x}^2} + \frac{\partial \tau^{SGS}}{\partial \mathbf{x}}\tag{24}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\tau^{SGS}[/katex] are the subgrid-scale stresses that we no longer resolve due to the spatial averaging. This equation uses bold letters for the velocity to indicate that this is a vector quantity, but we could equally write this equation in 1D, which would result in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \bar{u}}{\partial t} + \frac{\partial \bar{u}\bar{u}}{\partial x} = -\frac{1}{\rho}\frac{\partial \overline{p}}{\partial x} + \nu\frac{\partial^2 \overline{u}}{\partial x^2} + \frac{\partial \tau^{SGS}}{\partial x}\tag{25}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Compare that with the unsteady RANS (URANS) equations we have derived before, i.e.:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \bar{u}}{\partial t}+ \frac{\partial \bar{u}\bar{u}}{\partial x}=-\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x} + \nu\frac{\partial^2 \bar{u}}{\partial x^2} + \frac{\partial \tau^{RANS}}{\partial x}\tag{26}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The only difference here is the new stress tensor [katex]\tau^{SGS}[/katex] and [katex]\tau^{RANS}[/katex]. Sure, we used time-averaging to derive the Reynolds-averaged Navier-Stokes (RANS) equations, and spatial averaging to derive the filtered Navier-Stokes equation for LES, but my point is that from a pure mathematical point of view, we have obtained the same equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, except for the additional stresses, these are defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS} = -\overline{u'u'} \\[1em]
\tau^{SGS} = \bar{\mathbf{u}}\bar{\mathbf{u}} - \overline{\bar{\mathbf{u}}\bar{\mathbf{u}}} - \overline{\bar{\mathbf{u}}\mathbf{u}'} - \overline{\mathbf{u}'\bar{\mathbf{u}}} - \overline{\mathbf{u}'\mathbf{u}'}\tag{27}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, as long as we model the stress tensor in both RANS and LES exactly, we would expect differences between RANS and LES. But, as we will see in just a second, we do not model these stress tensors as they are, and this results in some rather interesting (or shocking?!) similarities between RANS and LES.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But I am getting ahead of myself, let's take stock of what we have and what we need to do next. We successfully derived the RANS equation, and we saw that we got additional stresses, namely the Reynolds stress tensor [katex]\tau^{RANS}[/katex], as also given explicitly in Eq.(20).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This means that we have obtained 9 additional unknown quantities in a 3D flow. Well, luckily, the tensor is symmetric, so stresses such as [katex]\overline{u'v'}[/katex] and [katex]\overline{v'u'}[/katex] are the same. We can express that more formally as [katex]\overline{u_i'u_j}'=\overline{u_j'u_i'}[/katex]. The 9 additional unknowns then reduce to only 6 unknowns. This is also shown explicitly in the following:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=-\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'}\\[1em]
\overline{v'u'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{w'u'} & \overline{w'v'} & \overline{w'w'}
\end{bmatrix}=
-\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'}\\[1em]
\overline{u'v'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{u'w'} & \overline{v'w'} & \overline{w'w'}
\end{bmatrix}\tag{28}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Notice how we have set [katex]\tau_{12}=\tau_{21}[/katex], [katex]\tau_{13}=\tau_{31}[/katex], and [katex]\tau_{23}=\tau_{32}[/katex]. In 2D, we have a 2 by 2 tensor with a total of 4 new unknowns (but, again, since the tensor is symmetric, only 3 components are actually unknown). Again, we can write out this tensor in 2D as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=-\begin{bmatrix}
\overline{u'u'} & \overline{u'v'}\\[1em]
\overline{v'u'} & \overline{v'v'}
\end{bmatrix}=
-\begin{bmatrix}
\overline{u'u'} & \overline{u'v'}\\[1em]
\overline{u'v'} & \overline{v'v'}
\end{bmatrix}\tag{29}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, we have only used [katex]\tau_{12}=\tau_{21}[/katex]. In 1D, as we already saw, we only have a single unknown quantity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, we need to come up with a mechanism to model these additional unknown quantities. This means that we need to derive a total of 6 new equations for a 3D flow to model the additional stresses [katex]\overline{u'u'}[/katex], [katex]\overline{u'v'}[/katex], [katex]\overline{u'w'}[/katex], [katex]\overline{v'v'}[/katex], [katex]\overline{v'w'}[/katex], and [katex]\overline{w'w'}[/katex] (or 3 and 1 equations in 2D and 1D, respectively).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So let's see if we can achieve this. It will take a bit longer to derive, so let's put that into its own section.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">The closure problem of RANS</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>As we have seen in the previous section, we currently have our continuity equation and momentum equation in the [katex]x[/katex], [katex]y[/katex], and [katex]z[/katex] directions, which gives us a total of 4 equations. We have four flow properties to solve for, i.e. the pressure [katex]p[/katex] and the three velocity components [katex]u[/katex], [katex]v[/katex], and [katex]w[/katex]. However, in addition, we have 6 Reynolds stresses for which we need to construct 6 additional equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In other words, we have [katex]4+6=10[/katex] unknowns that we need to solve for, but only 4 independent equations. This will not work. Our system of equations is not yet <em>closed</em>. We need to find an additional 6 equations to close our system of equations. So let's do that.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's remind ourselves what the goal here is. We want to find and equation for the Reynolds stresses, that is, [katex]\overline{u'u'}[/katex], [katex]\overline{u'v'}[/katex], [katex]\overline{u'w'}[/katex], [katex]\overline{v'v'}[/katex], [katex]\overline{v'w'}[/katex], and [katex]\overline{w'w'}[/katex]. Thus, we need to have some form of equation that can compute these quantities, e.g. [katex]\overline{u'u'} = f(\mathbf{x},t)[/katex], where we need to determine the function [katex]f(\mathbf{x},t)[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Before you read on and peek at the solution, what equation comes to mind that we could use here? Do we already know some equation that contains the Reynolds stresses? Well, not exactly, but let's write out our [katex]u[/katex] momentum equation again, this time for a 3D flow. This is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial U}{\partial t}+ \frac{\partial UU}{\partial x} + \frac{\partial UV}{\partial y} + \frac{\partial UW}{\partial z}=-\frac{1}{\rho}\frac{\partial P}{\partial x} + \nu\frac{\partial^2 U}{\partial x^2} + \nu\frac{\partial^2 U}{\partial y^2} + \nu\frac{\partial^2 U}{\partial z^2}\tag{30}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's introduce Reynolds decomposition, i.e. [katex]\phi=\bar{\phi}+\phi'[/katex], which results in the following [katex]u[/katex] momentum equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial (\bar{u}+u')}{\partial t}+ \frac{\partial (\bar{u}+u')(\bar{u}+u')}{\partial x} + \frac{\partial (\bar{u}+u')(\bar{v}+v')}{\partial y} + \frac{\partial (\bar{u}+u')(\bar{w}+w')}{\partial z}=\\[1em]
-\frac{1}{\rho}\frac{\partial (\bar{p}+p')}{\partial x} + \nu\frac{\partial^2 (\bar{u}+u')}{\partial x^2} + \nu\frac{\partial^2 (\bar{u}+u')}{\partial y^2} + \nu\frac{\partial^2 (\bar{u}+u')}{\partial z^2}\tag{31}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's focus on the time derivative, i.e. [katex]\partial (\bar{u}+u')/\partial t[/katex]. It already contains the fluctuating velocity component [katex]u'[/katex]. That's great news. If we multiply this term now with [katex]u'[/katex], then the time derivative will become</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial (\bar{u}+u')u'}{\partial t}=\frac{\partial \bar{u}u'}{\partial t} + \frac{\partial u'u'}{\partial t}\tag{32}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The second term looks almost like the Reynolds stresses [katex]\tau_{xx}=\tau_{11} = -\overline{u'u'}[/katex]. All we need to do is time-average the time derivative, and we obtain:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')u'}}{\partial t}=\frac{\partial \overline{\bar{u}u'}}{\partial t} + \frac{\partial \overline{u'u'}}{\partial t}= \frac{\partial \overline{u'u'}}{\partial t}
\tag{33}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The term [katex]\overline{\bar{u}u'}[/katex] is zero, as the time average of the fluctuating velocity component [katex]u'[/katex] is zero. Multiplied by the mean, it is still zero. Thus, by multiplying the [katex]u[/katex], [katex]v[/katex], and [katex]w[/katex] momentum equations with the fluctuating velocity components [katex]u'[/katex], [katex]v'[/katex], and [katex]w'[/katex], and taking the time average of the equations, we can, in theory, construct 9 additional equations. Great, we only need 6, so let's crack on and derive these additional 6 equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What we did above for the time derivative, i.e. in Eq.(33), needs to be done for all terms in the 3D momentum equation. This will take some time and space, but this will be worth it, I promise.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We first multiply the [katex]u[/katex] momentum equation by the [katex]u'[/katex] fluctuating velocity component. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial (\bar{u}+u')u'}{\partial t}+ \frac{\partial (\bar{u}+u')(\bar{u}+u')u'}{\partial x} + \frac{\partial (\bar{u}+u')(\bar{v}+v')u'}{\partial y} + \frac{\partial (\bar{u}+u')(\bar{w}+w')u'}{\partial z}=\\[1em]
-\frac{1}{\rho}\frac{\partial (\bar{p}+p')u'}{\partial x} + \nu\frac{\partial^2 (\bar{u}+u')u'}{\partial x^2} + \nu\frac{\partial^2 (\bar{u}+u')u'}{\partial y^2} + \nu\frac{\partial^2 (\bar{u}+u')u'}{\partial z^2}\tag{34}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Next, we need to take the time averages for each term:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')u'}}{\partial t}+ \frac{\partial \overline{(\bar{u}+u')(\bar{u}+u')u'}}{\partial x} + \frac{\partial \overline{(\bar{u}+u')(\bar{v}+v')u'}}{\partial y} + \frac{\partial \overline{(\bar{u}+u')(\bar{w}+w')u'}}{\partial z}=\\[1em]
-\frac{1}{\rho}\frac{\partial \overline{(\bar{p}+p')u'}}{\partial x} + \nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial x^2} + \nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial y^2} + \nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial z^2}
\tag{35}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's go through it term by term. We already know the time derivative, which is just repeated for completeness. It is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')u'}}{\partial t}=\frac{\partial \overline{\bar{u}u'}}{\partial t} + \frac{\partial \overline{u'u'}}{\partial t}= \frac{\partial \overline{u'u'}}{\partial t}
\tag{36}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Next, we have the three non-linear terms. The first term becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')(\bar{u}+u')u'}}{\partial x}=\underbrace{\frac{\overline{\bar{u}\bar{u}u'}}{\partial x}}_{=0} + \underbrace{\frac{\overline{\bar{u}u'u'}}{\partial x}}_{\ne 0} + \underbrace{\frac{\overline{u'\bar{u}u'}}{\partial x}}_{\ne 0} + \underbrace{\frac{\overline{u'u'u'}}{\partial x}}_{\ne 0}\tag{37}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The first term is zero because taking the time average of a single fluctuating velocity component returns zero; thus, it doesn't matter how many other terms are multiplied by it, the end result will always be zero. However, the second, third, and fourth terms all contain at least [katex]\overline{u'u'}[/katex], i.e. the Reynolds stresses, which we know are not zero, as these are correlated with each other.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The final term contains the Reynolds stresses multiplied by an additional instance of the fluctuating velocity component. Since these are all correlated with each other, this term is non-zero as well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can repeat this now for the other two non-linear terms and get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{(\bar{u}+u')(\bar{v}+v')u'}}{\partial y}=\underbrace{\frac{\overline{\bar{u}\bar{v}u'}}{\partial y}}_{=0} + \underbrace{\frac{\overline{\bar{u}v'u'}}{\partial y}}_{\ne 0} + \underbrace{\frac{\overline{u'\bar{v}u'}}{\partial y}}_{\ne 0} + \underbrace{\frac{\overline{u'v'u'}}{\partial y}}_{\ne 0}\\[1em]
\frac{\partial \overline{(\bar{u}+u')(\bar{w}+w')u'}}{\partial z}=\underbrace{\frac{\overline{\bar{u}\bar{w}u'}}{\partial z}}_{=0} + \underbrace{\frac{\overline{\bar{u}w'u'}}{\partial z}}_{\ne 0} + \underbrace{\frac{\overline{u'\bar{w}u'}}{\partial z}}_{\ne 0} + \underbrace{\frac{\overline{u'w'u'}}{\partial z}}_{\ne 0}\tag{38}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>That covers the left-hand side of the Eq.(35), let's see what happens to the right-hand side. First up, we have the pressure gradient term:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
-\frac{1}{\rho}\frac{\partial \overline{(\bar{p}+p')u'}}{\partial x}=-\underbrace{\frac{1}{\rho}\frac{\partial \overline{\bar{p}u'}}{\partial x}}_{=0}  - \underbrace{\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x}}_{\ne 0} = -\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x}\tag{39}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here we are using the fact again that the time average of the fluctuating velocity component [katex]u'[/katex] is zero, and multiplied by the time-averaged pressure, this term remains zero. Thus, the first term has to be zero.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The second term includes correlations of the pressure and velocity fluctuations. For an incompressible flow, we know that velocity and pressure are directly linked through the Bernoulli equation, for example, so pressure and velocity are correlated. As a result, their time-averaged fluctuating components must be correlated as well, and, therefore, the second term is not zero.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, we have the three diffusive terms. The first term becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial x^2} = \nu\underbrace{\frac{\partial^2 \overline{\bar{u}u'}}{\partial x^2}}_{=0} + \nu\underbrace{\frac{\partial^2 \overline{u'u'}}{\partial x^2}}_{\ne 0} = \nu\frac{\partial^2 \overline{u'u'}}{\partial x^2}\tag{40}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is just the second-order derivative of the Reynolds stress tensor. For the remaining two terms, we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial y^2} = \nu\underbrace{\frac{\partial^2 \overline{\bar{u}u'}}{\partial y^2}}_{=0} + \nu\underbrace{\frac{\partial^2 \overline{u'u'}}{\partial y^2}}_{\ne 0} = \nu\frac{\partial^2 \overline{u'u'}}{\partial y^2}=\\[1em]
\nu\frac{\partial^2 \overline{(\bar{u}+u')u'}}{\partial z^2} = \nu\underbrace{\frac{\partial^2 \overline{\bar{u}u'}}{\partial z^2}}_{=0} + \nu\underbrace{\frac{\partial^2 \overline{u'u'}}{\partial z^2}}_{\ne 0} = \nu\frac{\partial^2 \overline{u'u'}}{\partial z^2}
\tag{41}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can now put insert Eq.(36) to Eq.(41) into Eq.(35). This results in the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{u'u'}}{\partial t} +
\frac{\overline{\bar{u}u'u'}}{\partial x} + \frac{\overline{u'\bar{u}u'}}{\partial x} + \frac{\overline{u'u'u'}}{\partial x} +
\frac{\overline{\bar{u}v'u'}}{\partial y} + \frac{\overline{u'\bar{v}u'}}{\partial y} + \frac{\overline{u'v'u'}}{\partial y} +
\frac{\overline{\bar{u}w'u'}}{\partial z} + \frac{\overline{u'\bar{w}u'}}{\partial z} + \frac{\overline{u'w'u'}}{\partial z} =\\[1em]
-\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial x^2} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial y^2}+
\nu\frac{\partial^2 \overline{u'u'}}{\partial z^2}
\tag{42}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Eq.(42) presents a single transport equation to compute the Reynolds stress tensor component [katex]\tau_{11}=-\overline{u'u'}[/katex], as seen in the time derivative. However, if we inspect the equation, we can see additional unknown terms such as [katex]\overline{u'u'u'}[/katex], [katex]\overline{u'v'u'}[/katex], [katex]\overline{u'w'u'}[/katex], and [katex]\overline{p'u'}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>While we have generated 1 equation to <em>close</em> our Reynolds-averaged Navier-Stokes (RANS) equation, we also have produced more unknowns. How do we find these additional unknown quantities? Simple, just multiply Eq.(42) by an additional [katex]u'[/katex], [katex]v'[/katex], [katex]w'[/katex] and replace [katex]u'[/katex] by [katex]p'[/katex] in Eq.(35).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Perhaps you can see where this is going. If we multiply Eq.(42) by, say [katex]u'[/katex], then the time derivative will contain the quantity [katex]\overline{u'u'u'}[/katex], which is one of the unknowns in Eq.(ref{eq:reynolds-stress-equation-final}). However, the non-linear term will now generate unknowns such as [katex]\overline{u'u'u'u'}[/katex], [katex]\overline{u'v'u'u'}[/katex], and [katex]\overline{u'w'u'u'}[/katex], while the pressure gradient will now contain [katex]\overline{p'u'u'}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>How do we find these new unknowns? Simple, just multiply the equation that we have generated by an additional [katex]u'[/katex], [katex]v'[/katex], [katex]w'[/katex]. You see where this is going? We can always find more equations to solve for the unknowns that we have generated, but these new equations that we generate will contain more new unknowns. We will always end up with more unknowns for each equation that we generate, and this will continue until infinity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is known as the <em>closure problem</em> in RANS, i.e. we can generate new equations, but we will never find enough equations to <em>close</em> the system so that it becomes solvable.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we think about it for a second, this makes sense. We haven't actually used any new relation or equation here, we have simply multiplied the momentum equation (which we already use to solve for our mean flow quantities, i.e. [katex]\bar{u}[/katex], [katex]\bar{v}[/katex], and [katex]\bar{w}[/katex]) by some new fluctuating velocity component [katex]u'[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Take the following example: You are on a new planet and want to measure its gravitational acceleration. You have an object of which you know the mass, so you could use Newton's second law, i.e. [katex]F=ma=mg[/katex]. We only know mass, not the force. So, our equation is not yet <em>closed</em> (we have 2 unknowns, namely [katex]F[/katex] and [katex]g[/katex], and one equation to solve for them). We have to create an additional equation to solve for the unknowns.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We could rearrange the equation so that instead of [katex]F=mg[/katex], we write an equation for the gravitational acceleration directly, and we obtain [katex]g=F/m[/katex]. While we have two equations now, it doesn't help us in <em>closing</em> our system. Inserting [katex]g=F/m[/katex] into [katex]F=mg[/katex] gives us [katex]F=F[/katex], and thus we can see that the second equation is not actually introducing new knowledge.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The same is true for the procedure we have used with the momentum equation. We are simply generating new equations based on the momentum equation, but we are not introducing a fundamentally new or different equation; we just keep modifying it (similar to writing [katex]F=mg[/katex] as [katex]g=F/m[/katex]).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So what do we do? Well, two things, really:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>Introduce an alternative way of closing the RANS equation through an analogy (which we'll do in the next section), and

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Introduce model (or closure) coefficients whenever needed.

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Consider the following analogy: You are making a curry, and the recipe you are following tells you to add one tablespoon of chilli powder to spice it. If you are Paco, my Korean flatmate during my undergraduate studies, you may look at this recipe and say, "What, just one tablespoon? This can't be right, I'd better double or triple the amount".</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But, if you are me, growing up on bread, potato, and pasta, where chili is predominantly used to decorate the table if you throw a lavish buffet party, then you may say "Who thought that adding one tablespoon of chili powder is a good idea? I better remove it if I want to still enjoy my meal". Different taste buds, different chilli requirements.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Now, let's translate that to turbulence modelling. Let's say we want to model the flow past a flat plate and a cylinder. The former will be dominated by a turbulent boundary layer, while the latter will be dominated by a wake. Turbulence behaves differently, and as long as we can solve for all turbulence quantities directly, like in <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-origin-of-turbulence-and-direct-numerical-simulations-dns/" target="_blank" rel="noopener" title="">Direct Numerical Simulations</a>, this does not matter.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, our goal here is to derive a time-averaged system of equations that we can use to express turbulence in terms of mean flow properties. We said that we can't solve Eq.(42) directly, as it contains more unknowns than we have equations. But, we can use that equation as a starting point and <em>model</em> the terms for which we do not have an expression.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is the main idea behind RANS turbulence modelling. We start with an equation that is not closed, and then we model terms we don't know by some assumptions. These assumptions may work well for some flow scenarios, but not so well for other cases, and so closure coefficients allow us to strengthen or weaken our assumptions so that the equations we are deriving work for a broad range of flow applications.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Just like we assumed in our curry recipe that one tablespoon of chilli powder will be suitable for most people following that recipe, some will inevitably find it too weak (and add more), or too strong (and reduce it). Thus, we could also express this <em>highly scientifically</em> as [katex]\text{Spiciness}=C_{spicy}\cdot\text{1 tablespoon}[/katex]. In this analogy, [katex]C_{spicy}[/katex] is our closure coefficient, and we would try to find a value that works best for most people.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, we could prepare 5 curries with different spiciness and then ask 100 randomly selected people which one they find to be the best. We take an average value and then report that in our recipe (in this example, the recipe is using one tablespoon, so [katex]C_{spicy} = 1[/katex]).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's bring that back to turbulence modelling. We can develop a RANS turbulence model and then test it on 100 hundred different test cases (or a selection of test cases with different boundary and initial conditions). We then tune all of our closure coefficients in our model so that, on average, it will match experimental data well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is essentially a curve fitting exercise, and the usual cautions apply here. Take a look at the following figure:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5489,"scale":"cover","sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full"><img src="https://cfd.university/wp-content/uploads/2025/06/overfitting_vs_underfitting.png" alt="This figure shows an illustration over curve fitting, and how different polynomial degrees can lead to overfitting or underfitting of a given collection of point samples. " class="wp-image-5489" style="object-fit:cover"/><figcaption class="wp-element-caption">Reproduced from <a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_underfitting_overfitting.html" target="_blank" rel="noopener" title="">sklear</a>.</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Here, we are trying to approximate some samples with a polynomial of different orders. The figure on the left shows the least agreement. We have essentially just used a lower-order polynomial here, which in this case is just a line with a negative slope. Since the underlying curve is too simple (i.e. we can only specify the steepness of the line) to represent the actual data, we say that we have underfitted the data.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The figure in the middle shows a good agreement between the sample points and the curve we are fitting through. It isn't perfect, but accounting for measurement errors, noise in the test data, and other aspects that could add discrepancies, the fitted curve may actually represent the reality very well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The figure on the right is trying to fit a curve through each sample point. While we achieve that, and thus obtain excellent agreements in the points we have available, we add a lot of oscillatory motion, which isn't physical. This oscillatory behaviour is known as overfitting.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Our goal in selecting the right closure coefficients is to achieve good agreement over a range of different applications, without necessarily achieving a perfect match between numerical results and experimental data. Always remember the quote by George Box "All models are wrong, but some are useful". RANS turbulence models are just that, models, and they try to predict the behaviour of turbulence. Some are really good at predicting wall-bounded flows, others for shear layers, yet others for wakes, or adverse pressure gradient.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The reason we have so many different RANS models available is that different models behave better for certain applications than others. It is our duty as a CFD engineer to select the one which is best suited (either by performing a turbulence model comparison, performing a literature review, or using experience and intuition (though this should be checked with either of the first two methods)).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There are two fundamental problems with closure coefficients, that really make them a pain to live with:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>All turbulence models are validated and tested for simple test cases. Thus, if simulate the flow around a NACA 0012 aerofoil, or a flat plate, or around a cylinder, chances are the model was already tested and tuned for this specific case. So the expectation is that it will work well here. But what about more complex cases? Closure coefficients aren't tuned for more complex cases, and so it is anyone's guess as to how they will perform for your specific case (you will need to perform some validation studies yourself)

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>It is difficult, and sometimes impossible, to attribute a physical meaning to the different closure coefficients. Thus, if you want to tune them, there is no guideline on which closure coefficients to tune, and in which direction.

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>This can be illustrated with another example. Say you want to create your own aerofoil. For a 4-digit NACA aerofoil, we have the following equation, which is just a polynomial of some description:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
y_t= \pm 5t\left(0.2969\sqrt{x} - 0.1260x - 0.3516 x^2 + 0.2843 x^3 - 0.1015 x^4\right)
\tag{43}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>For each position [katex]x[/katex] along the aerofoil, we get the [katex]y[/katex] coordinate for the upper ([katex]+y[/katex]) and lower ([katex]-y[/katex]) curve on the aerofoil. Let's say you want to introduce some curvature. Which of these coefficients would you tune and in which direction? Would you make some larger and others smaller? If so, by how much? It is difficult to attribute physical meaning to the polynomial coefficients, and thus we would struggle to change these coefficients to arrive at the aerofoil shape we have in mind.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And yes, I know, Eq.(43) is only true for symmetrical aerofoils, so if we actually wanted to use this equation to create an aerofoil with a curved camber line, we could not do it. Anyways, my point is that closure coefficients are sometimes difficult to interpret from a physical point of view, and this means that you would typically not start tuning these parameters yourself. Instead, if you find that you are getting really bad results, you would simply choose a new RANS turbulence model and repeat the process until you get satisfactory results.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is the closure problem. But it is by far not the only problem we have. Given that we have just realised that we cannot create a new equation to model the Reynolds stresses in the Reynolds stress tensor, i.e. Eq.(20), directly, we need to come up with a different mechanism to construct a closed form for our equations. This is what we will do in the next section.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Boussinesq's eddy viscosity hypothesis and the turbulent viscosity</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Boussinesq was a special man in a long line of famous French contributors to the field of fluid dynamics. Navier, Cauchy, Lagrange (born Italian, died French), Poisson, Darcy, Saint-Venant, Poiseuille, d'Alembert, the list goes on. He received a lot of praise for his contributions to the field we love so much, but to me, he stood out for something else.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When I studied fluid dynamics for the first time, turbulence in particular, I always thought that all of the research that Boussinesq did on fluid dynamics must have been just a hobby. Clearly, his main contributions must have been the invention of relativity long before Einstein introduced it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you know the works of Boussinesq in and out, you'll probably be wondering what I am on about, he has never published anything on relativity. Well, he didn't need to publish anything, he just demonstrated his ability. Still no idea what I am on about?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, in 1877, <a href="https://gallica.bnf.fr/ark:/12148/bpt6k56673076/f1.item.texteImage" target="_blank" rel="noopener" title="">Boussinesq provided a closure</a> for Reynolds' decomposition of the Navier-Stokes equations, which produced the Reynolds stress tensor, i.e. [katex]\tau=-\overline{\mathbf{u}'\mathbf{u}'}[/katex]. Reynolds' decomposition was published by, well, Reynolds, in 1895, 18 years after Boussinesq. How did Boussinesq manage to pull off this stunt? Well, surely <em>he must have been</em> a time traveller. The first and the last.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>OK, Jokes aside, I should clarify that he did not actually contribute to the field of relativity and that he did not travel in time (sarcasm doesn't transmit well through the Hypertext Transfer Protocol (http)). But, certainly, he was <em>ahead of his time</em>. Clearly, he must have been if he can solve a problem that would only later arise.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Boussinesq was working on various aspects in the field of fluid dynamics, one of which was the study of tumultous fluids (yes, the word turbulence did not exist back then and it would only be later popularised by Prandtl). It was common knowledge that the Navier-Stokes equations could not describe the effect of turbulence in a time-averaged sense, and many scientists (as we used to call them, nowadays everyone is a researcher, it seems) were working on that problem. Boussinesq was just one more scientist working on this problem.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, how did Boussinesq close the Reynolds decomposition that didn't exist back then? Well, it is simple, really; he just had to invent the Reynolds decomposition first and then propose how to compute it. Well, it is not that simple. Yes, Boussinesq came up with his own stress tensor (which looked a lot like the Reynolds stress tensor we know today), but his stress tensor was inconsistent.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In special cases, his stress tensor would be incorrect. While the stress tensor itself was flawed, his approach to modelling it wasn't. And so, when Reynolds introduced his correct form of the stress tensor 18 years later, one could simply take Boussinesq's hypothesis to close the stress tensor, something Reynolds couldn't.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Interestingly, Reynolds didn't mention anything about Boussinesq's work in his 1895 work, nor did Boussinesq mention anything about Reynolds' work in his 1897 book. So the <em>scientific ignorance</em> extends both ways. Anyways, let's look at Boussinesq's contribution. What did he propose in 1877? What was his famous (eddy viscosity) hypothesis?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, we have already looked at it in some detail when we looked at Large Eddy Simulations (LES). In LES, we also obtain a stress tensor, not the Reynolds stress tensor, but rather the subgrid-scale tensor [katex]\tau^{SGS}[/katex]. If you have not read that section, I would recommend taking a slight detour and reading about it <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-the-filtered-navier-stokes-equations" target="_blank" rel="noopener" title="">here</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Are you back? Good, then let's continue.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As discussed in the LES article, Boussinesq said that Reynolds stress tensor can be model by analogy to Newton's law of viscosity. Here, shear stresses are related to flow gradients as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=\mu\frac{\partial U}{\partial y}
\tag{44}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>In Eq.(44), we assume a flow over a flat plate, and so the only velocity gradient we have is [katex]\partial U/\partial y[/katex]. All other gradients are zero. This is shown in the figure below on the left.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5350,"width":"800px","sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2025/04/velocity_gradients_and_the_strain_rate-2.png" alt="This image shows the flow past a flat plate and a cylinder, and the velocity gradients arising in either case." class="wp-image-5350" style="width:800px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>But what happens when the flow gradients aren't zero in the other directions? This is shown in the figure above on the right. Here, the flow around a cylinder is shown, where the curvature of the cylinder's surface is responsible for generating gradients of all velocity components in all directions. Thus, in general, the velocity gradients are not zero.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the article on <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/" target="_blank" rel="noopener" title="">LES</a>, I showed how the velocity gradient tensor can be decomposed into a symmetric (strain-rate) tensor and an anti-symmetric (rotation) tensor. We said that the rotation tensor does not contribute to shear stresses, only the strain-rate tensor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I used the analogy of a sponge filled with water. If we squeeze it, the sponge will deform, and water will be pushed out of the sponge. This causes water to flow within the sponge, and the water will shear against itself and the sponge, causing friction (and thus velocity gradients). This is expressed by Newton's law of viscosity in Eq.(44). In contrast, spinning the sponge will cause the water to remain in place (no shearing, no friction) and it will simply rotate with the sponge.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, it is the strain-rate tensor within the velocity gradient tensor that contains any shearing. Therefore, if we want to generalise Eq.(44), we replace the individual velocity gradient [katex]\partial U/\partial y[/katex] with the strain-rate tensor. The strain rate tensor is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\mathbf{S} = \frac{1}{2} \left[ \nabla \mathbf{U} + (\nabla \mathbf{U})^{T} \right]=
\begin{bmatrix}
\frac{\partial U}{\partial x} & \frac{1}{2} \left( \frac{\partial U}{\partial y} + \frac{\partial V}{\partial x} \right) & \frac{1}{2} \left( \frac{\partial U}{\partial z} + \frac{\partial W}{\partial x} \right) \\[1em]
\frac{1}{2} \left( \frac{\partial V}{\partial x} + \frac{\partial U}{\partial y} \right) & \frac{\partial V}{\partial y} & \frac{1}{2} \left( \frac{\partial V}{\partial z} + \frac{\partial W}{\partial y} \right) \\[1em]
\frac{1}{2} \left( \frac{\partial W}{\partial x} + \frac{\partial U}{\partial z} \right) & \frac{1}{2} \left( \frac{\partial W}{\partial y} + \frac{\partial V}{\partial z} \right) & \frac{\partial W}{\partial z}
\end{bmatrix}
\tag{45}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Using this definition, we can generalise Newton's law of viscosity, which provides us:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=2\mu_t\mathbf{S}
\tag{46}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The factor of 2 is required because of the [katex]1/2[/katex] in Eq.(45). Also, I have replaced [katex]\mu[/katex] by [katex]\mu_t[/katex]. We did that as well when we looked at LES, where we set [katex]\mu=\mu_{SGS}[/katex], i.e. the subgrid-scale viscosity. We said that it is the role of the subgrid-scale model to find a suitable value for [katex]\mu_{SGS}[/katex], and the same is the case for RANS. It is the role of the RANS turbulence model to find a suitable turbulent viscosity [katex]\mu_t[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, this isn't everything, and we need to look at the individual components of a tensor. In its general form, the stress tensor can be written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=-\begin{bmatrix}
\tau_{xx} & \tau_{xy} & \tau_{xz}\\[1em]
\tau_{yx} & \tau_{yy} & \tau_{yz} \\[1em]
\tau_{zx} & \tau_{zy} & \tau_{zz}
\end{bmatrix}\tag{47}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>In 3D, we can visualise these stresses as:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5345,"width":"500px","sizeSlug":"full","align":"center"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2025/04/tensor-components.png" alt="This figure shows a cube with the tensor components shown on each side, i.e. the direction in which they are acting. " class="wp-image-5345" style="width:500px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We can see that the diagonal tensor components [katex]\tau_{xx}[/katex], [katex]\tau_{yy}[/katex], and [katex]\tau_{zz}[/katex] all act in the normal direction on the cube shown above. All the other off-diagonal parts act in-plane, that is, [katex]\tau_{xy}[/katex], [katex]\tau_{xz}[/katex], [katex]\tau_{yx}[/katex], [katex]\tau_{yz}[/katex], [katex]\tau_{zx}[/katex], and [katex]\tau_{zy}[/katex]. So the diagonal and off-diagonal parts represent different actions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When we dealt with LES we decomposed the stress tensor into an isotropic (diagonal) and deviatoric (off-diagonal) part, and we write the stress tensor as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=\underbrace{\frac{1}{3}\tau\mathbf{I}}_\text{isotropic} + \underbrace{\left[\tau-\frac{1}{3}\text{tr}\left(\tau\right)\mathbf{I}\right]}_\text{deviatoric}
\tag{48}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The trace [katex]\text{tr}()[/katex] is just the sum of the main diagonal components of a tensor, i.e. in this case we have [katex]\text{tr}(\tau)=\tau_{xx}+\tau_{yy}+\tau_{zz}[/katex]. If we assume that [katex]\tau_{xx}=\tau_{yy}=\tau_{zz}[/katex], then we can write this equation as well as [katex]\text{tr}(\tau)=3\tau_{xx}[/katex], [katex]\text{tr}(\tau)=3\tau_{yy}[/katex], or [katex]\text{tr}(\tau)=3\tau_{zz}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Placing the 3 on the other side of the equation provides [katex](1/3)\cdot\text{tr}(\tau)=\tau_{ii}[/katex], where [katex]ii[/katex] can now be [katex]xx[/katex], [katex]yy[/katex], or [katex]zz[/katex]. This is where the factor [katex]1/3[/katex] comes from in the equation above. Why can we do that? Why do we assume that [katex]\tau_{xx}=\tau_{yy}=\tau_{zz}[/katex]?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, for the same reason, we say the pressure is the same in each direction. We don't decompose the pressure into its [katex]p_x[/katex], [katex]p_y[/katex], and [katex]p_z[/katex] components (on the molecular level we may want to do so), but instead, we say the pressure acts with the same magnitude in all directions. The pressure has the same units as the shear stresses, and so we say the isotropic part of the stress tensor acts like a pressure.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We want to remove the isotropic part from the Reynolds stress tensor so that we only retain the deviatoric part, which is responsible for in-plane stresses. These in-plane stresses are, according to Boussinesq, proportional to the Reynolds stresses.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What this means for us is that we have to decompose the Reynolds stress tensor using the decomposition shown in Eq.(48). Specifically, we need to use the definition for the deviatoric part of the tensor. That is, the Reynolds stress tensor [katex]\tau^{RANS}=-\rho\overline{\mathbf{u}'\mathbf{u}'}[/katex] we have defined in Eq.(20) now becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=\left[\tau-\frac{1}{3}\text{tr}\left(\tau\right)\mathbf{I}\right]=-\rho\overline{\mathbf{u}'\mathbf{u}'}+\frac{1}{3}\text{tr}\left(\rho\overline{\mathbf{u}'\mathbf{u}'}\right)\mathbf{I}
\tag{49}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>For the first term, i.e. [katex]\tau^{RANS}=-\rho\overline{\mathbf{u}'\mathbf{u}'}[/katex], we insert Newton's law of viscosity as modified for turbulent flows in Eq.(46). For the second term, let us write out the trace explicitly. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{1}{3}\text{tr}\left(\rho\overline{\mathbf{u}'\mathbf{u}'}\right)\mathbf{I} = \frac{1}{3}\left(u'u' + v'v' + w'w'\right)\mathbf{I}
\tag{50}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can rewrite the right-hand side by using the definition of the kinetic energy. We don't have to, but that is commonly done for reasons we will see in a bit. The general equation for the kinetic energy is [katex]k=(1/2)\rho U^2[/katex]. The units are [katex][kg/(m\,s^2)][/katex]. We can also divide this expression by the density, which results in [katex]k/\rho=(1/2)U^2[/katex]. The units are now [katex][m^2/s^2][/katex]. Since the units of kilograms have disappeared, we say that this definition of the kinetic energy is per unit mass.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus far, we have used the velocity [katex]U[/katex] for the calculation of the kinetic energy, but we can equally define the turbulent kinetic energy using the fluctuating velocity component, e.g. [katex]u'^2[/katex], or [katex]u'u'[/katex]. For a three-dimensional flow, with velocity components in the [katex]x[/katex], [katex]y[/katex], and [katex]z[/katex] direction, we have the definition for the turbulent kinetic energy (the literature is inconsistent here and also calls this quantity the turbulence kinetic energy sometimes):</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
k_t=\frac{1}{2}\left(u'u' + v'v' + w'w'\right)\\[1em]
2k_t = u'u' + v'v' + w'w'
\tag{69}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, I have used the subscript [katex]k_t[/katex] to indicate that we are dealing with the turbulent (turbulence) kinetic energy. This subscript is usually dropped, though, which makes the equations sometimes difficult to decipher without context. let's keep it for the moment, but once we deal with the RANS equations themselves, I'll use [katex]k[/katex] for the turbulent kinetic energy again so that my notation will be consistent with other literature you may consult.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Inserting Eq.(\ref{eq:turbulent_kinetic_energy}) into Eq.(\ref{eq:boussinesq_second_term}) results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{1}{3}\text{tr}\left(\rho\overline{\mathbf{u}'\mathbf{u}'}\right)\mathbf{I} = \frac{2}{3}k_t\mathbf{I}
\tag{52}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>On the right-hand side, we have the identity matrix [katex]\mathbf{I}[/katex], which indicates that the quantity [katex](2/3)k_t[/katex] will only influence the main diagonal. This is what we want, i.e. we wanted to remove the pressure-like forces from the Reynolds stress tensor as they do not contribute to turbulence. We can now insert Eq.(\ref{eq:boussinesq_second_term_with_turbulent_kinetic_energy}) into Eq.(\ref{eq:boussinesq_eddy_viscosity_hypothesis}), which results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-\rho\overline{\mathbf{u}'\mathbf{u}'}+\frac{2}{3}k_t\mathbf{I}\tag{53}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We said that we can model the Reynolds stresses themselves in analogy to Newton's law of viscosity, meaning that we have [katex]-\rho\overline{\mathbf{u}'\mathbf{u}'}=-2\mu_t\mathbf{S}[/katex]. Inserting this results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-2\mu_t\mathbf{S}+\frac{2}{3}k_t\mathbf{I}\tag{54}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's do one final modification. Instead of using the identity matrix [katex]\mathbf{I}[/katex], let us use the Kronecker delta [katex]\delta_{ij}[/katex] instead. It is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\delta_{ij}=
\begin{cases}
1\quad\quad i=j\\
0\quad\quad i\ne j
\end{cases}\tag{55}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>In other words, if [katex]i=j[/katex], we are on the main diagonal of our tensor. Thus, we multiply any quantity by 1 if we are on the main diagonal, and by zero otherwise. This is the same as using the identity matrix, which is defined as having ones on its main diagonal and zeros everywhere else. The Kronecker delta and the identity matrix represent one and the same concept, but are used in different equation notations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The Kronecker delta is preferred in index notation, i.e. those equations that use indices such as [katex]\partial u_i/\partial x_j[/katex], while the identity matrix is used together with vector quantities (typically indicated by bold letters), e.g. [katex]\partial \mathbf{u}/\partial \mathbf{x}[/katex]. I prefer vector notation, but the turbulence literature is full of equations in index notation, and generally, the preferred way of expressing equations here. Thus, using the Kronecker delta, we arrive at the final form of the Boussinesq eddy viscosity hypothesis as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-2\mu_t\mathbf{S}+\frac{2}{3}k_t\delta_{ij}
\tag{56}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let take a step back and appreciate what we have achieved at this point. We have derived the time-averaged Navier-Stokes equations, which we also call the Reynolds-averaged Navier-Stokes, or RANS, equations. These provide an exact description of how turbulence behaves in a time-averaged sense. However, averaging the Navier-Stokes equation in time produced a term that we have labelled as the Reynolds stresses, which are given by [katex]\tau^{RANS}=-\rho\overline{\mathbf{u}'\mathbf{u}'}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It turns out that we can't compute this term. If we tried to come up with an additional equation to solve for these Reynolds stresses, then we would just keep generating more and more unknowns, which we have labelled as the closure problem, i.e. we will never be able to close our system of equations (balancing the number of equations and unknowns).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, instead, we said we are going to <em>model</em> this term, and conveniently, Boussinesq did us a huge favour by telling us exactly how to do so some 150 years ago, before anyone could even dream of CFD, let alone a computer as we know them today.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, even though we have removed the problematic Reynolds stresses [katex]-\rho\overline{\mathbf{u}'\mathbf{u}'}[/katex] using Boussinesq's eddy viscosity hypothesis, we have gained an additional unknown [katex]\mu_t[/katex], which we said is the turbulent viscosity. It has nothing to do with the real (or physical) viscosity, but instead is a pure fictitious viscosity we use to scale the strain-rate tensor to get the correct turbulence behaviour.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This means we have to find a way to compute the turbulent viscosity [katex]\mu_t[/katex]. This is the role of any RANS model, i.e. we compute quantities for which we can find suitable equations and boundary conditions, and then we try to relate them to the turbulent viscosity. If we can do that, then we can close our system of equations and have a mechanism to compute turbulence.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It turns out that this approach works really well, and we are getting good agreement for engineering applications with RANS models. So, let us review the most common RANS models next and how they compute this new turbulent viscosity [katex]\mu_t[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Computing the turbulent viscosity</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Finding a value for [katex]\mu_t[/katex] is really all that RANS modelling is about, and there are a lot of different approaches. The <em>standard way</em>, if there is such a thing, is to solve one or more transport equations for turbulent quantities that we know and can compute.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When we talked about LES, I introduced you to a transport equation-based subgrid-scale model, which solved one transport equation for the unresolved subgrid-scale turbulent kinetic energy [katex]k_{SGS}[/katex]. I then went on to explain why transport equations are so powerful and what their general form is. Let us review here some key points, but again, to get the full picture, I'd encourage you to read at least the section on the <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-a-transport-equation-based-approach-the-one-equation-subgrid-scale-model" target="_blank" rel="noopener" title="">transport equation-based subgrid-scale model</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The general form of a transport equation is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial \phi}{\partial t}}_\text{Term 1}+\underbrace{\mathbf{u}\frac{\partial \phi}{\partial\mathbf{x}}}_\text{Term 2}=\underbrace{\frac{\partial}{\partial \mathbf{x}}\left(\Gamma\frac{\partial \phi}{\partial \mathbf{x}}\right)}_\text{Term 3}+\underbrace{S}_\text{Term 4}
\tag{57}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\phi[/katex] can be anything we want, really. I introduced this transport equation in the context of how gossip [katex]\phi=G[/katex] may spread in a high-school corridor. The first term is the time derivative. If you placed yourself anywhere in the corridor at some location [katex]\mathbf{x}[/katex], you could measure how often you hear people speaking about the gossip [katex]G[/katex]. Then, for each minute, you calculate the difference. You may only hear it 2 times in one minute but then 8 times in the next minute. The time derivative would thus become:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial G}{\partial t}\approx\frac{G^1-G^0}{\Delta t}=\frac{8-2}{60s}=\frac{6}{60s}=0.1\left[\frac{1}{s}\right]\tag{58}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can compute this time derivative at any location [katex]\mathbf{x}[/katex] and point in time [katex]t[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The second term represents how the gossip [katex]G[/katex] is advected, or transported from one point to another. You may tell your friend by the water fountain about the gossip, and they will then carry it over to the cafeteria, where they will then tell it to the next person. They have just transported, or advected, the gossip from the water fountain to the cafeteria. They were walking with a certain speed [katex]\mathbf{u}[/katex] and for a certain distance [katex]\mathbf{x}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The third term represents diffusion. Diffusion is the act of a quantity, here the gossip [katex]G[/katex], randomly spreading in each direction. For example, you may talk to your friend while <em>advecting</em> (or walking) through the corridor about this new gossip. But, at the same time, Andrew from grade 10 is passing you and walking in a different direction. Andrew overhears your discussion and now carries the gossip with him as well, in a new, random direction.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, we have the fourth and final term, the source term. This term typically accounts for any sinks and sources, but can include additional terms. A source is generating [katex]\phi[/katex]. If we translate that to our gossip [katex]G[/katex], this means that Julia, who has a bit of a wild fantasy and a loose mouth, is constantly making up new gossip and spreading it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A sink, then, is a place where gossip comes to die. This may be a teacher telling you to stop talking about any gossip, or you may model gossip as having a half-life, where, after a certain amount of time, people stop talking about it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Translating this to fluid dynamics, the transport equation can represent a lot of different aspects. In fact, you can represent the entire Navier-Stokes equations using the transport equation given in Eq.(57). Setting [katex]\phi=\rho[/katex], [katex]\Gamma=0[/katex], and [katex]S=0[/katex], we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \rho}{\partial t}+\mathbf{u}\frac{\partial \rho}{\partial\mathbf{x}}=\frac{\partial}{\partial \mathbf{x}}\left(0\cdot\frac{\partial \rho}{\partial \mathbf{x}}\right)+0\\[1em]
\frac{\partial \rho}{\partial t}+\mathbf{u}\frac{\partial \rho}{\partial\mathbf{x}}=0\tag{59}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is just the continuity equation. Setting [katex]\phi=\mathbf{u}[/katex], [katex]\Gamma=\mu[/katex], and [katex]S=-(1/\rho)\partial p/\partial\mathbf{x}[/katex], we obtain:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\frac{\partial \mathbf{u}}{\partial\mathbf{x}}=\frac{\partial}{\partial \mathbf{x}}\left(\mu\frac{\partial \mathbf{u}}{\partial \mathbf{x}}\right) - \frac{1}{\rho}\frac{\partial p}{\partial \mathbf{x}}\\[1em]
\frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\frac{\partial \mathbf{u}}{\partial\mathbf{x}} = -\frac{1}{\rho}\frac{\partial p}{\partial \mathbf{x}} + \mu\frac{\partial^2 \mathbf{u}}{\partial \mathbf{x}}\tag{60}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Looks familiar? Yes, this is just the momentum equation of the Navier-Stokes equations. Setting [katex]\phi[/katex] equal to some form of energy (e.g. total, kinetic, or internal energy), we can derive a form for the energy equation as well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So the transport equation approach is not just a concept that I picked out of thin air; it happens to model how a specific quantity [katex]\phi[/katex] evolves in space and time. And that holds for any quantity [katex]\phi[/katex], as long as we know what [katex]\phi[/katex], [katex]\Gamma[/katex], and [katex]S[/katex] are.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, the idea in RANS modelling is to compute [katex]\mu_t[/katex] from some other turbulent quantities, which in turn are computed from a transport equation. For example, we will look later at the [katex]k-\omega[/katex] model, for example, which indicates that we are solving for the turbulent (turbulence) kinetic energy [katex]k[/katex] and the specific dissipation rate [katex]\omega[/katex]. We will have values for [katex]k[/katex] and [katex]\omega[/katex] everywhere in the flow field, and so can compute at each location [katex]\mathbf{x}[/katex] a value for [katex]\mu_t[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You may ask yourself, then, how do we compute [katex]\mu_t[/katex]? You are asking the right questions! Well, I have mentioned it before, and I say it again: Turbulence research and modelling is full of argumentations based on dimensionality analysis. Since [katex]k[/katex] has units of [katex]m^2/s^2[/katex], [katex]\omega[/katex] has units of [katex]1/s[/katex], and [katex]\mu_t/\rho=\nu_t[/katex] has units of [katex]m^2/s[/katex], you don't need to have a PhD to realise (from dimensional grounds) that [katex]\nu_t=k/\omega[/katex]. Dimensionally, this statement is correct.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But that is one big problem in turbulence modelling. Yes, the dimensions are correct, so the expression is <em>mathematically</em> correct, but that doesn't mean that it is <em>physically</em>. Let's say we multiply a force [katex]F[/katex] with units of [katex]N/m^2[/katex] by the number of bread produced, per year, in Germany. This is then expressed as [katex]F\cdot N_{bread}[/katex] and it has units of [katex]NB/m^2[/katex], where [katex]NB[/katex], of course, is the famous Newton-bread unit (and flavour!).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If I divide this expression now by the number of bread consumed in Germany (which we probably can assume to be equal to the number of bread produced), then we have [katex]F\cdot N_{bread}/C_{bread}[/katex] with units of, drum roll please: [katex]N/m^2[/katex]. Mathematically, this checks out, the units are correct, and dimensionality analysis provides us with a false sense of security that this equation is meaningful. But what does a force multiplied by the bread production-consumption equilibrium represent in reality (in a <em>physical</em> sense)?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It is complete nonesense, of course, and while you may find this example a bit farfetched, turbulence modelling is full of examples where an approach may seem to make sense, but if you peek behind the curtains and try to understand the model in a bit more detail, you realise that it is full of flaws and shortcomings. We don't even need to investigate the equations in much detail, we can simply apply a given RANS model for different types of flow, and we will realise that some RANS model fail spectacularly while other perform well for the same case.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is because each turbulence model is making some assumption. It has to, otherwise we would not be able to overcome the closure problem. The closure problem is really forcing us to get <em>creative</em> with the equations, otherwise we wouldn't be able to solve them. Turbulence modelling really took off in the 1970s with the introduction of the [katex]k-\epsilon[/katex] and [katex]k-\omega[/katex] model, around the same <a href="https://en.wikipedia.org/wiki/Woodstock" target="_blank" rel="noopener" title="">Woodstock</a> took place, and the <a href="https://en.wikipedia.org/wiki/Hippie" target="_blank" rel="noopener" title="">hippie movement</a> was in full swing. Is that a coincidence?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We probably need a Woodstock 2 to find an analytic solution for the Navier-Stokes equations, then. If we are serious about that, I'll happily offer my garden for the venue. It has a shed and a Hollywood swing (apparently a word used by only Germans?!). Let's see if we can cram 460,000 CFD enthusiasts into it. Please bring your own drinks ...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, at this point, we have established that we want to model turbulence by using transport equations that describe how turbulent quantities evolve in space and time. As a result, we have come up with a RANS model taxonomy that you will commonly find in the literature. So let's review that as well. In this taxonomy, we specify how many additional transport equations we are solving to find [katex]\mu_t[/katex]. For example, if we have a 2-equation approach, then we are solving for 2 additional turbulent quantities, for example [katex]k[/katex] and [katex]\epsilon[/katex], or [katex]k[/katex] and [katex]\omega[/katex], as we have already seen.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can also have 0-equation models, which may sound odd, but this simply means we solve no additional transport equations and find an expression for [katex]\mu_t[/katex] through some algebraic equations. The following shows typical models you would find in this taxonomy:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li><strong>0-equation models</strong>: Prandtl's mixing length model, Cebeci-Smith, Baldwin-Lomax, Johnson-King

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li><strong>1-equation models</strong>: Spalart-Allmaras, Baldwin-Barth

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li><strong>2-equation models</strong>: [katex]k-\epsilon[/katex], [katex]k-\omega[/katex], [katex]k-\omega[/katex] SST, [katex]v^2-f[/katex]

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li><strong>3-equation models</strong>: [katex]k-k_l-\omega[/katex] (transition model)

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li><strong>4-equation models</strong>: [katex]Re_\theta-\gamma, k-\omega[/katex] SST (transition model), also sometimes referred to as the [katex]k-\omega[/katex] SST-LM, where LM stands for Langtry and Menter, who introduced the model.

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li><strong>7 equation models</strong>: Launder-Reece-Rodi Reynolds Stress Model (LRR RSM), Speziale-Sarkar-Gatsky Reynolds Stress Model (SSG RSM)

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>As you go from 0-equation to 7-equation models, the modelling complexity and computational time to solve these equations increases. But, at the same time, one hopes that these additional modelling complexities will be rewarded by resolving some additional turbulence phenomena.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, one of the cornerstone assumptions in RANS turbulence modelling is that Eq.(10) is valid everywhere in the flow. But what happens in regions where there is no turbulence, i.e. in laminar flow regions? Well, RANS turbulence models simply can't distinguish between laminar and turbulent flows, and more crucially, model the transition between the two regimes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, looking at 3 and 4 equation models, these were specifically formulated to model the transition process from laminar to turbulent. For example, in the [katex]k-k_l-\omega[/katex] model, we have a turbulent kinetic energy [katex]k[/katex] and a laminar kinetic energy [katex]k_l[/katex], where [katex]k_l[/katex] is associated with the kinetic energy of the flow that is laminar and [katex]k[/katex] is associated with the flow that is turbulent. The model then introduces additional source terms [katex]S[/katex] in both the [katex]k[/katex] and [katex]k_t[/katex] equations that allows [katex]k_l[/katex] to be transferred into [katex]k[/katex], and vice versa.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this way, we have a way to resolve the kinetic energy for both laminar and turbulent flow regions, and by concentrating on modelling the transfer between the two, we have a way to capture the transition.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Going even further, to the Reynolds Stress Models (RSM), these try to solve Eq.(42) for each Reynolds stress, i.e. [katex]\overline{u'u'}[/katex], [katex]\overline{u'v'}[/katex], [katex]\overline{u'w'}[/katex], [katex]\overline{v'v'}[/katex], [katex]\overline{v'w'}[/katex], and [katex]\overline{w'w'}[/katex]. Eq.(42) is first simplified before this can be done, but by doing so, we can represent anisotropic effects, which the other turbulence models can't predict.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is because the other RANS turbulence models rely on Boussinesq's eddy viscosity assumption, i.e. Eq.(56), where the effect of turbulence is presented by a single quantity [katex]\mu_t[/katex]. In the Reynolds Stress Model, however, we do not need the Boussinesq eddy viscosity assumption, as we are modelling the Reynolds stresses directly (which Boussinesq approximates in Eq.(56)).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, as we increase the number of additional transport equations, we resolve additional physical processes. However, we also increase the number of closure coefficients at the same time. So while we may be able to resolve more physical aspects with our equations, we may limit ourselves to just a few specific applications where these models have been tested and validated.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, as a general rule of thumb, the lower we are in the RANS taxonomy (the fewer equations we solve), the more robust the modelling approach may be, at the cost of not resolving additional physical phenomena. As we go up in the taxonomy, we resolve additional physical processes, but the models may only be valid for a narrower window of applications.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Take this as a rough guide, there are so many turbulence models out there that this may not always be the case. In general, 2-equation models are the de facto standard in RANS turbulence modelling, and you will most likely use these extensively in your CFD career.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Now that we have an understanding of transport equations, let us look at some popular models in more detail. We start with Prandtl's mixing length model, which is, as we saw above, a 0-equation model. It serves as a good introduction to turbulence modelling, and then, we will go up the taxonomy and look at some additional modelling approaches, using transport equations.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Prandtl's mixing length model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>At this point, I am going to sound like a broken record, but we already looked at the mixing length model when we talked about <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-comparing-the-smagorinsky-model-with-prandtls-mixing-length-model" target="_blank" rel="noopener" title="">LES and the Smagorinsky model</a>. Thus, I'll keep this section brief, feel free to look at the linked part of the LES article. Well, at this point, if you haven't devoured the entire LES article already, now may be the right time.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In any case, what Prandtl did was to introduce a characteristic length scale that he called the mixing length. Or, if you want to earn bragging rights at the next CFD conference, you should call it by its German name, the "Mischungsweg". And, while we are on that topic, let me throw in, for free, my favourite German word and German phrase. These are good conversation starters in any context.</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>Favourite word: Donaudampfschiffahrtselektrizittenhauptbetriebswerkbauunterbeamtengesellschaft

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:audio {"id":5495} -->
<figure class="wp-block-audio"><audio controls src="https://cfd.university/wp-content/uploads/2025/05/donau.m4a"></audio></figure>
<!-- /wp:audio -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>Fouvrite phrase: Tschechisches Streichholzschchtelchen und chinesisches Schsselchen

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:audio {"id":5496} -->
<figure class="wp-block-audio"><audio controls src="https://cfd.university/wp-content/uploads/2025/05/german_phrase.m4a"></audio></figure>
<!-- /wp:audio -->

<!-- wp:paragraph -->
<p>Yes, the first word is a word that exists in the German language and holds the record for being the longest German word. Even the AI bot I used to pronounce it has difficulties pronouncing it correctly. You are allowed to concatenate nouns to your heart's content. We already saw that. <em>Mischungsweg</em> is a combination of <em>Mischung</em> (mixing) and <em>Weg</em> (way, or length in this case). The second phrase just contains an awful lot of <em>ch</em> and <em>sch</em> sounds, which is the sound <em>everyone loves about the German language</em>. Where was I?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl, yes, I remember now. Unlike Reynolds, Prandtl did his homework and studied up on Boussinesq's work (to be fair, he had a few more decades compared to Reynolds, so let's not be overly critical here). The start of his famous <em>Mischungslength</em> model is:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{u_i'u_j'} = \nu_t\frac{\partial U}{\partial y}\tag{61}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, Prandtl is simply equating the Reynolds stresses to the mean flow gradient, multiplied by the turbulent viscosity for correct units. This is coming from Boussinesq. Now Prandtl is saying that the turbulent viscosity can be constructed from a velocity and length scale as [katex]\nu_t=U\cot l[/katex]. Of course, the length scale is Prandtl's mixing length (fine, I'll use English from now on ... <em>boring</em>). Why wouldn't he use it? But what is the mixing length in a physical sense?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let us consider a single particle. let's assume we are in a near vacuum condition, i.e. in space. Then, a particle may travel for several metres, or even longer, before it hits another particle. When the particle is hitting another particle, it will lose its original momentum, direction of travel, and potentially other properties. Thus, we can say that before the collision, the particle had properties which are changing after a collision with another particle takes place.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On Earth, we have a higher density, and so the average distance travelled before colliding reduces considerably. At mean sea level conditions, this distance is about [katex]10^{-9}m[/katex] (nanometres) and known as the <a href="https://en.wikipedia.org/wiki/Mean_free_path" target="_blank" rel="noopener" title="">mean free path</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The mixing length, then, is analogous to the mean free path. Consider a fluid particle travelling in the flow. Consider a turbulent flow in a water channel where we release some coloured dye into the flow. Well, let's look at this homemade experiment, which will illustrate this much better than my words can:</p>
<!-- /wp:paragraph -->

<!-- wp:embed {"url":"https://www.youtube.com/watch?v=MOhq3o0UGAQ","type":"video","providerNameSlug":"youtube","responsive":true,"className":"wp-embed-aspect-4-3 wp-has-aspect-ratio"} -->
<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-4-3 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
https://www.youtube.com/watch?v=MOhq3o0UGAQ
</div></figure>
<!-- /wp:embed -->

<!-- wp:paragraph -->
<p>Ah, sometimes I can put my internal disgust (we all collectively feel, right?) against experimental fluid dynamitists aside and just admire the internal beauty of fluids in action. But I didn't show this experiment here to cut our experimental <em>friends</em> some slack, no, we want to study the dye, specifically, when it is released from its source, which in this case is the tip of the needle.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Look at the flow pattern carefully. At first, the dye is flowing along with its original momentum, direction of travel, concentration, and other properties not easily visible (for example, density and temperature). In analogy to the mean free path, we say that the mixing length is defined as the distance it takes for a fluid particle (here the dye) to travel before it mixes with the surrounding fluid so that its <em>identity</em> (momentum, direction of travel, concentration, density, temperature, etc.) is lost.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is far more difficult to quantify compared to trying the distance a particle travels, on average, before hitting another particle (OK, sure, measuring the collision of particles is challenging as well due to their size). However, we can all agree on what a collision is, but can we agree on a unified definition of when a fluid particle looses its identity due to mixing? This is far more difficult, and one of the main drawbacks of Prandtl's mixing length model, since we have to provide the mixing length as an input parameter.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But I am getting ahead of myself, let us go through the model. So we have established that the turbulent viscosity will be modelled based on a length scale (the mixing length) and a velocity scale, so that we can write the turbulent viscosity as: [katex]\nu_t=U\cot l[/katex]. What is the velocity scale? Well, in turbulence, whenever we want to find a characteristic velocity (other than the freestream velocity) that relates turbulent quantities to the mean flow, we think of velocity gradients.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This means that we typically have a functional relationship of the form</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
U_{characteristic}=f(\nabla\mathbf{U})\tag{62}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now the velocity gradient, for example, [katex]\partial U/\partial y[/katex], which we would have in a turbulent boundary layer at the wall, where the wall normal direction is in the [katex]y[/katex] direction as per the usual convention, does not have the right units. The velocity gradient tensor, or individual velocity gradients, have units of [katex][1/s][/katex], i.e. a frequency, and in order to make this correct on dimensional grounds, we have to multiply this by some variable with units of metres, i.e. a length.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is 90% of what we do in turbulence, i.e. we establish relations purely on dimensional grounds and, combined with 7% of physical reasoning, 2% of black magic, and 1% of luck (hope?!), we establish equations that may or may not work. But in 100% of the cases, we present our results and equations with great confidence and tell everyone who gets bad results with our equations that they are using them wrong (I have received a few emails from Spalart, let's just say he has strong opinions and a lot of free time ...)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Which variable should we use? Well, if you are Prandtl, the "inventor" of the mixing length, which has units of metres, why would you not use, <em>drum roll for the suspense</em>, the mixing length? Yes, exactly, that is what you would use, and that is certainly what Prandtl did. So, on dimension grounds, we can establish:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
U_{characteristic}=l_{mixing}\frac{\partial U}{\partial y}\tag{63}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>From now on, I will simply use [katex]U_{characteristic}=U[/katex] and [katex]l_{mixing}=l[/katex]. So if we insert the velocity now into our turbulent viscosity definition of [katex]\nu_t=U\cdot l[/katex], then we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=U\cdot l=l\bigg|\frac{\partial U}{\partial y}\bigg|\cdot l=l^2\bigg|\frac{\partial U}{\partial y}\bigg|\tag{64}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Great, so now we can insert this relation into our Boussinesq hypothesis for the Reynolds stresses and arrive at:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{u_i'u_j'} = \nu_t\frac{\partial U}{\partial y}=l^2\bigg|\frac{\partial U}{\partial y}\bigg|\frac{\partial U}{\partial y}\tag{65}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, we are using the convention of using the magnitude of one of the velocity gradients, so that a negative velocity gradient will not become positive again, i.e. we want to retain the direction of the gradient. Otherwise, our Reynolds stresses would always be positive, and we could not get negative stresses, but the velocity can have negative values if it flows against the direction of the coordinate direction we chose, and so we need to account for that in our mixing length model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, as we have discussed at length in my article on LES, we can generally use Prandtl's mixing length model. Instead of using only [katex]\partial U/\partial y[/katex], which is only applicable for wall-bounded flows without any other gradients (which is fairly restrictive), we replace the velocity gradient by the strain rate tensor. This allows us to use the mixing length model for arbitrary flows. The turbulent viscosity becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=l^2\sqrt{2S_{ij}S_{ij}}\tag{66}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Using this definition, we can also generalise the Boussinesq hypothesis and close it with our generalised mixing length formula as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{u_i'u_j'} = \nu_t U\cdot l = l^2\sqrt{2S_{ij}S_{ij}}S_{ij}\tag{67}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, then, what is the mixing length [katex]l[/katex], which is an input to this model? Well, we have looked at a list already in the LES article, which I copy here again for convenience.</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>Mixing layer: [katex]l=0.07L[/katex], with [katex]L[/katex] being the layer width

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Jet: [katex]l=0.09L[/katex], with [katex]L[/katex] being the half width of the jet

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Wake: [katex]l=0.16L[/katex], with [katex]L[/katex] being the half width of the wake

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Outer boundary layer: [katex]l=0.09L[/katex], with [katex]L[/katex] being the boundary layer height.

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>This list is not exhaustive, but it helps to prove my point: Depending on the flow, the mixing length changes. This means we get, potentially, very good agreement with canonical flows (flat plate flows with a boundary layer or a free shear layer away from sold walls), but if you try to simulate the exhaust of a gas turbine, where you have temperature gradients inducing shear layers, a jet that mixes with the boundary layer of the nacelle, and other physical phenomena, then your mixing length model is as good as my neighbour is at playing his guitar.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Suffice to say, he isn't very good at it, much to my annoyance ...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, the mixing length model is a good idea, in theory, and due to its simplicity is dead simple to implement. If you are starting out with turbulence modelling and you want to implement your own turbulence modelling into your code, then you probably want to start with this model. It is so simple, it should be easy to debug, and for a flat plate flow, which is easy to set up, you should be getting excellent results for the wall shear stresses.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You can use this model to then test other turbulence models and validate their implementation, slowly building up the complexity of your turbulence modelling capabilities of your solver. I have spent a lot of time on the mixing length model, both in this article and my LES article, so let's move away from Prandtl. Where do we go next? Oh no, not Prandtl again ...</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Prandtl's 1-equation model for the turbulent kinetic energy</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Prandtl is getting a lot of criticism in the literature. People describe him as mathematically incompetent (perhaps a bit of a stretch), flawed in his assumptions, and, well, other ways of saying that he was basically not fit to do his work, and that it was his students (von Karman, Balsius, Nikuradse, Schlichting, Tollmien, the list goes on) that were doing the work for him.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Certainly, all of his students went on to have their own, prolific careers, but to state that Prandtl was incompetent at fluid mechanics is a bit much, in my view. I have gone through a few of his papers in preparation for this article, and I find the complete opposite to be the case. Prandtl presents logical reasoning for all of his assumptions, which may be crude in some cases (but Prandtl always seems aware and states limitations of these assumptions), and he is able to present, with clarity, his results.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl did not have the luxury of having supercomputers available like we have today, so he was never able to test his hypothesis, other than for very simple flows, for which analytic expressions could be derived. I am sure that with some computational power and the ability to fine-tune his work, Prandtl would have had a chance to improve upon his models and theories substantially.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What Prandtl did is akin to how Beethoven, Mozart, and the like composed music. These days, you have your music software and you play around until you find something that sounds nice. But how did Beethoven and Mozart write entire orchestral music pieces? They didn't have any music software available, nor did they have 100 musician sitting in their living room to test out some tunes. They had to write down the music on paper and imagine how it would sound. They would only get to hear the music once it was finished and given to an orchestra.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl had to work in a similar fashion. He had to write down equations, using physical reasoning (flawed or not), and then come up with an untested hypothesis, which we, decades later, can examine with our computational power. In this context, one has to stop and admire, not just the work of Prandtl, but each individual working in the field of fluid dynamics and turbulence, for being able to <em>see</em> the flow in front of their eyes and come up with equations that would satisfactorily describe the flow.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Furthermore, Prandtl published his work at the beginning of 1945, not a year known for its peaceful time for scientists to concentrate on research in Germany, you know, with the second small disagreement in its final stages. What I absolutely love about research from a few decades ago is that you were only allowed to publish when you had something to say. And you had to show that what you had to say was of importance, and new. These days, it seems, the floodgates are open, and any thought is being published into existence.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl published a 1 equation transport equation to describe how the turbulent kinetic energy evolves in space and time. He managed to derive using only seven equations, and the entire paper is about 10 pages long. These days, if we were to use the same font size and page layout that Prandtl used, by page ten, we would be halfway through the literature review. A paper these days is going to be between 20-30 pages long, has potentially tens, if not hundreds, of equations, and more often than not, presents no meaningful contribution.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you haven't read old papers, do yourself a favour and read a few of them. You'd be shocked at what clarity papers used to be written. These days, if you understand 10% of what authors are trying to convey in their incomprehensible collections of thoughts, you'd be lucky. Anyway, enough of me being grumpy and yearning <em>for ye good ol' days</em>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, what did Prandtl achieve? Well, his starting point was Eq.(42), i.e. the Reynolds stress equation. I have repeated it below so you don't have to scroll up:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{u'u'}}{\partial t} +
\frac{\overline{\bar{u}u'u'}}{\partial x} + \frac{\overline{u'\bar{u}u'}}{\partial x} + \frac{\overline{u'u'u'}}{\partial x} +
\frac{\overline{\bar{u}v'u'}}{\partial y} + \frac{\overline{u'\bar{v}u'}}{\partial y} + \frac{\overline{u'v'u'}}{\partial y} +
\frac{\overline{\bar{u}w'u'}}{\partial z} + \frac{\overline{u'\bar{w}u'}}{\partial z} + \frac{\overline{u'w'u'}}{\partial z} =\\[1em]
-\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial x^2} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial y^2}+
\nu\frac{\partial^2 \overline{u'u'}}{\partial z^2}\tag{68}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Prandtl now states that the kinetic energy of turbulence, or the turbulent kinetic energy as we know it these days, can be computed from the fluctuating velocity components as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
k=\frac{1}{2}\left(\overline{u'u'} + \overline{v'v'} + \overline{w'w'}\right)
\tag{69}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Since we also often assume isotropic flows, meaning that we have [katex]u'u'=v'v'=w'w'[/katex], we can also write the turbulent kinetic energy as</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
k=\frac{1}{2}\left(\overline{u'u'} + \overline{u'u'} + \overline{u'u'}\right)=\\[1em]
k=\frac{3}{2}\left(\overline{u'u'}\right)=\frac{3}{2}\left(\overline{v'v'}\right)=\frac{3}{2}\left(\overline{w'w'}\right)
\tag{70}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So Prandtl said, well, Eq.(42) already contains [katex]\overline{u'u'}[/katex] (and we only derived this form, but we could have also easily derived the equation for [katex]\overline{v'v'}[/katex] and [katex]\overline{w'w'}[/katex]), so why not reformulate Eq.(42) in terms of [katex]k[/katex]? This is what Prandtl did, but this did not necessarily achieve anything useful.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The next thing Prandtl did was to model each term and replace them with other known quantities. In this process, Prandtl made assumptions which, in my view, are no more clever, ridiculous, outrageous, or ingenious than, say, what Boussinesq did with the Reynolds stresses. Prandtl simply applied physical reasoning, sprinkled in a healthy dose of dimensional analysis, and used the best knowledge available to him at that time to model each term.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you read the <a href="https://cfd.university/blog/how-to-get-started-with-computational-fluid-dynamics-cfd/#aioseo-turbulence-modelling-and-its-physics" target="_blank" rel="noopener" title="">book by Wilcox</a>, you find some harsh words directed at Prandtl, stating that <em>Prandtl performed surgery on the Reynolds stress equations by replacing each term with modelling assumptions</em>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, newsflash, all RANS models do that, including the [katex]k-\omega[/katex] model that Wilcox is known for. And, would you look at that, the [katex]k-\omega[/katex] model is based on the turbulence kinetic energy [katex]k[/katex], so if Prandtl's approach was not sitting right with Wilcox, why did he use [katex]k[/katex] in his model (which wasn't really his model, he simply developed it the most, but the original ideas came from others). Well, perhaps because what Prandtl did was really useful? Or perhaps we just apply a double standard here, what do I know ...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>First, let's group terms together in the Reynolds stress equations:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial \overline{u'u'}}{\partial t}}_\text{Term 1} +
\underbrace{\frac{\overline{\bar{u}u'u'}}{\partial x} + \frac{\overline{u'\bar{u}u'}}{\partial x} + \frac{\overline{u'u'u'}}{\partial x} +
\frac{\overline{\bar{u}v'u'}}{\partial y} + \frac{\overline{u'\bar{v}u'}}{\partial y} + \frac{\overline{u'v'u'}}{\partial y} +
\frac{\overline{\bar{u}w'u'}}{\partial z} + \frac{\overline{u'\bar{w}u'}}{\partial z} + \frac{\overline{u'w'u'}}{\partial z}}_\text{Term 2} =\\[1em]
\underbrace{-\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x}}_\text{Term 3} +
\underbrace{\nu\frac{\partial^2 \overline{u'u'}}{\partial x^2} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial y^2}+
\nu\frac{\partial^2 \overline{u'u'}}{\partial z^2}}_\text{Term 4}
\tag{71}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, we have the rate of change in time (Term 1), transport (convection) of turbulent kinetic energy (Term 2), change due to pressure fluctuations (Term 3) and viscous dissipation/diffusion (Term 4). Let's compare that against the generic transport equation, which was given in Eq.(57) as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial \phi}{\partial t}}_\text{Term 1}+\underbrace{\mathbf{u}\frac{\partial \phi}{\partial\mathbf{x}}}_\text{Term 2}=\underbrace{\frac{\partial}{\partial \mathbf{x}}\left(\Gamma\frac{\partial \phi}{\partial \mathbf{x}}\right)}_\text{Term 3}+\underbrace{S}_\text{Term 4}\tag{72}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, Term 3 is the viscous dissipation/diffusion and Term 4 is a source term, and we could consider the change due to pressure in Eq.(71) as a source term in Eq.(57). So now, Prandtl essentially modelled each term in Eq.(71) which provided him with an equation of the form shown in Eq.(57). His equation for the turbulent kinetic energy [katex]k[/katex] is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial k}{\partial t}}_\text{Term 1} +
\underbrace{u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}}_\text{Term 2}= \\[1em]
\underbrace{\frac{\partial}{\partial x}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial x}\right) + \frac{\partial}{\partial y}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial y}\right) + \frac{\partial}{\partial z}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial z}\right)}_\text{Term 3} + 
\underbrace{C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u} - C_3 \frac{k\sqrt{k}}{l}}_\text{Term 4}
\tag{73}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>I have rewritten this equation in 3D for a general case. If you look up the paper of Prandtl then you will find it formulated for flat plate flows only, i.e. we only have the velocity gradient [katex]\partial U/\partial y[/katex] in this case. I have extended that with the strain rate tensor here so we can apply Prandtl's model to arbitrary 3D flows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In Eq.(73), we have a few constants [katex]C_1[/katex], [katex]C_2[/katex], and [katex]C_3[/katex], which need to be determined from experiments. This is what we would call closure coefficients these days. Then, we see the appearance of [katex]l[/katex] again, which is Prandtl's mixing length. We compute it akin to how we computed [katex]l[/katex] in the mixing length model in the previous section. Otherwise, if we compare Eq.(73) with the generic transport equation, i.e. Eq.(57), we see that the same terms appear.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The source term in Eq.(73) is given as [katex]S=C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u} - C_3 k\sqrt{k}/l[/katex]. Here, the first term represents the production of turbulent kinetic energy and the second term represents the destruction of turbulent kinetic energy. I have used these terms already a few times here, but to be more physically correct, we should say that we have transferred from laminar to turbulent kinetic energy (production) and dissipation into heat (destruction). Energy is conserved, it just changed its shape.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So let's investigate each term in more detail. Looking at the general transport equation, Eq.(57), and Prandtl's equation for the turbulent kinetic energy, Eq.(73), we can see that with the choice of [katex]\phi=k[/katex] we have</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \phi}{\partial t}=\frac{\partial k}{\partial t}\tag{74}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This substitution is straightforward. Next, let's look at the second term. Here, I use a bold letter to represent a vector quantity in Eq.(57), i.e. we have [katex]\mathbf{u}=(u,v,w)[/katex] and [katex]\mathbf{x}=(x,y,z)[/katex]. Thus, the second term of the transport equation becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\mathbf{u}\frac{\partial \phi}{\partial\mathbf{x}}=u\frac{\partial \phi}{\partial x} + v\frac{\partial \phi}{\partial y} + w\frac{\partial \phi}{\partial z}\tag{75}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Inserting now [katex]\phi=k[/katex] again, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\mathbf{u}\frac{\partial k}{\partial\mathbf{x}}=u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}\tag{76}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is the second term in Prandtl's equation for the turbulent kinetic energy, i.e. Eq.(73). If we look at the original Reynolds stress equation, you may ask, where all of the other terms went (we had 9 in total). Well, we will return to them later.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The third term relates to the diffusion process. First, let us expand this as well, as we are using vector quantities here again for the location vector [katex]\mathbf{x}[/katex]. The expanded form of the equation becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial}{\partial \mathbf{x}}\left(\Gamma\frac{\partial \phi}{\partial \mathbf{x}}\right) =
\frac{\partial}{\partial x}\left(\Gamma\frac{\partial \phi}{\partial x}\right) +
\frac{\partial}{\partial y}\left(\Gamma\frac{\partial \phi}{\partial y}\right) +
\frac{\partial}{\partial z}\left(\Gamma\frac{\partial \phi}{\partial z}\right)\tag{77}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we now equate [katex]\phi=k[/katex] (as per usual), and [katex]\Gamma=C_1 l\sqrt{k}[/katex], we get the following expression:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial}{\partial \mathbf{x}}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial \mathbf{x}}\right) =
\frac{\partial}{\partial x}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial x}\right) +
\frac{\partial}{\partial y}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial y}\right) +
\frac{\partial}{\partial z}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial z}\right)\tag{78}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is the third term in Prandtl's [katex]k[/katex] equation. Why can we set [katex]\Gamma=C_1 l\sqrt{k}[/katex]? Well, if in doubt, the answer is always dimensionality analysis. Forget physics or maths, if you have no idea what to do, just look at the units and see what quantities you have available that can give you that value. In this case, [katex]\Gamma[/katex] has units of [katex][m^2/s][/katex]. Looks familiar, doesn't it? Well, this is the unit for a kinematic viscosity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We have spent this (and the last) article developing formulas for evaluating the turbulent kinematic viscosity [katex]\nu_t[/katex] (or the dynamic turbulent viscosity [katex]\mu_t[/katex], which we can always transform into a kinematic version by dividing it by the density). We said that [katex]\nu_t[/katex] is the product of a velocity scale and a length scale. If you are Prandtl, finding a length scale is easy. Take the mixing length, which has worked out so well for you in the past.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What about the velocity scale? Well, since we are dealing here with the turbulent kinetic energy [katex]k[/katex] per unit mass (which, again, just means that we divide [katex]k[/katex] by the density [katex]\rho[/katex]), we have units of [katex]m^2/s^2[/katex]. Taking the square root of that unit provides [katex]m/s[/katex], i.e. the unit of a velocity. Therefore, it follows that [katex]\Gamma = C_1 l\sqrt{k}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The factor [katex]C_1[/katex] is just admitting that we have no idea if our dimensional analysis approach actually works. We may be introducing too much or too little diffusion. Tuning this parameter, similar to how it is done in the mixing length model, provides a mechanism to match experimental data. We should never forget: <strong>Just because we solve a partial differential equation, which may appear mathematically elegant, does not guarantee elegant results.</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Bleak, but that is turbulence modelling reality. Let's return to Eq.(71) for a second again. I said that term 2 contains other derivatives, which aren't included in Prandtl's [katex]k[/katex] equation, i.e. Eq.(73). These terms are [katex]\overline{u'u'}(\partial \bar{u}/\partial x)[/katex], [katex]\overline{u'v'}(\partial \bar{u}/\partial y)[/katex], and [katex]\overline{u'w'}(\partial \bar{u}/\partial z)[/katex]. These expressions are just the first line of the Reynolds stress tensor multiplied by the velocity gradient tensor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Remember that Eq.(71) was constructed for [katex]\overline{u'u'}[/katex] only, if we also constructed one equation for [katex]\overline{v'v'}[/katex] and [katex]\overline{w'w'}[/katex], then we would get the additional terms [katex]\overline{v'u'}(\partial \bar{v}/\partial x)[/katex], [katex]\overline{v'v'}(\partial \bar{v}/\partial y)[/katex], and [katex]\overline{v'w'}(\partial \bar{v}/\partial z)[/katex], as well as [katex]\overline{w'u'}(\partial \bar{w}/\partial x)[/katex], [katex]\overline{w'v'}(\partial \bar{w}/\partial y)[/katex], and [katex]\overline{w'w'}(\partial \bar{w}/\partial z)[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can write this in a compact tensor form as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'} \\[1em]
\overline{v'u'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{w'u'} & \overline{w'v'} & \overline{w'w'} \\[1em]
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial \bar{u}}{\partial x} & \frac{\partial \bar{u}}{\partial y} & \frac{\partial \bar{u}}{\partial y} \\[1em]
\frac{\partial \bar{v}}{\partial x} & \frac{\partial \bar{v}}{\partial y} & \frac{\partial \bar{v}}{\partial y} \\[1em]
\frac{\partial \bar{w}}{\partial x} & \frac{\partial \bar{w}}{\partial y} & \frac{\partial \bar{w}}{\partial y} \\[1em]
\end{bmatrix}
=\tau^{RANS}:\nabla\bar{\mathbf{u}}\tag{79}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, we can express the above expression as [katex]\tau^{RANS}:\nabla\bar{\mathbf{u}}[/katex]. Now Prandtl is saying that [katex]\tau^{RANS}[/katex] can be replaced by Boussinesq's eddy viscosity hypothesis, which we already saw expressed as [katex]\tau^{RANS}=2\epsilon\mathbf{S}[/katex]. Here, [katex]\epsilon[/katex] is a yet-to-be-determined quantity, not the turbulent viscosity. We can combine this with the equation above, which provides us with:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}:\mathbf{S}=2\epsilon\mathbf{S}:\nabla\bar{\mathbf{u}}\tag{80}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, how do we find [katex]\epsilon[/katex]? What do you think? Should we give this dimensional analysis thing a try (again)? That is certainly what Prandtl did, where he said that [katex]\epsilon[/katex] has units of [katex]m^2/s[/katex], i.e. the units of a velocity multiplied by a length. Now I'll let you guess which velocity and length scale we should use. If you said "let's just reuse what we already used for the diffusion", then you'd be spot on. That is what Prandtl did, and he set [katex]\epsilon=2C_2 l\sqrt{k}[/katex]. Thus, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u}\tag{81}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>[katex]C_2[/katex], of course, is yet another closure coefficient, determined from experiments (not by Prandtl, of course, he dismissed this exercise as a wind tunnel measurement campaign that any grad student can perform). It accounts, again, for our ignorance of using dimensionality analysis, with a healthy portion of black magic and supernatural belief.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you now look at Prandtl's [katex]k[/katex] equation, then you will find this term as part of Term 4, i.e. the source term. We said that this term is responsible for taking energy from the mean flow and transforming it into turbulent kinetic energy.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But what about the second contribution of Term 4 in Eq.(73)? We saw that we have [katex]-C_3 k\sqrt{k}/l[/katex], what is this? Well, how about we do some dimensional analysis and then figure out what Prandtl is doing here? [katex]k[/katex] has units of [katex]m^2/s^2[/katex], so that [katex]\sqrt{k}[/katex] has units of [katex]m/s[/katex]. Combine the nominator and you get [katex]m^3/s^3[/katex]. Now we divide this by a length (how about the mixing length? Sounds good to you? Good, let's use that then) so that we get units of [katex]m^2/s^3[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Does this unit look familiar? This is the unit of dissipation, and this makes sense, doesn't it? The source term, or rather, term 4 in Prandtl's [katex]k[/katex] equation, i.e. Eq.(73) states [katex]S=C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u} - C_3 k\sqrt{k}/l[/katex]. The first part is the <em>production</em> of turbulent kinetic energy, so that the second term (which we have now established as the dissipation term) provides a mechanism to <em>destroy</em> it (turning it into internal heat).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Of course, we add another closure coefficient for good measure. As we all know, the importance of a turbulence model is measured by the number of closure coefficients it features (or did they represent the cluelessness of the author about how to model turbulent flows? I forgot ...)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And that's it. You now know how to <em>derive</em> the [katex]k[/katex] equation, at least in the version that Prandtl put forward. Well, the verb derive is perhaps a bit strong in this context, we didn't derive anything but rather threw dimensional analysis at the Reynolds stress equation, i.e. Eq.(71), and then we tried to model each term with a combination of the turbulence kinetic energy and the mixing length.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>OK, after having gone through this exercise, I see the point Wilcox is making. We are performing surgery on the Reynolds stress equations, but I don't think this is a bad thing. If you suffer a cardiac arrest and need a bypass, you'll happily undergo surgery. Sure, your body has changed slightly after the surgery, but you live to see another day.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl performed <em>surgery</em> on the Reynolds stress equation, but this has opened up an entirely new field of turbulence research, and it is the pioneering work of Prandtl (and others), that all modern turbulence modelling, especially RANS, is based on. So I think Wilcox is a bit harsh in his words, though I agree with his sentiment.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Before we close this section, let's review the main shortcoming of Prandtl's [katex]k[/katex] equation. The mixing length. Yes, the mixing length [katex]l[/katex] makes the [katex]k[/katex] equation just as useful as the mixing length model itself. Here, we didn't know what value to set for [katex]l[/katex], except for simple canonical flows, and so we can't expect Prandtl's [katex]k[/katex] equation to perform any better than the mixing length (perhaps with marginal improvements).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What we really want is a way to independently compute a turbulent length scale. Not necessarily the mixing length, but any turbulent length scale. To do that, we need an additional equation, which brings us to 2-equation RANS models. These solve for another turbulent quantity, typically some form of dissipation, from which we can infer a turbulent length scale.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Various models have been proposed, but these days there really are only two main contenders: The [katex]k-\varepsilon[/katex] and [katex]k-\omega[/katex] models. Let us have a look at each of these models in turn now and see how we can avoid specifying a length scale as an input parameter.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">The [katex]k-\varepsilon[/katex] model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The [katex]k-\varepsilon[/katex] model is really what started RANS turbulence modelling in the CFD community, and it was introduced by Jones and Launder in 1972. While we often attribute the model to these two, we will see a lot of influence from Prandtl. However, other authors before them also introduced a similar two-equation model, but Jones and Launder were the ones to popularise it. The model that is in use these days is usually taken from the 1974 paper by Launder and Sharma, which tuned the closure coefficients of the 1972 paper.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The [katex]k-\varepsilon[/katex] model solves for two additional turbulent quantities:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>The turbulent kinetic energy [katex]k[/katex] which we have already seen in Prandtl's [katex]k[/katex] equation

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>The rate of dissipation of turbulent kinetic energy [katex]\varepsilon[/katex]

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Let's start with the [katex]k[/katex] equation. I am not going to derive it (and you will see why in a second). It is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} +
u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left[\left(\nu+\frac{\nu_t}{\sigma_k}\right)\frac{\partial k}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\frac{\nu_t}{\sigma_k}\right)\frac{\partial k}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\frac{\nu_t}{\sigma_k}\right)\frac{\partial k}{\partial z}\right] + 
2\nu_t\mathbf{S}:\nabla\mathbf{u} - \rho\varepsilon
\tag{82}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now let's compare that with Prandtl's [katex]k[/katex] equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} +
u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial x}\right) + \frac{\partial}{\partial y}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial y}\right) + \frac{\partial}{\partial z}\left(C_1 l\sqrt{k}\frac{\partial k}{\partial z}\right) + 
C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u} - C_3 \frac{k\sqrt{k}}{l}\tag{83}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>You don't need a PhD, or an office at Imperial College London to realise that we have the following equalities:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
C_1 l\sqrt{k} = \nu+\frac{\nu_t}{\sigma_k}\\[1em]
C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u} = 2\nu_t\mathbf{S}:\nabla\mathbf{u}\\[1em]
C_3 \frac{k\sqrt{k}}{l} = \rho\varepsilon\tag{84}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\nu[/katex] is the physical (kinematic) viscosity and [katex]\nu_t[/katex] is the turbulent viscosity, which comes from Boussinesq's eddy viscosity assumption. Then, from dimensional grounds, as we have seen previously, [katex]l\sqrt{k}[/katex] gives us a unit of viscosity, so we can directly replace that with the physical and turbulent viscosity, where [katex]\sigma_k[/katex] is a closure coefficient (set to [katex]\sigma_k=1.0[/katex], what's the point then? ...).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the second line, we equate [katex]l\sqrt{k}[/katex] to just [katex]\nu_t[/katex] in Jones' and Launder's [katex]k-\varepsilon[/katex] model (why [katex]\nu_t[/katex] and not [katex]\nu + \nu_t/\sigma_k[/katex]? Well, that is what the authors <em>assume</em> to be more correct). On the third line, we don't have to faff around with dimensionality analysis and work out a term whose unit is that of the dissipation, because we do have the dissipation available, so we can simply replace Prandtl's dissipation construct with the dissipation [katex]\varepsilon[/katex] directly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Voil, we have constructed the first equation of the two. The production term, i.e. [katex]C_2 l\sqrt{k}\mathbf{S}:\nabla\mathbf{u}[/katex] is typically written as [katex]\tau^{RANS}_{ij}(\partial u_i/\partial x_j)[/katex] in tensor notation in the literature. We can write this in vector notation as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j}=\tau^{RANS}_{ij}:\nabla\mathbf{u}\tag{85}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>I'll be using this definition from now on, as this is what you would more commonly see in the literature. Now on to the rate of dissipation of turbulent kinetic energy [katex]\varepsilon[/katex]. It does follow a very similar approach to the [katex]k[/katex] equation, as in we have our standard transport equation. Let's write</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \varepsilon}{\partial t} +
u\frac{\partial \varepsilon}{\partial x} + v\frac{\partial \varepsilon}{\partial y} + w\frac{\partial \varepsilon}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial z}\right] + 
C_{1\varepsilon}\frac{\varepsilon}{k}2\nu_t\mathbf{S}:\nabla\mathbf{u} - C_{2\varepsilon}\frac{\varepsilon^2}{k}
\tag{86}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, how do we end up with this equation? Well, we multiply the Navier-Stokes equations (with the instantaneous velocity field) with the following expression (and then take the time average of the product):</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
2\nu\nabla \mathbf{u}':\nabla=2\nu
\begin{bmatrix}
\frac{\partial u'}{\partial x} & \frac{\partial u'}{\partial y} & \frac{\partial u'}{\partial z} \\[1em]
\frac{\partial v'}{\partial x} & \frac{\partial v'}{\partial y} & \frac{\partial v'}{\partial z} \\[1em]
\frac{\partial w'}{\partial x} & \frac{\partial w'}{\partial y} & \frac{\partial w'}{\partial z} \\[1em]
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z} \\[1em]
\frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z} \\[1em]
\frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z} \\[1em]
\end{bmatrix}
\tag{87}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's see why. The goal here is to construct a transport equation for [katex]\varepsilon[/katex], which in turn is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\nu\nabla \mathbf{u}':\nabla\mathbf{u}'}
\tag{88}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Whatever quantity appears in the time derivative is the quantity we are solving for. That is, if our time derivative is [katex]\partial \varepsilon/\partial t[/katex], then we have constructed a transport equation for [katex]\varepsilon[/katex]. To get a more intuitive feeling for why that is, let us write the [katex]\varepsilon[/katex] equation in a simplified form as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \varepsilon}{\partial t} + Convection = Diffusion + Production - Dissipation\tag{89}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Discretising this simplified equation using a first-order Euler time integration scheme, as we discussed in the <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/space-and-time-integration-schemes-for-cfd-applications/#aioseo-numerical-schemes-for-time-integrations" target="_blank" rel="noopener" title="">numerical scheme article</a>, we can write this equation in semi-discretised form as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\varepsilon^{n+1}_{i,j,k}-\varepsilon^n_{i,j,k}}{\Delta t} + Convection = Diffusion + Production - Dissipation\tag{90}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now we can solve this equation for [katex]\varepsilon^{n+1}_{i,j,k}[/katex], i.e. the value of the dissipation at the next time level [katex]n+1[/katex] and for the vertex/cell centroid at indices [katex]i[/katex], [katex]j[/katex], and [katex]k[/katex] (i.e. assuming a structured, 3D grid here). If we assume that we use an explicit time stepping here, meaning that convection, diffusion, production, and dissipation terms can be evaluated from known quantities (from the previous time step [katex]n[/katex]), then we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\varepsilon^{n+1}_{i,j,k}=\varepsilon^n_{i,j,k} + \Delta t(Diffusion + Production - Dissipation -Convection)\tag{91}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>In other words, we have constructed an update equation for [katex]\varepsilon[/katex] which we can iteratively solve until values for [katex]\varepsilon[/katex] no longer change (which is the case when we have converged to a steady state solution). The update equation was constructed for the quantity appearing in the time derivative, and so if we want to construct an equation for [katex]\varepsilon[/katex], our goal is to manipulate the Navier-Stokes equations so that the rate of dissipation of the turbulent kinetic energy [katex]\varepsilon[/katex] appears in the time derivative.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, by multiplying the Navier-Stokes equation of the instantaneous velocity field with Eq.(87) and then time averaging it, we end up with:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\left(2\nu\nabla \mathbf{u}':\nabla\right)\cdot\left[\frac{\partial \mathbf{U}}{\partial t}+ (\mathbf{U}\cdot\nabla)\mathbf{U}+\frac{1}{\rho}\nabla P - \nu\nabla^2 \mathbf{U}\right]}\tag{92}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now we replace the instantaneous velocity field [katex]\mathbf{U}[/katex] with the Reynolds decomposition [katex]\mathbf{U}=\bar{\mathbf{u}} + \mathbf{u}'[/katex]. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\left(2\nu\nabla \mathbf{u}':\nabla\right)\cdot\left[\frac{\partial (\bar{\mathbf{u}} + \mathbf{u}')}{\partial t}+ ((\bar{\mathbf{u}} + \mathbf{u}')\cdot\nabla)(\bar{\mathbf{u}} + \mathbf{u}')+\frac{1}{\rho}\nabla P - \nu\nabla^2 (\bar{\mathbf{u}} + \mathbf{u}')\right]}
\tag{93}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Should we attempt to write out the equation in scalar form? I'll have to drop the overline, otherwise [katex]\LaTeX[/katex] won't allow me to break this equation up over two lines. We get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\left(
2\nu
\begin{bmatrix}
\frac{\partial u'}{\partial x} & \frac{\partial v'}{\partial x} & \frac{\partial w'}{\partial x} \\[1em]
\frac{\partial u'}{\partial y} & \frac{\partial v'}{\partial y} & \frac{\partial w'}{\partial y} \\[1em]
\frac{\partial u'}{\partial z} & \frac{\partial v'}{\partial z} & \frac{\partial w'}{\partial z} \\[1em]
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial}{\partial x} & \frac{\partial}{\partial x} & \frac{\partial}{\partial x} \\[1em]
\frac{\partial}{\partial y} & \frac{\partial}{\partial y} & \frac{\partial}{\partial y} \\[1em]
\frac{\partial}{\partial z} & \frac{\partial}{\partial z} & \frac{\partial}{\partial z} \\[1em]
\end{bmatrix}\right)\\[1em]
\cdot\left(
\frac{\partial}{\partial t}
\begin{bmatrix}
(\bar{u}+u') \\[1em]
(\bar{v}+v') \\[1em]
(\bar{w}+w') \\[1em]
\end{bmatrix}
+
\begin{bmatrix}
(\bar{u}+u')\frac{\partial (\bar{u}+u')}{\partial x} & (\bar{v}+v')\frac{\partial (\bar{u}+u')}{\partial y} & (\bar{w}+w')\frac{\partial (\bar{u}+u')}{\partial z} \\[1em]
(\bar{u}+u')\frac{\partial (\bar{v}+v')}{\partial x} & (\bar{v}+v')\frac{\partial (\bar{v}+v')}{\partial y} & (\bar{w}+w')\frac{\partial (\bar{v}+v')}{\partial z} \\[1em]
(\bar{u}+u')\frac{\partial (\bar{w}+w')}{\partial x} & (\bar{v}+v')\frac{\partial (\bar{w}+w')}{\partial y} & (\bar{w}+w')\frac{\partial (\bar{w}+w')}{\partial z}
\end{bmatrix}\\[1em]
+\frac{1}{\rho}
\begin{bmatrix}
\frac{\partial (\bar{p}+p')}{\partial x} \\[1em]
\frac{\partial (\bar{p}+p')}{\partial y} \\[1em]
\frac{\partial (\bar{p}+p')}{\partial z} \\[1em]
\end{bmatrix}
-\nu
\begin{bmatrix}
\frac{\partial^2 (\bar{u}+u')}{\partial x^2} & \frac{\partial^2 (\bar{u}+u')}{\partial y^2} & \frac{\partial^2 (\bar{u}+u')}{\partial z^2} \\[1em]
\frac{\partial^2 (\bar{v}+v')}{\partial x^2} & \frac{\partial^2 (\bar{v}+v')}{\partial y^2} & \frac{\partial^2 (\bar{v}+v')}{\partial z^2} \\[1em]
\frac{\partial^2 (\bar{w}+w')}{\partial x^2} & \frac{\partial^2 (\bar{w}+w')}{\partial y^2} & \frac{\partial^2 (\bar{w}+w')}{\partial z^2}
\end{bmatrix}\right)\tag{94}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Beautiful, writing this equation only took me 2009 characters. Now let's take this equation term by term. First up, the time derivative of the Navier-Stokes equation. This can be written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\left(2\nu\nabla \mathbf{u}':\nabla\right)\cdot\frac{\partial (\bar{\mathbf{u}} + \mathbf{u}')}{\partial t}}=
\overline{2\nu\nabla \mathbf{u}':\frac{\partial }{\partial t}\nabla (\bar{\mathbf{u}} + \mathbf{u}')}=
\overline{2\nu\nabla \mathbf{u}':\frac{\partial }{\partial t}\nabla \bar{\mathbf{u}} + 2\nu\nabla\mathbf{u}':\frac{\partial }{\partial t}\nabla \mathbf{u}'}
\tag{95}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's look at the first term in the summation. Let us first write the time derivative towards the front, which we are allowed to do. Then we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{2\nu\nabla \mathbf{u}':\frac{\partial }{\partial t}\nabla \bar{\mathbf{u}}}=\frac{\partial }{\partial t}\overline{2\nu\nabla \mathbf{u}':\nabla \bar{\mathbf{u}}}\tag{96}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we carry out the double dot product, i.e. [katex]\overline{\mathbf{u}':\nabla \bar{\mathbf{u}}}[/katex], which is just the extension of the vector (single) dot product for tensors, we end up with a scalar. Let's write this double dot product out:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{
\begin{bmatrix}
\frac{\partial u'}{\partial x} & \frac{\partial v'}{\partial x} & \frac{\partial w'}{\partial x} \\[1em]
\frac{\partial u'}{\partial y} & \frac{\partial v'}{\partial y} & \frac{\partial w'}{\partial y} \\[1em]
\frac{\partial u'}{\partial z} & \frac{\partial v'}{\partial z} & \frac{\partial w'}{\partial z} \\[1em]
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial \bar{\mathbf{u}}}{\partial x} & \frac{\partial \bar{\mathbf{v}}}{\partial x} & \frac{\partial \bar{\mathbf{w}}}{\partial x} \\[1em]
\frac{\partial \bar{\mathbf{u}}}{\partial y} & \frac{\partial \bar{\mathbf{v}}}{\partial y} & \frac{\partial \bar{\mathbf{w}}}{\partial y} \\[1em]
\frac{\partial \bar{\mathbf{u}}}{\partial z} & \frac{\partial \bar{\mathbf{v}}}{\partial z} & \frac{\partial \bar{\mathbf{w}}}{\partial z} \\[1em]
\end{bmatrix}}=\\[1em]
\overline{\frac{\partial u'}{\partial x}\frac{\partial \bar{\mathbf{u}}}{\partial x}} +
\overline{\frac{\partial v'}{\partial x}\frac{\partial \bar{\mathbf{v}}}{\partial x}} +
\overline{\frac{\partial w'}{\partial x}\frac{\partial \bar{\mathbf{w}}}{\partial x}} +
\overline{\frac{\partial u'}{\partial y}\frac{\partial \bar{\mathbf{u}}}{\partial y}} +
\overline{\frac{\partial v'}{\partial y}\frac{\partial \bar{\mathbf{v}}}{\partial y}} +
\overline{\frac{\partial w'}{\partial y}\frac{\partial \bar{\mathbf{w}}}{\partial y}} +
\overline{\frac{\partial u'}{\partial z}\frac{\partial \bar{\mathbf{u}}}{\partial z}} +
\overline{\frac{\partial v'}{\partial z}\frac{\partial \bar{\mathbf{v}}}{\partial z}} +
\overline{\frac{\partial w'}{\partial z}\frac{\partial \bar{\mathbf{w}}}{\partial z}}\tag{97}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can see that we are here taking the time average of a fluctuating velocity component and its time-averaged (mean) value. Well, we also take the derivative of that, but we saw that the product of a fluctuating velocity component and its mean value is equal to zero, so that has to be still true for its derivative. Thus, we can say that the above expression must be equal to zero, and therefore, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\underbrace{2\nu\nabla \mathbf{u}':\frac{\partial }{\partial t}\nabla \bar{\mathbf{u}}}_{=0} + 2\nu\nabla\mathbf{u}':\frac{\partial }{\partial t}\nabla \mathbf{u}'}\tag{98}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we do the same for the second term, then we can see that only the second velocity component changes from the mean to the fluctuating velocity component. Therefore, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{2\nu\nabla\mathbf{u}':\frac{\partial }{\partial t}\nabla \mathbf{u}'}=2
\frac{\partial }{\partial t}\overline{2\nu\nabla\mathbf{u}':\nabla \mathbf{u}'}=2
\frac{\partial }{\partial t}\varepsilon=
\frac{\partial \varepsilon}{\partial t}\tag{99}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Finally, we can say that that Eq.(95) becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\overline{\underbrace{2\nu\nabla \mathbf{u}':\frac{\partial }{\partial t}\nabla \bar{\mathbf{u}}}_{=0} + \underbrace{2\nu\nabla\mathbf{u}':\frac{\partial }{\partial t}\nabla \mathbf{u}'}_{=2\partial \varepsilon/\partial t}}\tag{100}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This checks out. Our goal was to obtain a transport equation for the dissipation [katex]\varepsilon[/katex], and multiplying the Navier-Stokes equations by [katex]2\nu\nabla \mathbf{u}':\nabla[/katex] produced this outcome. At this point, we could go through the remaining terms (e.g. advection, pressure, and diffusion) to construct the full equation for epsilon. However, doing so is, as it turns out, a waste of time. Why is that? Well, let's start with the definition of [katex]\varepsilon[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you go through the literature, pay close attention to how [katex]\varepsilon[/katex] is introduced. There are two things it can refer to.</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>The physical process of dissipation (i.e. how molecular motion turns kinetic energy (motion) into heat)

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>The rate of dissipation of turbulent kinetic energy, balancing production and destruction of turbulence (transformation from laminar to turbulent energy and turbulence to heat).

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>In Eq.(93), we are looking at the first of the two. That is, if you carry out the multiplication for each term, similar to what we have done for the time derivative in Eq.(95), you will end up with an equation that describes how the <strong>smallest</strong> of scales in a turbulent flow dissipate turbulent kinetic energy into heat.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In contrast, the rate of dissipation of turbulent (or turbulence) kinetic energy, i.e. the second definition, is captured by Eq.(86), and defines how the kinetic energy is balanced so that we always have an equilibrium between turbulence generation (transfer from energy between laminar and turbulent flows) and turbulence destruction (molecular motions turns into heat).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The problem here is that turbulent kinetic energy is <em>generated</em> at the largest of scales, i.e. it is the non-linear term and the large-scale motions of the flow that feed energy towards the production of [katex]k[/katex]. Thus, if [katex]\varepsilon[/katex] is there to balance this production, all of a sudden we are dealing with an equation that describes the dissipation at the <strong>largest</strong> of flow scales.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The assumption we are using here to justify this is that the rate of dissipation at the largest scales has to match the dissipation at the smallest scales. Thus, if we know one of them, we implicitly know the other as well. However, we can state that both Eq.(86) and Eq.(93) model dissipation at different scales, which is the complete opposite for the [katex]k[/katex] equation, where we have modelled each term through sensible (?!) assumptions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So the tone is set. As long as you have an idea for how to model any turbulent quantities, you are free to invent your own turbulence model. The only rule is that you have to use a transport equation, and, perhaps, don't burst into laughter when anyone takes your model seriously enough to ask serious questions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I think Wilcox summarised it well in his book:</p>
<!-- /wp:paragraph -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><!-- wp:paragraph -->
<p><em>So, we must ask whether the modelled [katex]\varepsilon[/katex] equation represents the dissipation as such, or whether it is actually an empirical equation for the rate of energy transfer from the largest (equal, of course, to the rate of dissipation in the small eddies). The answer seems clear since the closure approximations normally used parameterise the various terms in the modelled [katex]\varepsilon[/katex] equation as functions of large-eddy scales (our use of dimensionality analysis does tis implicitly). <strong>As a consequence, the relation between the modelled equation for</strong> [katex]\varepsilon[/katex] <strong>and the exact equation is so tenuous as to not need serious consideration.</strong></em></p>
<!-- /wp:paragraph --></blockquote>
<!-- /wp:quote -->

<!-- wp:paragraph -->
<p>I would have loved to see Wilcox at an open mic event doing some stand-up comedy material ...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But before I upset any more people working in the field of turbulence modelling, let me just say this: The [katex]k-\varepsilon[/katex] model was the first RANS model that really popularised them and showed that we can compute the effect of turbulence on our mean flow. Sure, it may not be the best, has some flaws in its derivation (in that the derivation is completely made up), but you would always expect that of early versions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As it turns out, this model is actually very well able to capture flow away from solid walls. In fact, it is the foundation for a much more popular model, the [katex]k-\omega[/katex] SST model, and I'll take a bit that most engineering objects that are designed with CFD these days, probably use some form of the [katex]k-\varepsilon[/katex] model, even if it is just through the more popular [katex]k-\omega[/katex] SST model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It has shown the be robust, work well for a broad range of flows, and ultimately, this is what counts. We can end up in endless debates on the meaning of turbulence and how to treat it, but in the meantime, engineers have real-world problems to which they need answers, and Jones and Launder provided such an answer.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>But this isn't everything. We said that Prandtl's [katex]k[/katex] equation, or one equation model, was flawed, in that it only computed a characteristic velocity scale, but not a characteristic length scale (and, instead, relying on the mixing length). For this reason, we said we need a second equation. So, how does the [katex]\varepsilon[/katex] equation solve this issue? Well, we have to resort to, you guessed it, dimensionality analysis to get the answer.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The units for the turbulent kinetic energy and rate of dissipation for the turbulent kinetic energy are [katex]m^2/s^2[/katex] and [katex]m^2/s^3[/katex]. If we squared the turbulent kinetic energy, we get units of [katex]k^2\,[m^4/s^4][/katex]. If we divide this by the dissipation, we get units of [katex]k^2/\varepsilon\,[m^2/s][/katex]. Perfect, this is the same units as our turbulent kinematic viscosity and so we can write:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{k^2}{\varepsilon}\tag{101}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Right? Well, remember how we use dimensional analysis because we don't know any better? We have to introduce the <em>coefficient of stupidity</em>, which allows us to pretend that the above equation has any physical meaning (<em>I'm sure it is called differently in the mainstream literature ...</em>). We simply scale the expression on the right-hand side until it matches values we can measure in DNS data, or perhaps even in a turbulent flow. Once we have found a suitable value, we hope that this is representative of a broad range of flows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The final equation becomes</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=C_\mu\frac{k^2}{\varepsilon}\tag{102}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So let us recap what we have achieved. We have constructed two additional transport equations, one for [katex]k[/katex] and one for [katex]\varepsilon[/katex], only so that we can compute [katex]\nu_t[/katex] at every grid point in the flow. We can now use this turbulent viscosity and compute the additional Reynolds stresses that appear in the time-averaged Navier-Stokes (RANS) equations through the Boussinesq eddy viscosity hypothesis, Eq.(56), i.e.:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-2\mu_t\mathbf{S}+\frac{2}{3}k_t\delta_{ij}\tag{103}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, remember that we can always obtain the kinematic (turbulent) viscosity [katex]\nu_t[/katex] by dividing the dynamic (turbulent) viscosity [katex]\mu_t[/katex] by the density [katex]\rho[/katex]. In the above equation, I used [katex]k_t[/katex] to indicate that this is the turbulent kinetic energy. Also, for completeness, sometimes you will find the [katex]\tau^{RANS}[/katex] being defined as [katex]-\tau^{RANS}[/katex], i.e. as a negative value. In this case, the signs simply swap in Eq.(56), i.e. we would have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
-\tau^{RANS}=2\mu_t\mathbf{S}-\frac{2}{3}k_t\delta_{ij}\tag{104}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Well, I would assume that this is the definition you will most commonly see, so before you wonder why all my equations are multiplied by -1, this is why (in my momentum equations, the derivative of [katex]\tau^{RANS}[/katex] is negative, whereas most literature keeps it positive and then takes the negative Reynolds stresses, i.e. [katex]-\tau^{RANS}[/katex]).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There is one big problem with the [katex]k-\varepsilon[/katex] model: It overpredicts turbulent quantities near the wall quite badly (as we will see later in some detail). This problem is akin to the issue observed with the <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-the-smagorinsky-model" target="_blank" rel="noopener" title="">Smagorinsky model</a> in LES, which does not predict flow near walls well. Various modifications were made, of which the simplest was the <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/the-introduction-to-large-eddy-simulations-les-i-wish-i-had/#aioseo-modifying-the-length-scale-van-driest-damping-function" target="_blank" rel="noopener" title="">van Driest damping function</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the [katex]k-\varepsilon[/katex] model, we also need to make similar modifications by employing some form of damping so that [katex]\nu_t[/katex] near the wall is not overpredicted. This would be one way of doing things, but there is a far superior way (in my view, anyway), and we will examine this solution later when we introduce the [katex]k-\omega[/katex] SST model. But before we go there, let us introduce the [katex]k-\omega[/katex] model first.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">The [katex]k-\omega[/katex] model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The [katex]k-\omega[/katex] is equally wild when viewed in the context of the [katex]k-\varepsilon[/katex] model development. Now both models seem to be highly polarising (especially if you read Wilcox's book on turbulence modelling), but I'd say it is just as good (or bad?!) as the [katex]k-\varepsilon[/katex] model. Let me elaborate.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>First of all, the first [katex]k-\omega[/katex] model that was introduced was by Kolmogorov in 1942. The astute reader will realise that this is 3 years before Prandtl introduced his [katex]k[/katex] equation in 1945, so Kolmogorov independently derived an equation for the turbulent kinetic energy, as well as a new parameter [katex]\omega[/katex], which we will look more closely at in this section.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Prandtl did not reference Kolmogorov's work, and for all we know, the second small disagreement of 1939-1945 meant that Germans and Russians would, perhaps, not be on the best of speaking terms. It is not difficult to imagine that there was little collaboration. Thus, Prandtl probably never bothered <em>sending an email</em> to check with his buddy about his work.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What is this second parameter [katex]\omega[/katex] then? It is defined as the specific turbulence dissipation rate and expressed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\omega=\frac{\varepsilon}{C_\mu k}
\tag{105}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]C_\mu[/katex] is the closure coefficient we saw previously as well in the [katex]k-\varepsilon[/katex] model. What gives? Is [katex]\omega[/katex] just a different way of expressing the process of dissipation? Yup, pretty much, case closed, let's move on to the next RANS model ...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, not so fast, hold your horses fellow-me-lad/girl, you and I have to have a conversation. Let's start at the beginning.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When Kolmogorov introduced his [katex]k-\omega[/katex] model, he didn't derive any equations; he merely stated them without even defining all terms/closure coefficients. It isn't clear, to this day, how he obtained his equations, but he was a strong believer in dimensional analysis, and a lot of his work is based on this. It is thus not farfetched to believe that his [katex]k-\omega[/katex] model is based on dimensional analysis as well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Improvements were made over the year, but it really is the momentum of Wilcox that gave the model its final touches. In the Wilcox [katex]k-\omega[/katex] model, the equation for the turbulent kinetic energy is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} +
u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial z}\right] + P - \beta^* k\omega
\tag{106}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, the production term [katex]P[/katex] is expressed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}=
\begin{bmatrix}
-\overline{u'u'} & -\overline{u'v'} & -\overline{u'w'} \\[1em]
-\overline{v'u'} & -\overline{v'v'} & -\overline{v'w'} \\[1em]
-\overline{w'u'} & -\overline{w'v'} & -\overline{w'w'}
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y} & \frac{\partial u}{\partial z} \\[1em]
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y} & \frac{\partial v}{\partial z} \\[1em]
\frac{\partial w}{\partial x} & \frac{\partial w}{\partial y} & \frac{\partial w}{\partial z}
\end{bmatrix}
\tag{107}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We use the Boussinesq eddy viscosity approach to get values for the individual Reynolds stresses. The Boussinesq eddy viscosity was given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-2\nu_t\mathbf{S}+\frac{2}{3}k\delta_{ij}\tag{108}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We haven't actually written out the Boussinesq hypothesis for each of the Reynolds stresses, so lets do that now. Recalling that our strain-rate tensor [katex]\mathbf{S}[/katex] was given by Eq.(45) as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\mathbf{S} =
\begin{bmatrix}
\frac{\partial u}{\partial x} & \frac{1}{2} \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right) & \frac{1}{2} \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right) \\[1em]
\frac{1}{2} \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right) & \frac{\partial v}{\partial y} & \frac{1}{2} \left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right) \\[1em]
\frac{1}{2} \left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right) & \frac{1}{2} \left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right) & \frac{\partial w}{\partial z}
\end{bmatrix}\tag{109}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can write the Reynolds stress tensor [katex]\tau^{RANS}[/katex] as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=
\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'} \\[1em]
\overline{v'u'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{w'u'} & \overline{w'v'} & \overline{w'w'}
\end{bmatrix}=
\begin{bmatrix}
-\frac{\partial u}{\partial x} + \frac{2}{3}k & \nu_t \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right) & \nu_t \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right) \\[1em]
\nu_t \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right) & 2\nu_t\frac{\partial v}{\partial y} + \frac{2}{3}k & \nu_t\left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right) \\[1em]
\nu_t\left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right) & \nu_t\left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right) & 2\nu_t\frac{\partial w}{\partial z} + \frac{2}{3}k 
\end{bmatrix}\tag{110}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>In the literature, though, you will mostly find it defined the other way around, i.e. all terms multiplied by (-1). It depends on how we define the Reynolds stress tensor in the momentum equation, i.e. if we add or subtract it on the right-hand side. I have added the Reynolds stress tensor on the right-hand side in Eq.(18), and so the Reynolds stresses themselves are negative (as they originate from the left-hand side of the momentum equation). Bringing them to the right-hand side makes them negative.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The version I'll be using, thus, is given as follows:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=
\begin{bmatrix}
-\overline{u'u'} & -\overline{u'v'} & -\overline{u'w'} \\[1em]
-\overline{v'u'} & -\overline{v'v'} & -\overline{v'w'} \\[1em]
-\overline{w'u'} & -\overline{w'v'} & -\overline{w'w'}
\end{bmatrix}=
\begin{bmatrix}
\frac{\partial u}{\partial x} - \frac{2}{3}k & -\nu_t \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right) & -\nu_t \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right) \\[1em]
-\nu_t \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right) & -2\nu_t\frac{\partial v}{\partial y} - \frac{2}{3}k & -\nu_t\left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right) \\[1em]
-\nu_t\left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right) & -\nu_t\left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right) & -2\nu_t\frac{\partial w}{\partial z} - \frac{2}{3}k 
\end{bmatrix}\tag{111}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, the individual Reynolds stresses can be computed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
-\overline{u'u'} = \frac{\partial u}{\partial x} - \frac{2}{3}k \\[1em]
-\overline{u'v'} = -\nu_t \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right) \\[1em]
-\overline{u'w'} = -\nu_t \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right) \\[1em]
-\overline{v'u'} = -\nu_t \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right) \\[1em]
-\overline{v'v'} = -2\nu_t\frac{\partial v}{\partial y} - \frac{2}{3}k \\[1em]
-\overline{v'w'} = -\nu_t\left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right) \\[1em]
-\overline{w'u'} = -\nu_t\left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right) \\[1em]
-\overline{w'v'} = -\nu_t\left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right) \\[1em]
-\overline{w'w'} = -2\nu_t\frac{\partial w}{\partial z} - \frac{2}{3}k \\[1em]
\tag{112}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can now insert Eq.(112) into the production term given in Eq.(107). This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}=
\begin{bmatrix}
\frac{\partial u}{\partial x} - \frac{2}{3}k & -\nu_t \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right) & -\nu_t \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right) \\[1em]
-\nu_t \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right) & -2\nu_t\frac{\partial v}{\partial y} - \frac{2}{3}k & -\nu_t\left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right) \\[1em]
-\nu_t\left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right) & -\nu_t\left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right) & -2\nu_t\frac{\partial w}{\partial z} - \frac{2}{3}k 
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y} & \frac{\partial u}{\partial z} \\[1em]
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y} & \frac{\partial v}{\partial z} \\[1em]
\frac{\partial w}{\partial x} & \frac{\partial w}{\partial y} & \frac{\partial w}{\partial z}
\end{bmatrix}\tag{113}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Carrying out the double dot tensor product, we obtain:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sum_{i=1}^3\sum_{j=1}^3\tau^{RANS}_{ij}(\nabla\mathbf{u})_{ij}=\\[1em]
\left[\frac{\partial u}{\partial x} - \frac{2}{3}k\right]\frac{\partial u}{\partial x} +
\left[-\nu_t \left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right)\right]\frac{\partial u}{\partial y} +
\left[-\nu_t \left( \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} \right)\right]\frac{\partial u}{\partial z} + \\[1em]
\left[-\nu_t \left( \frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} \right)\right]\frac{\partial v}{\partial x} +
\left[-2\nu_t\frac{\partial v}{\partial y} - \frac{2}{3}k\right]\frac{\partial v}{\partial y} +
\left[-\nu_t\left( \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} \right)\right]\frac{\partial v}{\partial z} + \\[1em]
\left[-\nu_t\left( \frac{\partial w}{\partial x} + \frac{\partial u}{\partial z} \right)\right]\frac{\partial w}{\partial x} +
\left[-\nu_t\left( \frac{\partial w}{\partial y} + \frac{\partial v}{\partial z} \right)\right]\frac{\partial w}{\partial y} +
\left[-2\nu_t\frac{\partial w}{\partial z} - \frac{2}{3}k\right]\frac{\partial w}{\partial z}\tag{114}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Sure, it is a long expression, but all of the quantities here are known. Here, [katex]u[/katex], [katex]v[/katex], and [katex]w[/katex] are the velocity components obtained from the momentum equations, and [katex]k[/katex] is taken from the previous iteration/time step. Then, we need to define the kinematic turbulent viscosity [katex]\nu_t[/katex], which is:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=k/\omega\tag{115}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Again, [katex]k[/katex] and [katex]\omega[/katex] are taken from the previous iteration/time step, or, if we are just starting the simulation, from the initial conditions. In this way, we can compute [katex]k[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What about the equation for [katex]\omega[/katex] then? Well, let's have a look. It is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial \omega}{\partial t}}_\text{Term 1} +
\underbrace{u\frac{\partial \omega}{\partial x} + v\frac{\partial \omega}{\partial y} + w\frac{\partial \omega}{\partial z}}_\text{Term 2}= \\[1em]
\underbrace{\frac{\partial}{\partial x}\left[\left(\nu+\sigma\nu_t\right)\frac{\partial \omega}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\sigma\nu_t\right)\frac{\partial \omega}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\sigma\nu_t\right)\frac{\partial \omega}{\partial z}\right]}_\text{Term 3} + 
\underbrace{\alpha\frac{\omega}{k}\tau^{RANS}:\nabla\mathbf{u}}_\text{Term 4} - 
\underbrace{\beta\omega^2}_\text{Term 5}
\tag{116}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We have our usual suspects here, i.e. a time derivative (Term 1), convection (Term 2), diffusion (Term 3), production (Term 4), and destruction (Term 5) of [katex]\omega[/katex], respectively. There isn't any mathematical derivation we can do here, as we have seen before, coming up with these equations requires a few steps:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol class="wp-block-list">

<!-- wp:list-item -->
<li>Decide which turbulent quantity we want to solve for (e.g. in this case [katex]k[/katex] and [katex]\omega[/katex])

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Write out a transport equation for each turbulent quantity

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Make some assumptions about how to model new unknown terms (e.g. a turbulent viscosity may be expressed from a velocity and length scale)

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>Introduce a healthy portion of closure coefficients so you can blame wrong results later on incorrectly tuned closure coefficients. +1 respect if you introduce your model without stating any values for your closure coefficients (so you can blame others later). Your model is perfect, of course, it is the end user who is too stupid to use/calibrate it right! ...

</li>
<!-- /wp:list-item -->
</ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>So, that is what Wilcox did, in a sense, though he provided values for his closure coefficients (-1 respect, sad emoji). His reasoning is no better or worse than Prandtl's logic in deriving his [katex]k[/katex] equation (I'm sure he would disagree), but there you go.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For fun (yes, if you are doing CFD for some time, your definition of <em>fun</em> changes), let's compare Wilcox's [katex]\omega[/katex] equation against Kolmogorov's version of the [katex]\omega[/katex] equation. They are actually different and yield some quite different results in different parts of the flow. Here it is:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{\frac{\partial \omega}{\partial t}}_\text{Term 1} +
\underbrace{u\frac{\partial \omega}{\partial x} + v\frac{\partial \omega}{\partial y} + w\frac{\partial \omega}{\partial z}}_\text{Term 2}= \\[1em]
\underbrace{\frac{\partial}{\partial x}\left[\nu_t\frac{\partial \omega}{\partial x}\right] + \frac{\partial}{\partial y}\left[\nu_t\frac{\partial \omega}{\partial y}\right] + \frac{\partial}{\partial z}\left[\nu_t\frac{\partial \omega}{\partial z}\right]}_\text{Term 3} - 
\underbrace{\beta\omega^2}_\text{Term 4}
\tag{117}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>There are two obvious differences here:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>First of all, there is no production term. Wilcox's [katex]\omega[/katex] equation, i.e. Eq.(116) has 5 terms, while Kolmogorov's [katex]\omega[/katex] equation, i.e. Eq.(117) has only 4 terms.

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>There is no laminar viscosity in the diffusion term, only the turbulent viscosity [katex]\nu_t[/katex].

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Kolmogorov stated that [katex]\omega[/katex], i.e. a form of dissipation, is linked with the smallest of scales. Our understanding of turbulence is that turbulent eddies are produced by the non-linear term at the largest length scales of the flow, then dissipate their energy to the smallest scales, where the dissipation takes over and turns turbulent motion into heat.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Kolmogorov stated that since [katex]\omega[/katex] is associated with the dissipation of the smallest scales, it can't have a production term, as production of turbulence happens at a vastly larger length scale. However, this logic is flawed as the dissipation is largely determined by the motion of the largest scales.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, if we run air through a wind tunnel, some background turbulence will be generated, which will then be matched and balanced by the dissipation. If we now introduce some imperfections (e.g. rough floor, a skewdriver left behind after adjusting the model, or even just leaving the door in the test section open), we will introduce more turbulence, and that has to be matched by an increased rate of dissipation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So what is the issue of leaving out the laminar viscosity, i.e. replacing [katex]\nu+\sigma\nu_t[/katex] by simply [katex]\nu_t[/katex]? Well, in the farfield, there isn't any issue, as we typically have [katex]\nu_t\gg\nu[/katex]. In turbulent wakes, [katex]\nu_t[/katex] can be several orders of magnitude larger than [katex]\nu[/katex]. However, as we approach a solid wall, we have a no-slip condition, meaning that the velocity goes to zero close to the wall. If all other properties remain the same, a decrease in velocity will decrease the Reynolds number.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This means that we eventually reach laminar flow very close to the wall, where the viscosity dominates. This is known as the viscous sublayer and typically in the region of [katex] y^+ < 5 [/katex]. Thus, here [katex]\nu[/katex] will be much larger than [katex]\nu_t[/katex] and so omitting [katex]\nu[/katex] from the [katex]\omega[/katex] equation, as Kolmogorov did, means that we can no longer model flow near walls with great accuracy.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And this is the [katex]k-\omega[/katex] model for you. Again, we model two transport equations for [katex]k[/katex] and [katex]\omega[/katex], and we can use the obtained quantities of [katex]k[/katex] and [katex]\omega[/katex] to compute the turbulent viscosity [katex]\nu_t[/katex], which we can then substitute into our Boussinesq hypothesis for the Reynolds stresses.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Unlike the [katex]k-\varepsilon[/katex] model, the [katex]k-\omega[/katex] model has been shown to behave well near walls, and for wall-bounded flows this model is typically favoured (i.e. whenever you need skin friction or viscous drag prediction, you want to use a variant of the [katex]k-\omega[/katex] model, not the [katex]k-\varepsilon[/katex]). The [katex]k-\omega[/katex] model, though, suffers from a strong dependence on its freestream (inlet boundary) conditions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, both models suffer from sone limitations, and strong believers in the [katex]k-\varepsilon[/katex] model were quick to point out the shortcomings of the [katex]k-\omega[/katex] model, and vice versa. That is, until another German entered the picture, dethroning Prandtl in the world of turbulence research and modelling and uniting turbulence research communities. I am speaking, of course, about Florian Menter. If you have no idea who Menter is, let me share with you his LinkedIn summary. I think this summarises his accomplishments best:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5504,"sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full"><img src="https://cfd.university/wp-content/uploads/2026/04/florian_menter.png" alt="" class="wp-image-5504"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Look at his skills, I am sure they are listed in descending order of competency. Turbulence modelling is last. Either Menter is very modest about his own accomplishments and skills, or he is a Microsoft Excel wizard (on steroids). So, who is this Excel power user with a healthy portion of strategic planning abilities? Let us look at his celebrated [katex]k-\omega[/katex] SST model in the next section.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">The [katex]k-\omega[/katex] SST model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>If you have started with CFD in the past few years and were looking for advice on which turbulence model to select out of the countless options available, chances are someone suggested to you to start with the [katex]k-\omega[/katex] SST model, and for good reasons! Let's look at its history for a bit.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When Menter introduced his [katex]k-\omega[/katex] SST in the 1990s, we had about 20 years of experience with the [katex]k-\varepsilon[/katex] model, and some less but still substantial experience with the [katex]k-\omega[/katex] model from <s>Kolmogorov</s> Wilcox. At this point, we had collected a fair bit of information on the strengths and weaknesses of each model, and so best practices were emerging for when to use which model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As mentioned above, the [katex]k-\omega[/katex] model was known for being heavily dependent on the freestream parameters, and so uncertainties for determining inflow boundary conditions would translate to vastly different predictions of the turbulent Reynolds stresses. This isn't exactly ideal. However, close to the wall, the [katex]k-\omega[/katex] model was providing pretty good (and robust) results.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The picture for the [katex]k-\varepsilon[/katex] model was somewhat different. It provided fairly good results in the farfield, and it was less susceptible to changes in freestream conditions, which are imposed at inflow boundaries. However, the model was formulated in a way that would overpredict turbulent stresses near the wall, and thus, velocity gradients would not be accurately captured. Given that the velocity gradient at the wall is used to determine things like drag force and separation points, this was bad, especially for aeronautical flows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, whenever results near walls were required, [katex]k-\omega[/katex] was preferred while [katex]k-\varepsilon[/katex] was used if flow away from walls was of most interest (e.g. wakes or shear layer flows).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, let us look closer at the quantities that are used in each model. Both use the same transport equation for the turbulent kinetic energy [katex]k[/katex], but they model the destruction of [katex]k[/katex] differently:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>In the [katex]k-\varepsilon[/katex] model, we solve for [katex]\varepsilon[/katex], which is the rate of dissipation of turbulent kinetic energy

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>In the [katex]k-\omega[/katex] model, we solve for [katex]\omega[/katex], which is the specific turbulence dissipation rate

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>We already saw that both [katex]\varepsilon[/katex] and [katex]\omega[/katex] represent the process of dissipation and they have a functional relationship, i.e. see Eq.(105). So Meter came up with an idea: What if we use the transport equation for [katex]\varepsilon[/katex] but insert the functional relationship to [katex]\omega[/katex] into the equation? We can then re-derive the [katex]\omega[/katex] equation. This new transport equation should hopefully look similar to the [katex]\omega[/katex] equation from the [katex]k-\omega[/katex] model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, as it turns out, they are not exactly the same, but, we can introduce a blending function to smoothly blend between the two different [katex]\omega[/katex] equations. Doing that will allow us to smoothly blend between the [katex]k-\varepsilon[/katex] model (now [katex]\varepsilon[/katex] is expressed in terms of [katex]\omega[/katex]) and the [katex]k-\omega[/katex] model. If we can blend between the two models, then we can switch between [katex]k-\omega[/katex] near the wall and [katex]k-\varepsilon[/katex] away from the wall so that we only turn on each model in the region of the flow where they perform best.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this way, we can remove all of the shortcomings of both models and create a somewhat super model, <em>a model to rule them all</em>. As we will see, the [katex]k-\omega[/katex] SST model is really powerful and provides good results for a large range of applications. It is the default turbulence model for a lot of CFD solvers, and if you ever run some RANS simulations, this is usually a good model to start with in the absence of any other pointers.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So let's look at how we can derive this model. I will take a step-by-step approach here, as I was looking for some time but could not find a decent derivation anywhere. It is not complicated, but with the information available in the public domain, even this <em>simple</em> derivation can be challenging. Hopefully, you'll appreciate the model after the derivation a bit more, and some of the terms will start to make more sense and not seem just randomly plugged out of thin air.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>First of all, when Menter introduced his [katex]k-\omega[/katex] SST model, he introduced 2 models at the same time. He labelled them the Baseline (BSL) [katex]k-\omega[/katex] model and the [katex]k-\omega[/katex] SST model. Both models use the same derivation to obtain the [katex]\omega[/katex] equation, the only difference is in how the turbulent viscosity [katex]\nu_t[/katex] is calculated, which in the SST (shear-stress transport) model is vastly different to the usual Boussinesq eddy viscosity hypothesis.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We start with the transport equation for the turbulent kinetic energy [katex]k[/katex]. This is given in scalar form as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} +
u\frac{\partial k}{\partial x} + v\frac{\partial k}{\partial y} + w\frac{\partial k}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\sigma^*\nu_t\right)\frac{\partial k}{\partial z}\right] + P - \beta^* k\omega\tag{118}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Our derivations will be long enough, so instead of keeping the scalar representation, I'll opt to transform this equation into vector (nabla) form. I appreciate this may be somewhat annoying for some, as most literature uses tensor notation instead of vector notation. There are pros and cons for each, though my personal preference is to use vector notation. Therefore, we can transform the scalar representation of the [katex]k[/katex] equation into vector (nabla) form, which is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} + (\mathbf{u}\cdot\nabla)k = \nabla\cdot\left[\left(\nu+\sigma^*\nu_t\right)\nabla k\right] + P - \beta^* k\omega\tag{119}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, the production term is given by:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}\tag{120}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We looked at how to expand this equation before, i.e. see Eq.(107). For completeness, if you look at the turbulence literature which uses tensor notation, you will see this term expressed as</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}=\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j}\tag{121}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>They are one and the same thing. If you don't believe me, the best way to get a feeling here is to expand these terms. Eq.(107) and those that follow it show how to deal with [katex]\tau^{RANS}:\nabla\mathbf{u}[/katex], and if you expand the right-hand side, you will see that you get the same result. Remember that in tensor notation, we use the Einstein summation convention, where summations are dropped. Thus, without the Einstein summation convention, we could also write this term as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sum_{i=1}^D\sum_{j=1}^D\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j}\tag{122}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]D[/katex] is the dimension of the flow, i.e. either 1, 2, or 3 (dimensional). If we set [katex]D=3[/katex], then we can expand the above as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sum_{i=1}^3\sum_{j=1}^3\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j} = 
\tau^{RANS}_{11}\frac{\partial u_1}{\partial x_1} + \tau^{RANS}_{12}\frac{\partial u_1}{\partial x_2} + \tau^{RANS}_{13}\frac{\partial u_1}{\partial x_3} + \\[1em]
\tau^{RANS}_{21}\frac{\partial u_2}{\partial x_1} + \tau^{RANS}_{22}\frac{\partial u_2}{\partial x_2} + \tau^{RANS}_{23}\frac{\partial u_2}{\partial x_3} + \\[1em]
\tau^{RANS}_{31}\frac{\partial u_3}{\partial x_1} + \tau^{RANS}_{32}\frac{\partial u_3}{\partial x_2} + \tau^{RANS}_{33}\frac{\partial u_3}{\partial x_3}\tag{123}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we now set [katex]u_1=u[/katex], [katex]u_2=v[/katex], [katex]u_3=w[/katex], as well as [katex]x_1=x[/katex], [katex]x_2=y[/katex], and [katex]x_3=z[/katex], then we can express the above as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sum_{i=1}^3\sum_{j=1}^3\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j} = 
\tau^{RANS}_{11}\frac{\partial u}{\partial x} + \tau^{RANS}_{12}\frac{\partial u}{\partial y} + \tau^{RANS}_{13}\frac{\partial u}{\partial z} + \\[1em]
\tau^{RANS}_{21}\frac{\partial v}{\partial x} + \tau^{RANS}_{22}\frac{\partial v}{\partial y} + \tau^{RANS}_{23}\frac{\partial v}{\partial z} + \\[1em]
\tau^{RANS}_{31}\frac{\partial w}{\partial x} + \tau^{RANS}_{32}\frac{\partial w}{\partial y} + \tau^{RANS}_{33}\frac{\partial w}{\partial z}\tag{124}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we now also insert the definition of the Reynolds stresses, i.e. [katex]\tau^{RANS}_{ij}=-\overline{u_i'u_j'}[/katex], then we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sum_{i=1}^3\sum_{j=1}^3\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j} = 
-\overline{u'u'}\frac{\partial u}{\partial x} -\overline{u'v'}\frac{\partial u}{\partial y} -\overline{u'w'}\frac{\partial u}{\partial z} + \\[1em]
-\overline{v'u'}\frac{\partial v}{\partial x} -\overline{v'v'}\frac{\partial v}{\partial y} -\overline{v'w'}\frac{\partial v}{\partial z} + \\[1em]
-\overline{w'u'}\frac{\partial w}{\partial x} -\overline{w'v'}\frac{\partial w}{\partial y} -\overline{w'w'}\frac{\partial w}{\partial z}\tag{125}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We see that we are now just multiplying the components of two vectors together, i.e. the Reynolds stress tensor [katex]\tau^{RANS}[/katex] and the velocity gradient tensor [katex]\nabla\mathbf{u}[/katex]. We can separate them again and write the equation as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}=
\begin{bmatrix}
-\overline{u'u'} & -\overline{u'v'} & -\overline{u'w'} \\[1em]
-\overline{v'u'} & -\overline{v'v'} & -\overline{v'w'} \\[1em]
-\overline{w'u'} & -\overline{w'v'} & -\overline{w'w'}
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y} & \frac{\partial u}{\partial z} \\[1em]
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y} & \frac{\partial v}{\partial z} \\[1em]
\frac{\partial w}{\partial x} & \frac{\partial w}{\partial y} & \frac{\partial w}{\partial z}
\end{bmatrix}\tag{126}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Compare this with Eq.(107), which was given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=
\begin{bmatrix}
-\overline{u'u'} & -\overline{u'v'} & -\overline{u'w'} \\[1em]
-\overline{v'u'} & -\overline{v'v'} & -\overline{v'w'} \\[1em]
-\overline{w'u'} & -\overline{w'v'} & -\overline{w'w'}
\end{bmatrix}
:
\begin{bmatrix}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y} & \frac{\partial u}{\partial z} \\[1em]
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y} & \frac{\partial v}{\partial z} \\[1em]
\frac{\partial w}{\partial x} & \frac{\partial w}{\partial y} & \frac{\partial w}{\partial z}
\end{bmatrix}\tag{127}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, we have shown that the equality:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\tau^{RANS}:\nabla\mathbf{u}=\tau^{RANS}_{ij}\frac{\partial u_i}{\partial x_j}\tag{128}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>does indeed hold, and we have seen how the vector and tensor notation represent one and the same thing. I point this out here as the production term looks drastically different in these two notations. Fortunately, the remaining terms look quite similar. But, without this little bit of detail, you may not be able to match my equation and derivation with that of what you see in other places.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The [katex]\varepsilon[/katex] equation in the [katex]k-\varepsilon[/katex] model was given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \varepsilon}{\partial t} +
u\frac{\partial \varepsilon}{\partial x} + v\frac{\partial \varepsilon}{\partial y} + w\frac{\partial \varepsilon}{\partial z}= \\[1em]
\frac{\partial}{\partial x}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial x}\right] + \frac{\partial}{\partial y}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial y}\right] + \frac{\partial}{\partial z}\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\frac{\partial \varepsilon}{\partial z}\right] + 
C_{1\varepsilon}\frac{\varepsilon}{k}2\nu_t\mathbf{S}:\nabla\mathbf{u} - C_{2\varepsilon}\frac{\varepsilon^2}{k}\tag{129}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Again, we transform it to vector (nabla) notation, which reads:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \varepsilon}{\partial t} + (\mathbf{u}\cdot\nabla)\varepsilon = \nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla \varepsilon\right] + 
C_{1\varepsilon}\frac{\varepsilon}{k}P - C_{2\varepsilon}\frac{\varepsilon^2}{k}
\tag{130}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now comes the crucial bit. We say that we can relate the rate of dissipation of turbulent kinetic energy [katex]\varepsilon[/katex] to the specific turbulence dissipation rate [katex]\omega[/katex] using the following relationship:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\varepsilon = \beta^*k\omega
\tag{131}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If you looked at Eq.(105), we defined [katex]\omega[/katex] in terms of [katex]\varepsilon[/katex], i.e. the other way around. If you do that, you will have the parameter [katex]C_\mu[/katex] instead of [katex]\beta^<em>[/katex]. If you look up their values, though, both are set to a value of [katex]C_\mu=\beta^</em>=0.09[/katex]. Different names for the same thing. Eq.(105) and Eq.(131) are the same; they just use different symbols.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can insert this relationship (Eq.(131)) into the [katex]\varepsilon[/katex] equation. i.e. Eq.(130). Doing so will produce the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \beta^*k\omega}{\partial t} + (\mathbf{u}\cdot\nabla)(\beta^*k\omega) = \nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla (\beta^*k\omega)\right] + 
C_{1\varepsilon}\frac{\beta^*k\omega}{k}P - C_{2\varepsilon}\beta^{*2} k \omega^2\tag{132}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>let us simplify this equation by dividing by [katex]\beta^*[/katex], which results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k\omega}{\partial t} + (\mathbf{u}\cdot\nabla)(k\omega) = \nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla (k\omega)\right] + 
C_{1\varepsilon}\frac{k\omega}{k}P - C_{2\varepsilon}\beta^* k \omega^2
\tag{133}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now, let's look at the product rule definition. From high school, you may remember the product rule for derivatives to be stated as something like this: [katex](uv)' = u'v + uv'[/katex], i.e. here [katex]u[/katex] and [katex]v[/katex] are both functions of which we want to take the derivative. If the derivative of the product is required, then we have to differentiate each term in turn, resulting in the product rule of the form [katex](uv)' = u'v + uv'[/katex]. But, we can also extend that to a different notation, i.e. using partial derivatives, which can be expressed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial uv}{\partial x} = \frac{\partial u}{\partial x}v + u\frac{\partial v}{\partial x}\\[1em]
\frac{\partial uv}{\partial t} = \frac{\partial u}{\partial t}v + u\frac{\partial v}{\partial t}\\[1em]
\nabla(uv) = (\nabla u)v + u(\nabla v)\tag{134}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We now need to apply this product rule to each derivative in the new [katex]\omega[/katex] equation. i.e. Eq.(133). For the first term, the time derivative, we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k\omega}{\partial t} = \omega\frac{\partial k}{\partial t} + k\frac{\partial \omega}{\partial t}
\tag{135}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>For the non-linear, or convective term, we have the following:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
(\mathbf{u}\cdot\nabla)(k\omega) = (\omega\mathbf{u}\cdot\nabla)k + (k\mathbf{u}\cdot\nabla)\omega
\tag{136}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Note that when we take the derivative of either [katex]k[/katex] or [katex]\omega[/katex], we treat the variable which we are not differentiating as a constant. We can always take out constants of the differentiation, and so I have opted to write these constants in front of the derivative, as is commonly done in the literature.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's turn our attention to the diffusion term now. It was given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla (k\omega)\right]\tag{137}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, we have the term [katex]\nabla (k\omega)[/katex]. Let us expand this first:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla (k\omega) = \omega\nabla k + k\nabla \omega\tag{138}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Both [katex]\nabla k[/katex] and [katex]\nabla \omega[/katex] will become vectors. Thus, if we look at each term, i.e. [katex]\omega\nabla k[/katex] and [katex]k\nabla \omega[/katex], we have a product of a scalar and a vector. Let's insert this into our diffusion term, which yields:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)(\omega\nabla k + k\nabla \omega)\right]\tag{139}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The viscosity does not depend on either [katex]k[/katex] or [katex]\omega[/katex], so it is essentially a constant, and we can move it out of the bracket. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla\cdot(\omega\nabla k + k\nabla \omega)
\tag{140}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now we have the divergence operator [katex]\nabla\cdot[/katex] multiplying the terms [katex]\omega\nabla k[/katex] and [katex]k\nabla \omega[/katex], which we stated before are a multiplication of a scalar and a vector. For this, we have the following vector identity:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot(\phi\mathbf{A})=(\nabla\phi)\cdot\mathbf{A} + \phi\nabla\cdot\mathbf{A}\tag{141}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Furthermore, we have a vector identity that the divergence operator [katex]\nabla\cdot[/katex] applied to the gradient operator [katex]\nabla[/katex], i.e. [katex]\nabla\cdot\nabla[/katex], results in the Laplacian operator [katex]\nabla^2[/katex]. For a given scalar [katex]\phi[/katex], this can be expressed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot\nabla\phi = \nabla^2\phi\tag{142}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Therefore, we can carry out the differentiation for each term in Eq.(140) as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot(\omega\nabla k) = \nabla \omega\nabla k + \omega \nabla k^2\\[1em]
\nabla\cdot(k\nabla \omega) = \nabla k \nabla \omega + k\nabla^2 \omega\tag{143}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Putting this together, we obtain:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot(\omega\nabla k + k\nabla \omega) = \nabla \omega\nabla k + \omega \nabla k^2 + \nabla k \nabla \omega + k\nabla^2 \omega = \omega \nabla k^2 + k\nabla^2 \omega + 2\nabla \omega\nabla k\tag{144}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can now put this result back into our diffusion operator and have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)(\omega\nabla k + k\nabla \omega)\right] = \left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\omega \nabla k^2 + k\nabla^2 \omega + 2\nabla \omega\nabla k\right)
\tag{145}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The production and destruction terms in Eq.(130) remain the same, as these do not provide derivatives in terms of either [katex]k[/katex] or [katex]\omega[/katex], and thus we do not need to worry about any product rule here. Now we insert the expanded time derivative (Eq.(135)), the expanded convective term (Eq.(136)), and the expanded diffusion term (Eq.(145)) back into Eq.(133), which then provides:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\omega\frac{\partial k}{\partial t} + k\frac{\partial \omega}{\partial t} + (\omega\mathbf{u}\cdot\nabla)k + (k\mathbf{u}\cdot\nabla)\omega = \\[1em]\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\omega \nabla k^2 + k\nabla^2 \omega + 2\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}\frac{k\omega}{k}P - C_{2\varepsilon}\beta^* k \omega^2\tag{146}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now let's rearrange this equation. We will collect all terms involving a derivative of [katex]k[/katex] on the left-hand side, and all terms involving derivatives of [katex]\omega[/katex] on the right-hand side. Mixed derivatives, as well as production and destruction terms, will also be moved to the right-hand side. This step isn't really required in the derivation, but it helps us organise the now somewhat longer equation. We get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\omega\frac{\partial k}{\partial t} + (\omega\mathbf{u}\cdot\nabla)k - \left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\omega \nabla k^2\right)  = \\[1em]
-k\frac{\partial \omega}{\partial t} - (k\mathbf{u}\cdot\nabla)\omega +
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(k\nabla^2 \omega + 2\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}\frac{k\omega}{k}P - C_{2\varepsilon}\beta^* k \omega^2\tag{147}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Next, we simplify this equation by dividing by [katex]\omega[/katex]. This produces:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} + (\mathbf{u}\cdot\nabla)k - \left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nabla k^2\right)  = \\[1em]
-\frac{k}{\omega}\frac{\partial \omega}{\partial t} - \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega +
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}\frac{k\omega}{k\omega}P - C_{2\varepsilon}\beta^* k \frac{\omega^2}{\omega}\tag{148}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let us also simplify the production and destruction term, by carrying out the division of [katex]k[/katex] and [katex]\omega[/katex]. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} + (\mathbf{u}\cdot\nabla)k - \left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nabla k^2\right)  = \\[1em]
-\frac{k}{\omega}\frac{\partial \omega}{\partial t} - \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega +
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}P - C_{2\varepsilon}\beta^* k \omega
\tag{149}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We now have a time derivative, a spatial (convective) derivative, and a spatial (diffusive) derivative of [katex]k[/katex] in our equation. These are the same terms appearing in the transport equation for [katex]k[/katex]. Let us solve this transport equation, i.e. Eq.(\tag{82}), from the [katex]k-\varepsilon[/katex] model, for the time derivative of [katex]k[/katex]. This gives us:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} = - (\mathbf{u}\cdot\nabla)k + \nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_k}\right)\nabla k\right] + P - \beta^* k\omega\tag{150}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We said that the viscosity is constant, and so we can place it in front of the divergence operator of the diffusion term, and then carry out the divergence and gradient operators to produce the Laplacian operator, as we have done before. This results in the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial k}{\partial t} = - (\mathbf{u}\cdot\nabla)k + \left(\nu+\frac{\nu_t}{\sigma_k}\right)\nabla^2 k + P - \beta^* k\omega
\tag{151}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can take Eq.(151) and insert that into Eq.(149), which produces:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\underbrace{- (\mathbf{u}\cdot\nabla)k + \left(\nu+\frac{\nu_t}{\sigma_k}\right)\nabla^2 k + P - \beta^* k\omega}_{\partial k/\partial t} + (\mathbf{u}\cdot\nabla)k - \left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nabla k^2\right)  = \\[1em]
-\frac{k}{\omega}\frac{\partial \omega}{\partial t} - \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega +
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}P - C_{2\varepsilon}\beta^* k \omega
\tag{152}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>On the left-hand side, we have now convection and diffusion of the same magnitude and opposite signs, so these term cancels out. Therefore, Eq.(152) becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P - \beta^* k\omega = \\[1em]
-\frac{k}{\omega}\frac{\partial \omega}{\partial t} - \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega +
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}P - C_{2\varepsilon}\beta^* k \omega
\tag{153}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We can now take Eq.(153) and re-arrange it into the canonical form of a transport equation, that is, the time derivative of [katex]\omega[/katex], as well as its convection will be placed on the left-hand side, while the production and destruction terms will be located on the right-hand side. This results in the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{k}{\omega}\frac{\partial \omega}{\partial t} + \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega = \\[1em]
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
C_{1\varepsilon}P - C_{2\varepsilon}\beta^* k \omega - P + \beta^* k\omega
\tag{154}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's clean up the production and dissipation terms next. For the production and destruction term, we have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
C_{1\varepsilon}P - P = P(C_{1\varepsilon}-1)\\[1em]
-C_{2\varepsilon}\beta^* k \omega + \beta^* k\omega = \beta^* k\omega(1 - C_{2\varepsilon})\tag{155}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now let's look at the closure coefficients. We have [katex]C_{1\varepsilon}-1[/katex] for the production term and [katex]1 - C_{2\varepsilon}[/katex] for the destruction term. Since [katex]C_{1\varepsilon}[/katex] and [katex]C_{2\varepsilon}[/katex] are constants, after we add or subtract another constant from them, they remain constant. Thus, we may simply replace them with another constant to simplify things. Menter does not specify this explicitly, but if you derive the equations, then this is what you have to do to match his equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Therefore, we have to introduce the new closure coefficient [katex]\gamma[/katex], which will absorb the contribution of [katex]C_{1\varepsilon}-1[/katex] in the production term. For the destruction term, we absorb the contribution of [katex]1 - C_{2\varepsilon}[/katex] into [katex]\beta[/katex]. Our new production and destruction terms become:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P(C_{1\varepsilon}-1) = \gamma P\\[1em]
\beta^* k\omega(1 - C_{2\varepsilon}) = \beta^* k\omega\tag{156}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we look up values for [katex]C_{1\varepsilon}[/katex], [katex]C_{2\varepsilon}[/katex], [katex]\gamma[/katex], and [katex]\beta^*[/katex], we can compute values for these terms according to <a href="https://arc.aiaa.org/doi/10.2514/3.12149" target="_blank" rel="noopener" title="">Menter</a>:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
(C_{1\varepsilon}-1)=1.44-1=0.44\\[1em]
\gamma = \frac{\beta_1}{\beta^*}-\sigma_{\omega 1}\kappa^2\sqrt{\beta^*}=\frac{0.075}{0.09}-0.5\cdot 0.41\sqrt{0.09}=0.808\\[1em]
(1 - C_{2\varepsilon}) = 1 - 1.92 = -0.92\\[1em]
\beta^*=0.09\tag{157}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So the first two terms have a difference of about a factor of 2. This is acceptable, as these closure coefficients are subject to fine tuning. However, the third and fourth are vastly different. There is some conflicting notation in the literature, and the following definition is also sometimes used instead of [katex]\beta^*[/katex] in the destruction term:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\beta^*=\gamma = \frac{\beta_2}{\beta^*}-\sigma_{\omega 2}\kappa^2\sqrt{\beta^*}=\frac{0.0828}{0.09}-0.856\cdot 0.41\sqrt{0.09}=0.877\tag{158}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>If we take the absolute value of [katex](1 - C_{2\varepsilon}) = -0.92[/katex], then this compares well. Unfortunately, there isn't any information on how the closure coefficients were obtained (or, at least, it isn't easy to locate, i.e. there might be some information hidden in an old technical report I haven't seen). This is somewhat frustrating, but as long as we accept that the determination of closure coefficients is always just a curve-fitting exercise, we do not need to get too carried away about their absolute value.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can now insert the new definitions for the production and destruction term into Eq.(154), which yields:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{k}{\omega}\frac{\partial \omega}{\partial t} + \left(\frac{k}{\omega}\mathbf{u}\cdot\nabla\right)\omega =
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\frac{k}{\omega}\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
\gamma P - \beta^* k\omega
\tag{159}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now we introduce the relation for the turbulent viscosity, which is given as [katex]\nu_t=k/\omega[/katex]. Let us insert this definition into Eq.(159), which results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t\frac{\partial \omega}{\partial t} + \left(\nu_t\mathbf{u}\cdot\nabla\right)\omega =
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nu_t\nabla^2 \omega + \frac{2}{\omega}\nabla \omega\nabla k\right)+ 
\gamma P - \beta^* k\omega
\tag{160}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Now we can divide by [katex]\nu_t[/katex]:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \omega}{\partial t} + \left(\mathbf{u}\cdot\nabla\right)\omega =
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nabla^2 \omega + \frac{2}{\nu_t\omega}\nabla \omega\nabla k\right) + 
\frac{\gamma P}{\nu_t} - \frac{\beta}{\nu_t}^* k\omega
\tag{161}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let us look at the destruction term again. We can rewrite this, using the definition of [katex]\nu_t=k/\omega[/katex] as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\beta}{\nu_t}^* k\omega = \beta^*\frac{\omega}{k} k\omega = \beta^*\omega^2
\tag{162}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let us also expand the diffusion term at this point. This can be written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right) \left(\nabla^2 \omega + \frac{2}{\nu_t\omega}\nabla \omega\nabla k\right) = \underbrace{\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla^2 \omega}_\text{Term 1} + \underbrace{\nu\frac{2}{\nu_t\omega}\nabla \omega\nabla k}_\text{Term 2} + \underbrace{\frac{\nu_t}{\sigma_\varepsilon}\frac{2}{\nu_t\omega}\nabla \omega\nabla k}_\text{Term 3}
\tag{163}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, term 1 is just the diffusive term that we also have in the [katex]\omega[/katex] equation from the [katex]k-\omega[/katex] model. Term 2 contains a fraction of [katex]\nu/\nu_t[/katex]. For a fully turbulent flow, it is common for the turbulent viscosity to be several orders of magnitude larger than the laminar viscosity, that is, [katex]\nu_t\gg\nu[/katex]. Therefore, we would expect the ratio [katex]\nu/\nu_t[/katex] in Term 2 to go to zero, and this is an assumption Menter is making in his [katex]k-\omega[/katex] SST model. Therefore, Term 2 is cancelled from the diffusion term.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Term 3 is interesting in that it appears after we insert [katex]\varepsilon = \beta^*k\omega[/katex], i.e. Eq.(131) into the [katex]\varepsilon[/katex] equation, i.e. Eq.(86). This new term, referred to as the cross-diffusion term, does not vanish and has to be included in the [katex]k-\omega[/katex] SST model. Thus, we can now write Eq.(161) using the definitions from Eq.(162) and Eq.(163) as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \omega}{\partial t} + \left(\mathbf{u}\cdot\nabla\right)\omega =
\left(\nu+\frac{\nu_t}{\sigma_\varepsilon}\right)\nabla^2 \omega + \frac{2}{\sigma_\varepsilon\omega}\nabla \omega\nabla k +
\frac{\gamma}{\nu_t}P - \beta^*\omega^2\tag{164}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Notice how [katex]\nu_t[/katex] appeared in the numerator and denominator of the cross-diffusion term and thus disappeared. Let's apply some finishing touches. First, we will change some closure coefficients. Since these represent empirical correlations we can measure in wind tunnels, we can arbitrarily add and remove them. We will also write the diffusion term in its more common notation using the divergence and gradient operators, instead of the Laplacian operator. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \omega}{\partial t} + \left(\mathbf{u}\cdot\nabla\right)\omega =
\nabla\cdot\left[\left(\nu+\sigma_\omega\nu_t\right)\nabla \omega\right] + \sigma_{\omega2}\frac{2}{\omega}\nabla \omega\nabla k +
\frac{\gamma}{\nu_t}P - \beta\omega^2
\tag{165}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's compare that with the transport equation for [katex]\omega[/katex] from the [katex]k-\omega[/katex] model, i.e. Eq.(116). This equation was given in scalar form (i.e. all derivatives were explicitly written for the [katex]x[/katex], [katex]y[/katex], and [katex]z[/katex] directions). If we reformulate it into vector (nabla) notation, we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \omega}{\partial t} + \left(\mathbf{u}\cdot\nabla\right)\omega =
\nabla\cdot\left[\left(\nu+\sigma_\omega\nu_t\right)\nabla \omega\right] + \alpha\frac{\omega}{k}P - \beta\omega^2
\tag{166}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>With [katex]\alpha=\gamma[/katex] and noting that [katex]\omega/k=1/\nu_t[/katex], we see that Eq.(165) and Eq.(166) are identical, apart from the appearance of the cross-diffusion term.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This was a lengthy derivation, but we managed to derive Menter's baseline (BSL) [katex]k-\omega[/katex] model, which we will augment in a second with a shear-stress transport (SST) assumption. But before we do that, remember what our goal was: We wanted to reformulate the [katex]\varepsilon[/katex] equation in terms of [katex]\omega[/katex]. We have achieved that and the result is shown in Eq.(165). That is, if we solve Eq.(165) now, together with the equation for [katex]k[/katex], we are really solving the [katex]k-\varepsilon[/katex] model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, Eq.(165) is formulated in terms of [katex]\omega[/katex], as is the [katex]\omega[/katex] equation from the [katex]k-\omega[/katex] model, i.e. Eq.(166). Thus, we can now introduce our hybrid [katex]k-\varepsilon[/katex] / [katex]k-\omega[/katex] using a blending function. This is achieved in the following way:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \omega}{\partial t} + \left(\mathbf{u}\cdot\nabla\right)\omega =
\nabla\cdot\left[\left(\nu+\sigma_\omega\nu_t\right)\nabla \omega\right] + (1-F_1)\sigma_{\omega2}\frac{2}{\omega}\nabla \omega\nabla k +
\frac{\gamma}{\nu_t}P - \beta\omega^2
\tag{167}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The only change we have done here is to insert a new blending function [katex](1-F_1)[/katex]. The goal is to formulate a function for [katex]F_1[/katex] that is 1 close to the wall and 0 away from the wall. Thus, if [katex]F_1=1[/katex], the blending function evaluates to [katex]1-F_1=1-1=0[/katex]. This means the cross diffusion term is multiplied by zero and effectively removed from the equation. This recovers the [katex]\omega[/katex] equation from the [katex]k=\omega[/katex] model. In contrast, if [katex]F_1=0[/katex], then [katex]1-0=1[/katex], and so the cross diffusion term is multiplied by 1, recovering the [katex]k=\varepsilon[/katex] model's behaviour.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The [katex]F_1[/katex] function is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
F_1 = \tanh\left(arg_1^4\right)\tag{168}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The argument to the hyperbolic tangent function is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
arg_1 = \min\left[\max\left(\frac{\sqrt{k}}{0.09\omega d};\frac{500\nu}{\omega d^2}\right); \frac{4\rho\sigma_{\omega 2}k}{CD_{k\omega}d^2}\right]\tag{169}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Each term contains a dependence on [katex]d[/katex], i.e. each term is either divided by [katex]d[/katex] or [katex]d^2[/katex]. The parameter [katex]d[/katex] is the distance to the closest wall in the domain. Thus, as we move away from the wall, [katex]d[/katex] increases in magnitude and all terms eventually become zero. Thus, [katex]F_1[/katex] becomes zero, and so [katex]1-F_1=1-0=1[/katex]. Multiplying the cross diffusion term by this result, i.e. 1, means it is retained in the equation, and we have the [katex]k-\varepsilon[/katex] model, which we want to have away from the wall.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The cross diffusion term [katex]CD_{k\omega}[/katex] in the [katex]arg_1[/katex] function is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
CD_{k\omega}=\max\left(\rho\sigma_{\omega2}\frac{2}{\omega}\nabla \omega\nabla k; 10^{-10}\right)\tag{170}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This is the end of the derivation of the [katex]k-\omega[/katex] baseline (BSL) model. We could stop our derivation here, but Menter went one step further and introduced a different eddy viscosity hypothesis that moves away from Boussinesq. He based his new eddy viscosity assumption on the shear-stress transport hypothesis used in the <a href="https://arc.aiaa.org/doi/10.2514/3.9152" target="_blank" rel="noopener" title="">Johnson and King</a>, which originated from Bradshaw. Bradshaw stated that the shear stresses should be a scaled version of the turbulent kinetic energy:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau =  a_1 \rho k
\tag{171}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]a_1[/katex] is a closure coefficient. Of course it is, what would be a new hypothesis without at least one new closure coefficient? Always remember, you need to have a scapegoat in case your model fails to predict certain flows. I wished I had a closure coefficient in front of each exam mark I received, especially that bloody economics class (why I had to take economics classes and learn how to mortgage a house on an aerospace engineering degree is beyond me ... I failed the module (but I still managed to get a mortgage, so swings and roundabouts I suppose ...)).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Contrast that with Boussinesq's eddy viscosity:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau = \mu_t \Omega\tag{172}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\Omega[/katex] is the vorticity vector accounting for rotation. Hold on, did I not say that vorticity does not contribute to turbulent shear forces? Yes, I did, and so Menter revised this later in an <a href="https://www.researchgate.net/publication/228742295_Ten_years_of_industrial_experience_with_the_SST_turbulence_model" target="_blank" rel="noopener" title="">updated model</a>. Here, he states that the shear stresses are computed as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=\mu_t\sqrt{2\mathbf{S}:\mathbf{S}}
\tag{173}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, the term [katex]2\mathbf{S}:\mathbf{S}[/katex] represents the magnitude of the strain rate tensor (i.e. it is a scalar value). You would expect to be subtracting [katex](2/3)k\mathbf{I}[/katex] from this definition, but some models (as we will see in the next section as well) elect to omit this subtraction. In any case, the definition for the turbulent viscosity according to Menter's [katex]k-\omega[/katex] SST model is</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{a_1 k}{\max(a_1\omega; \sqrt{2\mathbf{S}:\mathbf{S}} F_2)}\tag{174}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's see what happens if either of these terms in the denominator is maximised. Let's assume the first term in the denominator, i.e. [katex]a_1\omega[/katex] is the maximum value. In this case, we would have:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{a_1 k}{a_1\omega}=\frac{k}{\omega}=\nu_t\tag{175}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>That is, we use [katex]k[/katex] and [katex]\omega[/katex] to compute the turbulent viscosity. Now [katex]\omega[/katex] will essentially only increase near solid walls, and so near walls we would expect this behaviour to dominate. Away from walls, we would expect [katex]\omega[/katex] to go to zero (or low values compared to values observed near walls). Thus, in the farfield, we would expect the second term in the denominator, i.e. [katex]\sqrt{2\mathbf{S}:\mathbf{S}} F_2[/katex]. This would then result in [katex]\nu_t[/katex] to be defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{a_1 k}{\sqrt{2\mathbf{S}:\mathbf{S}} F_2}\tag{176}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>From Eq.(173), we can say that:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\sqrt{2\mathbf{S}:\mathbf{S}} = \frac{\tau}{\mu_t}\tag{177}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, the turbulent viscosity becomes</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{a_1 k}{\sqrt{2\mathbf{S}:\mathbf{S}} F_2}=\frac{a_1 k\mu_t}{\tau F_2}=\frac{a_1 \rho k\nu_t}{\tau F_2}\tag{178}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>We saw from Eq.(171) that [katex]\tau = a_1\rho k[/katex], which we can insert into the definition of [katex]\nu_t[/katex]. This results in:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{a_1 \rho k\nu_t}{\tau F_2}=\frac{\tau\nu_t}{\tau F_2}=\frac{\nu_t}{F_2}\tag{179}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, in the farfield, we define the turbulent viscosity implicitly through the Johnson and King shear stress transport eddy viscosity hypothesis, i.e. Eq.(171). The second blending function [katex]F_2[/katex] is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
F_2=\tanh\left(arg_2^2\right)\tag{180}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, the [katex]arg_2[/katex] variable is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\arg_2 = \max\left(2\frac{\sqrt{k}}{0.09\omega d};\frac{500\nu}{\omega d^2}\right)\tag{181}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Again, we have a dependence on the distance from the wall [katex]d[/katex]. Eventually, the denominator will go to zero, which will make [katex]\arg_2[/katex] go to infinity. However, we then pass the argument into the hyperbolic tangent function, which is clamped between [katex]-1[/katex] and [katex]+1[/katex], regardless of its input. Thus, for distances sufficiently far away from the wall, the value of [katex]F_2[/katex] will tend to [katex]F_2=1[/katex], and thus the definition seen above for distances far away from the wall becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t=\frac{\nu_t}{F_2}\approx\frac{\nu_t}{1}=\nu_t\tag{182}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Because we achieve this behaviour by including the eddy viscosity definition based on Bradshaw's shear stress transport hypothesis, we call the baseline [katex]k-\omega[/katex] also the [katex]k-\omega[/katex] SST model, if we are using Bradshaw's shear stress transport in the farfield.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So this is all nice and fine in theory, but what does it amount to in practice? Well, let us review a few selected results that Menter provides us in his 1994 paper: <a href="https://arc.aiaa.org/doi/10.2514/3.12149" target="_blank" rel="noopener" title="">"Two-Equation Eddy-Viscosity Turbulence Models for Engineering Applications"</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The first result is for a flat plate boundary layer flow, shown in the figure below:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5508,"width":"800px","sizeSlug":"large","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-large is-resized"><img src="https://cfd.university/wp-content/uploads/2026/04/freestream_dependence_of_omega-1024x533.png" alt="" class="wp-image-5508" style="width:800px"/><figcaption class="wp-element-caption">Reproduced from <a href="https://arc.aiaa.org/doi/10.2514/3.12149" target="_blank" rel="noopener" title="">Menter 1994</a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Here, Menter is showing the freestream dependence of [katex]\omega[/katex] on farfield conditions. On the left-hand side, Menter is plotting the behaviour of the original [katex]k-\omega[/katex] model of the turbulent viscosity [katex]\nu_t[/katex] profile near the wall for the correctly imposed conditions for [katex]\omega[/katex], here referred to as high [katex]\omega_f[/katex], as well as the result where those correct freestream conditions are multiplied by a factor of [katex]10^{-4}[/katex], which are labelled low [katex]\omega_f[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As we can see, the resulting turbulent viscosity profile differs significantly, showing the shortcomings of the original [katex]k-\omega[/katex] model and its dependence on changes of freestream conditions. On the right, Menter is showing results for the baseline [katex]k-\omega[/katex] model, i.e. the model where the [katex]\varepsilon[/katex] equation has been reformulated into the [katex]\omega[/katex] equation with blending functions [katex]F_1[/katex] and [katex]F_2[/katex]. Bradshaw's shear-stress transport hypothesis is not used in this model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can see that just the reformulation of the [katex]\varepsilon[/katex] equation itself is enough to remove this freestream dependence of the original [katex]k-\omega[/katex] model.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The next case Menter investigated is the flow around a <a href="https://turbmodels.larc.nasa.gov/backstep_val.html" target="_blank" rel="noopener" title="">backwards facing step</a>. The results shown in the figure below depict the wall shear stresses after the step, now for the original, baseline, and SST versions of the [katex]k-\omega[/katex] model. The [katex]k-\varepsilon[/katex] model is also shown, along with experimental data.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5509,"width":"800px","sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2026/04/wall_bounded_behaviour_k_epsilon.png" alt="" class="wp-image-5509" style="width:800px"/><figcaption class="wp-element-caption">Reproduced from <a href="https://arc.aiaa.org/doi/10.2514/3.12149" target="_blank" rel="noopener" title="">Menter 1994</a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We can see that the [katex]\varepsilon[/katex] model is struggling to capture the behaviour near the wall, while none of the versions of the [katex]k-\omega[/katex] model is showing any particular difficulty.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>These two results are representative of a larger set of applications. We typically see the [katex]k-\omega[/katex] model performing well in the near-wall region, though we need accurate freestream conditions, which may not always be easy to come by. The [katex]k-\varepsilon[/katex] model does not suffer from the same freestream dependence, but it is prone to produce incorrect results near walls.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As we have seen, the baseline [katex]k-\omega[/katex] and the [katex]k-\omega[/katex] SST model are both capable of removing these shortcomings and combine and amplify the strengths of the [katex]k-\varepsilon[/katex] and [katex]k-\omega[/katex] models. To bring home this point, let us have a look at the velocity profiles measured on the upper part of a NACA 4412 aerofoil at an angle of attack of 13.87 degrees. These results are shown below:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5510,"width":"800px","sizeSlug":"large","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-large is-resized"><img src="https://cfd.university/wp-content/uploads/2026/04/k_omega_SST_airfoil-1024x484.png" alt="" class="wp-image-5510" style="width:800px"/><figcaption class="wp-element-caption">Reproduced from <a href="https://arc.aiaa.org/doi/10.2514/3.12149" target="_blank" rel="noopener" title="">Menter 1994</a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>None of the models, except for the [katex]k-\omega[/katex] SST version, are capable of predicting the same behaviour as observed in experiments. In this higher angle of attack study, the flow is separating with a free separation point under adverse pressure gradient conditions. This is a difficult flow scenario for most RANS turbulence models, but we can see that the [katex]k-\omega[/katex] SST model matches the experimental data well here. Thus, Bradshaw's SST hypothesis does make a difference, since the baseline [katex]k-\omega[/katex] isn't able to match the SST results.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And there you have it. For an Excel power user, I'd say Menter has done a decent job at unifying a previously scattered turbulence modelling community. The [katex]k-\omega[/katex] SST model has consistently shown, both for simple academic benchmark cases, as well as complex industrial flow applications, that it can faithfully reproduce those. There are cases where it, too, fails. After all, it is just a RANS turbulence model with inherent limitations based on how the original [katex]k-\varepsilon[/katex] and [katex]k-\omega[/katex] models were formulated.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, RANS models, unless otherwise specified, assume flow to be fully turbulent, thus removing any laminar flow from their modelling capabilities. For cases where there are substantial laminar flow regions, drag values may be drastically over-predicted. For example, for moderate Reynolds numbers of [katex]Re=10^5[/katex] and flows around aerofoils, we see an extended laminar flow region, giving rise to a laminar separation bubble. If we wanted to capture this, we would need to reformulate the model to capture laminar and transitional flows, and modifications have been proposed.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Also, most turbulence models assume isotropic conditions, which isn't necessarily a good approximation for flows near walls, where anisotropic effects show up in the Reynolds stress tensor. We wouldn't expect the [katex]k-\omega[/katex] model to save us here, unless modifications have been done (and of course, we are talking about RANS, so <a href="https://link.springer.com/book/10.1007/978-3-030-13543-0" target="_blank" rel="noopener" title="">modifications have already been proposed</a> to make the [katex]k-\omega[/katex] SST model even stronger).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, if you followed the article up until now, you should have a really good grasp of how RANS turbulence models work and what they are doing under the hood. There isn't much more I can teach you, but there are two more models I want to highlight, as these are commonly found and used in CFD solvers, and they do something a bit differently.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I'll likely be somewhat brief (or, as my daughter is currently trying to teach me: <em>briefer</em>) in those sections. We'll look at some of the defining characteristics and how they show up in the equations. First up: the Spalart-Allmaras model.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">The Spalart-Allmaras model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The first of our two honourable mentions, if you want, is the Spalart-Allmaras model, introduced in 1992, showing particularly useful results for aerodynamic calculations. The Spalart-Allmaras model, or S-A model, is classified as a one-equation model, and thus solves one additional transport equation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The choice here is interesting. When we dealt with the [katex]k-\varepsilon[/katex] and [katex]k-\omega[/katex] model, we said that we solved for [katex]k[/katex] and then either [katex]\varepsilon[/katex] or [katex]\omega[/katex], only to use these quantities to then compute the turbulent viscosity [katex]\nu_t[/katex], which we then insert into our Boussinesq eddy viscosity hypothesis.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Spalart and Allmaras are saying, "Why bother?". Let's just write a transport equation that solves for the turbulent viscosity. No need to come up with intermediate quantities that can be used to determine the turbulent viscosity. Well, this is almost true; they introduced a new variable called [katex]\tilde{\nu}[/katex], which goes by various names in the literature, though I prefer to use the terminology <em>modified turbulent viscosity</em>, which I will be using here.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You may be surprised to hear that, but the Spalart-Allmaras model uses a, guess what, yes, correct, a transport equation for its modified turbulent viscosity. Let's have a look at it. It is written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \tilde{\nu}}{\partial t} + (\mathbf{u}\cdot\nabla)\tilde{\nu} = \frac{1}{\sigma}\nabla\cdot[(\nu+\tilde{\nu})\nabla\tilde{\nu}] + \frac{c_{b2}}{\sigma}\nabla\tilde{\nu}\nabla\tilde{\nu} + c_{b1}(1-f_{t2})\tilde{S}\tilde{\nu} + f_{f2}\frac{c_{b1}}{\kappa^2}\left(\frac{\tilde{\nu}}{d}\right)^2-c_{w1}f_w\left(\frac{\tilde{\nu}}{d}\right)^2
\tag{183}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Looks familiar? Well, we have our usual time derivative, spatial (convective term), as well as the diffusive term. There are now a total of 4 source terms which relate to the production and destruction of [katex]\tilde{\nu}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In two of the source terms, we have an expression of [katex](\tilde{\nu}/d)^2[/katex], where [katex]d[/katex] is the distance at any given grid point (at which we are evaluating Eq.(183)) to the next closest wall. This may be straightforward to determine for a structured solver, but for a general-purpose unstructured solver with parallelisation (where processors may not necessarily know about all possible wall boundaries), this becomes a cumbersome task!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For this reason, you probably don't want to start with the Spalart-Allmaras model if you have never implemented a turbulence model, even though it may seem appealing as it is just a single transport equation that we have to solve.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we look now at the turbulent viscosity [katex]\nu_t[/katex], it is obtained from the modified turbulent viscosity [katex]\tilde{\nu}[/katex] as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t = \tilde{\nu}f_{\nu 1}
\tag{184}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The function [katex]f_{\nu 1}[/katex] is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
f_{\nu 1}=\frac{\chi^3}{\chi^3+c_{\nu 1}^3}
\tag{185}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The variable [katex]\chi[/katex], on the other hand, is defined as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\chi=\frac{\tilde{\nu}}{\nu}\tag{186}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]\nu[/katex] is the physical viscosity of the material/fluid used in the simulation. Let's investigate this relationship a bit more.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At freestream (inlet) boundary conditions, it is recommended to set [katex]\tilde{\nu}[/katex] to about 3 to 5 times the value of [katex]\nu[/katex], i.e. [katex]3\nu < \tilde{\nu} < 5\nu[/katex]. Let say we have [katex]\tilde{\nu}=5\nu[/katex] at the inlet. Then, [katex]\chi=5[/katex] and the closure coefficient [katex]c_{\nu 1}[/katex] in Eq.(185)is given with a value of [katex]c_{\nu 1}=7.1[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we insert these values, we get:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
f_{\nu 1}=\frac{5^3}{5^3+7.1^3} = \frac{125}{125 + 357.911} = \frac{125}{482.911} \approx 0.26 \tag{187}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This, in the farfield, where we would expect the undisturbed flow to comprise of little to no turbulence, we see that the Spalart-Allmaras model gives us a mechanism to scale down the turbulent viscosity [katex]\nu_t[/katex] in Eq.(184). Close to solid walls, [katex]\tilde{\nu}[/katex] will increase. Here, we generally have the case that [katex]\tilde{\nu}\gg\nu[/katex]. Therefore, we can state that [katex]\chi^3\gg c_{\nu 1}^3[/katex]. If this is the case, the function [katex]f_{\nu 1}[/katex] approaches:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
f_{\nu 1}=\lim_{\chi\rightarrow\infty}\frac{\chi^3}{\chi^3+c_{\nu 1}^3}=\frac{\chi^3}{\chi^3} = 1\tag{188}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Thus, close to solid walls, the turbulent viscosity [katex]\nu_t[/katex], as defined in Eq.(184), effectively becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t = \tilde{\nu}f_{\nu 1}\approx\tilde{\nu}\tag{189}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>There are additional damping functions and closure coefficients in this model, but all they do is to modify the production and destruction terms in Eq.(183). A list of these can be found at <a href="https://turbmodels.larc.nasa.gov/spalart.html" target="_blank" rel="noopener" title="">NASA's turbulence resource page</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A few comments are in order on the correct usage of the Spalart-Allmaras model. It was introduced to capture the correct flow behaviour near solid walls, meaning that we have to have a fine grid (a [katex]y^+[/katex] value of 1) at walls. If we were to use it on a mesh where the average [katex]y^+[/katex] value at walls is far outside the viscous sublayer (i.e. we have [katex]y^+>30[/katex]), then the Spalart-Allmaras model is prone to produce negative values of [katex]\tilde{\nu}[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is a problem, I'd say, as I can't wrap my head around about what a negative viscosity physically represents. And thankfully, Spalart and Allmaras agree, so they proposed a new version, the Spalart-Allmaras negative (or SA-neg) version, where negative values of [katex]\tilde{\nu}[/katex] are detected and essentially forced to become positive. This allows the usage of the Spalart-Allmaras model on coarse grids.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In a commercial CFD solver that features the Spalart-Allmaras implementation, this is likely already done for you. Based on your [katex]y^+[/katex], the solver would likely automatically switch to the correct version. OpenFOAM, on the other hand, uses the standard Spalart-Allmaras model, and so you would have to provide your own negative version if you wanted to use coarse grids. Or, use <a href="https://github.com/jsebad/Negative-SpalartAllmaras" target="_blank" rel="noopener" title="">the implementation one of my students developed</a> during his MSc thesis (Hi Johan!).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, in summary, the Spalart-Allmaras model reduces turbulence modelling to a single transport equation, solving directly for the turbulent viscosity, albeit with additional damping functions that potentially scale its magnitude. On the other extreme, we have the Reynolds stress model (RSM), which does things quite a bit differently, shall we say. Let's look at this approach as well in the next section.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">The Reynolds stress model</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Thus far, we have followed the approach of using Boussinesq's eddy viscosity hypothesis to relate the Reynolds stress tensor (which I have labelled [katex]\tau^{RANS}[/katex] thus far, though it is typically written as [katex]\tau_{ij}[/katex] in the literature) to some mean flow properties, i.e. the strain rate tensor. For completeness, the equation we used was Eq.(56), repeated below for convenience:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau^{RANS}=-2\mu_t\mathbf{S}+\frac{2}{3}k\delta_{ij}\tag{190}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The additional unknown property [katex]\mu_t=\nu_t\rho[/katex] was labelled the turbulent viscosity, and we used either the [katex]k-\varepsilon[/katex], [katex]k-\omega[/katex] (SST), or Spalart-Allmaras model thus far to obtain this turbulent viscosity. While this certainly works for a wide range of applications, it has its limitations. From our Boussinesq hypothesis, we see that the turbulent viscosity [katex]\mu_t[/katex] multiplies the strain rate tensor [katex]\mathbf{S}[/katex]. This tensor is a 3 by 3 tensor, and each component is scaled by the same turbulent viscosity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This means that Boussinesq uses a so-called isotropic approach to model turbulence, and all turbulence models using Boussinesq's hypothesis are thus said to be isotropic RANS turbulence models. Is that an accurate description of the flow? Is turbulence isotropic? Well, let's look at the following image, showing the Reynolds stresses near a solid wall, and how they change as they move away from the wall:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":4781,"width":"600px","sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2024/12/reynolds_stresses_near_wall.png" alt="" class="wp-image-4781" style="width:600px"/><figcaption class="wp-element-caption">Reynolds stresses near solid walls</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We can see nicely here how different Reynolds stresses have different magnitudes, orientations, and behaviours. Close to the wall, the Reynolds stresses behave very much non isotropically (which we also call anisotropic). But, if we look on the left-hand side of Bousinesq's eddy viscosity hypothesis (in equation form), then we see that this isotropic hypothesis is modelling the anisotropic Reynolds stress tensor [katex]\tau^{RANS}[/katex]. So, probably it isn't the best approach.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So then people started to think about how we can introduce anisotropic effects back into the RANS turbulence modelling framework. Remember Eq.(42)? Probably not by heart, so I have repeated it below for your convenience:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{u'u'}}{\partial t} +
\frac{\overline{\bar{u}u'u'}}{\partial x} + \frac{\overline{u'\bar{u}u'}}{\partial x} + \frac{\overline{u'u'u'}}{\partial x} +
\frac{\overline{\bar{u}v'u'}}{\partial y} + \frac{\overline{u'\bar{v}u'}}{\partial y} + \frac{\overline{u'v'u'}}{\partial y} +
\frac{\overline{\bar{u}w'u'}}{\partial z} + \frac{\overline{u'\bar{w}u'}}{\partial z} + \frac{\overline{u'w'u'}}{\partial z} =\\[1em]
-\frac{1}{\rho}\frac{\partial \overline{p'u'}}{\partial x} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial x^2} +
\nu\frac{\partial^2 \overline{u'u'}}{\partial y^2}+
\nu\frac{\partial^2 \overline{u'u'}}{\partial z^2}\tag{191}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>This was the transport equation for the Reynolds stresses, and we looked at it when we discussed the closure problem of RANS modelling. We saw that deriving this equation introduced more unknowns than we could solve for, and there was no way for us to create additional (exact) relations for unknown terms.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, if we look at that equation and we apply our RANS turbulence modelling framework to it, then we know all we need to make this equation solvable is just a healthy portion of closure coefficients and some intuition as to how to model some of these terms. And this is what people have done, most notably Launder-Reece-Rodi (LRR), and Speziale-Sarkar-Gatski (SSG), after whom we have the LRR and SSG Reynolds stress models (RSMs).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In their model, they have replaced the exact equation for the Reynolds stresses, i.e. Eq.(42) with the following equation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \tau}{\partial t} + (\mathbf{u}\cdot\nabla)\tau = D + \Pi - P + \varepsilon + \Omega
\tag{192}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, we are solving for the Reynolds stress tensor, i.e.:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\tau=
-\begin{bmatrix}
\overline{u'u'} & \overline{u'v'} & \overline{u'w'}\\[1em]
\overline{u'v'} & \overline{v'v'} & \overline{v'w'} \\[1em]
\overline{u'w'} & \overline{v'w'} & \overline{w'w'}
\end{bmatrix}\tag{193}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Since we have 6 unknowns here (due to the fact that the tensor is symmetric, i.e. we have [katex]\tau_{ij}=\tau_{ji}[/katex]. A concrete example would be [katex]\tau_{12}=\tau_{21}[/katex], or [katex]\overline{u'v'}=\overline{v'u'}[/katex]), we get an additional 6 transport equations, shown below:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial \overline{u'u'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{u'u'} = D + \Pi - P + \varepsilon + \Omega \\[1em]
\frac{\partial \overline{u'v'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{u'v'} = D + \Pi - P + \varepsilon + \Omega \\[1em]
\frac{\partial \overline{u'w'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{u'w'} = D + \Pi - P + \varepsilon + \Omega \\[1em]
\frac{\partial \overline{v'v'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{v'v'} = D + \Pi - P + \varepsilon + \Omega \\[1em]
\frac{\partial \overline{v'w'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{v'w'} = D + \Pi - P + \varepsilon + \Omega \\[1em]
\frac{\partial \overline{w'w'}}{\partial t} + (\mathbf{u}\cdot\nabla)\overline{w'w'} = D + \Pi - P + \varepsilon + \Omega
\tag{194}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>On the left-hand side, we have our time derivative and convective term of the Reynolds stresses, while we have the following additional terms:</p>
<!-- /wp:paragraph -->

<!-- wp:list  -->
<ul class="wp-block-list">

<!-- wp:list-item -->
<li>[katex]D[/katex]: Dissipation of Reynolds stresses

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>[katex]\Pi[/katex]: Pressure-strain correlations, these are terms involving [katex]p'\mathbf{u}'[/katex].

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>[katex]P[/katex]: Production of Reynolds stresses (also understood as the transfer from laminar kinetic energy to turbulent kinetic energy)

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>[katex]\varepsilon[/katex]: Destruction (dissipation) of Reynolds stresses

</li>
<!-- /wp:list-item -->
<!-- wp:list-item -->
<li>[katex]\Omega[/katex]: Rotational related term.

</li>
<!-- /wp:list-item -->
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Since the dissipation [katex]\varepsilon[/katex] appears, we need to have a mechanism to obtain some form of dissipation, which is typically handled by the inclusion of the [katex]\omega[/katex] equation, i.e. Eq.(167).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you want to know what all of these additional terms are, well, I would recommend <a href="https://turbmodels.larc.nasa.gov/rsm-ssglrr.html" target="_blank" rel="noopener" title="">NASA's website as a starting point</a>. You will see that these additional terms have quite a bit of detail to them. If we wanted to go into depth on the RSM model, then we would spend another hour or so on its discussion, and that is probably overkill.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The key takeaway from the RSM model is that we solve for the Reynolds stresses directly, and therefore do not have to use Boussinesq's eddy viscosity hypothesis. In theory, this should give us an edge over other Boussinesq-based RANS models, especially if anisotropic effects are of importance, but despite their mathematical superiority, they have not replaced isotropic 2-equation-based models, which still dominate the turbulence modelling community.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At this point, I would also like to point out the work of Knzsy on <a href="https://link.springer.com/book/10.1007/978-3-030-13543-0" target="_blank" rel="noopener" title="">anisotropic RANS turbulence models</a>. His approach to capturing anisotropic effects goes in a very different direction, and his work can be traced back all the way to von Karman.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>While I have not made an attempt to understand his model in full mathematical detail, I know from first-hand experience (he was my PhD supervisor) that his brilliance and contributions to the CFD community have mostly gone unnoticed. If you are in desperate need to resolve turbulence with anisotropic behaviour, I would strongly encourage you to have a look at his work.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As I have stated before, if we really wanted to go into depth on the Reynolds stress model, we would have to spend quite a bit more time. But in the end, the approach is similar to how we derive Prandtl's [katex]k[/katex] equation; make assumptions about how to model terms, and multiply them with a closure coefficient to be determined later. The RSM model just has a lot of terms to model, as well as a lot of closure coefficients that needs to be determined.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Instead, I want to come to a close here and finish the discussion of RANS turbulence models. There are quite a lot more out there, but they all follow a similar pattern to the models we have described. In most cases, we just change the turbulent quantities we solve for and then reformulate the equations accordingly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Instead of going on and describing what other turbulence models are available, I thought it might be a better use of our time to develop a new turbulence model from scratch, one that will, of course, <em>revolutionise CFD as we know it</em>!. Let's jump straight into that discussion.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Let's create our own turbulence model - the STUPID model</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Now that we have seen how various RANS turbulence models were proposed in the literature, I think it is time to create our very own turbulence model. Now, if I wanted to follow the convention we have set in the CFD literature, I would have to pick one or more turbulent quantities to solve for, and then name my model after those quantities.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>But here at cfd.university, we do things differently</em> (I love it when people use the word <em>we</em> when it is very clear that it is just a single person running the show). Even better, I find it hilarious when people call themselves CEO when they create a company, and they are the only person working there. I think a more appropriate title would be: CEO, engineer, janitor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Anyways, the turbulence model I will be introducing to you today is called <strong>Statistical Turbulence Using Parameter-Injected Delusion</strong>, or <strong>STUPID</strong> in short. The statistical part refers to the time averaging, while the parameter-injected delusion aspects cover our rigorous use of closure coefficients.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, the first thing we need to do is to select the variables we want to solve for. In my case, I will create a two-equation model and so I will need 2 quantities.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's look at the following figure:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":5304,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cfd.university/wp-content/uploads/2025/04/large_eddies_and_small_eddies.png" alt="" class="wp-image-5304"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We can see that we will have turbulent eddies (even though this is just a schematic) scattered throughout our domain. No turbulence means no eddies, but in regions with turbulence, we will have these eddies. Each eddy will have a volume (in 3D) or an area (in 2D). Thus, my first quantity I will introduce is the turbulent eddy area, which I will abbreviate with the letter  (a for area and the additional circle indicates that it is the area of the eddy). I mainly use it because it will annoy people to type it without a Scandinavian keyboard.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In 2D, we just take the area of the eddy; in 3D, we have to convert the volume first into a projected area by using the following relation:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
 = V_{eddy}^{2/3}\tag{195}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>All I have done here is to use dimensional analysis to go from [katex]m^3[/katex] (volume) to an area [katex]m^2[/katex]. Now you may be saying, hang on, typically the turbulent eddies we resolve are larger than the computational cell. Correct, each cell will simply contain the average size of the eddy that is found within it. If there is more than one eddy, then a weighted average of the areas of each eddy will be computed.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So what is the transport equation for ? Well, it is:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial }{\partial t} + (\mathbf{u}\cdot\nabla) = \nabla\cdot\left[\left(\nu + \frac{\nu_t}{\sigma_{Jin}}\right)\nabla \right] + P - D
\tag{196}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Here, [katex]P[/katex] and [katex]D[/katex] are the production and destruction of , respectively. Let's look at these in turn. The production term is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
P=\sigma_{Suga}l^2\mathbf{S}\tag{197}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>I postulate that  is generated by meanflow gradients. Thus, I use the strain rate tensor, as we have done so many times before, which has units of [katex]1/s[/katex]. If we inspect the expected units of our transport equation, i.e. Eq.(196), we can see, from the time derivative, for example, that we need units of [katex]m^2/s[/katex]. Thus, we need to multiply the strain rate by an area, and I am saying that any old turbulent length scale will do.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This could be the mixing length or it could be the integral length scale. In the end, it doesn't really matter which one we choose, as we also multiply this by the [katex]\sigma_{Suga}[/katex] closure coefficient (which implies that we all collectively believe that the area of the turbulent eddy is proportional to a given turbulent length scale). It is a dangerous assumption, but we are living life in the fast lane, don't we?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Now on to the dissipation. Since we have an area , and the dissipation requires units of [katex]m^2/s[/katex], this means that I am missing a quantity of [katex]1/s[/katex]. I am going to be naughty, and blatantly rip off the [katex]\omega[/katex] equation from either the [katex]k-\omega[/katex], Baseline [katex]k-\omega[/katex], or the [katex]k-\omega[/katex] SST model, as [katex]\omega[/katex] has units of [katex]1/s[/katex]. But don't you worry, I am not a copycat. I won't call it the specific dissipation rate, but instead the super-specific dissipation rate, and I'll define it as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
=\sqrt{\omega^2}
\tag{200}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Of course, I am not going to simply use the letter [katex]\omega[/katex] here, but instead, we'll be using the Russian alphabet here in recognition of Kolmogorov's [katex]\omega[/katex] equation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, the dissipation term becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
D = \sigma_{J-Hope}\tag{199}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>The  equation, in turn, is written as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\frac{\partial }{\partial t} + (\mathbf{u}\cdot\nabla) = \nabla\cdot\left[\left(\nu+\frac{\nu_t}{\sigma_{RM}}\right)\nabla \right] + 
\frac{\sigma_{Jimin}}{\max[\min(d^2,(\kappa\delta)^2),]}\tau^{RANS}:\nabla\mathbf{u} - \sigma_{V}^2
\tag{200}
</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So hopefully the time derivative, convection, and diffusion terms are clear. They just follow the same pattern as every other RANS model we have looked at thus far. For the production term, I have <em>borrowed</em> the same idea that turbulent eddies are generated through the shear stresses and velocity gradient. Looking at the time derivative again, where we take the time derivative of [katex][/katex] (units of [katex]1/s[/katex]), we expect the terms in the  transport equation to be have units of [katex]1/s^2[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Using dimensional analysis like the GOATs (greatest of all time) of turbulence modelling before us, we know that the Reynolds stress tensor (defined without the density) has units of [katex]m^2/s^2[/katex]. For example, if we consider the Reynolds stresses [katex]\tau_{11}=-\overline{u'u'}[/katex], we multiply two velocities, which have units of [katex]m/s[/katex]. If we multiply them, so do the units, so we end up with [katex]m^2/s^2[/katex].</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We multiply individual components of the Reynolds stress tensor with the velocity gradient tensor, which in turn has units of [katex]1/s[/katex], so that the product [katex]\tau^{RANS}:\nabla\mathbf{u}[/katex] will have units of [katex]m^2/s^3[/katex]. To get this to [katex]1/s^2[/katex], we need to divide it by an area and multiply it by a time unit. The inverse of  has units of seconds, we may use that to get the time units right. But what about the area?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Well, you may say, we already solved for , which has units of area, and sure, that <em>could</em> work, but what about solid walls? Close to solid walls, we have the viscous sublayer, a region where the velocity is small enough for viscous effects to become important again (i.e. turbulence is effectively damped away). Thus, no turbulent eddies are to be expected, and so  would be zero here. Since we need to divide our production term by a quantity of units [katex]m^2[/katex], it would be a bad idea to use  here if it can be zero (division by zero).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the freestream, where  has finite values, we can use that, but close to walls, we want to use something else. I am proposing to use the following expression to determine a characteristic area, as seen in Eq.(200):</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
A_{characteristic} = \max[\min(d^2,(\kappa\delta)^2),]\tag{201}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>Let's check the inner [katex]\min()[/katex] expression. Here I am saying that we take the smallest of [katex]d^2[/katex] or [katex](\kappa\delta)^2[/katex]. [katex]d[/katex] is the distance from the wall, and regardless of our discretisation, the cells' vertices or centroids will always be some finite distance away from the wall, so [katex]d>0[/katex] is always the case. [katex]\kappa\delta[/katex] is the multiplication of the von Karman constant [katex]\kappa=0.41[/katex] with the boundary layer height [katex]\delta[/katex]. This product provides a characteristic turbulent length scale, which we square, to get correct units.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, if we are outside the boundary layer, we would expect the term with [katex]d^2[/katex] to grow to infinity; thus, we need to cap it, which we achieve with the [katex]\min()[/katex] statement. Next, we check which expression is the largest of the result from the [katex]\min()[/katex] expression and the product . In the farfield, this may dominate, and since we take the maximum value, we have an effective way of switching between boundary layers and farfield flows.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Of course, the PID in STUPID stands for parameter-injected delusion, so let's not forget to slap on some closure coefficients, which I have introduced as [katex]\sigma_{Jimin}[/katex]. The dissipation term, very boringly, stays the same as in the [katex]k-\omega[/katex] equation. Once we have  and  defined and solved for, we realise that  has units of [katex]m^2[/katex] while  has units of [katex]1/s[/katex]. If we multiply them together, we get units of [katex]m^2/s[/katex], which happens to be the units we need for our turbulent viscosity [katex]\nu_t[/katex], i.e.:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>
\nu_t = \sigma_{Jung Kook}\tag{202}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>And of course, it wouldn't be a proper definition for [katex]\nu_t[/katex] if we did not include a new closure coefficient. In case you haven't noticed, all closure coefficients were named after members of the boy band <a href="https://en.wikipedia.org/wiki/BTS" target="_blank" rel="noopener" title="">BTS</a>. Why? Because I can! But also, because I don't understand them, everything about them seems random and chaotic, just like turbulence (catchy tune, though!)</p>
<!-- /wp:paragraph -->

<!-- wp:embed {"url":"https://youtu.be/XsX3ATc3FbA?si=KqDIQzM18vpWPKzN\u0026t=17","type":"video","providerNameSlug":"youtube","responsive":true,"className":"wp-embed-aspect-16-9 wp-has-aspect-ratio"} -->
<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
https://youtu.be/XsX3ATc3FbA?si=KqDIQzM18vpWPKzN&amp;t=17
</div></figure>
<!-- /wp:embed -->

<!-- wp:paragraph -->
<p>And that is my contribution to the field of RANS turbulence models. One more RANS model the world didn't ask for or indeed need. But what is one more, right?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's get serious for a moment, hopefully you caught my sarcasm, this model is, of course, ridiculous (it is called the STUPID model after all, that should give it away). It has serious flaws and I would expect it to fail spectacularly (but then again, the history of CFD is full of controversial methods and algorithms <a href="https://cfd.university/learn/10-key-concepts-everyone-must-understand-in-cfd/how-to-solve-incompressible-and-compressible-flows-in-cfd/#aioseo-the-verdict" target="_blank" rel="noopener" title="">(I am looking at you SIMPLE ...)</a>, so perhaps my model isn't that bad after all?!)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's think about it for a moment, the  equation will be fine, that is just a copy of the [katex]\omega[/katex] equation (with some modelling in the production term from yours truly). But what about the  equation? How would we go about measuring the size of a turbulent eddy, i.e. where is the boundary between one and another turbulent eddy? If we can't easily measure our transport equation variable (here ) in either experiments or numerical simulations, how do we stand a chance of calibrating our model (let alone solving it)? <em>No bueno</em>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I'll be honest, I invented this model as I was typing the text. The time and effort I took to <em>derive</em> this model was shockingly small. Perhaps this is the same effort Kolmogorov put into his equation? (probably not). Thus, I wouldn't be surprised if I put in some obvious blunders that I'm sure you all will let me know about!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The reason I invented this model is that I think extreme examples (serious or not) can help to bring across key messages. For example, we saw that time derivative, convection, and diffusion always follow pretty much the same pattern. The differences between models is the production and destruction terms, as well as the variables we are solving for and the closure coefficients.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>While I have <em>ridiculed</em> some authors and models, that was mostly for entertainment (how else would I keep your attention span for this long?!). I know and understand that we have to make these modelling assumptions and that closure coefficients are a necessary evil. While they are annoying to work with, we also know that RANS turbulence model works really well for a lot of applications, just not all, but we can't expect that from equations butchered this badly. If anything, it is a miracle that RANS works as well as it does!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I think you get the point. If you were able to follow my <em>not-too-serious</em> derivation of the STUPID model, then there is nothing more I can teach you about RANS. Except, there is, unfortunately. Oh, you thought after this blockbuster-length article, I would simply let you go? No, my friend, we are just getting started, but I'm afraid that has to wait for the next article!</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This brings us to the end. What have we learned? Turbulence is an inherently 3D and unsteady phenomenon, yet RANS modelling allows us to model turbulence in lower dimensions in steady state conditions. We are seeking a time-averaged result of the quantities of interest, and this allows us to vastly speed up computational times.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We saw that inserting the Reynolds decomposition into the Navier-Stokes equation produces an additional tensor, which we labelled the Reynolds stress tensor. To model this tensor, we typically use the isotropic Boussinesq eddy viscosity assumption, which largely works well. Within the Boussinesq eddy viscosity hypothesis, we need to solve for an additional turbulent viscosity, and it is the role of the turbulence model to determine that turbulent viscosity (if Boussinesq is used).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We looked at the [katex]k-\varepsilon[/katex] and [katex]k-\omega[/katex] models, which were (and probably still are) rivals in the field of turbulence. However, with the introduction of the [katex]k-\omega[/katex] SST model, both equations were unified, and both communities had to accept that this hybrid model was actually providing the most useful results and that both models had to be used in conjunction so that better results overall could be obtained.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We also saw models that do things very differently, e.g. the Spalart-Allmaras model, which basically just solves for the turbulent viscosity directly, and the Reynolds stress model, where we model each Reynolds stress individually (allowing for anisotropic effects).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, I also showed you how quickly we can come up with our own turbulence model. Sure, the model we derived is pointless and serves no other purpose than showing how to set up your own RANS model, but by going through the motion, you may understand other turbulence models better now by just looking at their equations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This covers classical RANS turbulence modelling, but there are still a few things we ought to be talking about, but let's leave that for the next article. I'll see you there.</p>
<!-- /wp:paragraph -->

