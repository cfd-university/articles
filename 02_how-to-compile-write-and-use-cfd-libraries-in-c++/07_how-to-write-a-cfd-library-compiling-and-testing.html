<!-- wp:paragraph -->
<p>In this article, we have a bit of ground to cover. We will look at how we can take the library code that we developed over the last few articles and turn it into either a static, dynamic, or header-only library. While static and dynamic libraries only differ in the compilation process, we have to modify our code completely for header-only libraries and we will see how to do that. Dynamic libraries require some further fine-tuning on Windows and we will highlight how to get dynamic libraries to work on Windows, something not very well covered elsewhere. We'll test our library as well and see that we get converged results for our 1D heat diffusion equation in the end.</p>
<!-- /wp:paragraph -->

<!-- wp:block {"ref":2490} /-->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>Download</strong>: <a href="https://cfd.university/download/linearalgebralib-part-7-compiling-and-testing/?tmstv=1712896293" title="">linearAlgebraLib-Part-7-Compiling-and-testing.zip</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="how-to-compile-write-and-use-cfd-libraries-in-c"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":7,"blockClientId":"dfdd54af-02a0-43aa-926d-13087e78287b","content":"How we got here","level":2,"anchor":"aioseo-how-we-got-here","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":16,"blockClientId":"d6a84487-412e-42c9-a9ef-7bf320cad3c6","content":"Compiling the library as a static or dynamic library","level":2,"anchor":"aioseo-compiling-the-library-as-a-static-dynamic-or-header-only-library","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":21,"blockClientId":"17462e62-cc07-4ae5-9b88-a9b7fd8c9e1b","content":"Compiling on UNIX platforms","level":3,"anchor":"aioseo-compiling-on-unix-platforms","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":25,"blockClientId":"e7a6eb01-d05a-4975-85cf-2f7ea82cc090","content":"Static library build script","level":4,"anchor":"aioseo-static-library","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":33,"blockClientId":"d18b01ce-3ee6-4dc8-a303-3b22614f91e0","content":"Dynamic library build script","level":4,"anchor":"aioseo-dynamic-library","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":40,"blockClientId":"e6b45d87-3ae9-43a5-bc9a-6f961e7640f9","content":"Compiling on Windows platforms","level":3,"anchor":"aioseo-compiling-on-windows-platforms","order":5,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":44,"blockClientId":"cbd7dc34-dbde-492e-b9a7-b021cfbd000a","content":"Static library build script","level":4,"anchor":"aioseo-static-library-build-script","order":6,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":51,"blockClientId":"8d8039a6-002e-4df8-9471-9ae1271f050f","content":"Dynamic library build script","level":4,"anchor":"aioseo-dynamic-library-build-script","order":7,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":60,"blockClientId":"51fe70e8-1225-477a-adc4-e87398cf1d42","content":"Intermission: The preprocessor","level":5,"anchor":"aioseo-intermission-the-preprocessor","order":8,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":68,"blockClientId":"0db75580-4605-40e3-9264-0b60f8bd53f1","content":"Necessary library modifications","level":5,"anchor":"aioseo-necessary-library-modifications","order":9,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]}]}]},{"id":83,"blockClientId":"d62b5834-d006-4c8a-bab2-43cc82fcac59","content":"Creating a header-only version","level":2,"anchor":"aioseo-creating-a-header-only-version","order":10,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":103,"blockClientId":"c2ecca2c-7b71-438a-98d8-bfd1371a1ed6","content":"Testing our libraries for correctness","level":2,"anchor":"aioseo-testing-our-library-for-correctness","order":11,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":113,"blockClientId":"6bfb1fb9-2a1a-47f0-8f28-857310c2f1df","content":"Summary","level":2,"anchor":"aioseo-summary","order":12,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-how-we-got-here">How we got here</a></li><li><a href="#aioseo-compiling-the-library-as-a-static-dynamic-or-header-only-library">Compiling the library as a static or dynamic library</a><ul><li><a href="#aioseo-compiling-on-unix-platforms">Compiling on UNIX platforms</a><ul><li><a href="#aioseo-static-library">Static library build script</a></li><li><a href="#aioseo-dynamic-library">Dynamic library build script</a></li></ul></li><li><a href="#aioseo-compiling-on-windows-platforms">Compiling on Windows platforms</a><ul><li><a href="#aioseo-static-library-build-script">Static library build script</a></li><li><a href="#aioseo-dynamic-library-build-script">Dynamic library build script</a><ul><li><a href="#aioseo-intermission-the-preprocessor">Intermission: The preprocessor</a></li><li><a href="#aioseo-necessary-library-modifications">Necessary library modifications</a></li></ul></li></ul></li></ul></li><li><a href="#aioseo-creating-a-header-only-version">Creating a header-only version</a></li><li><a href="#aioseo-testing-our-library-for-correctness">Testing our libraries for correctness</a></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-how-we-got-here">How we got here</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's recap how we ended up at this point, as there is quite a bit to remember. We have gone through a few articles all looking at different aspects, and I'll briefly summarise each article below so we have a shared understanding of what we have done. This will make it easier to follow the rest of the article.</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-discretising-the-model-equation" target="_blank" rel="noopener" title="">How to write a CFD library: Discretising the model equation</a>: In this article, we looked at our model problem. We set out to solve the 1D heat diffusion equation, and we discretised the equation. In doing so, we realised that we would need an iterative matrix solver to solve the linear system of equations of the form [katex]\mathbf{Ax}=\mathbf{b}[/katex].</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-basic-library-structure" target="_blank" rel="noopener" title="">How to write a CFD library: Basic library structure</a>: In this article, we looked at how we would have to structure our library and how to compile it for testing. We wrote a test that implemented the 1D heat diffusion equation that we will use here as a test. We will also revisit the compilation step in this article and make it more general.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-the-conjugate-gradient-class" target="_blank" rel="noopener" title="">How to write a CFD library: The Conjugate Gradient class</a>: Here, we looked at the base class for the linear algebra solver and then derived a single child class that implemented the Conjugate Gradient algorithm. We highlighted the need for matrix-vector-scalar multiplications, providing the necessary motivation to provide our own matrix and vector classes.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-the-vector-class" target="_blank" rel="noopener" title="">How to write a CFD library: The vector class</a>: This article, then, implemented the vector class and focused primarily on mathematical arithmetic operations, and how we can implement these for the vector class using operator overloading.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-the-sparse-matrix-class" target="_blank" rel="noopener" title="">How to write a CFD library: The sparse matrix class</a>: The final piece in the puzzle was the matrix class. We spend quite a bit of time understanding how we can implement sparse matrices, which dominate CFD applications. We looked at the implementation of a sparse matrix class itself using the compressed sparse row (CSR) storage format.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>With all of this out of the way, we are now finally in a position to look at libraries themselves. What I want to do in this article specifically is to show you how you can turn this library code now into a static, dynamic, or header-only library. We discussed these different types earlier in this series in the article <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries" target="_blank" rel="noopener" title="">Understanding static, dynamic, and header-only C++ libraries</a>, which you may want to check out if you need a refresher. If you want the TL;DR version, the image below summarises how these different libraries are injected into our code.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1959,"width":"800px","sizeSlug":"large","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-large is-resized"><img src="http://cfd.university/wp-content/uploads/2023/11/compiling_and_linking_diagram-2-1024x295.png" alt="" class="wp-image-1959" style="width:800px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Header-only libraries do not define any source code files and thus do not get compiled into a library itself. All function definitions live in header files, which can simply be included in a project. It's the simplest form of a library and is especially useful for pure C++ libraries that make a lot of use of templates.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Static libraries do have source files (i.e. files ending in <code>*.cpp</code>, typically), and these get compiled into object codes first, and then packaged into a library. The best analogy for static libraries is a zip file; all your compiled code is put together into a single library (or <em>zip file</em>) and that gets injected into your executable at compile time if you want to bring this library into your codebase.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Dynamic libraries are compiled similarly to static libraries, but they don't get compiled into any executable. The idea is that your executable has to look for the dynamic library at runtime, meaning that even if you successfully compile your application against a dynamic library, there is still no guarantee that you will be able to run your code after compilation. There may be look-up issues at runtime and dynamic libraries are the most difficult ones to get to work.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>All of these libraries have their advantages and disadvantages, which we looked at in the article linked above, but at this point, we want to move on and see how we can compile the libraries into their different forms and use them in our 1D heat diffusion example code. We'll start with static and dynamic libraries, as their compilation step is rather straightforward. For header-only libraries, we have to make changes to the code first, which we will look at separately.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-compiling-the-library-as-a-static-dynamic-or-header-only-library">Compiling the library as a static or dynamic library</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's split this part into two subsections. First, we'll explore how we can compile our library on a UNIX machine (e.g. Ubuntu, macOS, etc.), and then we look at Windows, which has some nasty surprises for us in store. UNIX platforms are usually quite good for developing code and are preferred by most in the CFD community. After reading this section you may understand why. I want to break free of this UNIX mindset, though, and show that Windows can be used as well (depending on how much pain you can tolerate).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Before we get started, we are going to add a few files to our project. The new files with the new project structure is shown below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"root\n├── build\n├── linearAlgebraLib\n│   ├── linearAlgebraLib.hpp\n│   └── src\n│       ├── vector.(hpp|cpp)\n│       ├── sparseMatrixCSR.(hpp|cpp)\n│       ├── linearAlgebraSolverBase.(hpp|cpp)\n│       └── conjugateGradient.(hpp|cpp)\n├── main.cpp\n├── buildAndRun.(sh|bat)\n├── testStaticLib.(sh|bat)\n└── testDynamicLib.(sh|bat)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eroot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── linearAlgebraLib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003elinearAlgebraLib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── src\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── vector.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── sparseMatrixCSR.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── linearAlgebraSolverBase.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       └── conjugateGradient.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.(sh|bat)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── testStaticLib.(sh|bat)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── testDynamicLib.(sh|bat)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="root
├── build
├── linearAlgebraLib
│   ├── linearAlgebraLib.hpp
│   └── src
│       ├── vector.(hpp|cpp)
│       ├── sparseMatrixCSR.(hpp|cpp)
│       ├── linearAlgebraSolverBase.(hpp|cpp)
│       └── conjugateGradient.(hpp|cpp)
├── main.cpp
├── buildAndRun.(sh|bat)
├── testStaticLib.(sh|bat)
└── testDynamicLib.(sh|bat)" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">root</span></span>
<span class="line"><span style="color: #D4D4D4">├── build</span></span>
<span class="line"><span style="color: #D4D4D4">├── linearAlgebraLib</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── </span><span style="color: #9CDCFE">linearAlgebraLib</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── src</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── vector.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── sparseMatrixCSR.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── linearAlgebraSolverBase.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│       └── conjugateGradient.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">├── </span><span style="color: #9CDCFE">main</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cpp</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.(sh|bat)</span></span>
<span class="line"><span style="color: #D4D4D4">├── testStaticLib.(sh|bat)</span></span>
<span class="line"><span style="color: #D4D4D4">└── testDynamicLib.(sh|bat)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We have added the <code>testStaticLib.(sh|bat)</code> and <code>testDynamicLib.(sh|bat)</code> files in the root directory of our project, where <code>*.sh</code> files will be used on UNIX (Ubuntu, other Linux distributions, macOS) and <code>*.bat</code> files on Windows. These will be used to build and test our static and dynamic libraries, respectively. Let's do exactly that next.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-compiling-on-unix-platforms">Compiling on UNIX platforms</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Before we look at the static and dynamic library build scripts, let's look back at the original <code>buildAndRun.sh</code> file. For convenience, this is listed below again:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o\ng++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o\n\n# link\ng++ -o build/main.out build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o build/main.o\n\n# run\n./build/main.out","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/sparseMatrixCSR.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/vector.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/linearAlgebraSolverBase.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/conjugateGradient.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003emain.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.out\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/main.out\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":17,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o
g++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o

# link
g++ -o build/main.out build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o build/main.o

# run
./build/main.out" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/sparseMatrixCSR.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/vector.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/linearAlgebraSolverBase.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/conjugateGradient.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">main.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.out</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run</span></span>
<span class="line"><span style="color: #DCDCAA">./build/main.out</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>As we have seen before, we compile our code with the GNU g++ compiler, and we do so for each source file (<code>*.cpp</code>) as seen in lines 7-11. However, what I want to focus on is line 14. On this line, we build an executable that directly includes all object files (<code>.o</code>) from our library code. This is not what we want, though. The whole point of a library is that we want to inject that into our code, instead of having to compile it as part of our project and then inject the object files from the library into our code. So we will have to separate line 14 into the creation of a library and then link that library with our program, here the <code>main.cpp</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-static-library">Static library build script</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's look at the new build script and then discuss the changes made to it. Below is the content for the <code>testStaticLib.sh</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile source files into object code\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o\ng++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o\ng++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o\n\n# link object files into static library\nar rcs build/libStaticLinearAlgebra.a build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o\n\n# compile main function and link library into executable\ng++ -g -O0 -Wall -Wextra -I. build/main.o -o build/staticLibExample -Lbuild -lStaticLinearAlgebra\n\n# remove object files\nrm build/*.o\n\n# run\necho \u0022Running static library example\u0022\n./build/staticLibExample","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object code\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/sparseMatrixCSR.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/vector.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/linearAlgebraSolverBase.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/conjugateGradient.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003emain.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files into static library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ear\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ercs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/libStaticLinearAlgebra.a\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile main function and link library into executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/staticLibExample\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Lbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lStaticLinearAlgebra\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# remove object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e*\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Running static library example\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/staticLibExample\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":24,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile source files into object code
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o
g++ -c -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o
g++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o

# link object files into static library
ar rcs build/libStaticLinearAlgebra.a build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o

# compile main function and link library into executable
g++ -g -O0 -Wall -Wextra -I. build/main.o -o build/staticLibExample -Lbuild -lStaticLinearAlgebra

# remove object files
rm build/*.o

# run
echo &quot;Running static library example&quot;
./build/staticLibExample" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object code</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/sparseMatrixCSR.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/vector.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/linearAlgebraSolverBase.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/conjugateGradient.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">main.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files into static library</span></span>
<span class="line"><span style="color: #DCDCAA">ar</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">rcs</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/libStaticLinearAlgebra.a</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile main function and link library into executable</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/staticLibExample</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Lbuild</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lStaticLinearAlgebra</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># remove object files</span></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/</span><span style="color: #569CD6">*</span><span style="color: #CE9178">.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run</span></span>
<span class="line"><span style="color: #DCDCAA">echo</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;Running static library example&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">./build/staticLibExample</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The compilation on lines 7-11 is unaffected, i.e. we still produce object files in the same way as we did before. Line 14, though, has changed, where we now call a program called <code>ar</code>, which is the archiver on UNIX systems. The command line flags rcs are used to essentially allow overwriting or updating an existing library if already present and new files were generated (source code changed).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The first argument is the location and filename where we want to store our static library, in this case, in the build directory. Notice that on UNIX system we use a file ending <code>*.a</code> to indicate that it is a static library (or archive). The following arguments are all the object files that should be included in this archive (or static library). </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then, on line 17, we simply build an executable called <code>staticLibExample</code> within the <code>build</code> directory, and the only object file we are using is the <code>main.o</code> file. However, we now also specify the location of the static library with the <code>-L</code> flag, and then the name of the static library with the <code>-l</code> flag (notice the absence of spaces between the flags and their arguments). On UNIX platforms, the name of the library is expected to start with <code>lib</code> and end in the ending <code>*.a</code>, both of which are implicitly added when you specify the library name to the <code>-l</code> flag. Thus, the names we specify here and on line 14 are different. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we think of the analogy that the archiver <code>ar</code> just creates glorified zip files, then we can see that specifying the location of the static library along with its name allows extracting the archive, which just contains the object files of the library code we packaged on line 14. We essentially recover again what was line 14 in the <code>buildAndRun.sh</code> script we saw before, where we explicitly linked against all object files. Now, we sort of implicitly link against them.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The final lines 20 and 24 remove all object files and run the executable to test that the compilation has worked.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-dynamic-library">Dynamic library build script</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The dynamic library creation follows a similar step, i.e. we separate the creation of the library into a separate step and then link against it in our main program. Let's look at our build script and then analyse it again step-by-step.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile source files into object code\ng++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o\ng++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o\ng++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o\ng++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o\ng++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o\n\n# link object files into dynamic library\ng++ -shared -g -O0 -Wall -Wextra -I. -o build/libDynamicLinearAlgebra.so build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o\n\n# compile main function and link library into executable\ng++ -g -O0 -Wall -Wextra -I. build/main.o -o build/dynamicLibExample -Lbuild -Wl,-rpath=build -lDynamicLinearAlgebra\n\n# remove object files\nrm build/*.o\n\n# run\necho \u0022Running dynamic library example\u0022\n./build/dynamicLibExample","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object code\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-fPIC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/sparseMatrixCSR.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-fPIC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/vector.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-fPIC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/linearAlgebraSolverBase.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-fPIC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elinearAlgebraLib/src/conjugateGradient.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003emain.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files into dynamic library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-shared\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/libDynamicLinearAlgebra.so\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/sparseMatrixCSR.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/vector.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/linearAlgebraSolver.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/conjugateGradient.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile main function and link library into executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/main.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/dynamicLibExample\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Lbuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wl,-rpath=build\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lDynamicLinearAlgebra\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# remove object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e*\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Running dynamic library example\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/dynamicLibExample\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":24,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile source files into object code
g++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/sparseMatrixCSR.cpp -o build/sparseMatrixCSR.o
g++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/vector.cpp -o build/vector.o
g++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/linearAlgebraSolverBase.cpp -o build/linearAlgebraSolver.o
g++ -c -fPIC -g -O0 -Wall -Wextra -I. linearAlgebraLib/src/conjugateGradient.cpp -o build/conjugateGradient.o
g++ -c -g -O0 -Wall -Wextra -I. main.cpp -o build/main.o

# link object files into dynamic library
g++ -shared -g -O0 -Wall -Wextra -I. -o build/libDynamicLinearAlgebra.so build/sparseMatrixCSR.o build/vector.o build/linearAlgebraSolver.o build/conjugateGradient.o

# compile main function and link library into executable
g++ -g -O0 -Wall -Wextra -I. build/main.o -o build/dynamicLibExample -Lbuild -Wl,-rpath=build -lDynamicLinearAlgebra

# remove object files
rm build/*.o

# run
echo &quot;Running dynamic library example&quot;
./build/dynamicLibExample" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object code</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-fPIC</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/sparseMatrixCSR.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-fPIC</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/vector.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-fPIC</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/linearAlgebraSolverBase.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-fPIC</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">linearAlgebraLib/src/conjugateGradient.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">main.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files into dynamic library</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-shared</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/libDynamicLinearAlgebra.so</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/sparseMatrixCSR.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/vector.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/linearAlgebraSolver.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/conjugateGradient.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile main function and link library into executable</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/main.o</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/dynamicLibExample</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Lbuild</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wl,-rpath=build</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lDynamicLinearAlgebra</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># remove object files</span></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/</span><span style="color: #569CD6">*</span><span style="color: #CE9178">.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run</span></span>
<span class="line"><span style="color: #DCDCAA">echo</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;Running dynamic library example&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">./build/dynamicLibExample</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Lines 7-11 are almost the same compared to our previous build scrips, but we have added the -fPIC compiler flag. PIC stands for <a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener" title="">position independent code</a>, and we looked at this briefly in our overview on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries" target="_blank" rel="noopener" title="">static, dynamic, and header-only libraries</a>. This is a requirement for dynamic libraries, as we don't know in advance where in memory these functions will be (as opposed to static libraries, where we do know that at compile time as we inject all object files directly into our code). We only add it to our library code, but not the <code>main.cpp</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then, on line 14, we use now <code>g++</code>, i.e. the compiler, to link all object files (<code>*.o</code>) from our library code into a dynamic library. Here the compiler flag <code>-shared</code> tells <code>g++ </code>to create the dynamic library, and we put that into the build directory with a file ending of <code>*.so</code>, standing for shared object. I say we use <code>g++</code>, that is incorrect, we abuse it here and <code>g++</code> will call for us the linker, which on UNIX platforms is called <code>ld</code>. But this is common practice, as <code>g++</code> will pass a lot of boilerplate instructions to <code>ld</code> which we don't have to type.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The linking of the main program on line 17 is now somewhat more interesting. We still pass the <code>-L</code> and <code>-l</code> flag to <code>g++</code> (and this will be forwarded again to the linker <code>ld</code>) and they operate in the same way as for static libraries. However, since dynamic libraries are only loaded during runtime, not during compilation, we also pass the ominous <code>-Wl,-rpath=build</code> flag. This flag does two things, first, the <code>-Wl</code> part says that the following flags should be passed to the linker <code>ld</code> directly. Any flag listed after the comma will be used by the linker.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>-rpath=build</code> adds the build directory to the run path. Our executable will then have some idea of where to look for the dynamic library during runtime. If you don't specify this, you can still compile your code, but when you try to run it, you'll get an error message when you try to execute your code saying: <code>error while loading shared libraries: libDynamicLinearAlgebra.so: cannot open shared object file: No such file or directory</code>. If you encounter this error, it means your program does not know where it is located and by adding the <code>-rpath=build</code> variable, your code will know where to check and find the library now. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-compiling-on-windows-platforms">Compiling on Windows platforms</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's have a quick look at the <code>buildAndTest.bat</code> program as well before we look into creating the static and dynamic library. <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-basic-library-structure" target="_blank" rel="noopener" title="">We saw previously</a> that it is given as:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"@echo off\n\ndel /q build\nmkdir build\n\nREM compile\ncl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\sparseMatrixCSR.obj linearAlgebraLib\\src\\sparseMatrixCSR.cpp\ncl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\vector.obj linearAlgebraLib\\src\\vector.cpp\ncl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\linearAlgebraSolver.obj linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp\ncl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\conjugateGradient.obj linearAlgebraLib\\src\\conjugateGradient.cpp\ncl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\main.obj main.cpp\n\nREM link\ncl /Fe:build\\main.exe build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj build\\main.obj\n\nREM run\nbuild\\main.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e@\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoff\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /q build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e compile\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\sparseMatrixCSR.obj linearAlgebraLib\\src\\sparseMatrixCSR.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\vector.obj linearAlgebraLib\\src\\vector.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\linearAlgebraSolver.obj linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\conjugateGradient.obj linearAlgebraLib\\src\\conjugateGradient.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /c /EHsc /Zi /Od /I. /Fobuild\\main.obj main.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e link\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /Fe:build\\main.exe build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj build\\main.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild\\main.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bat","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":17,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="@echo off

del /q build
mkdir build

REM compile
cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\sparseMatrixCSR.obj linearAlgebraLib\src\sparseMatrixCSR.cpp
cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\vector.obj linearAlgebraLib\src\vector.cpp
cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\linearAlgebraSolver.obj linearAlgebraLib\src\linearAlgebraSolverBase.cpp
cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\conjugateGradient.obj linearAlgebraLib\src\conjugateGradient.cpp
cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\main.obj main.cpp

REM link
cl /Fe:build\main.exe build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj build\main.obj

REM run
build\main.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">@</span><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">off</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> /q build</span></span>
<span class="line"><span style="color: #569CD6">mkdir</span><span style="color: #D4D4D4"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> compile</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\sparseMatrixCSR.obj linearAlgebraLib\src\sparseMatrixCSR.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\vector.obj linearAlgebraLib\src\vector.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\linearAlgebraSolver.obj linearAlgebraLib\src\linearAlgebraSolverBase.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\conjugateGradient.obj linearAlgebraLib\src\conjugateGradient.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /c /EHsc /Zi /Od /I. /Fobuild\main.obj main.cpp</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> link</span></span>
<span class="line"><span style="color: #D4D4D4">cl /Fe:build\main.exe build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj build\main.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> run</span></span>
<span class="line"><span style="color: #D4D4D4">build\main.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>In the following, we'll attempt to turn this into a static and dynamic library as well, as we just did for the UNIX build script.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-static-library-build-script">Static library build script</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Below is the version that will allow us to build and execute our static library on Windows. Remember, in order to be able to compile code on Windows, you have to use a PowerShell that has the Visual Studio variables loaded. I went over this in our <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-basic-library-structure" target="_blank" rel="noopener" title="">basic library structure</a> article when discussing the above build script for Windows, scan that section if you need a refresher.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"@echo off\n\ndel /q build\nmkdir build\n\nREM compile source files into object code\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\sparseMatrixCSR.cpp /Fobuild\\sparseMatrixCSR.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\vector.cpp /Fobuild\\vector.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp /Fobuild\\linearAlgebraSolver.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\conjugateGradient.cpp /Fobuild\\conjugateGradient.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB main.cpp /Fobuild\\main.obj\n\nREM link object files into static library\nlib /nologo /OUT:build\\staticLinearAlgebra.lib build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj\n\nREM link library into main executable\ncl /nologo /EHsc /Od /I. build\\main.obj /Fe:build\\staticLibExample.exe /link /LIBPATH:build staticLinearAlgebra.lib\n\nREM remove object files\ndel build\\*.obj\n\nREM run\necho Running static library example\nbuild\\staticLibExample.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e@\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoff\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /q build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e compile source files into object code\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\sparseMatrixCSR.cpp /Fobuild\\sparseMatrixCSR.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\vector.cpp /Fobuild\\vector.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp /Fobuild\\linearAlgebraSolver.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\\src\\conjugateGradient.cpp /Fobuild\\conjugateGradient.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB main.cpp /Fobuild\\main.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e link object files into static library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003elib /nologo /OUT:build\\staticLinearAlgebra.lib build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e link library into main executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /EHsc /Od /I. build\\main.obj /Fe:build\\staticLibExample.exe /link /LIBPATH:build staticLinearAlgebra.lib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e remove object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\\*.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e Running static library example\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild\\staticLibExample.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bat","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":24,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="@echo off

del /q build
mkdir build

REM compile source files into object code
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\sparseMatrixCSR.cpp /Fobuild\sparseMatrixCSR.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\vector.cpp /Fobuild\vector.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\linearAlgebraSolverBase.cpp /Fobuild\linearAlgebraSolver.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\conjugateGradient.cpp /Fobuild\conjugateGradient.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB main.cpp /Fobuild\main.obj

REM link object files into static library
lib /nologo /OUT:build\staticLinearAlgebra.lib build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj

REM link library into main executable
cl /nologo /EHsc /Od /I. build\main.obj /Fe:build\staticLibExample.exe /link /LIBPATH:build staticLinearAlgebra.lib

REM remove object files
del build\*.obj

REM run
echo Running static library example
build\staticLibExample.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">@</span><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">off</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> /q build</span></span>
<span class="line"><span style="color: #569CD6">mkdir</span><span style="color: #D4D4D4"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> compile source files into object code</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\sparseMatrixCSR.cpp /Fobuild\sparseMatrixCSR.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\vector.cpp /Fobuild\vector.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\linearAlgebraSolverBase.cpp /Fobuild\linearAlgebraSolver.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB linearAlgebraLib\src\conjugateGradient.cpp /Fobuild\conjugateGradient.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILELIB main.cpp /Fobuild\main.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> link object files into static library</span></span>
<span class="line"><span style="color: #D4D4D4">lib /nologo /OUT:build\staticLinearAlgebra.lib build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> link library into main executable</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /EHsc /Od /I. build\main.obj /Fe:build\staticLibExample.exe /link /LIBPATH:build staticLinearAlgebra.lib</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> remove object files</span></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> build\*.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> run</span></span>
<span class="line"><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> Running static library example</span></span>
<span class="line"><span style="color: #D4D4D4">build\staticLibExample.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We compile our code on lines 7-11 as before, and even line 14 does not look too different from line 14 in the UNIX build script for static libraries. We have included, though, a preprocessor directive with the <code>/D</code> flag, here <code>/DCOMPILELIB</code>, and we will see in the next section why we have to do this. We do this not just for the library code, but also for the <code>main.cpp</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We use the <code>lib</code> command here, instead of <code>ar</code> which is only available on UNIX. We specify the location and name of the library, followed by all object files that should be stored in this static library (archive). We then use it in a similar way on line 17, where we have added the <code>/link</code> flag to indicate that the following arguments are linker commands. On both lines, notice that our library no longer starts with the prefix <code>lib</code> as it did on our UNIX build script(i.e. our library is now called <code>staticLinearAlgebra</code> and not <code>libStaticLinearAlgebra</code>). This is not required on Windows and is also not a convention, so we removed it here to follow standard practices.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>/LIBPATH:</code> behaves the same way as the <code>-L</code> flag on UNIX, i.e. it states where the library should be built into. It is followed by the name of the static library, and you see that on Windows the names of the library given on lines 14 and 17 are the same, i.e. we are not implicitly adding any strings to the library name as we did on UNIX.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Lines 20 and 24, again, remove object files we no longer need and execute our code for testing.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-dynamic-library-build-script">Dynamic library build script</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I once read a great quote, which states (I am paraphrasing here as I don't remember the exact wording):</p>
<!-- /wp:paragraph -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><!-- wp:paragraph -->
<p>Compiling on Windows is only difficult if you expect it to be a direct clone of UNIX</p>
<!-- /wp:paragraph --><cite>anonymous</cite></blockquote>
<!-- /wp:quote -->

<!-- wp:paragraph -->
<p>So, do you really want to learn how to turn your library into a dynamic library to be run on Windows? <em>Yes</em>? Well, then strap in, we have some work to do. Getting things done on Windows is not as straightforward as we would hope. However, I can pretty much guarantee you that you won't find this information easily anywhere else; if you look to build dynamic libraries on Windows, you'll find plenty of resources on how to do that with CMake or Visual Studio. But if you wanted to know how to do that on the command line yourself, there is pretty much nothing on that topic.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I'd argue you should know how to do things first yourself, on the command line, before upgrading to a build system. In this way, you can troubleshoot errors easily when they come up and are not dependent on ChatGPT to tell you what's wrong (in most cases, ChatGPT is rather unhelpful in these situations). So, let's look then how to build a dynamic library ourselves, without tool support, we'll later learn how to achieve this with CMake as well. Let's start with the build script and see what we are doing here:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"@echo off\n\ndel /q build\nmkdir build\n\nREM compile source files into object code\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\sparseMatrixCSR.cpp /Fobuild\\sparseMatrixCSR.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\vector.cpp /Fobuild\\vector.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp /Fobuild\\linearAlgebraSolver.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\conjugateGradient.cpp /Fobuild\\conjugateGradient.obj\ncl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL main.cpp /Fobuild\\main.obj\n\nREM link object files into dynamic library\nlink /nologo /DLL /OUT:build\\dynamicLinearAlgebra.dll build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj\n\nREM link library into executable\ncl /nologo /EHsc /Od /I. build\\main.obj /Fe:build\\dynamicLibExample.exe /link /LIBPATH:build build\\dynamicLinearAlgebra.lib \n\nREM remove object files\ndel build\\*.obj\n\nREM run\necho Running dynamic library example\nbuild\\dynamicLibExample.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e@\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoff\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /q build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e compile source files into object code\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\sparseMatrixCSR.cpp /Fobuild\\sparseMatrixCSR.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\vector.cpp /Fobuild\\vector.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\linearAlgebraSolverBase.cpp /Fobuild\\linearAlgebraSolver.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\\src\\conjugateGradient.cpp /Fobuild\\conjugateGradient.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL main.cpp /Fobuild\\main.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e link object files into dynamic library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003elink /nologo /DLL /OUT:build\\dynamicLinearAlgebra.dll build\\sparseMatrixCSR.obj build\\vector.obj build\\linearAlgebraSolver.obj build\\conjugateGradient.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e link library into executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /EHsc /Od /I. build\\main.obj /Fe:build\\dynamicLibExample.exe /link /LIBPATH:build build\\dynamicLinearAlgebra.lib \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e remove object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\\*.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e Running dynamic library example\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild\\dynamicLibExample.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bat","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":24,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="@echo off

del /q build
mkdir build

REM compile source files into object code
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\sparseMatrixCSR.cpp /Fobuild\sparseMatrixCSR.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\vector.cpp /Fobuild\vector.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\linearAlgebraSolverBase.cpp /Fobuild\linearAlgebraSolver.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\conjugateGradient.cpp /Fobuild\conjugateGradient.obj
cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL main.cpp /Fobuild\main.obj

REM link object files into dynamic library
link /nologo /DLL /OUT:build\dynamicLinearAlgebra.dll build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj

REM link library into executable
cl /nologo /EHsc /Od /I. build\main.obj /Fe:build\dynamicLibExample.exe /link /LIBPATH:build build\dynamicLinearAlgebra.lib 

REM remove object files
del build\*.obj

REM run
echo Running dynamic library example
build\dynamicLibExample.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">@</span><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">off</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> /q build</span></span>
<span class="line"><span style="color: #569CD6">mkdir</span><span style="color: #D4D4D4"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> compile source files into object code</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\sparseMatrixCSR.cpp /Fobuild\sparseMatrixCSR.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\vector.cpp /Fobuild\vector.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\linearAlgebraSolverBase.cpp /Fobuild\linearAlgebraSolver.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL linearAlgebraLib\src\conjugateGradient.cpp /Fobuild\conjugateGradient.obj</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /c /EHsc /Od /I. /DCOMPILEDLL main.cpp /Fobuild\main.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> link object files into dynamic library</span></span>
<span class="line"><span style="color: #D4D4D4">link /nologo /DLL /OUT:build\dynamicLinearAlgebra.dll build\sparseMatrixCSR.obj build\vector.obj build\linearAlgebraSolver.obj build\conjugateGradient.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> link library into executable</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /EHsc /Od /I. build\main.obj /Fe:build\dynamicLibExample.exe /link /LIBPATH:build build\dynamicLinearAlgebra.lib </span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> remove object files</span></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> build\*.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> run</span></span>
<span class="line"><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> Running dynamic library example</span></span>
<span class="line"><span style="color: #D4D4D4">build\dynamicLibExample.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Lines 7-11 again compile the code, but we do not have to specify that this is position-independent code here. We also make use of the preprocessor directive <code>/DCOMPILEDLL</code>, i.e. we are defining the <code>COMPILEDLL</code> here and this will help us distinguish later if we want to compile a static or dynamic library.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 14, we call the linker directly and say that we want to create a dynamic link library (<code>DLL</code>), which is Windows terminology for dynamic library, or shared object, as known on UNIX systems. This follows the usual pattern, i.e. we specify first the name and location of the dynamic library, which is followed by the source files it depends on.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then link the generated library on line 17 against our compiled <code>main</code> function and then remove build files on line 20, as well as execute the code on line 24 for testing, as per usual. Did you notice something strange? On line 14, we create the library <code>dynamicLinearAlgebra.dll</code> but then we link against <code>dynamicLinearAlgebra.lib</code> on line 17, i.e. the postfix has changed from <code>*.dll</code> to <code>*.lib</code>. Windows creates two libraries for us; a <code>*.lib</code> and a <code>*.dll</code> file. The <code>*.dll</code> file contains the actual library while the <code>*.lib</code> file acts like a wrapper around the dynamic library.  We call (and link against) the <code>*.lib</code> file which will retrieve the correct functions from the <code>*.dll</code> file.  </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-intermission-the-preprocessor">Intermission: The preprocessor</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Remember that for both the static and dynamic libraries, we introduced a preprocessor directive with the <code>/D</code> compiler flag. Now it is time to consume this compiler flag. Before we do that, though, let's look at a simple example to understand what preprocessor directives are doing. For a more in-depth discussion, I can only recommend <a href="https://www.learncpp.com/cpp-tutorial/introduction-to-the-preprocessor/" target="_blank" rel="noopener" title="">learncpp </a>again on this topic, they have a great write-up, as always.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's look at the following code and assume this file is called <code>main.cpp</code>:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// main.cpp\n#include \u0026lt;iostream\u003e\n\nint main() {\n  #ifdef PRINT_LOGS\n    std::cout \u0026lt;\u0026lt; \u0022printing logging information ... \u0022 \u0026lt;\u0026lt; std::endl;\n  #endif\n\n  #ifdef WIN32\n    std::cout \u0026lt;\u0026lt; \u0022I am compiled on windows\u0022 \u0026lt;\u0026lt; std::endl;\n  #else\n    std::cout \u0026lt;\u0026lt; \u0022I am not compiled on windows\u0022 \u0026lt;\u0026lt; std::endl;\n  #endif\n\n  #ifdef __cplusplus\n    std::cout \u0026lt;\u0026lt; \u0022i am compiled with a c++ compiler\u0022 \u0026lt;\u0026lt; std::endl;\n  #endif\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// main.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#ifdef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e PRINT_LOGS\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;printing logging information ... \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#ifdef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e WIN32\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;I am compiled on windows\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;I am not compiled on windows\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#ifdef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e __cplusplus\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;i am compiled with a c++ compiler\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// main.cpp
#include &lt;iostream&gt;

int main() {
  #ifdef PRINT_LOGS
    std::cout &lt;&lt; &quot;printing logging information ... &quot; &lt;&lt; std::endl;
  #endif

  #ifdef WIN32
    std::cout &lt;&lt; &quot;I am compiled on windows&quot; &lt;&lt; std::endl;
  #else
    std::cout &lt;&lt; &quot;I am not compiled on windows&quot; &lt;&lt; std::endl;
  #endif

  #ifdef __cplusplus
    std::cout &lt;&lt; &quot;i am compiled with a c++ compiler&quot; &lt;&lt; std::endl;
  #endif

  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// main.cpp</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#ifdef</span><span style="color: #569CD6"> PRINT_LOGS</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;printing logging information ... &quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#ifdef</span><span style="color: #569CD6"> WIN32</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;I am compiled on windows&quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #C586C0">  #else</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;I am not compiled on windows&quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#ifdef</span><span style="color: #569CD6"> __cplusplus</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;i am compiled with a c++ compiler&quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Preprocessor directives start with the <code>#</code> character. We saw that before in our classes when we declared <code>#pragma once</code>. As a reminder, <code>#pragma once</code> makes sure that each header file is only included once during compilation, even if it is included in several files with an <code>#include</code> statement. If it was included several times, we get a compiler error saying that we have multiple definitions of the same class, because we included that file multiple times during compilation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Whenever you see code that starts with a preprocessor directive (<code>#</code> character), then what will happen is that before your compiler sees the source code for compilation, the preprocessor will go over the file and apply all of these statements. What does that mean? Let's look at lines 5-7. We are saying that if <code>PRINT_LOGS</code> is defined (<code>#ifdef</code> is a shorthand notation for <code>#if defined(PRINT_LOGS)</code>), then go ahead and include everything up until the next <code>#endif</code> statement. If it isn't defined, then remove the entire code. How do we define <code>PRINT_LOGS</code>? During compilation with the <code>/D</code> flag (or <code>-D</code> on <code>g++</code>).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, if we compiled the above code, assumed to be called <code>main.cpp</code>, with <code>cl /DPRINT_LOGS main.cpp</code> on Windows or <code>g++ -DPRINT_LOGS main.cpp</code> on UNIX, our executable would print <code>printing logging information …</code> to the console. Without these definitions, it would simply remove this line.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On lines 9-13 and 15-17 we make use of some system definition. For example, on line 9, we check if we are compiling on Windows, and if we are, we print the statement on line 10. If it is not Windows, then we print line 12. Similarly, we can figure out if we used a C++ compiler on line 15, which can be handy if we want to compile both with a c and C++ compiler.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-necessary-library-modifications">Necessary library modifications</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Ok, so we do understand the preprocessor now. We need that knowledge in a second, but first, we need to understand what we want to achieve. On UNIX, all functions are exported in a way that a dynamic library can consume them. On Windows, unfortunately, it is different for compiling and linking.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Say we are looking at one function of our matrix class <code>void set(unsigned row, unsigned column, double value);</code>. If we compile the code now as a dynamic library, Windows expects us to say which function should be part of the dynamic link library (<code>*.dll</code> file). We do that by exporting that function to the library, and this will then generate the required code in our <code>*.lib</code> library, which we use to make calls to the <code>*.dll</code> library. If we do not export any functions from the <code>*.dll</code> file, then Windows will not generate the <code>*.lib</code> function (as there is nothing to call) and we can't proceed with the linking.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We specify a function to be exported through a Windows-specific command <code>__declspec(dllexport)</code>. So our function would now be <code>__declspec(dllexport)</code> <code>void set(unsigned row, unsigned column, double value);</code>. However, during linking, we don't want to export this function anymore but rather import this function from the generated <code>*.dll</code> file, for which we use <code>__declspec(dllimport)</code>. So, during linking, we are expecting a statement of <code>__declspec(dllimport)</code> <code>void set(unsigned row, unsigned column, double value);</code>. This allows us on Windows to specify which functions to export, while on UNIX all functions are exported by default.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, hopefully, you can see the link now between the preprocessor and the above export/import conditional statement. What we have to do now is modify all of our header files and include the following code directly after <code>#pragma once</code>:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)\n  #if defined(COMPILEDLL)\n    #define LINEARALGEBRALIB_EXPORT __declspec(dllexport)\n  #elif defined(COMPILELIB)\n    #define LINEARALGEBRALIB_EXPORT\n  #else\n    #define LINEARALGEBRALIB_EXPORT __declspec(dllimport)\n  #endif\n#else\n  #define LINEARALGEBRALIB_EXPORT\n#endif","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(_WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__WIN32__) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__NT__)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(COMPILEDLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #elif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(COMPILELIB)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":11,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)
  #if defined(COMPILEDLL)
    #define LINEARALGEBRALIB_EXPORT __declspec(dllexport)
  #elif defined(COMPILELIB)
    #define LINEARALGEBRALIB_EXPORT
  #else
    #define LINEARALGEBRALIB_EXPORT __declspec(dllimport)
  #endif
#else
  #define LINEARALGEBRALIB_EXPORT
#endif" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(_WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__WIN32__) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__NT__)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(COMPILEDLL)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">  #elif</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defined</span><span style="color: #D4D4D4">(COMPILELIB)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">  #else</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The first line checks if we are on Windows. Some systems define it differently, so we try to capture all possible Windows identifications here. Then, line 2 checks if the <code>COMPILEDLL</code> is defined, which is the case when we are trying to build the dynamic library. If this is the case, we define a new variable called LINEARALGEBRALIB_EXPORT (i.e. the convention is to use your library name + <code>_EXPORT</code>) and set it equal to the <code>__declspec(dllexport)</code> we saw before. On the other hand, if we compile a static library (<code>COMPILELIB</code>, line 4), we still define <code>LINEARALGEBRALIB_EXPORT</code> but set it equal to an empty string (by not specifying anything after the name). If we specify neither, we set <code>LINEARALGEBRALIB_EXPORT</code> equal to <code>__declspec(dllimport)</code> and so our linker will be able to import our library.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Line 9 is essentially there for UNIX environments, i.e. if we are not on Windows, we still want to define <code>LINEARALGEBRALIB_EXPORT</code> but set it equal to an empty string again so that we have this variable always defined but only do something in case we want to compile a dynamic library on Windows. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With <code>LINEARALGEBRALIB_EXPORT</code> defined, we are now ready to change our classes. We saw before that we could now append this to all of our functions, but we can also directly inject it into our classes which means we only have to make modifications in one place. Taking the <code>LinearAlgebraSolverBase</code> class as an example, our modified class now looks like:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"class LINEARALGEBRALIB_EXPORT LinearAlgebraSolverBase {\n// ...\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e LINEARALGEBRALIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eLinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="class LINEARALGEBRALIB_EXPORT LinearAlgebraSolverBase {
// ...
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> LINEARALGEBRALIB_EXPORT </span><span style="color: #4EC9B0">LinearAlgebraSolverBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>You see, we just inject this new definition directly in front of the library name and that's it. We have to now copy and paste the preprocessor statements into all header files (or if you want to be a good programmer, create a header file containing all the preprocessor statements and include it in each header file). For completeness, the <code>LinearAlgebraSolverBase</code> class now looks like the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)\n  #if defined(COMPILEDLL)\n    #define LINEARALGEBRALIB_EXPORT __declspec(dllexport)\n  #elif defined(COMPILELIB)\n    #define LINEARALGEBRALIB_EXPORT\n  #else\n    #define LINEARALGEBRALIB_EXPORT __declspec(dllimport)\n  #endif\n#else\n  #define LINEARALGEBRALIB_EXPORT\n#endif\n\n#include \u0022linearAlgebraLib/src/sparseMatrixCSR.hpp\u0022\n#include \u0022linearAlgebraLib/src/vector.hpp\u0022\n\nnamespace linearAlgebraLib {\n\nclass LINEARALGEBRALIB_EXPORT LinearAlgebraSolverBase {\npublic:\n  LinearAlgebraSolverBase(unsigned numberOfCells);\n  virtual ~LinearAlgebraSolverBase() = default;\n\n  void setCoefficientMatrix(const SparseMatrixCSR \u0026amp;matrix);\n  void setRightHandSide(const Vector \u0026amp;rhs);\n  \n  virtual Vector solve(unsigned maxIterations, double convergenceThreshold) = 0;\n\nprotected:\n  SparseMatrixCSR _coefficientMatrix;\n  Vector _rightHandSide;\n};\n\n} // namespace linearAlgebraLib","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(_WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__WIN32__) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__NT__)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(COMPILEDLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #elif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(COMPILELIB)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e LINEARALGEBRALIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/src/sparseMatrixCSR.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/src/vector.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003enamespace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003elinearAlgebraLib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e LINEARALGEBRALIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eLinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eLinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003enumberOfCells\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e~LinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edefault\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esetCoefficientMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eSparseMatrixCSR\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ematrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esetRightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eVector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003erhs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eVector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esolve\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxIterations\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003econvergenceThreshold\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  SparseMatrixCSR _coefficientMatrix;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  Vector _rightHandSide;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // namespace linearAlgebraLib\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":35,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)
  #if defined(COMPILEDLL)
    #define LINEARALGEBRALIB_EXPORT __declspec(dllexport)
  #elif defined(COMPILELIB)
    #define LINEARALGEBRALIB_EXPORT
  #else
    #define LINEARALGEBRALIB_EXPORT __declspec(dllimport)
  #endif
#else
  #define LINEARALGEBRALIB_EXPORT
#endif

#include &quot;linearAlgebraLib/src/sparseMatrixCSR.hpp&quot;
#include &quot;linearAlgebraLib/src/vector.hpp&quot;

namespace linearAlgebraLib {

class LINEARALGEBRALIB_EXPORT LinearAlgebraSolverBase {
public:
  LinearAlgebraSolverBase(unsigned numberOfCells);
  virtual ~LinearAlgebraSolverBase() = default;

  void setCoefficientMatrix(const SparseMatrixCSR &amp;matrix);
  void setRightHandSide(const Vector &amp;rhs);
  
  virtual Vector solve(unsigned maxIterations, double convergenceThreshold) = 0;

protected:
  SparseMatrixCSR _coefficientMatrix;
  Vector _rightHandSide;
};

} // namespace linearAlgebraLib" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(_WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__WIN32__) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__NT__)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(COMPILEDLL)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">  #elif</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defined</span><span style="color: #D4D4D4">(COMPILELIB)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">  #else</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> LINEARALGEBRALIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/src/sparseMatrixCSR.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/src/vector.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">namespace</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">linearAlgebraLib</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> LINEARALGEBRALIB_EXPORT </span><span style="color: #4EC9B0">LinearAlgebraSolverBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">LinearAlgebraSolverBase</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">numberOfCells</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">~LinearAlgebraSolverBase</span><span style="color: #D4D4D4">() = </span><span style="color: #569CD6">default</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setCoefficientMatrix</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">SparseMatrixCSR</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">&amp;</span><span style="color: #9CDCFE">matrix</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">setRightHandSide</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Vector</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">&amp;</span><span style="color: #9CDCFE">rhs</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Vector</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">solve</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">maxIterations</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">convergenceThreshold</span><span style="color: #D4D4D4">) = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  SparseMatrixCSR _coefficientMatrix;</span></span>
<span class="line"><span style="color: #D4D4D4">  Vector _rightHandSide;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">}</span><span style="color: #6A9955"> // namespace linearAlgebraLib</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We just doubled the size of the interface, but that is what we have to do in order to get dynamic libraries to work on Windows. Now it is up to you to decide if it is worth the pain.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, before we finish this section, leave it behind us and perhaps never dare speak or even think about it again, there is <a href="https://atomheartother.github.io/c++/2018/07/12/CPPDynLib.html" target="_blank" rel="noopener" title="">a good article</a> that shows how to achieve cross-platform (Windows, UNIX) compilation of dynamic libraries using CMake. Ultimately, we want to be using a build system such as CMake as well, but for now, we have an idea of what is involved in writing cross-platform libraries ourselves.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As I mentioned earlier, you probably won't find that knowledge condensed in this form elsewhere (which probably means no one cares and no one except me is reading this in the future), but if you are serious about CFD development, cross-platform compilation should be the norm these days. Don't limit yourself to running your code on UNIX only, be bold, and support Windows, even if no one seemingly cares (I do, you have my support!). </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-creating-a-header-only-version">Creating a header-only version</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Ok, so we may decide that this whole static and dynamic library stuff isn't for us. Perhaps you value your sanity and just can't be bothered going through endless lines of compiler errors. Well, don't give up on libraries just yet, there is something in store for you as well. When we discussed <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries" target="_blank" rel="noopener" title="">the differences between static, dynamic, and header-only libraries</a>, we said that header-only libraries do not need to be compiled before usage, but instead contain their entire code in the interface, or header files. This means all we have to do is to include the required header files and we are done.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Even if this means that we have to change all of our code now, I want to show you how you could turn our linear algebra library into a header-only library if that is what you want to do. Since we do have to copy all source code into the header files, the easiest solution is to provide an additional directory within our library folder, as well as a separate header include file. The new project structure is given below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"root\n├── build\n├── linearAlgebraLib\n│   ├── linearAlgebraLib.hpp\n│   ├── headerOnlyLinearAlgebraLib.hpp          // new\n│   ├── src\n│   │   ├── vector.(hpp|cpp)\n│   │   ├── sparseMatrixCSR.(hpp|cpp)\n│   │   ├── linearAlgebraSolverBase.(hpp|cpp)\n│   │   └── conjugateGradient.(hpp|cpp)\n│   └── headerOnly                              // new\n│       ├── vector.hpp                          // new\n│       ├── sparseMatrixCSR.hpp                 // new\n│       ├── linearAlgebraSolverBase.hpp         // new \n│       └── conjugateGradient.hpp               // new\n├── main.cpp\n├── buildAndRun.(sh|bat)\n├── testHeaderOnlyLib.(sh|bat)                  // new\n├── testStaticLib.(sh|bat)\n└── testDynamicLib.(sh|bat)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eroot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── linearAlgebraLib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003elinearAlgebraLib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eheaderOnlyLinearAlgebraLib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e          // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── src\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── vector.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── sparseMatrixCSR.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── linearAlgebraSolverBase.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── conjugateGradient.(hpp|cpp)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── headerOnly\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e                              // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e                          // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esparseMatrixCSR\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e                 // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       ├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003elinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e         // new \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│       └── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003econjugateGradient\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ehpp\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e               // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.(sh|bat)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── testHeaderOnlyLib.(sh|bat)\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e                  // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── testStaticLib.(sh|bat)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── testDynamicLib.(sh|bat)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="root
├── build
├── linearAlgebraLib
│   ├── linearAlgebraLib.hpp
│   ├── headerOnlyLinearAlgebraLib.hpp          // new
│   ├── src
│   │   ├── vector.(hpp|cpp)
│   │   ├── sparseMatrixCSR.(hpp|cpp)
│   │   ├── linearAlgebraSolverBase.(hpp|cpp)
│   │   └── conjugateGradient.(hpp|cpp)
│   └── headerOnly                              // new
│       ├── vector.hpp                          // new
│       ├── sparseMatrixCSR.hpp                 // new
│       ├── linearAlgebraSolverBase.hpp         // new 
│       └── conjugateGradient.hpp               // new
├── main.cpp
├── buildAndRun.(sh|bat)
├── testHeaderOnlyLib.(sh|bat)                  // new
├── testStaticLib.(sh|bat)
└── testDynamicLib.(sh|bat)" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">root</span></span>
<span class="line"><span style="color: #D4D4D4">├── build</span></span>
<span class="line"><span style="color: #D4D4D4">├── linearAlgebraLib</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── </span><span style="color: #9CDCFE">linearAlgebraLib</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── </span><span style="color: #9CDCFE">headerOnlyLinearAlgebraLib</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span><span style="color: #6A9955">          // new</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── src</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── vector.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── sparseMatrixCSR.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── linearAlgebraSolverBase.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── conjugateGradient.(hpp|cpp)</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── headerOnly</span><span style="color: #6A9955">                              // new</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── </span><span style="color: #9CDCFE">vector</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span><span style="color: #6A9955">                          // new</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── </span><span style="color: #9CDCFE">sparseMatrixCSR</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span><span style="color: #6A9955">                 // new</span></span>
<span class="line"><span style="color: #D4D4D4">│       ├── </span><span style="color: #9CDCFE">linearAlgebraSolverBase</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span><span style="color: #6A9955">         // new </span></span>
<span class="line"><span style="color: #D4D4D4">│       └── </span><span style="color: #9CDCFE">conjugateGradient</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">hpp</span><span style="color: #6A9955">               // new</span></span>
<span class="line"><span style="color: #D4D4D4">├── </span><span style="color: #9CDCFE">main</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">cpp</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.(sh|bat)</span></span>
<span class="line"><span style="color: #D4D4D4">├── testHeaderOnlyLib.(sh|bat)</span><span style="color: #6A9955">                  // new</span></span>
<span class="line"><span style="color: #D4D4D4">├── testStaticLib.(sh|bat)</span></span>
<span class="line"><span style="color: #D4D4D4">└── testDynamicLib.(sh|bat)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The updated <code>headerOnlyLinearAlgebraLib.hpp</code> file simply points to the header files in the <code>linearAlgebraLib/headerOnly</code> directory and is given as</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// headerOnlyLinearAlgebraLib.hpp\n#include \u0022headerOnly/sparseMatrixCSR.hpp\u0022\n#include \u0022headerOnly/vector.hpp\u0022\n#include \u0022headerOnly/linearAlgebraSolverBase.hpp\u0022\n#include \u0022headerOnly/conjugateGradient.hpp\u0022\n","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// headerOnlyLinearAlgebraLib.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;headerOnly/sparseMatrixCSR.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;headerOnly/vector.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;headerOnly/linearAlgebraSolverBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;headerOnly/conjugateGradient.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// headerOnlyLinearAlgebraLib.hpp
#include &quot;headerOnly/sparseMatrixCSR.hpp&quot;
#include &quot;headerOnly/vector.hpp&quot;
#include &quot;headerOnly/linearAlgebraSolverBase.hpp&quot;
#include &quot;headerOnly/conjugateGradient.hpp&quot;
" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// headerOnlyLinearAlgebraLib.hpp</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;headerOnly/sparseMatrixCSR.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;headerOnly/vector.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;headerOnly/linearAlgebraSolverBase.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;headerOnly/conjugateGradient.hpp&quot;</span></span>
<span class="line"></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The remaining files in the <code>headerOnly</code> directory simply contain the interface (class structure) and all of the implementation. Let's look at the <code>conjugateGradient.hpp</code> file this time as an example, its content is now given as</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// conjugateGradient.hpp\n#pragma once\n\n#include \u0026lt;iostream\u003e\n\n#include \u0022linearAlgebraLib/headerOnly/linearAlgebraSolverBase.hpp\u0022\n#include \u0022linearAlgebraLib/headerOnly/sparseMatrixCSR.hpp\u0022\n#include \u0022linearAlgebraLib/headerOnly/vector.hpp\u0022\n\nnamespace linearAlgebraLib {\n\nclass ConjugateGradient : public LinearAlgebraSolverBase {\npublic:\n  ConjugateGradient(unsigned numberOfCells) : LinearAlgebraSolverBase(numberOfCells) { }\n\n  virtual Vector solve(unsigned maxIterations, double convergenceThreshold) final override {\n    Vector r0(_rightHandSide.size());\n    Vector r1(_rightHandSide.size());\n    Vector p0(_rightHandSide.size());\n    Vector p1(_rightHandSide.size());\n    Vector x(_rightHandSide.size());\n\n    auto \u0026amp;A = _coefficientMatrix;\n    auto \u0026amp;b = _rightHandSide;\n    \n    double alpha = 0.0;\n    double beta = 0.0;\n\n    unsigned iteration = 0;\n\n    p1 = b - A * x;\n    r1 = b - A * x;\n\n    do {\n      r0 = r1;\n      p0 = p1;\n\n      alpha = (r0.transpose() * r0) / (p0.transpose() * (A * p0));\n      x = x + alpha * p0;\n      r1 = r0 - alpha * A * p0;\n      beta = (r1.transpose() * r1) / (r0.transpose() * r0);\n      p1 = r1 + beta * p0;\n\n      ++iteration;\n    } while (iteration \u0026lt; maxIterations \u0026amp;\u0026amp; r1.getL2Norm() \u003e convergenceThreshold);\n\n    return x;\n  }\n};\n\n} // namespace linearAlgebraLib","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// conjugateGradient.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/headerOnly/linearAlgebraSolverBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/headerOnly/sparseMatrixCSR.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/headerOnly/vector.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003enamespace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003elinearAlgebraLib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eConjugateGradient\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eLinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eConjugateGradient\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003enumberOfCells\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) : \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eLinearAlgebraSolverBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCells) { }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eVector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esolve\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxIterations\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003econvergenceThreshold\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    Vector \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003er0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_rightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    Vector \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003er1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_rightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    Vector \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ep0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_rightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    Vector \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ep1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_rightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    Vector \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_rightHandSide\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;A = _coefficientMatrix;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;b = _rightHandSide;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e alpha = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e beta = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0.0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e iteration = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    p1 = b - A * x;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    r1 = b - A * x;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edo\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      r0 = r1;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      p0 = p1;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      alpha = (\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003er0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etranspose\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() * r0) / (\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ep0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etranspose\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() * (A * p0));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      x = x + alpha * p0;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      r1 = r0 - alpha * A * p0;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      beta = (\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003er1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etranspose\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() * r1) / (\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003er0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etranspose\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() * r0);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      p1 = r1 + beta * p0;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      ++iteration;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    } \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ewhile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (iteration \u0026lt; maxIterations \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003er1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetL2Norm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u0026gt; convergenceThreshold);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e x;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // namespace linearAlgebraLib\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":51,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// conjugateGradient.hpp
#pragma once

#include &lt;iostream&gt;

#include &quot;linearAlgebraLib/headerOnly/linearAlgebraSolverBase.hpp&quot;
#include &quot;linearAlgebraLib/headerOnly/sparseMatrixCSR.hpp&quot;
#include &quot;linearAlgebraLib/headerOnly/vector.hpp&quot;

namespace linearAlgebraLib {

class ConjugateGradient : public LinearAlgebraSolverBase {
public:
  ConjugateGradient(unsigned numberOfCells) : LinearAlgebraSolverBase(numberOfCells) { }

  virtual Vector solve(unsigned maxIterations, double convergenceThreshold) final override {
    Vector r0(_rightHandSide.size());
    Vector r1(_rightHandSide.size());
    Vector p0(_rightHandSide.size());
    Vector p1(_rightHandSide.size());
    Vector x(_rightHandSide.size());

    auto &amp;A = _coefficientMatrix;
    auto &amp;b = _rightHandSide;
    
    double alpha = 0.0;
    double beta = 0.0;

    unsigned iteration = 0;

    p1 = b - A * x;
    r1 = b - A * x;

    do {
      r0 = r1;
      p0 = p1;

      alpha = (r0.transpose() * r0) / (p0.transpose() * (A * p0));
      x = x + alpha * p0;
      r1 = r0 - alpha * A * p0;
      beta = (r1.transpose() * r1) / (r0.transpose() * r0);
      p1 = r1 + beta * p0;

      ++iteration;
    } while (iteration &lt; maxIterations &amp;&amp; r1.getL2Norm() &gt; convergenceThreshold);

    return x;
  }
};

} // namespace linearAlgebraLib" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// conjugateGradient.hpp</span></span>
<span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/headerOnly/linearAlgebraSolverBase.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/headerOnly/sparseMatrixCSR.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/headerOnly/vector.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">namespace</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">linearAlgebraLib</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ConjugateGradient</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">LinearAlgebraSolverBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ConjugateGradient</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">numberOfCells</span><span style="color: #D4D4D4">) : </span><span style="color: #DCDCAA">LinearAlgebraSolverBase</span><span style="color: #D4D4D4">(numberOfCells) { }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Vector</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">solve</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">maxIterations</span><span style="color: #D4D4D4">, </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">convergenceThreshold</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    Vector </span><span style="color: #DCDCAA">r0</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_rightHandSide</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">());</span></span>
<span class="line"><span style="color: #D4D4D4">    Vector </span><span style="color: #DCDCAA">r1</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_rightHandSide</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">());</span></span>
<span class="line"><span style="color: #D4D4D4">    Vector </span><span style="color: #DCDCAA">p0</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_rightHandSide</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">());</span></span>
<span class="line"><span style="color: #D4D4D4">    Vector </span><span style="color: #DCDCAA">p1</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_rightHandSide</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">());</span></span>
<span class="line"><span style="color: #D4D4D4">    Vector </span><span style="color: #DCDCAA">x</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_rightHandSide</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> &amp;A = _coefficientMatrix;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> &amp;b = _rightHandSide;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> alpha = </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">double</span><span style="color: #D4D4D4"> beta = </span><span style="color: #B5CEA8">0.0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> iteration = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    p1 = b - A * x;</span></span>
<span class="line"><span style="color: #D4D4D4">    r1 = b - A * x;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">do</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      r0 = r1;</span></span>
<span class="line"><span style="color: #D4D4D4">      p0 = p1;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      alpha = (</span><span style="color: #9CDCFE">r0</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">transpose</span><span style="color: #D4D4D4">() * r0) / (</span><span style="color: #9CDCFE">p0</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">transpose</span><span style="color: #D4D4D4">() * (A * p0));</span></span>
<span class="line"><span style="color: #D4D4D4">      x = x + alpha * p0;</span></span>
<span class="line"><span style="color: #D4D4D4">      r1 = r0 - alpha * A * p0;</span></span>
<span class="line"><span style="color: #D4D4D4">      beta = (</span><span style="color: #9CDCFE">r1</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">transpose</span><span style="color: #D4D4D4">() * r1) / (</span><span style="color: #9CDCFE">r0</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">transpose</span><span style="color: #D4D4D4">() * r0);</span></span>
<span class="line"><span style="color: #D4D4D4">      p1 = r1 + beta * p0;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      ++iteration;</span></span>
<span class="line"><span style="color: #D4D4D4">    } </span><span style="color: #C586C0">while</span><span style="color: #D4D4D4"> (iteration &lt; maxIterations &amp;&amp; </span><span style="color: #9CDCFE">r1</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">getL2Norm</span><span style="color: #D4D4D4">() &gt; convergenceThreshold);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> x;</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">}</span><span style="color: #6A9955"> // namespace linearAlgebraLib</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Where we only declared the <code>solve()</code> function on line 16 before and then provided the implementation in a <code>conjugateGradient.cpp</code> file afterwards, we now have both the definition and implementation in the same file. This is all we have to do for all header files, at which point all code has migrated into the interface.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Since we have now two competing header files we can use for our library (the header-only version or the one we used for the static and dynamic libraries before), we have to modify our <code>main.cpp</code> file a bit. Thankfully, we know about the preprocessor magic now and can reuse it in the header file as well. Before, our main.cpp file started in the following way:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0022linearAlgebraLib/linearAlgebraLib.hpp\u0022\n\n// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate\n// gradient methdod\n// initial condition: 0 everywhere\n// boundary condition: T(0) = 0, T(L) = 1\nint main() {\n // code ...\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/linearAlgebraLib.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// gradient methdod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// initial condition: 0 everywhere\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// boundary condition: T(0) = 0, T(L) = 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e // code ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":9,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &quot;linearAlgebraLib/linearAlgebraLib.hpp&quot;

// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate
// gradient methdod
// initial condition: 0 everywhere
// boundary condition: T(0) = 0, T(L) = 1
int main() {
 // code ...
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/linearAlgebraLib.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate</span></span>
<span class="line"><span style="color: #6A9955">// gradient methdod</span></span>
<span class="line"><span style="color: #6A9955">// initial condition: 0 everywhere</span></span>
<span class="line"><span style="color: #6A9955">// boundary condition: T(0) = 0, T(L) = 1</span></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955"> // code ...</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>But now, we are going to change line 1 so we have now</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#ifdef HEADERONLYLIB\n  #include \u0022linearAlgebraLib/headerOnlyLinearAlgebraLib.hpp\u0022\n#else\n  #include \u0022linearAlgebraLib/linearAlgebraLib.hpp\u0022\n#endif\n\n// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate\n// gradient methdod\n// initial condition: 0 everywhere\n// boundary condition: T(0) = 0, T(L) = 1\nint main() {\n  // code ...\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#ifdef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e HEADERONLYLIB\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/headerOnlyLinearAlgebraLib.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;linearAlgebraLib/linearAlgebraLib.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// gradient methdod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// initial condition: 0 everywhere\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// boundary condition: T(0) = 0, T(L) = 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // code ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#ifdef HEADERONLYLIB
  #include &quot;linearAlgebraLib/headerOnlyLinearAlgebraLib.hpp&quot;
#else
  #include &quot;linearAlgebraLib/linearAlgebraLib.hpp&quot;
#endif

// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate
// gradient methdod
// initial condition: 0 everywhere
// boundary condition: T(0) = 0, T(L) = 1
int main() {
  // code ...
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#ifdef</span><span style="color: #569CD6"> HEADERONLYLIB</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/headerOnlyLinearAlgebraLib.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;linearAlgebraLib/linearAlgebraLib.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// solve the heat equation implicitly of the form dT/dt = gamma * d^2 T/ dx^2 over a domain L using the conjugate</span></span>
<span class="line"><span style="color: #6A9955">// gradient methdod</span></span>
<span class="line"><span style="color: #6A9955">// initial condition: 0 everywhere</span></span>
<span class="line"><span style="color: #6A9955">// boundary condition: T(0) = 0, T(L) = 1</span></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // code ...</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We define a macro called <code>HEADERONLYLIB</code>. If this is defined during compilation, then we include the header-only version of the library, if it isn't defined, we fall back on the static/dynamic library header. This means we end up with the following build scripts on UNIX, named <code>testHeaderOnlyLib.sh</code>:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile main function and link against header-only library\ng++ -g -O0 -Wall -Wextra -I. -DHEADERONLYLIB -o build/headerOnlyLibExample main.cpp\n\n# run\necho \u0022Running header-only library example\u0022\n./build/headerOnlyLibExample","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile main function and link against header-only library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-g\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-O0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wall\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-Wextra\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-DHEADERONLYLIB\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild/headerOnlyLibExample\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003emain.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Running header-only library example\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/headerOnlyLibExample\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":11,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile main function and link against header-only library
g++ -g -O0 -Wall -Wextra -I. -DHEADERONLYLIB -o build/headerOnlyLibExample main.cpp

# run
echo &quot;Running header-only library example&quot;
./build/headerOnlyLibExample" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile main function and link against header-only library</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-g</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-O0</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wall</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-Wextra</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-DHEADERONLYLIB</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build/headerOnlyLibExample</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">main.cpp</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run</span></span>
<span class="line"><span style="color: #DCDCAA">echo</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;Running header-only library example&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">./build/headerOnlyLibExample</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>And, the corresponding build script on Windows, named <code>testHeaderOnlyLib.bat</code> becomes:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"@echo off\n\ndel /q build\nmkdir build\n\nREM compile main function and link against header-only library\ncl /nologo /Zi /EHsc /Od /I. /DHEADERONLYLIB /Fe:build\\headerOnlyLibExample.exe main.cpp\n\nREM remove object files\ndel *.obj\n\nREM run\necho Running header-only library example\nbuild\\headerOnlyLibExample.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e@\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoff\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /q build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e compile main function and link against header-only library\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ecl /nologo /Zi /EHsc /Od /I. /DHEADERONLYLIB /Fe:build\\headerOnlyLibExample.exe main.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e remove object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edel\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e *.obj\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eREM\u003c/span\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e run\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eecho\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e Running header-only library example\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003ebuild\\headerOnlyLibExample.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bat","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="@echo off

del /q build
mkdir build

REM compile main function and link against header-only library
cl /nologo /Zi /EHsc /Od /I. /DHEADERONLYLIB /Fe:build\headerOnlyLibExample.exe main.cpp

REM remove object files
del *.obj

REM run
echo Running header-only library example
build\headerOnlyLibExample.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">@</span><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">off</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> /q build</span></span>
<span class="line"><span style="color: #569CD6">mkdir</span><span style="color: #D4D4D4"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> compile main function and link against header-only library</span></span>
<span class="line"><span style="color: #D4D4D4">cl /nologo /Zi /EHsc /Od /I. /DHEADERONLYLIB /Fe:build\headerOnlyLibExample.exe main.cpp</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> remove object files</span></span>
<span class="line"><span style="color: #569CD6">del</span><span style="color: #D4D4D4"> *.obj</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">REM</span><span style="color: #6A9955"> run</span></span>
<span class="line"><span style="color: #569CD6">echo</span><span style="color: #D4D4D4"> Running header-only library example</span></span>
<span class="line"><span style="color: #D4D4D4">build\headerOnlyLibExample.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Both of these files are located in our root directory, next to the <code>testDynamicLib.(sh|bat)</code> and <code>testStaticLib.(sh|bat)</code>. Notice the absence of the compilation requirement for the library code, since all is located in the header file, we only need to compile the <code>main.cpp</code> function, which is done on line 7. For both UNIX and Windows, we create a <code>HEADERONLYLIB</code> define through the <code>-D</code> and <code>/D</code> flag, respectively, which will import the correct header for us. Since we only have a single source file to compile, we can let the compiler directly create an executable. To do so, we have removed the <code>-c</code> and <code>/c</code> compiler flag, which instructs the compiler to create the object files instead of the executable directly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We also used to have a statement to remove any build artefacts (object files) for our UNIX build script. Since we compile straight into an executable, we no longer need that, since no intermediary object files are created. On Windows, we kept it as the <code>cl</code> compiler will still create that intermediate object file and will dump it next to our source file, i.e. <code>main.cpp</code>. So we kept the <code>del</code> command but point it to the root directory this time, not the build directory.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, there you have it, a header-only version of our library as well. These libraries are very popular for C++-only libraries that make liberal use of templates. If you want to write your library with lots of template usage, header-only libraries are the way to go. If you want to support other programming languages such as C, Fortran, or even Python, templates can still be used but complicate the library creation (we essentially have to specify ahead of time what possible types to expect for the template and then all versions of that will be created). If this is where you want to be heading, <a href="https://www.swig.org/" target="_blank" rel="noopener" title="">SWIG</a> can help you with that.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-testing-our-library-for-correctness">Testing our libraries for correctness</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Ok, we have come a long way. We have written the code, we have provided build scripts and we have written a test (our <code>main.cpp</code> file). At this point, we simply want to test all of our code with the build scripts. Running the <code>testStaticLib.sh</code>, <code>testDynamicLib.sh</code>, and <code>testHeaderOnlyLib.sh</code> on UNIX provides the following output:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./testStaticLib.sh\nRunning static library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./testStaticLib.sh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003estatic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="./testStaticLib.sh
Running static library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./testStaticLib.sh</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">static</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./testDynamicLib.sh\nRunning dynamic library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./testDynamicLib.sh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003edynamic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="./testDynamicLib.sh
Running dynamic library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./testDynamicLib.sh</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">dynamic</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"./testHeaderOnlyLib.sh\nRunning header-only library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./testHeaderOnlyLib.sh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eheader-only\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="./testHeaderOnlyLib.sh
Running header-only library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">./testHeaderOnlyLib.sh</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">header-only</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>On Windows, we get the following output after running the <code>testStaticLib.bat</code>, <code>testDynamicLib.bat</code>, and <code>testHeaderOnlyLib.bat</code> files:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\testStaticLib.bat    \nA subdirectory or file build already exists.\nsparseMatrixCSR.cpp\nvector.cpp\nlinearAlgebraSolverBase.cpp\nconjugateGradient.cpp\nmain.cpp\nRunning static library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\\testStaticLib.bat    \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eA\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esubdirectory\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ealready\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexists.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esparseMatrixCSR.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003evector.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003elinearAlgebraSolverBase.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003econjugateGradient.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003estatic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":9,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code=".\testStaticLib.bat    
A subdirectory or file build already exists.
sparseMatrixCSR.cpp
vector.cpp
linearAlgebraSolverBase.cpp
conjugateGradient.cpp
main.cpp
Running static library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">.</span><span style="color: #D4D4D4">\testStaticLib.bat    </span></span>
<span class="line"><span style="color: #DCDCAA">A</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">subdirectory</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">or</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">file</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">already</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">exists.</span></span>
<span class="line"><span style="color: #DCDCAA">sparseMatrixCSR.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">vector.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">linearAlgebraSolverBase.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">conjugateGradient.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">main.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">static</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\testDynamicLib.bat   \nA subdirectory or file build already exists.\nsparseMatrixCSR.cpp\nvector.cpp\nlinearAlgebraSolverBase.cpp\nconjugateGradient.cpp\nmain.cpp\n   Creating library build\\dynamicLinearAlgebra.lib and object build\\dynamicLinearAlgebra.exp\n   Creating library build\\dynamicLibExample.lib and object build\\dynamicLibExample.exp\nRunning dynamic library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\\testDynamicLib.bat   \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eA\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esubdirectory\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ealready\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexists.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esparseMatrixCSR.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003evector.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003elinearAlgebraSolverBase.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003econjugateGradient.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e   \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCreating\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\d\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eynamicLinearAlgebra.lib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eand\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eobject\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\d\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eynamicLinearAlgebra.exp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e   \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCreating\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\d\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eynamicLibExample.lib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eand\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eobject\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D7BA7D\u0022\u003e\\d\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eynamicLibExample.exp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003edynamic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":11,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code=".\testDynamicLib.bat   
A subdirectory or file build already exists.
sparseMatrixCSR.cpp
vector.cpp
linearAlgebraSolverBase.cpp
conjugateGradient.cpp
main.cpp
   Creating library build\dynamicLinearAlgebra.lib and object build\dynamicLinearAlgebra.exp
   Creating library build\dynamicLibExample.lib and object build\dynamicLibExample.exp
Running dynamic library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">.</span><span style="color: #D4D4D4">\testDynamicLib.bat   </span></span>
<span class="line"><span style="color: #DCDCAA">A</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">subdirectory</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">or</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">file</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">already</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">exists.</span></span>
<span class="line"><span style="color: #DCDCAA">sparseMatrixCSR.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">vector.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">linearAlgebraSolverBase.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">conjugateGradient.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">main.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">   </span><span style="color: #DCDCAA">Creating</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">ynamicLinearAlgebra.lib</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">and</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">object</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">ynamicLinearAlgebra.exp</span></span>
<span class="line"><span style="color: #D4D4D4">   </span><span style="color: #DCDCAA">Creating</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">ynamicLibExample.lib</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">and</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">object</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D7BA7D">\d</span><span style="color: #CE9178">ynamicLibExample.exp</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">dynamic</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:kevinbatdorf/code-block-pro {"code":".\\testHeaderOnlyLib.bat\nA subdirectory or file build already exists.\nmain.cpp\nRunning header-only library example\nSimulation successful, final residual: 4.72557e-15","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\\testHeaderOnlyLib.bat\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eA\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esubdirectory\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efile\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ealready\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexists.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRunning\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eheader-only\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003elibrary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eexample\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eSimulation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003esuccessful,\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003eresidual:\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4.72557\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ee-15\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code=".\testHeaderOnlyLib.bat
A subdirectory or file build already exists.
main.cpp
Running header-only library example
Simulation successful, final residual: 4.72557e-15" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">.</span><span style="color: #D4D4D4">\testHeaderOnlyLib.bat</span></span>
<span class="line"><span style="color: #DCDCAA">A</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">subdirectory</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">or</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">file</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">already</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">exists.</span></span>
<span class="line"><span style="color: #DCDCAA">main.cpp</span></span>
<span class="line"><span style="color: #DCDCAA">Running</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">header-only</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">library</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">example</span></span>
<span class="line"><span style="color: #DCDCAA">Simulation</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">successful,</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">final</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">residual:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">4.72557</span><span style="color: #CE9178">e-15</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>While we see some more verbose output on Windows, what I want to point out here is that regardless of the operating system or library type, we are always getting the same final residual, to the last digit. This is to be expected if we change the library type, as long as we stay on the same operating system but if you are getting different values for different operating systems, that can happen as well. The importance here is that regardless of the library type (static, dynamic, header-only) we get the same result. And with that, we are done, we have generated our own library that we can reuse in the future (and we will come back to it).</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This article was again a somewhat longer write-up but I felt it was important to have everything in one place, and not to split it up over two or three sections. I hope you don't mind. But what we have achieved here is to take our library code and compile that into either a static, dynamic, or header-only library.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It is not up to you to decide which type you want to support for your libraries, but let me give you some pointers that may help you decide which library type is best for you:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>Static libraries</strong>: Use static libraries for small-ish projects. The total size of your library is not going to be a problem and user won't complain that their executable file is getting too large. They are the simplest to build and link against. Once linked, i.e. embedded into the executable, you won't face any runtime issues and this user-friendliness can save you and your end-users a lot of headaches.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>Dynamic libraries</strong>: While static libraries are compiled into the executable, dynamic libraries are loaded at runtime only when needed. This means no need to embed them into your code and for larger software projects (we are talking 10000+ lines of code), dynamic libraries are probably what you want to go for. So, if you download your favourite open-source library which contains 100,000+ lines of code, you probably want to compile them as a dynamic library. Another advantage is that you can keep using your code without recompiling it, even when the dynamic library changes. Since the dynamic library is loaded at runtime, you can replace an older version with a newer version. As long as the interface doesn't change, you don't have to change your code and thus there is no need to recompile your code.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>Header-only libraries</strong>: These libraries are good for two types: Either you want to make heavy use of templates (then header-only libraries really are your only option) or you want to provide a very user-friendly library, i.e. one which is easy to include for others in their project. As long as the library is small in size, that is usually a good option, but keep in mind that header-only libraries can't be compiled ahead of time. That means that every time you include a header-only library in your code, you have to compile the library every time you compile your code that includes it. This can significantly increase development time. It is not uncommon to jump from a few seconds to a few minutes in compilation time. You may tolerate it at first, but it can really frustrate you in the long run. I'm speaking from experience here.  </li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>So there you have it. By now, you should have a good understanding of the differences in library types and how to write your own library. I don't want to stop here just yet, there is still a bit more to cover. In the remaining articles of this series, I want to look at how to work with already developed third-party CFD libraries and how you can bring those into your code. I hope you are looking forward to that and I'll see you in the next article. </p>
<!-- /wp:paragraph -->