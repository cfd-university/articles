<!-- wp:paragraph -->
<p>In this article, we will look at implementing a base class from which we will derive all future mesh reading classes (for structured and unstructured grids). This implementation will already contain some functionality to interact with the CGNS file and read some basic information, so we will get a feel for how to work with CGNS files and what functions to call to read the required information. Along with the base class, we also set up the project structure, including the build scripts for Windows and UNIX, as well as a first implementation of the <code>main.cpp</code> file, which will serve as a test file to read our different types of grids.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>By the end of this article, you should have a good grasp of the class structure required to read either a structured or unstructured mesh file and through the exposure of the CGNS mid-level library calls that we will carry out, you should also feel comfortable reading basic information from a CGNS file such as reading the number of bases, zones, families, as well as reading boundary conditions directly from he family nodes.</p>
<!-- /wp:paragraph -->

<!-- wp:block {"ref":2490} /-->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>Download</strong>: <a href="https://cfd.university/download/cgnsmeshreaderlib-part2/?tmstv=1712896735" title="">cgnsMeshReaderLib-Part-2.zip</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":8,"blockClientId":"fdb9dd5d-b1a5-4e62-a427-67d8b5233345","content":"Introduction","level":2,"anchor":"aioseo-introduction","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":11,"blockClientId":"d9eab4e4-26b9-418f-9097-70e090db2f9a","content":"Project structure","level":2,"anchor":"aioseo-project-structure","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":20,"blockClientId":"1b45d80f-ab28-4273-afba-4ce2bf667f15","content":"Cross-platform Build scripts","level":2,"anchor":"aioseo-cross-platform-build-scripts","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":22,"blockClientId":"067eb9cf-9afd-4a61-9e3d-2d47baf9c2cf","content":"Compiling on Windows","level":3,"anchor":"aioseo-compiling-on-windows","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":37,"blockClientId":"df46f82e-c310-4d72-a516-55015a2e1920","content":"Compiling on UNIX","level":3,"anchor":"aioseo-compiling-on-unix","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":46,"blockClientId":"3ae4d8be-c767-4679-a9e4-0711dc70c9d7","content":"The mesh reading base class","level":2,"anchor":"aioseo-the-mesh-reading-base-class","order":5,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":48,"blockClientId":"b50df430-0a02-4b32-860f-32c308a2d176","content":"Custom types","level":3,"anchor":"aioseo-custom-types","order":6,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":59,"blockClientId":"f2e621de-4d0a-43f2-8590-b6d034673b2c","content":"The library interface","level":3,"anchor":"aioseo-the-library-interface-meshreader-hpp","order":7,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":63,"blockClientId":"613bc6a3-84cd-4390-a160-c9b1c3c1057c","content":"The base class interface","level":3,"anchor":"aioseo-the-interface-header-file","order":8,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":67,"blockClientId":"09824a77-7504-4b74-bdb7-736f08575844","content":"Required pre-processor directives for dynamic library linkage","level":4,"anchor":"aioseo-required-pre-processor-directives-for-dynamic-library-linkage","order":9,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":69,"blockClientId":"6365be0e-7249-4c98-ae3d-d19bb053242f","content":"Custom types for interface and boundary condition information","level":4,"anchor":"aioseo-custom-types-for-interface-and-boundary-condition-information","order":10,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":87,"blockClientId":"704b36c0-c59b-4ba9-9546-7f72986925ca","content":"Base class for the mesh reading library","level":4,"anchor":"aioseo-base-class-for","order":11,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":98,"blockClientId":"86be7e9d-eeec-4503-af16-85784d70bcd9","content":"The implementation (source file)","level":3,"anchor":"aioseo-the-implementation-source-file","order":12,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":101,"blockClientId":"3524bb50-8a11-40b0-8e72-19c40fec4b7a","content":"The constructor and destructor","level":4,"anchor":"aioseo-the-constructor-and-destructor","order":13,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":114,"blockClientId":"99f4e1c0-1517-4ddb-bbd3-adb2acbaec27","content":"Reading the number of bases","level":4,"anchor":"aioseo-reading-the-number-of-bases","order":14,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":120,"blockClientId":"9af5a5b9-dea7-4a2c-81de-67446eba086f","content":"Reading all zones and zone information","level":4,"anchor":"aioseo-reading-all-zones-and-zone-information","order":15,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":132,"blockClientId":"2df4c43c-e951-4bd7-a3db-989f2efd1dc3","content":"Creating a boundary condition lookup table","level":4,"anchor":"aioseo-creating-a-boundary-condition-lookup-table","order":16,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":137,"blockClientId":"934f1e4b-193b-4aa3-a5b6-b045dc441036","content":"Mapping CGNS boundary conditions ID","level":4,"anchor":"aioseo-mapping-cgns-boundary-conditions-id","order":17,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":150,"blockClientId":"f2dc8b85-a008-4c27-ae80-5933d7a2440a","content":"Initial library testing","level":3,"anchor":"aioseo-initial-library-testing-the-main-cpp-file","order":18,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":153,"blockClientId":"6c6b469a-a68c-4113-9fbd-07e473d64c92","content":"Summary","level":2,"anchor":"aioseo-summary","order":19,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-introduction">Introduction</a></li><li><a href="#aioseo-project-structure">Project structure</a></li><li><a href="#aioseo-cross-platform-build-scripts">Cross-platform Build scripts</a><ul><li><a href="#aioseo-compiling-on-windows">Compiling on Windows</a></li><li><a href="#aioseo-compiling-on-unix">Compiling on UNIX</a></li></ul></li><li><a href="#aioseo-the-mesh-reading-base-class">The mesh reading base class</a><ul><li><a href="#aioseo-custom-types">Custom types</a></li><li><a href="#aioseo-the-library-interface-meshreader-hpp">The library interface</a></li><li><a href="#aioseo-the-interface-header-file">The base class interface</a><ul><li><a href="#aioseo-required-pre-processor-directives-for-dynamic-library-linkage">Required pre-processor directives for dynamic library linkage</a></li><li><a href="#aioseo-custom-types-for-interface-and-boundary-condition-information">Custom types for interface and boundary condition information</a></li><li><a href="#aioseo-base-class-for">Base class for the mesh reading library</a></li></ul></li><li><a href="#aioseo-the-implementation-source-file">The implementation (source file)</a><ul><li><a href="#aioseo-the-constructor-and-destructor">The constructor and destructor</a></li><li><a href="#aioseo-reading-the-number-of-bases">Reading the number of bases</a></li><li><a href="#aioseo-reading-all-zones-and-zone-information">Reading all zones and zone information</a></li><li><a href="#aioseo-creating-a-boundary-condition-lookup-table">Creating a boundary condition lookup table</a></li><li><a href="#aioseo-mapping-cgns-boundary-conditions-id">Mapping CGNS boundary conditions ID</a></li></ul></li><li><a href="#aioseo-initial-library-testing-the-main-cpp-file">Initial library testing</a></li></ul></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-introduction">Introduction</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In the previous two articles, I introduced you to the general structure of a CGNS file, what it can (and currently still) can't do, and I also laid out my motivation for why we ought to learn this format if we are serious about CFD development. We used the utility <code>cgnslist</code>, which is compiled as part of the CGNS library and sits among various other CGNS tools that we haven't looked at for now. With <code>cgnslist</code>, we were able to inspect 4 different structured and unstructured grids that we want to read with our mesh reading library that we will create as part of this series.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In today's article, we will look at the basic library structure, the build scripts for Windows and UNIX (Linux, macOS), and then develop a base class from which we will derive a structured and unstructured mesh reading version. Both these classes will be developed in the next two articles. We are also going to start to write some code to test our library, which we will put, for now, in the <code>main.cpp</code> file. There is a more formal process for testing software and this will be introduced in a different series. For now, we just use this file to test and make sure that we are happy that these files have been read correctly.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-project-structure">Project structure</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's start with a high-level overview of our project/library structure. We will develop an initial structure in this article, and then build upon this in the next articles that follow. The project structure that we will be working with looks like the one shown below (and you can download this initial project using the zip file linked at the beginning of this article):</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"meshReadingLibRoot\n├── mesh\n│   ├── structured2D.cgns\n│   ├── structured2DNoFamily.cgns\n│   ├── unstructured2D.cgns\n│   └── unstructured2DNoFamily.cgns\n├── meshReaderLib\n│   ├── include\n│   │   ├── readMeshBase.hpp\n│   │   └── types.hpp\n│   ├── src\n│   │   └── readMeshBase.cpp\n│   └── meshReader.hpp\n├── buildAndRun.ps1\n├── buildAndRun.sh\n└── main.cpp","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003emeshReadingLibRoot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── mesh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── structured2D.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── structured2DNoFamily.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── unstructured2D.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── unstructured2DNoFamily.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── meshReaderLib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── include\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── readMeshBase.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── types.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── src\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── readMeshBase.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── meshReader.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.ps1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.sh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── main.cpp\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":16,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="meshReadingLibRoot
├── mesh
│   ├── structured2D.cgns
│   ├── structured2DNoFamily.cgns
│   ├── unstructured2D.cgns
│   └── unstructured2DNoFamily.cgns
├── meshReaderLib
│   ├── include
│   │   ├── readMeshBase.hpp
│   │   └── types.hpp
│   ├── src
│   │   └── readMeshBase.cpp
│   └── meshReader.hpp
├── buildAndRun.ps1
├── buildAndRun.sh
└── main.cpp" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">meshReadingLibRoot</span></span>
<span class="line"><span style="color: #D4D4D4">├── mesh</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── structured2D.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── structured2DNoFamily.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── unstructured2D.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── unstructured2DNoFamily.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">├── meshReaderLib</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── include</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── readMeshBase.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── types.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── src</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── readMeshBase.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── meshReader.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.ps1</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.sh</span></span>
<span class="line"><span style="color: #D4D4D4">└── main.cpp</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We have already looked in detail at the <code>mesh/</code> folder and its content in the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-inspect-structured-and-unstructured-grids-using-cgns" target="_blank" rel="noopener" title="">previous article</a>. The <code>meshReaderLib/</code> contains the actual library that we want to develop. As usual, we split the interface/API (application programming interface) and the implementation into two separate folders. Within the meshReaderLib/include/ folder, we collect all header files that tell us what functions need to be implemented and also single to a user of this library which functions to call. We then implement these functions in files stored within the <code>meshReaderLib/src/</code> folder.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For the moment, there are only the <code>readMeshBase.hpp</code> (header) and <code>readMeshBase.cpp</code> (source) files, but as stated above, we will fill these folders with structured and unstructured mesh reading classes as we go along in this series. You'll also notice a file called <code>types.hpp</code>, which is located in the <code>include/</code> folder. This is a personal preference; I like to have a dedicated place in my libraries where I can define custom types and, in particular, <code>enum</code>s. We will start populating it today and then use it throughout this series.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When we want to use our library, we need to first compile it as a static/dynamic library (we will develop the build scripts for that towards the end of this series). If you are unsure what the difference is between static/dynamic libraries, we looked at that in much greater depth before in my article on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries" target="_blank" rel="noopener" title="">static, dynamic, and header-only libraries</a>. The next thing we need to do is to provide an interface to the library. This is what the <code>meshReaderLib/meshReader.hpp</code> file is for; we include this file in the code where we want to use the mesh reading library, and it will provide all the information to the compiler to use this library. The linker will then get the remaining information from the compiled libraries.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The two build scripts that we will use for now are called <code>buildAndRun.ps1</code> (Windows) and <code>buildAndRun.sh</code> (UNIX). If you are an astute observer, you'll notice that we used batch files on Windows before (i.e. <code>buildAndRun.bat</code>), see my previous series on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-basic-library-structure" target="_blank" rel="noopener" title="">how to build a linear algebra library - basic project structure</a>. Batch files are pretty much outdated by now so we will be using the more up-to-date PowerShell scripting language, and those files end in <code>*.ps1</code>. The build script we developed before should still run as a PowerShell script, it is just the file extension that has changed.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As alluded to above, the <code>main.cpp</code> file, for now, will just be a dumping ground to test that the library reading was successful and that no error messages were encountered during the mesh reading. We will extend this function a bit more in the final part of this series, where we will do some more serious testing to ensure our implementation is actually doing what it is supposed to.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-cross-platform-build-scripts">Cross-platform Build scripts</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's have a look then at the build scripts we will be using to compile this library on Windows or UNIX (Linux, macOS). We will create an initial structure for these build scripts and then update them as we add more files to our library. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-compiling-on-windows">Compiling on Windows</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The build script for Windows (<code>buildAndRun.ps1</code>) is shown below:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"# clean up before building\nRemove-Item .\\build -Force -Recurse\nNew-Item -Name \u0022build\u0022 -ItemType \u0022directory\u0022\nCopy-Item \u0022C:\\libraries\\bin\\hdf5.dll\u0022 -Destination .\\build\nCopy-Item \u0022C:\\libraries\\bin\\zlib.dll\u0022 -Destination .\\build\n\n# compile source files into object files\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readMeshBase.cpp /Fo\u0022.\\build\\readMeshBase.obj\u0022\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c /O2 /DCOMPILELIB .\\main.cpp /Fo\u0022.\\build\\main.obj\u0022\n\n# link object files against CGNS library and its dependencies\ncl.exe /nologo /EHsc /std:c++20 .\\build\\main.obj .\\build\\readMeshBase.obj /Fe\u0022.\\build\\cgnsTest.exe\u0022 /link /MACHINE:x64 /LIBPATH:\u0022C:\\libraries\\lib\u0022 cgns.lib hdf5.lib msvcrt.lib libcmt.lib\n.\\build\\cgnsTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# clean up before building\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRemove-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build -Force -Recurse\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eNew-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Name \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;build\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -ItemType \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;directory\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCopy-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\bin\\hdf5.dll\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Destination .\\build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCopy-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\bin\\zlib.dll\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Destination .\\build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readMeshBase.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\readMeshBase.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c /O2 /DCOMPILELIB .\\main.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\main.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files against CGNS library and its dependencies\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build\\main.obj .\\build\\readMeshBase.obj /Fe\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\cgnsTest.exe\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /link /MACHINE:x64 /LIBPATH:\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\lib\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e cgns.lib hdf5.lib msvcrt.lib libcmt.lib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\build\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecgnsTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="# clean up before building
Remove-Item .\build -Force -Recurse
New-Item -Name &quot;build&quot; -ItemType &quot;directory&quot;
Copy-Item &quot;C:\libraries\bin\hdf5.dll&quot; -Destination .\build
Copy-Item &quot;C:\libraries\bin\zlib.dll&quot; -Destination .\build

# compile source files into object files
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c /O2 /DCOMPILELIB .\meshReaderLib\src\readMeshBase.cpp /Fo&quot;.\build\readMeshBase.obj&quot;
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c /O2 /DCOMPILELIB .\main.cpp /Fo&quot;.\build\main.obj&quot;

# link object files against CGNS library and its dependencies
cl.exe /nologo /EHsc /std:c++20 .\build\main.obj .\build\readMeshBase.obj /Fe&quot;.\build\cgnsTest.exe&quot; /link /MACHINE:x64 /LIBPATH:&quot;C:\libraries\lib&quot; cgns.lib hdf5.lib msvcrt.lib libcmt.lib
.\build\cgnsTest.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955"># clean up before building</span></span>
<span class="line"><span style="color: #DCDCAA">Remove-Item</span><span style="color: #D4D4D4"> .\build -Force -Recurse</span></span>
<span class="line"><span style="color: #DCDCAA">New-Item</span><span style="color: #D4D4D4"> -Name </span><span style="color: #CE9178">&quot;build&quot;</span><span style="color: #D4D4D4"> -ItemType </span><span style="color: #CE9178">&quot;directory&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">Copy-Item</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;C:\libraries\bin\hdf5.dll&quot;</span><span style="color: #D4D4D4"> -Destination .\build</span></span>
<span class="line"><span style="color: #DCDCAA">Copy-Item</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;C:\libraries\bin\zlib.dll&quot;</span><span style="color: #D4D4D4"> -Destination .\build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object files</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c /O2 /DCOMPILELIB .\meshReaderLib\src\readMeshBase.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\readMeshBase.obj&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c /O2 /DCOMPILELIB .\main.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\main.obj&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files against CGNS library and its dependencies</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> .\build\main.obj .\build\readMeshBase.obj /Fe</span><span style="color: #CE9178">&quot;.\build\cgnsTest.exe&quot;</span><span style="color: #D4D4D4"> /link /MACHINE:x64 /LIBPATH:</span><span style="color: #CE9178">&quot;C:\libraries\lib&quot;</span><span style="color: #D4D4D4"> cgns.lib hdf5.lib msvcrt.lib libcmt.lib</span></span>
<span class="line"><span style="color: #D4D4D4">.\build\</span><span style="color: #DCDCAA">cgnsTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The first 5 lines prepare the project. First, we remove the <code>build/</code> folder and then afterwards re-create it (we just want to get rid of any previously created object files which we dump inside the <code>build/</code> folder). We then copy the <code>hdf5.dll</code> and <code>zlib.dll</code> library inside the <code>build/</code> folder. As we discussed in our overview on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/understanding-static-dynamic-and-header-only-c-libraries" target="_blank" rel="noopener" title="">static, dynamic, and header-only libraries</a> (if you haven't checked it out, it would be good to go through this first), DLL stands for dynamic-linked libraries and is Windows terminology for dynamic libraries. Why do we need to do this?</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The way dynamic libraries are located when an executable is launched is platform-specific and, well, Windows doesn't have a sensible way of dealing with them. On Windows, you need to dump all of your dynamic libraries in the same folder where you are planning to keep your executable. If you are on Windows right now, go to <code>C:\Program Files\</code> and pick any folder (ideally, a somewhat larger application). Then, find the executable of that application and look at files ending with <code>*.dll</code>. Just as an example, looking at <a href="https://www.blender.org/" target="_blank" rel="noopener" title="">Blender</a> on my PC, this is what I can see:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2576,"sizeSlug":"full","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-full"><img src="https://cfd.university/wp-content/uploads/2024/01/blenderFolderStructure.png" alt="" class="wp-image-2576"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>I count 21 different <code>*.dll</code> files, and the executable is <code>blender.exe</code> (file extension not shown). For the executable to be able to find all of these dependencies (libraries), they need to be next to the executable. This gives us a horrible folder structure, but, well, this is the price to pay to develop on or for Windows. (Yes, I know we can use environmental variables to specify search paths, but that approach is rarely used. We don't have an easy way to set the library search path as easily and cleanly as on UNIX, so dll-dumping is a common exercise on Windows).  </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, we, too have to copy our dependencies into the folder where we keep our executable, which is the <code>build/</code> folder. I am assuming here that libraries are installed in <code>C:\libraries</code>, so that we can find <code>C:\libraries\bin\hdf5.dll</code> and <code>C:\libraries\bin\zlib.dll</code>. If you have them installed at a different location, you will need to change the copy location. We don't have to copy the CGNS library because we will use the static version of the library (for no particular reason, but I thought it would be good to show how to deal with both static and dynamic libraries). Static libraries can be located anywhere on the disk.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With all the required dependencies out of the way, we can go ahead and compile the <code>readMeshBase.cpp</code> and <code>main.cpp</code> files on lines 8-9. We are using the C++ 2020 standard, as we will make use of the filesystem header, which was only introduced in 2020. Any compiler modern compiler should offer you C++ 2020 support. We include the current (<code>.</code>) directory, as well as <code>C:\libraries\include</code>, i.e. where we expect header files that define the interface for the various libraries we use (primarily CGNS, but it, in turn, requires knowledge of HDF5 as well).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We define a preprocessor directive called <code>COMPILELIB</code>, this is again a requirement on Windows (we can call it whatever we want) if we are planning to compile our library into a dynamic library. I discussed this at great length in my article on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-compiling-and-testing" target="_blank" rel="noopener" title="">How to write a CFD library: Compiling and testing</a> which you may want to check out. It describes the purpose of this pre-processor directive and how this is used in the code later. We will come across it later when we look at the base class implementation as well.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The rest is pretty much straightforward, we use /O2 as a compiler optimisation, but we could have used <code>/O0</code> here with the <code>/Zi</code> flag for debugging purposes as well (and during development, this is advisable). In this case, we simply compile the library with optimisation already turned on.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 12, we link both object files (<code>meshReaderBase.obj</code> and <code>main.obj</code>) into the executable <code>cgnsTest.exe</code>, which is located inside the <code>build/</code> folder. We specify that we want to compile a 64-bit version (because, apparently, Microsoft thinks that this is necessary) and tell the linker where to find additional (static) libraries. In this case, in <code>C:\libraries\lib</code>. In this folder, the linker will find the <code>cgns.lib</code> file, which it will then copy into our executable. Confusingly on Windows, we also have to link against <code>hdf5.lib</code>, despite already linking against the <code>*.dll</code> file. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Here, the <code>*.lib</code> file will simply provide some additional information but no actual implementation, that is provided by the <code>*.dll</code> file. Both <code>hdf5.lib</code> and <code>hdf5.dll</code> are needed, but not <code>zlib.lib</code>, oh no, we can't have consistency on Windows! We also throw in some Windows specific libraries (<code>msvcrt.lib</code> and <code>libcmt.lib</code>, god knows why) and this should produce then an executable we can use. If you wonder how to figure out which libraries you have to link against, it is a process of trial and error. You do the best you can to second guess what Windows need and then you have to plow through the compiler/linker error messages and see what else you need.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you are getting error messages of the kind of <code>undefined reference</code>, that means that you are correctly importing header files, but the dynamic library can't be found. You then need to figure out where the undefined reference is coming from (e.g. which library) and then you have to located that library and copy it into your <code>build/</code> folder, or wherever you keep your executable.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The joy of developing on Windows ...</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-compiling-on-unix">Compiling on UNIX</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Developing on UNIX is much better for our sanity and once you understand the basics, it is really rather straightforward and also somewhat fool-proof. Starting out with code development, especially linking against external libraries, is always easier on UNIX and thus probably the best starting point. If you want to follow along on a UNIX distribution or macOS, then you need the below-shown <code>buildAndRun.sh</code> script:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile source files into object files\ng++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readMeshBase.cpp -o ./build/readMeshBase.o\ng++ -std=c++20 -I. -I ~/libs/include -c ./main.cpp -o ./build/main.o\n\n# link object files against CGNS library and its dependencies\ng++ -std=c++20 ./build/main.o ./build/readMeshBase.o -o ./build/cgnsTest -L~/libs/lib -lcgns\n\n# run executable\n./build/cgnsTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./meshReaderLib/src/readMeshBase.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readMeshBase.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./main.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files against CGNS library and its dependencies\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/main.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readMeshBase.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/cgnsTest\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-L~/libs/lib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lcgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/cgnsTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile source files into object files
g++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readMeshBase.cpp -o ./build/readMeshBase.o
g++ -std=c++20 -I. -I ~/libs/include -c ./main.cpp -o ./build/main.o

# link object files against CGNS library and its dependencies
g++ -std=c++20 ./build/main.o ./build/readMeshBase.o -o ./build/cgnsTest -L~/libs/lib -lcgns

# run executable
./build/cgnsTest" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object files</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./meshReaderLib/src/readMeshBase.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readMeshBase.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./main.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files against CGNS library and its dependencies</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/main.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readMeshBase.o</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/cgnsTest</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-L~/libs/lib</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lcgns</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run executable</span></span>
<span class="line"><span style="color: #DCDCAA">./build/cgnsTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Lines 3-4 simply remove and recreate the <code>build/</code> folder, but there is no need to copy and dynamic libraries around, which on UNIX have a file ending of <code>*.so</code> (Linux) or <code>*.dylib</code> (macOS). The reason is simple, UNIX provides default locations where libraries and header-include files are stored (either within the <code>/usr/</code> or <code>/usr/local/</code> folder). So, if I simply installed CGNS, HDF5 and zlib without specifying an install directory, they would end up in <code>/usr/include/</code> and <code>/usr/lib/</code> and compilers are instructed to always look into these folders when looking for libraries that do not live next to the executable (we can still use this Windows hack if we want to).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In our case, we install the libraries in a non-default location, i.e. <code>~/libs</code>, thus the libraries are located in <code>~/libs/lib/</code> and the header-include files are in <code>~/libs/include/</code>. We can see that we use the include path on lines 7-8 when we compile the <code>meshReaderBase.cpp</code> and <code>main.cpp</code> source files, and then we link against the CGNS library on line 11 and specify the location of the library with the <code>-L</code> flag.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you looked inside the ~/libs/lib folder, you would find a file called <code>libcgns.a</code>, where <code>a</code> stands for archive and is Linux terminology for a static library. The UNIX convention is that in this case, the prefix <code>lib</code> and the file ending <code>.a</code> is removed from the library name, so we only link against <code>cgns</code> with the <code>-l</code> flag (<code>-lcgns</code>) instead of writing <code>-llibcgns.a</code> on line 11.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Notice the absence of any UNIX-specific libraries or even the need to link against HDF5. If we had to link against any dynamic library that wasn't in the default <code>/usr/lib/</code> folder, we could provide the linker with the runtime path to check for any dynamic libraries. We would achieve that with the <code>-Wl,-rpath ~/libs/lib</code> flag, where <code>-Wl</code> is a flag saying that anything that follows after the comma should be given to the linker. The linker then receives the path variable (runtime path) and we can specify where the dynamic libraries are located. Windows does not provide this feature, which is annoying.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>One thing to note here: if we manually compile and link our code, make sure that during linking, you provide object files first (<code>meshReaderBase.o</code>, <code>main.o</code>) and afterwards, you provide library information with the <code>-L</code> and <code>-l</code> flags. The order is important. Otherwise, the linker may not find the required libraries by the time it needs to know about them.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The last line (line 14) simply executes our executable. Now, this is much cleaner than the Windows build script, but it is good to know the differences between operating systems. I'll leave you to decide which one you prefer for development.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-the-mesh-reading-base-class">The mesh reading base class</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>So then, with all of the prerequisites out of the way, let us dive into the first class, the mesh reading base class. We'll look at some helper files first and then look at the base class in more detail.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-custom-types">Custom types</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The first thing I want to look at is the <code>meshReaderLib/include/types.hpp</code> file. As mentioned previously, I like to have a dedicated file in which I can define custom types and <code>enum</code>s. For this library, we will only create a few <code>enum</code>s but at other times it may be necessary to define some custom types. I provided some examples in my article on <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/templates-in-c-boost-your-cfd-solver-performance/" target="_blank" rel="noopener" title="">C++ templates</a>, which you may want to check out.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p> The content of the <code>meshReaderLib/include/types.hpp</code> file is given below:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\nenum COORDINATE {X = 0, Y};\nenum INTERFACE {OWNER = 0, NEIGHBOUR};\nenum BC {WALL = 0, INLET, OUTLET, SYMMETRY};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eenum\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eX\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eY\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eenum\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eINTERFACE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eOWNER\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eNEIGHBOUR\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eenum\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eWALL\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eINLET\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eOUTLET\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eSYMMETRY\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

enum COORDINATE {X = 0, Y};
enum INTERFACE {OWNER = 0, NEIGHBOUR};
enum BC {WALL = 0, INLET, OUTLET, SYMMETRY};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">enum</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">X</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">Y</span><span style="color: #D4D4D4">};</span></span>
<span class="line"><span style="color: #569CD6">enum</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">INTERFACE</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">OWNER</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">NEIGHBOUR</span><span style="color: #D4D4D4">};</span></span>
<span class="line"><span style="color: #569CD6">enum</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">WALL</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">INLET</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">OUTLET</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">SYMMETRY</span><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We want to ensure we only include the file once; hence we use the #pragma once statement at the top (and we'll do that for all remaining header files). The reason is to avoid cyclic dependencies which, granted, will not happen here even if we remove the #pragma once statement, but I am just consistently applying it to my library code. There is a detailed description of header include guards over at <a href="https://www.learncpp.com/cpp-tutorial/header-guards/" target="_blank" rel="noopener" title="">learncpp.com</a>, which covers why we need <code>#pragma once</code> statements.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>enum</code>s that are defined will help us to index arrays in a much more readable way. They are just <a href="https://en.wikipedia.org/wiki/Syntactic_sugar" target="_blank" rel="noopener" title="">syntactic sugar</a>, and allow us to transform a less readable loops like</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"for (int i = 0; i \u0026lt; 1000; ++i)\n  std::cout \u0026lt;\u0026lt; coordinates[i][0] \u0026lt;\u0026lt; \u0022, \u0022 \u0026lt;\u0026lt; coordinates[i][1] \u0026lt;\u0026lt; std::endl;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1000\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; ++i)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;, \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[i][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="for (int i = 0; i &lt; 1000; ++i)
  std::cout &lt;&lt; coordinates[i][0] &lt;&lt; &quot;, &quot; &lt;&lt; coordinates[i][1] &lt;&lt; std::endl;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; </span><span style="color: #B5CEA8">1000</span><span style="color: #D4D4D4">; ++i)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">coordinates</span><span style="color: #D4D4D4">[i][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #CE9178">&quot;, &quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #9CDCFE">coordinates</span><span style="color: #D4D4D4">[i][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>into something more meaningful and easier to understand like</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"for (int vertex = 0; vertex \u0026lt; numberOfVertices; ++vertex)\n  std::cout \u0026lt;\u0026lt; coordinates[vertex][COORDINATE::X] \u0026lt;\u0026lt; \u0022, \u0022 \u0026lt;\u0026lt; coordinates[vertex][COORDINATE::Y] \u0026lt;\u0026lt; std::endl;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e vertex = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; vertex \u0026lt; numberOfVertices; ++vertex)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[vertex][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;, \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[vertex][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="for (int vertex = 0; vertex &lt; numberOfVertices; ++vertex)
  std::cout &lt;&lt; coordinates[vertex][COORDINATE::X] &lt;&lt; &quot;, &quot; &lt;&lt; coordinates[vertex][COORDINATE::Y] &lt;&lt; std::endl;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> vertex = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; vertex &lt; numberOfVertices; ++vertex)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #9CDCFE">coordinates</span><span style="color: #D4D4D4">[vertex][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] &lt;&lt; </span><span style="color: #CE9178">&quot;, &quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #9CDCFE">coordinates</span><span style="color: #D4D4D4">[vertex][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Comparing the two loops, I think we can all come to the conclusion that the second variant is easier to understand. If you need some additional help with <code>enum</code>s, <a href="https://www.learncpp.com/cpp-tutorial/unscoped-enumerations/" target="_blank" rel="noopener" title="">learncpp</a> got you covered.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>INTERFACE enum</code> will help us to identify zones on the left/right of the interface, and the <code>BC enum</code> is there to allow us easy assignment of boundary conditions that we want to support.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-library-interface-meshreader-hpp">The library interface</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The next file we have a brief look at is the <code>meshReaderLib/meshReader.hpp</code> file. This file will contain links to all other header files so that when we include this file somewhere in a different code which wants to consume our mesh reading library, then it will have access to all function signatures and the compiler can go ahead and compile the code. This is the only header file where we don't need the header include guards (<code>#pragma once</code>, and yes I know, I said that we are going to apply them across all header files, but since this header file is not implementing anything but rather just collecting header files, it is exempt). </p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0022meshReaderLib/include/readMeshBase.hpp\u0022\n#include \u0022meshReaderLib/include/types.hpp\u0022","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readMeshBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/types.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &quot;meshReaderLib/include/readMeshBase.hpp&quot;
#include &quot;meshReaderLib/include/types.hpp&quot;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readMeshBase.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/types.hpp&quot;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We will add to this file as we add more header files to our library, namely the structured and unstructured mesh reader classes.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-interface-header-file">The base class interface </h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>So then, this is the first bit of the mesh reading library. The base class actually already implements quite a bit of logic which is shared across both structured and unstructured mesh reading. Thus, we can collect this in the base class. The file <code>meshReaderLib/include/readMeshBase.hpp</code> is shown below:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)\n  #if defined(COMPILEDLL)\n    #define MESHREADERLIB_EXPORT __declspec(dllexport)\n  #elif defined(COMPILELIB)\n    #define MESHREADERLIB_EXPORT\n  #else\n    #define MESHREADERLIB_EXPORT __declspec(dllimport)\n  #endif\n#else\n  #define MESHREADERLIB_EXPORT\n#endif\n\n#include \u0026lt;iostream\u003e\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;cassert\u003e\n#include \u0026lt;vector\u003e\n#include \u0026lt;array\u003e\n#include \u0026lt;unordered_map\u003e\n\n#include \u0022cgnslib.h\u0022\n\n#include \u0022meshReaderLib/include/types.hpp\u0022\n\ntemplate\u0026lt;typename IndexType\u003e\nstruct MESHREADERLIB_EXPORT InterfaceConnectivity {\n  std::array\u0026lt;int, 2\u003e zones;\n  std::vector\u0026lt;IndexType\u003e ownerIndex;\n  std::vector\u0026lt;IndexType\u003e neighbourIndex;\n};\n\ntemplate\u0026lt;typename IndexType\u003e\nstruct MESHREADERLIB_EXPORT BoundaryConditionInformation {\n  std::string boundaryName;\n  unsigned boundaryType;\n  std::vector\u0026lt;IndexType\u003e indices;\n};\n\nclass MESHREADERLIB_EXPORT ReadMeshBase {\npublic:\n  using ZoneType = typename std::vector\u0026lt;std::vector\u0026lt;cgsize_t\u003e\u003e;\n\npublic:\n  ReadMeshBase(std::filesystem::path cgnsFilePath);\n  ~ReadMeshBase();\n\n// interface / API\npublic:\n  virtual void readMesh() = 0;\n\n// internal implementation hidden from the user\nprotected:\n  void readBases();\n  void readZones(ZoneType_t zoneType);\n  void createBoundaryNameLookupTable();\n\n// internal implementations that must be implemented by derived classes\nprotected:\n  virtual void readCoorinates() = 0;\n  virtual void readInterfaceConnectivity() = 0;\n  virtual void readBoundaries() = 0;\n  unsigned getBoundaryConditionID(BCType_t bcType);\n\nprotected:\n  std::filesystem::path _cgnsFilePath;\n  int _numberOfZones = 0;\n  int _numberOfBoundaries = 0;\n  int _fileIndex = 0;\n\n  ZoneType _zoneSizesMax, _zoneSizesMin;\n  std::unordered_map\u0026lt;std::string, cgsize_t\u003e _zoneNamesMap;\n  std::unordered_map\u0026lt;std::string, BCType_t\u003e _boundaryConditionMap;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(_WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__WIN32__) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__NT__)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(COMPILEDLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #elif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(COMPILELIB)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;cassert\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;vector\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;array\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;unordered_map\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;cgnslib.h\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/types.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003estruct\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::array\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; zones;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; ownerIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; neighbourIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003estruct\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string boundaryName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e boundaryType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; indices;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e~ReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// interface / API\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// internal implementation hidden from the user\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadZones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// internal implementations that must be implemented by derived classes\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ebcType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path _cgnsFilePath;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _numberOfZones = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _numberOfBoundaries = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _fileIndex = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ZoneType _zoneSizesMax, _zoneSizesMin;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::unordered_map\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; _zoneNamesMap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::unordered_map\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; _boundaryConditionMap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":74,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)
  #if defined(COMPILEDLL)
    #define MESHREADERLIB_EXPORT __declspec(dllexport)
  #elif defined(COMPILELIB)
    #define MESHREADERLIB_EXPORT
  #else
    #define MESHREADERLIB_EXPORT __declspec(dllimport)
  #endif
#else
  #define MESHREADERLIB_EXPORT
#endif

#include &lt;iostream&gt;
#include &lt;filesystem&gt;
#include &lt;cassert&gt;
#include &lt;vector&gt;
#include &lt;array&gt;
#include &lt;unordered_map&gt;

#include &quot;cgnslib.h&quot;

#include &quot;meshReaderLib/include/types.hpp&quot;

template&lt;typename IndexType&gt;
struct MESHREADERLIB_EXPORT InterfaceConnectivity {
  std::array&lt;int, 2&gt; zones;
  std::vector&lt;IndexType&gt; ownerIndex;
  std::vector&lt;IndexType&gt; neighbourIndex;
};

template&lt;typename IndexType&gt;
struct MESHREADERLIB_EXPORT BoundaryConditionInformation {
  std::string boundaryName;
  unsigned boundaryType;
  std::vector&lt;IndexType&gt; indices;
};

class MESHREADERLIB_EXPORT ReadMeshBase {
public:
  using ZoneType = typename std::vector&lt;std::vector&lt;cgsize_t&gt;&gt;;

public:
  ReadMeshBase(std::filesystem::path cgnsFilePath);
  ~ReadMeshBase();

// interface / API
public:
  virtual void readMesh() = 0;

// internal implementation hidden from the user
protected:
  void readBases();
  void readZones(ZoneType_t zoneType);
  void createBoundaryNameLookupTable();

// internal implementations that must be implemented by derived classes
protected:
  virtual void readCoorinates() = 0;
  virtual void readInterfaceConnectivity() = 0;
  virtual void readBoundaries() = 0;
  unsigned getBoundaryConditionID(BCType_t bcType);

protected:
  std::filesystem::path _cgnsFilePath;
  int _numberOfZones = 0;
  int _numberOfBoundaries = 0;
  int _fileIndex = 0;

  ZoneType _zoneSizesMax, _zoneSizesMin;
  std::unordered_map&lt;std::string, cgsize_t&gt; _zoneNamesMap;
  std::unordered_map&lt;std::string, BCType_t&gt; _boundaryConditionMap;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(_WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__WIN32__) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__NT__)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(COMPILEDLL)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">  #elif</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defined</span><span style="color: #D4D4D4">(COMPILELIB)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">  #else</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;cassert&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;vector&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;array&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;unordered_map&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;cgnslib.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/types.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">struct</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">InterfaceConnectivity</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::array&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">&gt; zones;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; ownerIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; neighbourIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">struct</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">BoundaryConditionInformation</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string boundaryName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> boundaryType;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; indices;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ZoneType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt;&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cgnsFilePath</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">~ReadMeshBase</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// interface / API</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// internal implementation hidden from the user</span></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readZones</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zoneType</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// internal implementations that must be implemented by derived classes</span></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">bcType</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path _cgnsFilePath;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _numberOfZones = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _numberOfBoundaries = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _fileIndex = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  ZoneType _zoneSizesMax, _zoneSizesMin;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::unordered_map&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string, </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt; _zoneNamesMap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::unordered_map&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string, </span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4">&gt; _boundaryConditionMap;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>There is quite a bit to look through, so let's split this file up into its separate parts and look at that in more detail.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-required-pre-processor-directives-for-dynamic-library-linkage">Required pre-processor directives for dynamic library linkage</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>At the top, we define some preprocessor directives (lines 3-13). We saw in our previous series on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-compiling-and-testing" target="_blank" rel="noopener" title="">writing a linear algebra library</a>, that we need to define these directives to allow for dynamic libraries to be compiled on Windows. That's all, if you are only targeting UNIX, then you can get rid of them. I won't repeat the reasoning or a more detailed description here as well have already discussed this in much greater depth in the above-linked article.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-custom-types-for-interface-and-boundary-condition-information">Custom types for interface and boundary condition information</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>After defining some header includes that we'll need to implement the library, there are two additional structures we define, repeated below for convenience.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"template\u0026lt;typename IndexType\u003e\nstruct MESHREADERLIB_EXPORT InterfaceConnectivity {\n  std::array\u0026lt;int, 2\u003e zones;\n  std::vector\u0026lt;IndexType\u003e ownerIndex;\n  std::vector\u0026lt;IndexType\u003e neighbourIndex;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003estruct\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::array\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; zones;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; ownerIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; neighbourIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="template&lt;typename IndexType&gt;
struct MESHREADERLIB_EXPORT InterfaceConnectivity {
  std::array&lt;int, 2&gt; zones;
  std::vector&lt;IndexType&gt; ownerIndex;
  std::vector&lt;IndexType&gt; neighbourIndex;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">struct</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">InterfaceConnectivity</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::array&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">&gt; zones;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; ownerIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; neighbourIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The <code>InterfaceConnectivity</code> type (defined on lines 26-31 in the header file above) defines interface connectivity information. When we store an interface, we want to know the two zones that are connected by the interface (which are stored on the <code>std::array&lt;int, 2&gt; zones</code> array). There will be two zones, one on each side of the interface, and thus we need to define the array of type <code>int</code> with 2 entries.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Next, we store the <code>ownerIndex</code> and <code>neighbourIndex</code> arrays within a <code>std::vector</code>. For each vertex in the interface, we want to know the index in the owning and the neighbouring zone. Since we don't know how many vertices there will be per zone, we have to declare them as <code>std::vector</code> and then at runtime determine how many indices we want to store on the owning and neighbouring zones. Take again how structured and unstructured grid as an example:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2467,"scale":"cover","sizeSlug":"large","linkDestination":"none","align":"center"} -->
<figure class="wp-block-image aligncenter size-large"><img src="http://cfd.university/wp-content/uploads/2024/01/meshOverview-e1705524025331-1024x298.png" alt="" class="wp-image-2467" style="object-fit:cover"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We said that there is a single interface between both black and red zones. If we concentrate on the structured grid for the moment, and say that the origin is at the bottom left corner, then we can make the following statements:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The size of the <code>ownerIndex</code> and <code>neighbourIndex</code> <code>std::vector</code> will be in both cases 5 (5 vertices across the interface). If we start at 0, 0 at the bottom left, and the x-axis is going to the right, the y-axis to the top, then the <code>ownerIndex</code> <code>std::vector</code> will look like the following:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"std::vector\u0026lt;IndexType\u003e ownerIndex{{4, 0}, {4, 1}, {4, 2}, {4, 3}, {4, 4}};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; ownerIndex{{\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="std::vector&lt;IndexType&gt; ownerIndex{{4, 0}, {4, 1}, {4, 2}, {4, 3}, {4, 4}};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; ownerIndex{{</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">}};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>I am assuming that the interface starts at the bottom and goes to the top, but it may be stored the other way around. The x index is always 4, as we are at the right-most part of the zone and only the index in y is changing. The point is, we know all vertices through the ownerIndex. Similarly, the <code>neighbourIndex</code> would be stored in the following way:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"std::vector\u0026lt;IndexType\u003e neighbourIndex{{0, 0}, {0, 1}, {0, 2}, {0, 3}, {0, 4}};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; neighbourIndex{{\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="std::vector&lt;IndexType&gt; neighbourIndex{{0, 0}, {0, 1}, {0, 2}, {0, 3}, {0, 4}};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; neighbourIndex{{</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">}};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>In this case, we are at the left-most part, x is again constant and 0, while the index only changes in the y-direction.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For both indices, we define the type of the std::vector through a template. We do that because the index type will change from structured to unstructured. For structured meshes, as we saw above, we will have the same number of indices as dimensions, i.e. in our 2D grid we have 2 indices for the x and y directions. For unstructured grids, though, we will always store information as 1D arrays. We store a 1D array of indices, through which we can find out what the coordinates are, for example, by indexing either the x or y coordinate array with the indices stored on the interface. Thus, using a template here allows us to use the <code>struct</code> for both structured and unstructured grids.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There is a second <code>struct</code> for boundary condition information, repeated below for convenience and given on lines 33-38 in the header file given above:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"template\u0026lt;typename IndexType\u003e\nstruct MESHREADERLIB_EXPORT BoundaryConditionInformation {\n  std::string boundaryName;\n  unsigned boundaryType;\n  std::vector\u0026lt;IndexType\u003e indices;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003estruct\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string boundaryName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e boundaryType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; indices;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="template&lt;typename IndexType&gt;
struct MESHREADERLIB_EXPORT BoundaryConditionInformation {
  std::string boundaryName;
  unsigned boundaryType;
  std::vector&lt;IndexType&gt; indices;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">struct</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">BoundaryConditionInformation</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string boundaryName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> boundaryType;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; indices;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>This <code>struct</code> is similar to the interface connectivity <code>struct</code> in that it stores information for each boundary condition such as its name, its type and again the indices that allow us to find the location of the boundary. For the structured mesh shown above, we may have </p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"std::vector\u0026lt;IndexType\u003e indices{{0, 0}, {1, 0}, {2, 0}, {3, 0}, {4, 0}};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; indices{{\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}, {\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e4\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="std::vector&lt;IndexType&gt; indices{{0, 0}, {1, 0}, {2, 0}, {3, 0}, {4, 0}};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; indices{{</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}, {</span><span style="color: #B5CEA8">4</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">}};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>For the boundary at the bottom (south) face, which has a type of <code>wall</code> and a name of <code>wall</code>. We store this information for all boundaries and thus can then later determine whether to use a Dirichlet or Neumann condition for the flow quantities solved for at that boundary.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-base-class-for">Base class for the mesh reading library</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The base class definition is given below again for convenience:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"class MESHREADERLIB_EXPORT ReadMeshBase {\npublic:\n  using ZoneType = typename std::vector\u0026lt;std::vector\u0026lt;cgsize_t\u003e\u003e;\n\npublic:\n  ReadMeshBase(std::filesystem::path cgnsFilePath);\n  ~ReadMeshBase();\n\n// interface / API\npublic:\n  virtual void readMesh() = 0;\n\n// internal implementation hidden from the user\nprotected:\n  void readBases();\n  void readZones(ZoneType_t zoneType);\n  void createBoundaryNameLookupTable();\n\n// internal implementations that must be implemented by derived classes\nprotected:\n  virtual void readCoorinates() = 0;\n  virtual void readInterfaceConnectivity() = 0;\n  virtual void readBoundaries() = 0;\n  unsigned getBoundaryConditionID(BCType_t bcType);\n\nprotected:\n  std::filesystem::path _cgnsFilePath;\n  int _numberOfZones = 0;\n  int _numberOfBoundaries = 0;\n  int _fileIndex = 0;\n\n  ZoneType _zoneSizesMax, _zoneSizesMin;\n  std::unordered_map\u0026lt;std::string, cgsize_t\u003e _zoneNamesMap;\n  std::unordered_map\u0026lt;std::string, BCType_t\u003e _boundaryConditionMap;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e~ReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// interface / API\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// internal implementation hidden from the user\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadZones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// internal implementations that must be implemented by derived classes\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evirtual\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ebcType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path _cgnsFilePath;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _numberOfZones = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _numberOfBoundaries = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _fileIndex = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ZoneType _zoneSizesMax, _zoneSizesMin;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::unordered_map\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; _zoneNamesMap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::unordered_map\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::string, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; _boundaryConditionMap;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":35,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="class MESHREADERLIB_EXPORT ReadMeshBase {
public:
  using ZoneType = typename std::vector&lt;std::vector&lt;cgsize_t&gt;&gt;;

public:
  ReadMeshBase(std::filesystem::path cgnsFilePath);
  ~ReadMeshBase();

// interface / API
public:
  virtual void readMesh() = 0;

// internal implementation hidden from the user
protected:
  void readBases();
  void readZones(ZoneType_t zoneType);
  void createBoundaryNameLookupTable();

// internal implementations that must be implemented by derived classes
protected:
  virtual void readCoorinates() = 0;
  virtual void readInterfaceConnectivity() = 0;
  virtual void readBoundaries() = 0;
  unsigned getBoundaryConditionID(BCType_t bcType);

protected:
  std::filesystem::path _cgnsFilePath;
  int _numberOfZones = 0;
  int _numberOfBoundaries = 0;
  int _fileIndex = 0;

  ZoneType _zoneSizesMax, _zoneSizesMin;
  std::unordered_map&lt;std::string, cgsize_t&gt; _zoneNamesMap;
  std::unordered_map&lt;std::string, BCType_t&gt; _boundaryConditionMap;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ZoneType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt;&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cgnsFilePath</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">~ReadMeshBase</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// interface / API</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// internal implementation hidden from the user</span></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readZones</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zoneType</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// internal implementations that must be implemented by derived classes</span></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">virtual</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">() = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">bcType</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path _cgnsFilePath;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _numberOfZones = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _numberOfBoundaries = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> _fileIndex = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  ZoneType _zoneSizesMax, _zoneSizesMin;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::unordered_map&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string, </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt; _zoneNamesMap;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::unordered_map&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::string, </span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4">&gt; _boundaryConditionMap;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We define a <code>ZoneType</code> on line 3, which will store the sizes of each zone (i.e. number of vertices per zone). We use this type on line 32. Lines 6-7 define the constructor and destructor, nothing too interesting happening here, we just take the path to a CGNS file as a parameter to the constructor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then, there is only a single pure virtual function for the public interface, defined on line 11. This is the only function we can call from outside the base class and will go through the motion of reading the entire mesh from the CGNS file. We looked at what virtual functions are and how virtual and pure virtual functions differ. If you need a refresher, then have a look at my article on <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/handling-inheritance-in-c/" target="_blank" rel="noopener" title="">how to handle inheritance in C++</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On lines 21-23, there are a few more pure virtual functions that need to be implemented by both the structured and unstructured mesh reading class (that we will implement in the next articles). These will read the coordinates, interfaces and boundary conditions. Since these give us slightly different information (and, in the case of the interface, they may even be stored under different CGNS nodes and thus require completely different functions to read the information required), we delegate the responsibility to implement these functions to the child classes (i.e. the structured and unstructured mesh reading classes).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Line 24 provides a function definition to map CGNS boundary conditions IDs to the boundary IDs we defined above in the <code>meshReaderLib/include/types.hpp</code> file, specifically, the <code>BC enum</code>. We redefine the IDs here, as we do not want to store all the boundary IDs and only use a subset of all available boundary conditions. You'll also notice that this function, along with the ones defined on lines 21-23, are all marked as protected (line 20). This is to limit their scope to child classes which will derive from this base class.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We looked at access modifiers (public, protected, private) in my article on <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/object-orientated-programming-in-cfd/" target="_blank" rel="noopener" title="">object-orientated programming</a>. They are commonly used together with class inheritance so if you do not feel comfortable yet with either of these concepts, the two articles linked above from my series on what every CFD developer needs to know about C++ will get you started.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Lines 27-30 store a few self-explanatory variables, except for the <code>_fileIndex</code> variable, perhaps. This is just a file ID used to identify a CGNS file, in case we have more than one open. In this case, we have a mechanism to distinguish between several CGNS files that may be open. Lines 33-34 define two helper variables that we will need to identify the zone and boundary condition we are currently on. We will populate them in the source file (below) and then make use of them later in the child classes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I really should have provided a custom type for the variables on lines 33-34, this must have slipped through my review before starting to write up this series. It's annoying me endlessly but it'll do its job.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Before we close this section and move on to the actual implementation, it may be worthwhile to mention a few of the CGNS-specific types. You'll notice types such as <code>ZoneType_t</code> (line 16), <code>BCType_t</code> (line 24) and <code>cgsize_t</code> (line 33). These are typically some form of <code>int</code>, <code>unsigned</code>, <code>long</code>, <code>short</code> or combinations thereof, see for example a collection of possible C data types here: <a href="https://www.programiz.com/c-programming/c-data-types" target="_blank" rel="noopener" title="">C Data Types</a>. To figure out which type needs to be used, the CGNS <a href="https://cgns.github.io/standard/MLL/api/c_api.html" target="_blank" rel="noopener" title="">mid-level library</a> provides all types required to store the right information in the correct type, and this has influenced which variable types I have selected here.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-the-implementation-source-file">The implementation (source file)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Below is the entire content of the <code>meshReaderLib/src/readMeshBase.cpp</code> file, i.e. the implementation of some functions from the base class that can already be implemented. We'll chop them off into smaller chunks afterwards again to make them easier to discuss in their own subsections.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0022meshReaderLib/include/readMeshBase.hpp\u0022\n\nReadMeshBase::ReadMeshBase(std::filesystem::path cgnsFilePath) : _cgnsFilePath(cgnsFilePath) {\n  if (cg_open(_cgnsFilePath.string().c_str(), CG_MODE_READ, \u0026amp;_fileIndex)) cg_error_exit();\n  readBases();\n  createBoundaryNameLookupTable();\n}\n\nReadMeshBase::~ReadMeshBase() {\n  cg_close(_fileIndex);\n}\n\nvoid ReadMeshBase::readBases() {\n  // check how many bases there are. Only a single base per mesh is supported, which should always be true. \n  int numberOfBases;\n  if (cg_nbases(_fileIndex, \u0026amp;numberOfBases)) cg_error_exit();\n  assert(numberOfBases == 1 \u0026amp;\u0026amp; \u0022Mesh reading only supported for a mesh with a single base\u0022);\n}\n\nvoid ReadMeshBase::readZones(ZoneType_t zoneTypeRequired) {\n  char zonename[64];\n  cgsize_t sizes[3][3];\n\n  // check how many zones there are in the CGNS file\n  if (cg_nzones(_fileIndex, 1, \u0026amp;_numberOfZones)) cg_error_exit();\n  _zoneSizesMax.resize(_numberOfZones);\n  _zoneSizesMin.resize(_numberOfZones);\n\n  for (int zone = 0; zone \u0026lt; _numberOfZones; ++zone) {\n    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument\n    ZoneType_t zoneType;\n    if (cg_zone_type(_fileIndex, 1, zone + 1, \u0026amp;zoneType)) cg_error_exit();\n    assert(zoneType == zoneTypeRequired \u0026amp;\u0026amp; \u0022Wrong mesh type read, expected either structured or unstrucutred\u0022);\n\n    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises\n    int numberOfGrids;\n    if (cg_ngrids(_fileIndex, 1, zone + 1, \u0026amp;numberOfGrids)) cg_error_exit();\n    assert(numberOfGrids == 1 \u0026amp;\u0026amp; \u0022Mesh reading only supported for a mesh with a single grid per zone\u0022);\n\n    // get the name of the zone and store it in a temporary map. We'll need that for reading boundary conditions later\n    if (cg_zone_read(_fileIndex, 1, zone + 1, zonename, sizes[0])) cg_error_exit();\n    _zoneNamesMap.emplace(std::string(zonename), zone);\n\n    // we only support 2D meshes for now, make sure this is the case\n    int numberOfCoordinatesToRead;\n    if (cg_ncoords(_fileIndex, 1, zone + 1, \u0026amp;numberOfCoordinatesToRead)) cg_error_exit();\n    assert(numberOfCoordinatesToRead == 2 \u0026amp;\u0026amp; \u0022Mesh reading only supported for 2D meshes\u0022);\n\n    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1\n    _zoneSizesMin[zone].resize(numberOfCoordinatesToRead);\n    _zoneSizesMax[zone].resize(numberOfCoordinatesToRead);\n    for (int coordinate = 0; coordinate \u0026lt; numberOfCoordinatesToRead; ++coordinate) {\n      _zoneSizesMin[zone][coordinate] = 1;\n      _zoneSizesMax[zone][coordinate] = sizes[0][coordinate];\n    }\n  }\n}\n\nvoid ReadMeshBase::createBoundaryNameLookupTable() {\n  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by\n  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The\n  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.\n  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we\n  // need to read the family information and then get the boundary condition name and type from the family. Later,\n  // we need to to map that information to the correct boundary condition. In the following, we check if the\n  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family\n  // node with all of its boundary information, which we'll store in the boundaryConditionMap for later lookup.\n  int numberOfFamilies = 0;\n  if (cg_nfamilies(_fileIndex, 1, \u0026amp;numberOfFamilies)) cg_error_exit();\n\n  for (int family = 0; family \u0026lt; numberOfFamilies; ++family) {\n    char familyName[128];\n    int isBoundaryCondition, nGeo;\n    if (cg_family_read(_fileIndex, 1, family + 1, familyName, \u0026amp;isBoundaryCondition, \u0026amp;nGeo)) cg_error_exit();\n\n    char familyBoundaryName[128];\n    BCType_t familyBoundaryType;\n\n    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other\n    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to\n    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.\n    if (isBoundaryCondition == 1) {\n      if (cg_fambc_read(_fileIndex, 1, family + 1, 1, familyBoundaryName, \u0026amp;familyBoundaryType)) cg_error_exit();\n      _boundaryConditionMap.emplace(familyName, familyBoundaryType);\n    }\n  }\n}\n\nunsigned ReadMeshBase::getBoundaryConditionID(BCType_t bcType) {\n  if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)\n    return BC::WALL;\n  else if (bcType == 9 || bcType == 10 || bcType == 11 || bcType == 18)\n    return BC::INLET;\n  else if (bcType == 13 || bcType == 14 || bcType == 15 || bcType == 19)\n    return BC::OUTLET;\n  else if (bcType == 16 || bcType == 17)\n    return BC::SYMMETRY;\n  else {\n    throw std::runtime_error(\u0022Unsupported boundary condition type specified\u0022);\n    exit(-1);\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readMeshBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path cgnsFilePath) : \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e_cgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(cgnsFilePath) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_open\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_cgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e().\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ec_str\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(), CG_MODE_READ, \u0026amp;_fileIndex)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::~\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_close\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // check how many bases there are. Only a single base per mesh is supported, which should always be true. \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfBases;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nbases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u0026amp;numberOfBases)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfBases == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for a mesh with a single base\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadZones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneTypeRequired\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezonename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e64\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // check how many zones there are in the CGNS file\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nzones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;_numberOfZones)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zone = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; zone \u0026lt; _numberOfZones; ++zone) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zoneType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_zone_type\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;zoneType)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(zoneType == zoneTypeRequired \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Wrong mesh type read, expected either structured or unstrucutred\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfGrids;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_ngrids\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfGrids)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfGrids == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for a mesh with a single grid per zone\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // get the name of the zone and store it in a temporary map. We\u0026#39;ll need that for reading boundary conditions later\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_zone_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zonename, \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e])) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneNamesMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eemplace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(zonename), zone);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // we only support 2D meshes for now, make sure this is the case\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfCoordinatesToRead;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_ncoords\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfCoordinatesToRead)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for 2D meshes\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e coordinate = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; coordinate \u0026lt; numberOfCoordinatesToRead; ++coordinate) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][coordinate] = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][coordinate] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][coordinate];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // need to read the family information and then get the boundary condition name and type from the family. Later,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // we need to to map that information to the correct boundary condition. In the following, we check if the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // node with all of its boundary information, which we\u0026#39;ll store in the boundaryConditionMap for later lookup.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfFamilies = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nfamilies\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfFamilies)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e family = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; family \u0026lt; numberOfFamilies; ++family) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e isBoundaryCondition, nGeo;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_family_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, family + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, familyName, \u0026amp;isBoundaryCondition, \u0026amp;nGeo)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyBoundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e familyBoundaryType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (isBoundaryCondition == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_fambc_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, family + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, familyBoundaryName, \u0026amp;familyBoundaryType)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditionMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eemplace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(familyName, familyBoundaryType);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ebcType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e21\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e22\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e23\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e24\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::WALL;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e9\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e10\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e11\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e18\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::INLET;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e13\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e14\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e15\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e19\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::OUTLET;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e16\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e17\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::SYMMETRY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ethrow\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eruntime_error\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Unsupported boundary condition type specified\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eexit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(-\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":102,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(3 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &quot;meshReaderLib/include/readMeshBase.hpp&quot;

ReadMeshBase::ReadMeshBase(std::filesystem::path cgnsFilePath) : _cgnsFilePath(cgnsFilePath) {
  if (cg_open(_cgnsFilePath.string().c_str(), CG_MODE_READ, &amp;_fileIndex)) cg_error_exit();
  readBases();
  createBoundaryNameLookupTable();
}

ReadMeshBase::~ReadMeshBase() {
  cg_close(_fileIndex);
}

void ReadMeshBase::readBases() {
  // check how many bases there are. Only a single base per mesh is supported, which should always be true. 
  int numberOfBases;
  if (cg_nbases(_fileIndex, &amp;numberOfBases)) cg_error_exit();
  assert(numberOfBases == 1 &amp;&amp; &quot;Mesh reading only supported for a mesh with a single base&quot;);
}

void ReadMeshBase::readZones(ZoneType_t zoneTypeRequired) {
  char zonename[64];
  cgsize_t sizes[3][3];

  // check how many zones there are in the CGNS file
  if (cg_nzones(_fileIndex, 1, &amp;_numberOfZones)) cg_error_exit();
  _zoneSizesMax.resize(_numberOfZones);
  _zoneSizesMin.resize(_numberOfZones);

  for (int zone = 0; zone &lt; _numberOfZones; ++zone) {
    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument
    ZoneType_t zoneType;
    if (cg_zone_type(_fileIndex, 1, zone + 1, &amp;zoneType)) cg_error_exit();
    assert(zoneType == zoneTypeRequired &amp;&amp; &quot;Wrong mesh type read, expected either structured or unstrucutred&quot;);

    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises
    int numberOfGrids;
    if (cg_ngrids(_fileIndex, 1, zone + 1, &amp;numberOfGrids)) cg_error_exit();
    assert(numberOfGrids == 1 &amp;&amp; &quot;Mesh reading only supported for a mesh with a single grid per zone&quot;);

    // get the name of the zone and store it in a temporary map. We'll need that for reading boundary conditions later
    if (cg_zone_read(_fileIndex, 1, zone + 1, zonename, sizes[0])) cg_error_exit();
    _zoneNamesMap.emplace(std::string(zonename), zone);

    // we only support 2D meshes for now, make sure this is the case
    int numberOfCoordinatesToRead;
    if (cg_ncoords(_fileIndex, 1, zone + 1, &amp;numberOfCoordinatesToRead)) cg_error_exit();
    assert(numberOfCoordinatesToRead == 2 &amp;&amp; &quot;Mesh reading only supported for 2D meshes&quot;);

    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1
    _zoneSizesMin[zone].resize(numberOfCoordinatesToRead);
    _zoneSizesMax[zone].resize(numberOfCoordinatesToRead);
    for (int coordinate = 0; coordinate &lt; numberOfCoordinatesToRead; ++coordinate) {
      _zoneSizesMin[zone][coordinate] = 1;
      _zoneSizesMax[zone][coordinate] = sizes[0][coordinate];
    }
  }
}

void ReadMeshBase::createBoundaryNameLookupTable() {
  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by
  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The
  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.
  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we
  // need to read the family information and then get the boundary condition name and type from the family. Later,
  // we need to to map that information to the correct boundary condition. In the following, we check if the
  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family
  // node with all of its boundary information, which we'll store in the boundaryConditionMap for later lookup.
  int numberOfFamilies = 0;
  if (cg_nfamilies(_fileIndex, 1, &amp;numberOfFamilies)) cg_error_exit();

  for (int family = 0; family &lt; numberOfFamilies; ++family) {
    char familyName[128];
    int isBoundaryCondition, nGeo;
    if (cg_family_read(_fileIndex, 1, family + 1, familyName, &amp;isBoundaryCondition, &amp;nGeo)) cg_error_exit();

    char familyBoundaryName[128];
    BCType_t familyBoundaryType;

    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other
    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to
    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.
    if (isBoundaryCondition == 1) {
      if (cg_fambc_read(_fileIndex, 1, family + 1, 1, familyBoundaryName, &amp;familyBoundaryType)) cg_error_exit();
      _boundaryConditionMap.emplace(familyName, familyBoundaryType);
    }
  }
}

unsigned ReadMeshBase::getBoundaryConditionID(BCType_t bcType) {
  if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)
    return BC::WALL;
  else if (bcType == 9 || bcType == 10 || bcType == 11 || bcType == 18)
    return BC::INLET;
  else if (bcType == 13 || bcType == 14 || bcType == 15 || bcType == 19)
    return BC::OUTLET;
  else if (bcType == 16 || bcType == 17)
    return BC::SYMMETRY;
  else {
    throw std::runtime_error(&quot;Unsupported boundary condition type specified&quot;);
    exit(-1);
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readMeshBase.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path cgnsFilePath) : </span><span style="color: #DCDCAA">_cgnsFilePath</span><span style="color: #D4D4D4">(cgnsFilePath) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_open</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_cgnsFilePath</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">c_str</span><span style="color: #D4D4D4">(), CG_MODE_READ, &amp;_fileIndex)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::~</span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">cg_close</span><span style="color: #D4D4D4">(_fileIndex);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // check how many bases there are. Only a single base per mesh is supported, which should always be true. </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfBases;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nbases</span><span style="color: #D4D4D4">(_fileIndex, &amp;numberOfBases)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfBases == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for a mesh with a single base&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readZones</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zoneTypeRequired</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zonename</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">64</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // check how many zones there are in the CGNS file</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nzones</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;_numberOfZones)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> zone = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; zone &lt; _numberOfZones; ++zone) {</span></span>
<span class="line"><span style="color: #6A9955">    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> zoneType;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_zone_type</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;zoneType)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(zoneType == zoneTypeRequired &amp;&amp; </span><span style="color: #CE9178">&quot;Wrong mesh type read, expected either structured or unstrucutred&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfGrids;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_ngrids</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfGrids)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfGrids == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for a mesh with a single grid per zone&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // get the name of the zone and store it in a temporary map. We&#39;ll need that for reading boundary conditions later</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_zone_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zonename, </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">])) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneNamesMap</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">emplace</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">(zonename), zone);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // we only support 2D meshes for now, make sure this is the case</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfCoordinatesToRead;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_ncoords</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfCoordinatesToRead)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead == </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for 2D meshes&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> coordinate = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; coordinate &lt; numberOfCoordinatesToRead; ++coordinate) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone][coordinate] = </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone][coordinate] = </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][coordinate];</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by</span></span>
<span class="line"><span style="color: #6A9955">  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The</span></span>
<span class="line"><span style="color: #6A9955">  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.</span></span>
<span class="line"><span style="color: #6A9955">  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we</span></span>
<span class="line"><span style="color: #6A9955">  // need to read the family information and then get the boundary condition name and type from the family. Later,</span></span>
<span class="line"><span style="color: #6A9955">  // we need to to map that information to the correct boundary condition. In the following, we check if the</span></span>
<span class="line"><span style="color: #6A9955">  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family</span></span>
<span class="line"><span style="color: #6A9955">  // node with all of its boundary information, which we&#39;ll store in the boundaryConditionMap for later lookup.</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfFamilies = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nfamilies</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfFamilies)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> family = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; family &lt; numberOfFamilies; ++family) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> isBoundaryCondition, nGeo;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_family_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, family + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, familyName, &amp;isBoundaryCondition, &amp;nGeo)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyBoundaryName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> familyBoundaryType;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other</span></span>
<span class="line"><span style="color: #6A9955">    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to</span></span>
<span class="line"><span style="color: #6A9955">    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (isBoundaryCondition == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_fambc_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, family + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, familyBoundaryName, &amp;familyBoundaryType)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_boundaryConditionMap</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">emplace</span><span style="color: #D4D4D4">(familyName, familyBoundaryType);</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">bcType</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">21</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">22</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">23</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">24</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::WALL;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">9</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">11</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">18</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::INLET;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">13</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">14</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">15</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">19</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::OUTLET;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">16</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">17</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::SYMMETRY;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">throw</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">runtime_error</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;Unsupported boundary condition type specified&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">exit</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-the-constructor-and-destructor">The constructor and destructor</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The constructor and destructor of the <code>ReadMeshBase</code> class are given below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"ReadMeshBase::ReadMeshBase(std::filesystem::path cgnsFilePath) : _cgnsFilePath(cgnsFilePath) {\n  if (cg_open(_cgnsFilePath.string().c_str(), CG_MODE_READ, \u0026amp;_fileIndex)) cg_error_exit();\n  readBases();\n  createBoundaryNameLookupTable();\n}\n\nReadMeshBase::~ReadMeshBase() {\n  cg_close(_fileIndex);\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path cgnsFilePath) : \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e_cgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(cgnsFilePath) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_open\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_cgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e().\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ec_str\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(), CG_MODE_READ, \u0026amp;_fileIndex)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::~\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_close\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":9,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="ReadMeshBase::ReadMeshBase(std::filesystem::path cgnsFilePath) : _cgnsFilePath(cgnsFilePath) {
  if (cg_open(_cgnsFilePath.string().c_str(), CG_MODE_READ, &amp;_fileIndex)) cg_error_exit();
  readBases();
  createBoundaryNameLookupTable();
}

ReadMeshBase::~ReadMeshBase() {
  cg_close(_fileIndex);
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path cgnsFilePath) : </span><span style="color: #DCDCAA">_cgnsFilePath</span><span style="color: #D4D4D4">(cgnsFilePath) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_open</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_cgnsFilePath</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">().</span><span style="color: #DCDCAA">c_str</span><span style="color: #D4D4D4">(), CG_MODE_READ, &amp;_fileIndex)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::~</span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">cg_close</span><span style="color: #D4D4D4">(_fileIndex);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Let's spend some time on the constructor, lines 1-5, as it we will see this function calling pattern repeating. Each CGNS function call returns an error code. We could simply store this error code in a variable and then check if it is any other value than zero. However, there is an accepted shorthand notation, and that is the one you see on line 2.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We place each CGNS function call inside an <code>if</code> statement. Should the <code>if</code> statement evaluate to <code>true</code>, then we call <code>cg_error_exit()</code>, which you can see at the end of line 2. We make use of a little trick here; both <code>true</code> and <code>false</code> evaluate to numerical values, where we have <code>true = 1</code> and <code>false = 0</code>. So, if the CGNS function call returns an error code of <code>0</code>, meaning the function call was successful, then the <code>if</code> statement evaluates to <code>false</code> and the <code>cg_error_exit()</code> function is not called. On the other hand, if there is an error, the return code will be anything except <code>0</code> and thus evaluate to <code>true</code>, so we do call <code>cg_error_exit()</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>cg_error_exit()</code> function remembers the return code of the last called CGNS function, and there are <a href="https://cgns.github.io/standard/CGIO/CGNS_CGIO_errors.html#error-messages" target="_blank" rel="noopener" title="">a few error codes</a> defined in the library. So, if there was an error, the function will give you a brief description of what went wrong, which should help in debugging your code.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's then look at the CGNS function itself. On line 2, we make a call to <code>cg_open()</code> to open a CGNS file and, on line 8, inside the destructor, we close the CGNS file again with a call to <code>cg_close()</code>. The <code>cg_open()</code> function expects a path and filename, which we provide as the first argument.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We use here the <a href="https://en.cppreference.com/w/cpp/filesystem" target="_blank" rel="noopener" title="">C++ filesystem header</a>, which makes it easier to store path and filename information across different operating systems. But the CGNS library is written in plain C and so expects a <code>char</code> for its filename. A file path from the <code>filesystem</code> library can be converted to a C++ <code>std::string</code> using the <code>string()</code> method, and, a C++ <code>std::string</code> can be converted to a C-style string using the <code>c_str()</code> method. This is why you see this chain of functions coupled together, we are downcasting from a filesystem path variable to a C-style char.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The second argument defines whether to open the file in read-only or edit mode, essentially. We want to read from the file only, without making any modifications, so we use there the CGNS-defined variable <code>CG_MODE_READ</code>. Finally, we pass the variable <code>_fileIndex</code> as the last argument. The importance here is that we pass the variable by reference (using the <code>&amp;</code> symbol in front of the variable) and so the function will modify this value for us. If you are not comfortable with references, I took a deep dive into them in my article on <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/understanding-memory-management-in-c" target="_blank" rel="noopener" title="">memory management</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is a common and repeating pattern in the CGNS library. We pass all inputs first and follow them by outputs. In this example, <code>_cgnsFilePath</code> and <code>CG_MODE_READ</code> (i.e. the first two arguments) are inputs, and the last variable (<code>_fileIndex</code>) is an output of this function. By output I mean that the value of the variable is changed. If you look up the function definitions for <code>cg_open()</code>, for example, in the CGNS <a href="https://cgns.github.io/standard/MLL/api/c_api.html#file-and-library-operations" target="_blank" rel="noopener" title="">mid-level library</a>, you'll find the following representation:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2594,"width":"auto","height":"150px","sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full is-resized"><img src="https://cfd.university/wp-content/uploads/2024/01/cgnsFunctionCall.png" alt="" class="wp-image-2594" style="width:auto;height:150px"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>You can see that the first two arguments are shown in blue, and this means they are inputs, whereas the last argument is given in red(-ish) colour. Whenever you look up the function names, this is how you differentiate between inputs and outputs.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There are two more functions the constructor calls; the <code>readBases()</code> and <code>createBoundaryNameLookupTable()</code>. Both of these functions are implemented below and we make sure that both functions are read before we proceed with calling any other function within the class.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-the-number-of-bases">Reading the number of bases</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The code for the <code>readBases()</code> function is given below. But before we look at the function, remember that a base node sits just underneath the root node of a CGNS file. We looked at base nodes and the general structure in my <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/what-is-the-cgns-format-and-how-to-get-started" target="_blank" rel="noopener" title="">first article of this series</a>. But just as a quick recap, we need several bases to store either a deforming mesh, or, keeping the mesh the same, different flow solutions (if we decide to store the flow solution inside a CGNS file, in which case, unsteady data could be written as a series of different bases). For mesh reading, we don't have different flow solutions to worry about and general of static meshes, so we would expect only a single bases.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadMeshBase::readBases() {\n  // check how many bases there are. Only a single base per mesh is supported, which should always be true. \n  int numberOfBases;\n  if (cg_nbases(_fileIndex, \u0026amp;numberOfBases)) cg_error_exit();\n  assert(numberOfBases == 1 \u0026amp;\u0026amp; \u0022Mesh reading only supported for a mesh with a single base\u0022);\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // check how many bases there are. Only a single base per mesh is supported, which should always be true. \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfBases;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nbases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u0026amp;numberOfBases)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfBases == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for a mesh with a single base\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadMeshBase::readBases() {
  // check how many bases there are. Only a single base per mesh is supported, which should always be true. 
  int numberOfBases;
  if (cg_nbases(_fileIndex, &amp;numberOfBases)) cg_error_exit();
  assert(numberOfBases == 1 &amp;&amp; &quot;Mesh reading only supported for a mesh with a single base&quot;);
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readBases</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // check how many bases there are. Only a single base per mesh is supported, which should always be true. </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfBases;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nbases</span><span style="color: #D4D4D4">(_fileIndex, &amp;numberOfBases)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfBases == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for a mesh with a single base&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we define a local variable <code>numberOfBases</code> here, which we pass on line 4 to the <code>cg_nbases()</code> function. This function will check, for a given file index (remember, the file index is used to identify a CGNS file that was opened before and we received the <code>_fileIndex</code> back as an output from our call to <code>cg_open()</code>), how many bases there are. Our file CGNS reading is based on the assumption that there is only 1 base, which is not a very strong assumption to make, so this should be true in general. We make sure this is true with the assert statement on line 5.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The reason we use assert statements here is the same as with our linear algebra solver library we looked at in the previous series. We should use as many <code>assert</code> statements as we can in our code as they come for free. What do I mean by that? During development, we want to make sure that the code is behaving as expected, and <code>assert</code> statements help us to verify this automatically at various checkpoints. Here, for example, we expect only to get a single base back, otherwise, the rest of our code will behave unexpectedly and we are unlikely to succeed in reading the mesh successfully.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We can always turn <code>assert</code> statements off (using the <code>/DNDEBUG</code> (Windows) or <code>-DNDEBUG</code> (UNIX) compiler arguments, NDEBUG = no debug), and during the pre-processor state, all assert statements will be removed from our file before they are compiled. In this way, once we are happy that the code is working, we remove all debugging statements and don't lose performance (hence <code>assert</code> statements come for free, in terms of computational overhead). This philosophy is known as the <a href="https://dzone.com/articles/fail-fast-principle-in-software-development" target="_blank" rel="noopener" title="">fail-fast method</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-all-zones-and-zone-information">Reading all zones and zone information</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Next, we want to read, for each base (of which we only have one), the number of zones and then store some content for each zone. The full code for reading zones is given below:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadMeshBase::readZones(ZoneType_t zoneTypeRequired) {\n  char zonename[64];\n  cgsize_t sizes[3][3];\n\n  // check how many zones there are in the CGNS file\n  if (cg_nzones(_fileIndex, 1, \u0026amp;_numberOfZones)) cg_error_exit();\n  _zoneSizesMax.resize(_numberOfZones);\n  _zoneSizesMin.resize(_numberOfZones);\n\n  for (int zone = 0; zone \u0026lt; _numberOfZones; ++zone) {\n    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument\n    ZoneType_t zoneType;\n    if (cg_zone_type(_fileIndex, 1, zone + 1, \u0026amp;zoneType)) cg_error_exit();\n    assert(zoneType == zoneTypeRequired \u0026amp;\u0026amp; \u0022Wrong mesh type read, expected either structured or unstrucutred\u0022);\n\n    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises\n    int numberOfGrids;\n    if (cg_ngrids(_fileIndex, 1, zone + 1, \u0026amp;numberOfGrids)) cg_error_exit();\n    assert(numberOfGrids == 1 \u0026amp;\u0026amp; \u0022Mesh reading only supported for a mesh with a single grid per zone\u0022);\n\n    // get the name of the zone and store it in a temporary map. We'll need that for reading boundary conditions later\n    if (cg_zone_read(_fileIndex, 1, zone + 1, zonename, sizes[0])) cg_error_exit();\n    _zoneNamesMap.emplace(std::string(zonename), zone);\n\n    // we only support 2D meshes for now, make sure this is the case\n    int numberOfCoordinatesToRead;\n    if (cg_ncoords(_fileIndex, 1, zone + 1, \u0026amp;numberOfCoordinatesToRead)) cg_error_exit();\n    assert(numberOfCoordinatesToRead == 2 \u0026amp;\u0026amp; \u0022Mesh reading only supported for 2D meshes\u0022);\n\n    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1\n    _zoneSizesMin[zone].resize(numberOfCoordinatesToRead);\n    _zoneSizesMax[zone].resize(numberOfCoordinatesToRead);\n    for (int coordinate = 0; coordinate \u0026lt; numberOfCoordinatesToRead; ++coordinate) {\n      _zoneSizesMin[zone][coordinate] = 1;\n      _zoneSizesMax[zone][coordinate] = sizes[0][coordinate];\n    }\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadZones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneTypeRequired\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezonename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e64\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // check how many zones there are in the CGNS file\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nzones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;_numberOfZones)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zone = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; zone \u0026lt; _numberOfZones; ++zone) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zoneType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_zone_type\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;zoneType)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(zoneType == zoneTypeRequired \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Wrong mesh type read, expected either structured or unstrucutred\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfGrids;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_ngrids\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfGrids)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfGrids == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for a mesh with a single grid per zone\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // get the name of the zone and store it in a temporary map. We\u0026#39;ll need that for reading boundary conditions later\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_zone_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zonename, \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e])) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneNamesMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eemplace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(zonename), zone);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // we only support 2D meshes for now, make sure this is the case\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfCoordinatesToRead;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_ncoords\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfCoordinatesToRead)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh reading only supported for 2D meshes\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfCoordinatesToRead);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e coordinate = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; coordinate \u0026lt; numberOfCoordinatesToRead; ++coordinate) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][coordinate] = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][coordinate] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003esizes\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][coordinate];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":38,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadMeshBase::readZones(ZoneType_t zoneTypeRequired) {
  char zonename[64];
  cgsize_t sizes[3][3];

  // check how many zones there are in the CGNS file
  if (cg_nzones(_fileIndex, 1, &amp;_numberOfZones)) cg_error_exit();
  _zoneSizesMax.resize(_numberOfZones);
  _zoneSizesMin.resize(_numberOfZones);

  for (int zone = 0; zone &lt; _numberOfZones; ++zone) {
    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument
    ZoneType_t zoneType;
    if (cg_zone_type(_fileIndex, 1, zone + 1, &amp;zoneType)) cg_error_exit();
    assert(zoneType == zoneTypeRequired &amp;&amp; &quot;Wrong mesh type read, expected either structured or unstrucutred&quot;);

    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises
    int numberOfGrids;
    if (cg_ngrids(_fileIndex, 1, zone + 1, &amp;numberOfGrids)) cg_error_exit();
    assert(numberOfGrids == 1 &amp;&amp; &quot;Mesh reading only supported for a mesh with a single grid per zone&quot;);

    // get the name of the zone and store it in a temporary map. We'll need that for reading boundary conditions later
    if (cg_zone_read(_fileIndex, 1, zone + 1, zonename, sizes[0])) cg_error_exit();
    _zoneNamesMap.emplace(std::string(zonename), zone);

    // we only support 2D meshes for now, make sure this is the case
    int numberOfCoordinatesToRead;
    if (cg_ncoords(_fileIndex, 1, zone + 1, &amp;numberOfCoordinatesToRead)) cg_error_exit();
    assert(numberOfCoordinatesToRead == 2 &amp;&amp; &quot;Mesh reading only supported for 2D meshes&quot;);

    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1
    _zoneSizesMin[zone].resize(numberOfCoordinatesToRead);
    _zoneSizesMax[zone].resize(numberOfCoordinatesToRead);
    for (int coordinate = 0; coordinate &lt; numberOfCoordinatesToRead; ++coordinate) {
      _zoneSizesMin[zone][coordinate] = 1;
      _zoneSizesMax[zone][coordinate] = sizes[0][coordinate];
    }
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readZones</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zoneTypeRequired</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zonename</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">64</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // check how many zones there are in the CGNS file</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nzones</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;_numberOfZones)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> zone = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; zone &lt; _numberOfZones; ++zone) {</span></span>
<span class="line"><span style="color: #6A9955">    // check that the zone within the mesh file contains an structured/unstructured mesh, depending on function argument</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">ZoneType_t</span><span style="color: #D4D4D4"> zoneType;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_zone_type</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;zoneType)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(zoneType == zoneTypeRequired &amp;&amp; </span><span style="color: #CE9178">&quot;Wrong mesh type read, expected either structured or unstrucutred&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // ensure that we only have 1 grid per zone. This should always be the case but we check to avoid nasty surprises</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfGrids;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_ngrids</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfGrids)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfGrids == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for a mesh with a single grid per zone&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // get the name of the zone and store it in a temporary map. We&#39;ll need that for reading boundary conditions later</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_zone_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zonename, </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">])) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneNamesMap</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">emplace</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">(zonename), zone);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // we only support 2D meshes for now, make sure this is the case</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfCoordinatesToRead;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_ncoords</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfCoordinatesToRead)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead == </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> &amp;&amp; </span><span style="color: #CE9178">&quot;Mesh reading only supported for 2D meshes&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // store the number of vertices (start and end) for each coordiante (e.g. x and y). Start is always 1</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfCoordinatesToRead);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> coordinate = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; coordinate &lt; numberOfCoordinatesToRead; ++coordinate) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone][coordinate] = </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone][coordinate] = </span><span style="color: #9CDCFE">sizes</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][coordinate];</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>There are two things to notice here; first, while we do call the function <code>readBases()</code> in the constructor, we do not call the function <code>readZones()</code> (above). Secondly, the function expects one function argument (<code>zoneTypeRequired</code>) which is either going to be <code>Structured</code> or <code>Unstructured</code>. These two values are defined in the CGNS header file within an enum. Thus, later when we derive the structured and unstructured mesh reading class, we have to make a call to this function to get all zone information.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We are primarily interested in reading the sizes of the zones, i.e. how many vertices there are for each zone. This will allow us to allocate sufficient memory before we read coordinates. First, we read the number of zones on line 6, which follows a similar pattern to the reading of the number of bases. Notice, though, that we had <code>cg_nbases(_fileIndex, &amp;numberOfBases)</code> before and now we have <code>cg_nzones(_fileIndex, 1, &amp;_numberOfZones)</code>. When we read the number of zones, we also have to specify for which base (index) we want to read zone information.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If we had several bases, then we would have to loop over all bases and then read the number of zones for each base, e.g.:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"int numberOfBases;\nif (cg_nbases(_fileIndex, \u0026amp;numberOfBases)) cg_error_exit();\n\nfor (int base = 0; base \u0026lt; numberOfBases; ++base) {\n  int numberOfZones;\n  if (cg_nzones(_fileIndex, base + 1, \u0026amp;_numberOfZones)) cg_error_exit();\n  // read rest of the zone information ...\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfBases;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nbases\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u0026amp;numberOfBases)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e base = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; base \u0026lt; numberOfBases; ++base) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfZones;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nzones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, base + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;_numberOfZones)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // read rest of the zone information ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":8,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="int numberOfBases;
if (cg_nbases(_fileIndex, &amp;numberOfBases)) cg_error_exit();

for (int base = 0; base &lt; numberOfBases; ++base) {
  int numberOfZones;
  if (cg_nzones(_fileIndex, base + 1, &amp;_numberOfZones)) cg_error_exit();
  // read rest of the zone information ...
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfBases;</span></span>
<span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nbases</span><span style="color: #D4D4D4">(_fileIndex, &amp;numberOfBases)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> base = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; base &lt; numberOfBases; ++base) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfZones;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nzones</span><span style="color: #D4D4D4">(_fileIndex, base + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;_numberOfZones)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #6A9955">  // read rest of the zone information ...</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>CGNS indices are Fortran-based, meaning that the lowest index is <code>1</code>, not <code>0</code>, as in C/C++, so we need to specify an offset by using <code>base + 1</code>. We will see this pattern repeating for other CGNS functions as well, as we go deeper into the zones.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Back to the code above, after we have read the number of zones, we loop over all of them on line 10. On line 13, we check that we are reading the expected zone type (i.e. either a structured or unstructured grid) which we assert on line 14. Line 18 checks that there is only a single grid for this zone, just to make sure that the mesh was written correctly by the mesh generator (we expect to have only a single collection of grid information per zone).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Line 22, then, reads the actual information that we are interested in, specifically the <code>sizes</code> array, which we specified on line 3. We pass in the first argument, and, since C-arrays are contiguous in memory, even if they are 2-dimensional (as in our case, i.e. we have <code>sizes[3][3]</code>), the function can write information into the other allocated memory slots as well. Also notice that since we loop over all zones now, we have to specify for each function call which zone to read information for, e.g. <code>cg_function(_fileIndex, 1, zone + 1, ...)</code>. We hard code the index for the bases to be 1 (as we only have one) but we need to read all zone information separately as we loop over all zones.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We'll later need a lookup table that tells us the zone index for a given zone name. We store that on line 23 and will see that in a later article in action. Line 27 enforces the fact that we are currently only able to read 2D grids. When I originally planned this series, I wanted to support both 2D and 3D but that got quickly out of hand in terms of the code required, it can be done, but look at how long this article is already, and we haven't even gotten into any of the mesh reading, just some helper routines. And, there would have been a lot more templates, which may have been difficult to follow then.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Lines 31-36 then basically store the size of each zone. We specify the minimum index, which is always <code>1</code> (remember, again, CGNS uses Fortran-based indexing, <code>1</code> is the smallest, not <code>0</code>). Then, we store the maximum index for each <code>zone</code> and <code>coordinate</code> (i.e. the x or y direction). This allows us, again, to correctly size our arrays before we pass them back to CGNS to read our coordinates. The reason we have to specify the smallest index as well is generality. We could decide to only read a portion of a grid if that is what we wanted to do. There may be some case-specific reasons why you would want to do that, but during mesh reading, we typically want to read everything in one go.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-creating-a-boundary-condition-lookup-table">Creating a boundary condition lookup table</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Next, we will create a boundary condition lookup table. We need this in case the boundary conditions are written under a family node as discussed above. If boundary conditions are stored in the zone, then there will be no family nodes and so the loop on line 13 will never execute. There is a longer comment at the top which summarises this function as well.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadMeshBase::createBoundaryNameLookupTable() {\n  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by\n  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The\n  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.\n  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we\n  // need to read the family information and then get the boundary condition name and type from the family. Later,\n  // we need to to map that information to the correct boundary condition. In the following, we check if the\n  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family\n  // node with all of its boundary information, which we'll store in the boundaryConditionMap for later lookup.\n  int numberOfFamilies = 0;\n  if (cg_nfamilies(_fileIndex, 1, \u0026amp;numberOfFamilies)) cg_error_exit();\n\n  for (int family = 0; family \u0026lt; numberOfFamilies; ++family) {\n    char familyName[128];\n    int isBoundaryCondition, nGeo;\n    if (cg_family_read(_fileIndex, 1, family + 1, familyName, \u0026amp;isBoundaryCondition, \u0026amp;nGeo)) cg_error_exit();\n\n    char familyBoundaryName[128];\n    BCType_t familyBoundaryType;\n\n    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other\n    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to\n    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.\n    if (isBoundaryCondition == 1) {\n      if (cg_fambc_read(_fileIndex, 1, family + 1, 1, familyBoundaryName, \u0026amp;familyBoundaryType)) cg_error_exit();\n      _boundaryConditionMap.emplace(familyName, familyBoundaryType);\n    }\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecreateBoundaryNameLookupTable\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // need to read the family information and then get the boundary condition name and type from the family. Later,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // we need to to map that information to the correct boundary condition. In the following, we check if the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // node with all of its boundary information, which we\u0026#39;ll store in the boundaryConditionMap for later lookup.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfFamilies = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nfamilies\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfFamilies)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e family = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; family \u0026lt; numberOfFamilies; ++family) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e isBoundaryCondition, nGeo;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_family_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, family + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, familyName, \u0026amp;isBoundaryCondition, \u0026amp;nGeo)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyBoundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e familyBoundaryType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (isBoundaryCondition == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_fambc_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, family + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, familyBoundaryName, \u0026amp;familyBoundaryType)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditionMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eemplace\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(familyName, familyBoundaryType);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":29,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadMeshBase::createBoundaryNameLookupTable() {
  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by
  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The
  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.
  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we
  // need to read the family information and then get the boundary condition name and type from the family. Later,
  // we need to to map that information to the correct boundary condition. In the following, we check if the
  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family
  // node with all of its boundary information, which we'll store in the boundaryConditionMap for later lookup.
  int numberOfFamilies = 0;
  if (cg_nfamilies(_fileIndex, 1, &amp;numberOfFamilies)) cg_error_exit();

  for (int family = 0; family &lt; numberOfFamilies; ++family) {
    char familyName[128];
    int isBoundaryCondition, nGeo;
    if (cg_family_read(_fileIndex, 1, family + 1, familyName, &amp;isBoundaryCondition, &amp;nGeo)) cg_error_exit();

    char familyBoundaryName[128];
    BCType_t familyBoundaryType;

    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other
    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to
    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.
    if (isBoundaryCondition == 1) {
      if (cg_fambc_read(_fileIndex, 1, family + 1, 1, familyBoundaryName, &amp;familyBoundaryType)) cg_error_exit();
      _boundaryConditionMap.emplace(familyName, familyBoundaryType);
    }
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">createBoundaryNameLookupTable</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #6A9955">  // In CGNS, we can read boundary conditions in two ways; either by placing them directly onto the grid, or by</span></span>
<span class="line"><span style="color: #6A9955">  // inserting an additional layer (called a family) which connects the grid with a boundary condition. The</span></span>
<span class="line"><span style="color: #6A9955">  // advantage of using a family node is that the boundary condition remains intact, even if the mesh is changed.</span></span>
<span class="line"><span style="color: #6A9955">  // The disadvantage is that we have to do a bit more work to read the boundary condition information. First, we</span></span>
<span class="line"><span style="color: #6A9955">  // need to read the family information and then get the boundary condition name and type from the family. Later,</span></span>
<span class="line"><span style="color: #6A9955">  // we need to to map that information to the correct boundary condition. In the following, we check if the</span></span>
<span class="line"><span style="color: #6A9955">  // boundary conditions are stored under a family (i.e. the bc type is FamilySpecified) and then we read the family</span></span>
<span class="line"><span style="color: #6A9955">  // node with all of its boundary information, which we&#39;ll store in the boundaryConditionMap for later lookup.</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfFamilies = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nfamilies</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfFamilies)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> family = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; family &lt; numberOfFamilies; ++family) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> isBoundaryCondition, nGeo;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_family_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, family + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, familyName, &amp;isBoundaryCondition, &amp;nGeo)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyBoundaryName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> familyBoundaryType;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // only if isBoundaryCondition is equal to 1 are boundary conditions stored. For a value other than 1, other</span></span>
<span class="line"><span style="color: #6A9955">    // family information may be stored e.g. different volume conditions (useful for separating zones/volumes to</span></span>
<span class="line"><span style="color: #6A9955">    // apply MRF or sliding grids, for example). We are only interested in reading boundary conditions, though.</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (isBoundaryCondition == </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_fambc_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, family + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, familyBoundaryName, &amp;familyBoundaryType)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_boundaryConditionMap</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">emplace</span><span style="color: #D4D4D4">(familyName, familyBoundaryType);</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we check the number of families (lines 10-11), which, like the zones, also sit under the base node. We loop over all families, if there are any, on line 13, and then read the family information on line 16. Of particular interest is the flag <code>isBoundaryCondition</code>. If this is set to <code>true</code> (even though the CGNS mid-level library requires you to specify these values as an <code>int</code>, but we also saw above that <code>true = 1</code> and <code>false = 0</code>, i.e. they are just integers, essentially), then we can expect boundary conditions to be present.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In my <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-inspect-structured-and-unstructured-grids-using-cgns" target="_blank" rel="noopener" title="">previous article</a> we saw that we may have volume conditions as well stored under the family nodes so we don't want to read them as part of the boundary condition reading task. So, only if <code>isBoundaryCondition == true</code> (or equal to 1, as we check on line 24), we want to read boundary information, which we do on line 25. In particular, we are interested in the boundary name and the type. The name is what we gave during mesh generation, and the type is one of the 21 different CGNS types we can choose from.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-mapping-cgns-boundary-conditions-id">Mapping CGNS boundary conditions ID</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Remember a bit further up we defined within the <code>meshReaderLib/include/types.hpp</code> file a few <code>enum</code>s? One of them was given as</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"enum BC {WALL = 0, INLET, OUTLET, SYMMETRY};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eenum\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eWALL\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eINLET\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eOUTLET\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4FC1FF\u0022\u003eSYMMETRY\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="enum BC {WALL = 0, INLET, OUTLET, SYMMETRY};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">enum</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">WALL</span><span style="color: #D4D4D4"> = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">INLET</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">OUTLET</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">SYMMETRY</span><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>These are the boundary conditions we want to support, for now (and who knows, maybe we get periodic boundary conditions one day in a sensible way, and we may add one more to the list). I come very much from an incompressible background, with these 4 boundary conditions you get quite far, if you are dealing with compressible flows, you may need more than that (or maybe you just use farfield condition, in which case you actually need less). The point is, I want to specify the boundary conditions that my mesh should have, and then I need to map all available CGNS boundary conditions to my types. This is done in the code below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"unsigned ReadMeshBase::getBoundaryConditionID(BCType_t bcType) {\n  if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)\n    return BC::WALL;\n  else if (bcType == 9 || bcType == 10 || bcType == 11 || bcType == 18)\n    return BC::INLET;\n  else if (bcType == 13 || bcType == 14 || bcType == 15 || bcType == 19)\n    return BC::OUTLET;\n  else if (bcType == 16 || bcType == 17)\n    return BC::SYMMETRY;\n  else {\n    throw std::runtime_error(\u0022Unsupported boundary condition type specified\u0022);\n    exit(-1);\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ebcType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e21\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e22\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e23\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e24\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::WALL;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e9\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e10\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e11\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e18\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::INLET;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e13\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e14\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e15\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e19\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::OUTLET;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e16\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e17\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::SYMMETRY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ethrow\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eruntime_error\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Unsupported boundary condition type specified\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eexit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(-\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="unsigned ReadMeshBase::getBoundaryConditionID(BCType_t bcType) {
  if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)
    return BC::WALL;
  else if (bcType == 9 || bcType == 10 || bcType == 11 || bcType == 18)
    return BC::INLET;
  else if (bcType == 13 || bcType == 14 || bcType == 15 || bcType == 19)
    return BC::OUTLET;
  else if (bcType == 16 || bcType == 17)
    return BC::SYMMETRY;
  else {
    throw std::runtime_error(&quot;Unsupported boundary condition type specified&quot;);
    exit(-1);
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">bcType</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">21</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">22</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">23</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">24</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::WALL;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">9</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">11</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">18</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::INLET;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">13</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">14</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">15</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">19</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::OUTLET;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">16</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">17</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::SYMMETRY;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">throw</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">runtime_error</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;Unsupported boundary condition type specified&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">exit</span><span style="color: #D4D4D4">(-</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We get one function argument, <code>bcType</code>, which is a number pointing to one of the 21 boundary conditions (you notice that we check up to a <code>bcType</code> value of 24, there are a few boundary conditions that I discard, such as <code>general</code> and <code>user-defined</code>, hence, the actual number of boundary conditions stored in the CGNS header file are more than 21, but there are 21 usable boundary conditions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then simply check what value <code>bcType</code> has and then map it to the best approximation. I am using here the numbers of the boundary conditions as this saves some space (but for educational purposes I should have used the types instead, my bad). If you want to figure out which boundary condition corresponds to which index, you will need to inspect the CGNS header file, i.e. <code>cgnslib.h</code>. Below is a screenshot of the relevant section:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2604,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cfd.university/wp-content/uploads/2024/01/boundaryCoinditionTypes.png" alt="" class="wp-image-2604"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>With that information, let's rewrite the first line where we check for wall boundary conditions. So, instead of writing</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)\n  return BC::WALL;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e21\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e22\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e23\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e || bcType == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e24\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::WALL;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="if (bcType == 20 || bcType == 21 || bcType == 22 || bcType == 23 || bcType == 24)
  return BC::WALL;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == </span><span style="color: #B5CEA8">20</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">21</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">22</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">23</span><span style="color: #D4D4D4"> || bcType == </span><span style="color: #B5CEA8">24</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::WALL;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>using the information above, we could have also written this line as</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"if (bcType == BCWall || bcType == BCWallInviscid || bcType == BCWallViscous || bcType == BCWallViscousHeatFlux || bcType == BCWallViscousIsothermal)\n  return BC::WALL;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (bcType == BCWall || bcType == BCWallInviscid || bcType == BCWallViscous || bcType == BCWallViscousHeatFlux || bcType == BCWallViscousIsothermal)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBC\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::WALL;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="if (bcType == BCWall || bcType == BCWallInviscid || bcType == BCWallViscous || bcType == BCWallViscousHeatFlux || bcType == BCWallViscousIsothermal)
  return BC::WALL;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (bcType == BCWall || bcType == BCWallInviscid || bcType == BCWallViscous || bcType == BCWallViscousHeatFlux || bcType == BCWallViscousIsothermal)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BC</span><span style="color: #D4D4D4">::WALL;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>A bit longer, but definitely more readable. I must of on a mental vacation while writing this function, but well, you get the idea, hopefully. Using these <code>enum</code> types is probably a better way to map the boundary conditions, especially should additional boundary conditions be added in the future, in which case the numbers may not be the same. So, it is not just more readable but also less error prone.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-initial-library-testing-the-main-cpp-file">Initial library testing</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Well, we start by populating some code into our <code>main.cpp</code> file, which is where we want to start testing our library. For the moment, we can't actually do that much. We can't create an object from our base class, because it contains pure virtual functions, and a class containing pure virtual functions can not be instantiated. So we need to wait until we derive from hat class, implement all pure virtual functions and then test those derived classes instead. For now, we simply specify the path to one of the mesh files and print it.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;iostream\u003e\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;cmath\u003e\n#include \u0026lt;string\u003e\n\n#include \u0022meshReaderLib/meshReader.hpp\u0022\n\nint main() {\n  auto structuredMeshPathFamily = std::filesystem::path(\u0022mesh/structured2D.cgns\u0022);\n  std::cout \u0026lt;\u0026lt; \u0022Mesh path: \u0022 \u0026lt;\u0026lt; structuredMeshPathFamily \u0026lt;\u0026lt; std::endl;\n\n  return 0;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;cmath\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;string\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/meshReader.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e structuredMeshPathFamily = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;mesh/structured2D.cgns\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Mesh path: \u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; structuredMeshPathFamily \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;iostream&gt;
#include &lt;filesystem&gt;
#include &lt;cmath&gt;
#include &lt;string&gt;

#include &quot;meshReaderLib/meshReader.hpp&quot;

int main() {
  auto structuredMeshPathFamily = std::filesystem::path(&quot;mesh/structured2D.cgns&quot;);
  std::cout &lt;&lt; &quot;Mesh path: &quot; &lt;&lt; structuredMeshPathFamily &lt;&lt; std::endl;

  return 0;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;cmath&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;string&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/meshReader.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> structuredMeshPathFamily = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">path</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;mesh/structured2D.cgns&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;Mesh path: &quot;</span><span style="color: #D4D4D4"> &lt;&lt; structuredMeshPathFamily &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Right, so this was quite a long write-up, and we haven't even started writing much in the way of structured od unstructured mesh reading code. This will happen in the next two articles. But for now, we looked at how to set up the basic project structure, which closely follows that of the previous library we wrote. It makes sense to keep these developments in a library form, as this allows us later to rescue the code we are writing now.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We looked at the basic build scripts and the same caveats as for the last series apply; we will eventually have to replace them with proper build scripts and we will do so in the future using CMake. For now, we looked at the raw compiler commands, which should help us understand how to call our compiler with which flags to get the final executable we want.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this article, then, we looked at the first class, which serves as our base class for mesh reading. It defines a few functions as pure virtual functions which will need to be implemented by the structured and unstructured mesh reading class (e.g. coordinate, interface, and boundary condition reading). The function calls will be very similar, but the information that is stored is different, so there will be some differences in code and hence it makes sense to split this code into their own child classes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We looked at some common functionality as well, specifically how to read bases and zones, as well as how to extract boundary conditions from family nodes, should there be any. So we already saw how to interact with a CGNS file through the mid-level library calls and we will continue to use this API in upcoming articles.</p>
<!-- /wp:paragraph -->