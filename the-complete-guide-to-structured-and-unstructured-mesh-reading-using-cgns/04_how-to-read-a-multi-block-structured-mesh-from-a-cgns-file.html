<!-- wp:paragraph -->
<p>In this article, we extend the work we have done in the previous article, where we have set up the basic library structure of our mesh reading library and started to provide an initial implementation of the base class. Specifically, we add a class that can read a multi-block structured mesh from a CGNS file. While we limit ourselves to 2D here, this can be easily extended to 3D (and we may get around one day to do so).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>By the end of this article, you should have an excellent understanding of how to interact with the CGNS mid-level library and how we can use this to read the coordinates, interfaces, and boundary conditions from a CGNS file. You will start to build up an intuition for how the mid-level library calls are constructed and we even have a look at some advanced functionalities. I also make comments about how we could extend this class in case your mesh generator writes out CGNS files slightly differently to the one used in this series. Let's get started.</p>
<!-- /wp:paragraph -->

<!-- wp:block {"ref":2490} /-->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><strong>Download</strong>: <a href="https://cfd.university/download/cgnsmeshreaderlib-part3/?tmstv=1712896766" title="">cgnsMeshReaderLib-Part-3.zip</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this series</h2>
<!-- /wp:heading -->

<!-- wp:shortcode -->
[custom_category_posts_list category_slug="the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns"]
<!-- /wp:shortcode -->

<!-- wp:heading -->
<h2 class="wp-block-heading">In this article</h2>
<!-- /wp:heading -->

<!-- wp:aioseo/table-of-contents {"headings":[{"id":8,"blockClientId":"b45c227c-1c1a-4a75-93d0-7381c2b49889","content":"Overview","level":2,"anchor":"aioseo-introduction","order":0,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":15,"blockClientId":"bff605bf-fe21-4815-8c42-45cf31cd4ab0","content":"Updating existing files","level":2,"anchor":"aioseo-initial-build-scripts-to-test-our-implementations","order":1,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":17,"blockClientId":"ca8f2c13-6f99-4f9c-a696-cdbc90090546","content":"Build scrips","level":3,"anchor":"aioseo-build-scrips","order":2,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":19,"blockClientId":"88936847-621b-4411-a77f-1d8462872142","content":"Windows","level":4,"anchor":"aioseo-windows","order":3,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":23,"blockClientId":"8758439e-7144-4d75-8bac-5a0d53672423","content":"UNIX","level":4,"anchor":"aioseo-unix","order":4,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":26,"blockClientId":"f2277497-b054-4c6c-b9dd-cb7752c2e68b","content":"Header files","level":3,"anchor":"aioseo-header-files","order":5,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":29,"blockClientId":"09a6c6ee-659e-47ae-b631-521e49770996","content":"main.cpp for testing","level":3,"anchor":"aioseo-main-cpp-for-testing","order":6,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":35,"blockClientId":"7519b70a-c3e2-4ef5-affa-0614f44535aa","content":"Creating a derived class for structured grids","level":2,"anchor":"aioseo-creating-a-derived-class-for-structured-grids","order":7,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":37,"blockClientId":"5d836527-0c2b-431a-abb5-a4db393af9a0","content":"Creating the class interface","level":3,"anchor":"aioseo-creating-the-class-interface-header-file","order":8,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":40,"blockClientId":"51525fbe-38ce-4ee9-82d1-39a2f9b5598d","content":"Preprocessor directives","level":4,"anchor":"aioseo-preprocessor-directives","order":9,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":49,"blockClientId":"1cdf737c-6a45-4590-a3df-60cf8c7d0672","content":"Specified types","level":4,"anchor":"aioseo-types-and-interface","order":10,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":56,"blockClientId":"e10dee84-797b-4045-8a7b-73ac14a41d53","content":"Function declarations","level":4,"anchor":"aioseo-function-declarations","order":11,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]},{"id":64,"blockClientId":"9a4d7b47-cf0e-4d3e-84a4-93dfa7ccbfae","content":"Implementing the interface","level":3,"anchor":"aioseo-implementing-the-interface","order":12,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":66,"blockClientId":"eeac65d7-adf2-4eec-bcd3-afc05df71b64","content":"Constructor","level":4,"anchor":"aioseo-constructor","order":13,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":69,"blockClientId":"d328666d-75fc-49ce-9c9b-f8a2a258f497","content":"Implementing the readMesh() function","level":4,"anchor":"aioseo-implementing-the-readmesh-and-getter-functions","order":14,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":73,"blockClientId":"d923bf83-10d6-49ca-a32c-fea6d57e14a7","content":"Reading coordinates from a CGNS file","level":4,"anchor":"aioseo-reading-coordinates-from-cgns-file","order":15,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":86,"blockClientId":"c3c9ab55-45df-4526-9c41-79f8f42aa2f8","content":"Reading interface connectivity for multi-block structured grids from a CGNS file","level":4,"anchor":"aioseo-reading-interface-connectivity-information-from-cgns-file","order":16,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":88,"blockClientId":"4757663e-8f0e-4635-9a5a-b5d147434a93","content":"What interface connectivity information do we need and what does CGNS offer?","level":5,"anchor":"aioseo-what-interface-connectivity-information","order":17,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":98,"blockClientId":"b71cb39a-00e9-434e-a376-0cac53ea4352","content":"CGNS implementation of reading global interface connectivity information.","level":5,"anchor":"aioseo-cgns-implementation-of-reading-global-interface-connectivity-information","order":18,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":101,"blockClientId":"d0e7067a-219b-4a58-80b6-42967386d8f1","content":"C-style array memory allocation for CGNS functions","level":6,"anchor":"aioseo-c-style-array-memory-allocation-for-cgns-functions","order":19,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":104,"blockClientId":"8c03d91b-2673-49ed-99ab-4ea028c944d0","content":"Reading interface connectivity information in the interface","level":6,"anchor":"aioseo-reading-interface-connectivity-information-in-the-interface","order":20,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":112,"blockClientId":"6647e41d-405a-4901-9a87-1166c6d4506a","content":"Constructing the transformation matrix for owner-neighbour indices","level":6,"anchor":"aioseo-constructing-the-transformation-matrix-for-owner-neighbour","order":21,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":121,"blockClientId":"6263e970-9c92-416e-80b4-179d630f5237","content":"Calculate the number of indices in the interface","level":6,"anchor":"aioseo-calculate-the-number-of-indices-in-the-interface","order":22,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":127,"blockClientId":"929b89db-6d0f-494e-b48e-4fdaafdcee39","content":"Constructing i,j index pairs of owner/neighbour vertices using the transformation matrix","level":6,"anchor":"aioseo-constructing-ij-index-pairs-of-owner-neighbour-vertices-using-the-transformation-matrix","order":23,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]}]},{"id":140,"blockClientId":"fee6e25a-fb21-4dd0-8607-d77e3f5d962a","content":"Reading boundary conditions from a CGNS file","level":4,"anchor":"aioseo-reading-boundary-conditions-from-cgns-file","order":24,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[{"id":146,"blockClientId":"b3f43039-bc51-4d9c-ba2a-fc694a127d0d","content":"Reading the boundary condition information","level":5,"anchor":"aioseo-reading-boundary-condition-information","order":25,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":153,"blockClientId":"75e2a4f1-0243-4cfc-9929-87a4439224c4","content":"Constructing i,j index pairs for each boundary condition","level":5,"anchor":"aioseo-reading-boundary","order":26,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":159,"blockClientId":"cc5c1634-1851-433c-8968-c2d621b03bd0","content":"Extending the boundary condition reading for point lists","level":5,"anchor":"aioseo-extending-the-boundary-condition-reading-for-point-lists","order":27,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]},{"id":164,"blockClientId":"7172586f-ddf5-4e3f-aad8-71cb22fea483","content":"Storing boundary condition name and type","level":5,"anchor":"aioseo-storing-boundary-condition-name-and-type","order":28,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]}]}]},{"id":173,"blockClientId":"6abe6c55-0e8f-4fb6-aeb6-896c839834fd","content":"Summary","level":2,"anchor":"aioseo-summary","order":29,"editedContent":"","editedLevel":0,"editedOrder":0,"hidden":false,"headings":[]}]} -->
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#aioseo-introduction">Overview</a></li><li><a href="#aioseo-initial-build-scripts-to-test-our-implementations">Updating existing files</a><ul><li><a href="#aioseo-build-scrips">Build scrips</a><ul><li><a href="#aioseo-windows">Windows</a></li><li><a href="#aioseo-unix">UNIX</a></li></ul></li><li><a href="#aioseo-header-files">Header files</a></li><li><a href="#aioseo-main-cpp-for-testing">main.cpp for testing</a></li></ul></li><li><a href="#aioseo-creating-a-derived-class-for-structured-grids">Creating a derived class for structured grids</a><ul><li><a href="#aioseo-creating-the-class-interface-header-file">Creating the class interface</a><ul><li><a href="#aioseo-preprocessor-directives">Preprocessor directives</a></li><li><a href="#aioseo-types-and-interface">Specified types</a></li><li><a href="#aioseo-function-declarations">Function declarations</a></li></ul></li><li><a href="#aioseo-implementing-the-interface">Implementing the interface</a><ul><li><a href="#aioseo-constructor">Constructor</a></li><li><a href="#aioseo-implementing-the-readmesh-and-getter-functions">Implementing the readMesh() function</a></li><li><a href="#aioseo-reading-coordinates-from-cgns-file">Reading coordinates from a CGNS file</a></li><li><a href="#aioseo-reading-interface-connectivity-information-from-cgns-file">Reading interface connectivity for multi-block structured grids from a CGNS file</a><ul><li><a href="#aioseo-what-interface-connectivity-information">What interface connectivity information do we need and what does CGNS offer?</a></li><li><a href="#aioseo-cgns-implementation-of-reading-global-interface-connectivity-information">CGNS implementation of reading global interface connectivity information.</a><ul><li><a href="#aioseo-c-style-array-memory-allocation-for-cgns-functions">C-style array memory allocation for CGNS functions</a></li><li><a href="#aioseo-reading-interface-connectivity-information-in-the-interface">Reading interface connectivity information in the interface</a></li><li><a href="#aioseo-constructing-the-transformation-matrix-for-owner-neighbour">Constructing the transformation matrix for owner-neighbour indices</a></li><li><a href="#aioseo-calculate-the-number-of-indices-in-the-interface">Calculate the number of indices in the interface</a></li><li><a href="#aioseo-constructing-ij-index-pairs-of-owner-neighbour-vertices-using-the-transformation-matrix">Constructing i,j index pairs of owner/neighbour vertices using the transformation matrix</a></li></ul></li></ul></li><li><a href="#aioseo-reading-boundary-conditions-from-cgns-file">Reading boundary conditions from a CGNS file</a><ul><li><a href="#aioseo-reading-boundary-condition-information">Reading the boundary condition information</a></li><li><a href="#aioseo-reading-boundary">Constructing i,j index pairs for each boundary condition</a></li><li><a href="#aioseo-extending-the-boundary-condition-reading-for-point-lists">Extending the boundary condition reading for point lists</a></li><li><a href="#aioseo-storing-boundary-condition-name-and-type">Storing boundary condition name and type</a></li></ul></li></ul></li></ul></li><li><a href="#aioseo-summary">Summary</a></li></ul></div>
<!-- /wp:aioseo/table-of-contents -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-introduction">Overview</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">last article</a>, we looked at setting up the basic library structure and proceeded with writing some code. We mainly concentrated on the <code>ReadMeshBase</code> class, which provides an interface for mesh reading classes to implement. It was structured in a way to read CGNS mesh files in particular and so provided already implementations to read the number of bases (and assertions that we only expect a single base), as well as code to read zone information (the number of vertices).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this article, I want to continue the implementation of the mesh reading interface and write the code for the structured mesh reading class. This will require the addition of one header and one source file, as well as a few updates to existing files. The updated project tree is given below, and if you download the zip archive provided at the beginning of this article, you can inspect the project structure, as well as all of the code files as we go along.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"meshReadingLibRoot\n├── mesh\n│   ├── structured2D.cgns\n│   ├── structured2DNoFamily.cgns\n│   ├── unstructured2D.cgns\n│   └── unstructured2DNoFamily.cgns\n├── meshReaderLib\n│   ├── include\n│   │   ├── readMeshBase.hpp\n│   │   ├── readStructuredMesh.hpp    // new\n│   │   └── types.hpp\n│   ├── src\n│   │   ├── readMeshBase.cpp\n│   │   └── readStructuredMesh.cpp    // new\n│   └── meshReader.hpp                // updated\n├── buildAndRun.ps1                   // updated\n├── buildAndRun.sh                    // updated\n└── main.cpp                          // updated","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003emeshReadingLibRoot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── mesh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── structured2D.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── structured2DNoFamily.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── unstructured2D.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── unstructured2DNoFamily.cgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── meshReaderLib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── include\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── readMeshBase.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── readStructuredMesh.hpp    // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── types.hpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   ├── src\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   ├── readMeshBase.cpp\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   │   └── readStructuredMesh.cpp    // new\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e│   └── meshReader.hpp                // updated\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.ps1                   // updated\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e├── buildAndRun.sh                    // updated\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e└── main.cpp                          // updated\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"plaintext","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":18,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="meshReadingLibRoot
├── mesh
│   ├── structured2D.cgns
│   ├── structured2DNoFamily.cgns
│   ├── unstructured2D.cgns
│   └── unstructured2DNoFamily.cgns
├── meshReaderLib
│   ├── include
│   │   ├── readMeshBase.hpp
│   │   ├── readStructuredMesh.hpp    // new
│   │   └── types.hpp
│   ├── src
│   │   ├── readMeshBase.cpp
│   │   └── readStructuredMesh.cpp    // new
│   └── meshReader.hpp                // updated
├── buildAndRun.ps1                   // updated
├── buildAndRun.sh                    // updated
└── main.cpp                          // updated" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">meshReadingLibRoot</span></span>
<span class="line"><span style="color: #D4D4D4">├── mesh</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── structured2D.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── structured2DNoFamily.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── unstructured2D.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── unstructured2DNoFamily.cgns</span></span>
<span class="line"><span style="color: #D4D4D4">├── meshReaderLib</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── include</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── readMeshBase.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── readStructuredMesh.hpp    // new</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── types.hpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   ├── src</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   ├── readMeshBase.cpp</span></span>
<span class="line"><span style="color: #D4D4D4">│   │   └── readStructuredMesh.cpp    // new</span></span>
<span class="line"><span style="color: #D4D4D4">│   └── meshReader.hpp                // updated</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.ps1                   // updated</span></span>
<span class="line"><span style="color: #D4D4D4">├── buildAndRun.sh                    // updated</span></span>
<span class="line"><span style="color: #D4D4D4">└── main.cpp                          // updated</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We can see that we are going to add the <code>meshReaderLib/include/readStructuredMesh.hpp</code> header file, as well as the corresponding <code>meshReaderLib/src/readStructuredMesh.cpp</code> source file. These files will contain the definition and implementation of the <code>ReadStructuredMesh</code> class which will allow us, by the end of the article, to read a multi-block structured mesh.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Next, we have to provide a few updates to our build scripts, simply to include the added source file, we have to update our library header include file, so that we are including the new interface (class definition provided in the header file), and, finally, we want to update our <code>main.cpp</code> file to check that after we have read the mesh, we are not getting any error messages. Let's look at the updated code first, and then we'll jump into writing the structured mesh reading class.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-initial-build-scripts-to-test-our-implementations">Updating existing files</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have mentioned that a few files need updating. In this section, we will go through them quickly and see the changes we have to apply. Note that we have discussed each file in more depth in the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">previous article</a>, so if some of the files do not make sense or you need additional explanations, have a look at the previous article which hopefully should clear things up.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-build-scrips">Build scrips</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have to make minor tweaks to both the build script on Windows and UNIX to include the additional source file we are going to add. These are shown below</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-windows">Windows</h4>
<!-- /wp:heading -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"# clean up before building\nRemove-Item .\\build -Force -Recurse\nNew-Item -Name \u0022build\u0022 -ItemType \u0022directory\u0022\nCopy-Item \u0022C:\\libraries\\bin\\hdf5.dll\u0022 -Destination .\\build\nCopy-Item \u0022C:\\libraries\\bin\\zlib.dll\u0022 -Destination .\\build\n\n# compile source files into object files\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readMeshBase.cpp /Fo\u0022.\\build\\readMeshBase.obj\u0022\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readStructuredMesh.cpp /Fo\u0022.\\build\\readStructuredMesh.obj\u0022\ncl.exe /nologo /EHsc /std:c++20 /I. /I \u0022C:\\libraries\\include\u0022 /c /O2 /DCOMPILELIB .\\main.cpp /Fo\u0022.\\build\\main.obj\u0022\n\n# link object files against CGNS library and its dependencies\ncl.exe /nologo /EHsc /std:c++20 .\\build\\main.obj .\\build\\readMeshBase.obj .\\build\\readStructuredMesh.obj /Fe\u0022.\\build\\cgnsTest.exe\u0022 /link /MACHINE:x64 /LIBPATH:\u0022C:\\libraries\\lib\u0022 cgns.lib hdf5.lib msvcrt.lib libcmt.lib\n.\\build\\cgnsTest.exe","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# clean up before building\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eRemove-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build -Force -Recurse\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eNew-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Name \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;build\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -ItemType \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;directory\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCopy-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\bin\\hdf5.dll\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Destination .\\build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCopy-Item\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\bin\\zlib.dll\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e -Destination .\\build\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readMeshBase.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\readMeshBase.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c /O2 /DCOMPILELIB .\\meshReaderLib\\src\\readStructuredMesh.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\readStructuredMesh.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /I. /I \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\include\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /c /O2 /DCOMPILELIB .\\main.cpp /Fo\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\main.obj\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files against CGNS library and its dependencies\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecl.exe\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /nologo /EHsc /std:c+\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e+20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e .\\build\\main.obj .\\build\\readMeshBase.obj .\\build\\readStructuredMesh.obj /Fe\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;.\\build\\cgnsTest.exe\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e /link /MACHINE:x64 /LIBPATH:\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;C:\\libraries\\lib\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e cgns.lib hdf5.lib msvcrt.lib libcmt.lib\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\\build\\\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecgnsTest.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"powershell","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":14,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="# clean up before building
Remove-Item .\build -Force -Recurse
New-Item -Name &quot;build&quot; -ItemType &quot;directory&quot;
Copy-Item &quot;C:\libraries\bin\hdf5.dll&quot; -Destination .\build
Copy-Item &quot;C:\libraries\bin\zlib.dll&quot; -Destination .\build

# compile source files into object files
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c /O2 /DCOMPILELIB .\meshReaderLib\src\readMeshBase.cpp /Fo&quot;.\build\readMeshBase.obj&quot;
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c /O2 /DCOMPILELIB .\meshReaderLib\src\readStructuredMesh.cpp /Fo&quot;.\build\readStructuredMesh.obj&quot;
cl.exe /nologo /EHsc /std:c++20 /I. /I &quot;C:\libraries\include&quot; /c /O2 /DCOMPILELIB .\main.cpp /Fo&quot;.\build\main.obj&quot;

# link object files against CGNS library and its dependencies
cl.exe /nologo /EHsc /std:c++20 .\build\main.obj .\build\readMeshBase.obj .\build\readStructuredMesh.obj /Fe&quot;.\build\cgnsTest.exe&quot; /link /MACHINE:x64 /LIBPATH:&quot;C:\libraries\lib&quot; cgns.lib hdf5.lib msvcrt.lib libcmt.lib
.\build\cgnsTest.exe" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955"># clean up before building</span></span>
<span class="line"><span style="color: #DCDCAA">Remove-Item</span><span style="color: #D4D4D4"> .\build -Force -Recurse</span></span>
<span class="line"><span style="color: #DCDCAA">New-Item</span><span style="color: #D4D4D4"> -Name </span><span style="color: #CE9178">&quot;build&quot;</span><span style="color: #D4D4D4"> -ItemType </span><span style="color: #CE9178">&quot;directory&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">Copy-Item</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;C:\libraries\bin\hdf5.dll&quot;</span><span style="color: #D4D4D4"> -Destination .\build</span></span>
<span class="line"><span style="color: #DCDCAA">Copy-Item</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&quot;C:\libraries\bin\zlib.dll&quot;</span><span style="color: #D4D4D4"> -Destination .\build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object files</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c /O2 /DCOMPILELIB .\meshReaderLib\src\readMeshBase.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\readMeshBase.obj&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c /O2 /DCOMPILELIB .\meshReaderLib\src\readStructuredMesh.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\readStructuredMesh.obj&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> /I. /I </span><span style="color: #CE9178">&quot;C:\libraries\include&quot;</span><span style="color: #D4D4D4"> /c /O2 /DCOMPILELIB .\main.cpp /Fo</span><span style="color: #CE9178">&quot;.\build\main.obj&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files against CGNS library and its dependencies</span></span>
<span class="line"><span style="color: #DCDCAA">cl.exe</span><span style="color: #D4D4D4"> /nologo /EHsc /std:c+</span><span style="color: #B5CEA8">+20</span><span style="color: #D4D4D4"> .\build\main.obj .\build\readMeshBase.obj .\build\readStructuredMesh.obj /Fe</span><span style="color: #CE9178">&quot;.\build\cgnsTest.exe&quot;</span><span style="color: #D4D4D4"> /link /MACHINE:x64 /LIBPATH:</span><span style="color: #CE9178">&quot;C:\libraries\lib&quot;</span><span style="color: #D4D4D4"> cgns.lib hdf5.lib msvcrt.lib libcmt.lib</span></span>
<span class="line"><span style="color: #D4D4D4">.\build\</span><span style="color: #DCDCAA">cgnsTest.exe</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Here, we have added line 9 to include the <code>meshReaderLib/src/readStructuredMesh.cpp</code> source file during compilation. We then include the compiled object file, i.e. <code>build/readStructuredMesh.obj</code>, during the linking on line 13 as well, thus this line needs to be modified.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At the moment, we are compiling and linking both the library code and the <code>main.cpp</code> file at the same time. Once the library is completed, we are going to split both of these into separate compilation steps, i.e. we'll compile the library code first into a static or dynamic library and we will then link our main.cpp file against that library, similar to <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-compiling-and-testing" target="_blank" rel="noopener" title="">how we set up our final library structure</a> for our previous linear algebra solver library.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-unix">UNIX</h4>
<!-- /wp:heading -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#!/bin/bash\n\nrm -rf build\nmkdir -p build\n\n# compile source files into object files\ng++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readMeshBase.cpp -o ./build/readMeshBase.o\ng++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readStructuredMesh.cpp -o ./build/readStructuredMesh.o\ng++ -std=c++20 -I. -I ~/libs/include -c ./main.cpp -o ./build/main.o\n\n# link object files against CGNS library and its dependencies\ng++ -std=c++20 ./build/main.o ./build/readMeshBase.o ./build/readStructuredMesh.o -o ./build/cgnsTest -L~/libs/lib -lcgns\n\n# run executable\n./build/cgnsTest","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e#!/bin/bash\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003erm\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-rf\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emkdir\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-p\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003ebuild\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# compile source files into object files\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./meshReaderLib/src/readMeshBase.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readMeshBase.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./meshReaderLib/src/readStructuredMesh.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readStructuredMesh.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I.\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-I\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e~/libs/include\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-c\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./main.cpp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/main.o\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# link object files against CGNS library and its dependencies\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eg++\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-std=c++20\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/main.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readMeshBase.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/readStructuredMesh.o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-o\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e./build/cgnsTest\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-L~/libs/lib\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e-lcgns\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e# run executable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003e./build/cgnsTest\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"bash","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":15,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#!/bin/bash

rm -rf build
mkdir -p build

# compile source files into object files
g++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readMeshBase.cpp -o ./build/readMeshBase.o
g++ -std=c++20 -I. -I ~/libs/include -c ./meshReaderLib/src/readStructuredMesh.cpp -o ./build/readStructuredMesh.o
g++ -std=c++20 -I. -I ~/libs/include -c ./main.cpp -o ./build/main.o

# link object files against CGNS library and its dependencies
g++ -std=c++20 ./build/main.o ./build/readMeshBase.o ./build/readStructuredMesh.o -o ./build/cgnsTest -L~/libs/lib -lcgns

# run executable
./build/cgnsTest" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DCDCAA">rm</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-rf</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"><span style="color: #DCDCAA">mkdir</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-p</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">build</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># compile source files into object files</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./meshReaderLib/src/readMeshBase.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readMeshBase.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./meshReaderLib/src/readStructuredMesh.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readStructuredMesh.o</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I.</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-I</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">~/libs/include</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-c</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./main.cpp</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># link object files against CGNS library and its dependencies</span></span>
<span class="line"><span style="color: #DCDCAA">g++</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-std=c++20</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/main.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readMeshBase.o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/readStructuredMesh.o</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-o</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">./build/cgnsTest</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-L~/libs/lib</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">-lcgns</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955"># run executable</span></span>
<span class="line"><span style="color: #DCDCAA">./build/cgnsTest</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Similar consideration to what we discussed for the Windows build script holds for UNIX (bash) as well. We are adding here line 8 to compile <code>meshReaderLib/src/readStructuredMesh.cpp</code> as part of the compilation step and then adding its object file during the linking on line 12. We'll separate the compilation of the library and <code>main.cpp</code> file later as well for UNIX to have a separate library to link against once we compile the <code>main.cpp</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-header-files">Header files</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This change is a quick one, within the <code>meshReaderLib/meshReader.hpp</code> file, we simply add an include statement so that we are now including the class definition for the structured mesh reading class, i.e. line 2 <code>#include "meshReaderLib/include/readStructuredMesh.hpp"</code> is added here.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0022meshReaderLib/include/readMeshBase.hpp\u0022\n#include \u0022meshReaderLib/include/readStructuredMesh.hpp\u0022\n#include \u0022meshReaderLib/include/types.hpp\u0022","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readMeshBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readStructuredMesh.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/types.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &quot;meshReaderLib/include/readMeshBase.hpp&quot;
#include &quot;meshReaderLib/include/readStructuredMesh.hpp&quot;
#include &quot;meshReaderLib/include/types.hpp&quot;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readMeshBase.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readStructuredMesh.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/types.hpp&quot;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-main-cpp-for-testing">main.cpp for testing</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The main.cpp file is the only modified file which is pretty much changed completely, at least in terms of its main content body. Let's look at the file first and then discuss the changes.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0026lt;iostream\u003e\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;cmath\u003e\n#include \u0026lt;string\u003e\n\n#include \u0022meshReaderLib/meshReader.hpp\u0022\n\nint main() {\n  auto structuredMeshPathFamily = std::filesystem::path(\u0022mesh/structured2D.cgns\u0022);\n  ReadStructuredMesh structuredMeshFamily(structuredMeshPathFamily);\n  structuredMeshFamily.readMesh();\n\n  std::cout \u0026lt;\u0026lt; \u0022structured mesh was read\u0022 \u0026lt;\u0026lt; std::endl;\n\n  return 0;\n}\n","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;cmath\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;string\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/meshReader.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emain\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e structuredMeshPathFamily = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;mesh/structured2D.cgns\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  ReadStructuredMesh \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estructuredMeshFamily\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(structuredMeshPathFamily);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003estructuredMeshFamily\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::cout \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;structured mesh was read\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u0026lt;\u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::endl;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":17,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &lt;iostream&gt;
#include &lt;filesystem&gt;
#include &lt;cmath&gt;
#include &lt;string&gt;

#include &quot;meshReaderLib/meshReader.hpp&quot;

int main() {
  auto structuredMeshPathFamily = std::filesystem::path(&quot;mesh/structured2D.cgns&quot;);
  ReadStructuredMesh structuredMeshFamily(structuredMeshPathFamily);
  structuredMeshFamily.readMesh();

  std::cout &lt;&lt; &quot;structured mesh was read&quot; &lt;&lt; std::endl;

  return 0;
}
" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;cmath&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;string&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/meshReader.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">main</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> structuredMeshPathFamily = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">path</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&quot;mesh/structured2D.cgns&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  ReadStructuredMesh </span><span style="color: #DCDCAA">structuredMeshFamily</span><span style="color: #D4D4D4">(structuredMeshPathFamily);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">structuredMeshFamily</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::cout &lt;&lt; </span><span style="color: #CE9178">&quot;structured mesh was read&quot;</span><span style="color: #D4D4D4"> &lt;&lt; </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Since we have included the structured mesh reading class header file in the <code>meshReaderLib/meshReader.hpp</code> file, we do not need to make any changes to our library include header, e.g. line 6. The main body itself, however, has entirely changed, mainly as we were not able to instantiate any classes in the previous article, as the base class contains pure virtual functions, which does not allow the creation of objects from these classes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We still provide a path to the structured mesh CGNS file, where boundary conditions are written under a family node. If you are wondering what families in the context of a CGNS file are and how they relate to boundary conditions, I have provided a detailed discussion of them in my article on <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-inspect-structured-and-unstructured-grids-using-cgns" target="_blank" rel="noopener" title="">inspecting structured and unstructured CGNS files</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 10, we path that mesh file path as a constructor argument to the <code>ReadStructuredMesh</code> class and then we use the generated class object <code>structuredMeshFamily</code> to read the mesh on line 11. If everything goes well and no error messages are encountered, we should see the message <code>"structured mesh was read"</code> printed to the console. This is our first indication that there were no issues during the mesh reading. Later, we will test the mesh reading more formally, where we also inspect the mesh (e.g. coordinates, boundary conditions, interface data) that the class is providing us.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-creating-a-derived-class-for-structured-grids">Creating a derived class for structured grids</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In this section, we will look then at the new code we provide to read a structured mesh from a CGNS file. We start, as usual, defining the interface (class structure defined in the header file) first, and then we proceed to look at each function implementation within the source file.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-creating-the-class-interface-header-file">Creating the class interface</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The class definition, or the interface, is defined in the new header file located at <code>meshReaderLib/include/readStructuredMesh.hpp</code>. The file is given below in its full length and we'll go through it afterwards and highlight important code sections.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#pragma once\n\n#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)\n  #if defined(COMPILEDLL)\n    #define MESHREADERLIB_EXPORT __declspec(dllexport)\n  #elif defined(COMPILELIB)\n    #define MESHREADERLIB_EXPORT\n  #else\n    #define MESHREADERLIB_EXPORT __declspec(dllimport)\n  #endif\n#else\n  #define MESHREADERLIB_EXPORT\n#endif\n\n#include \u0026lt;filesystem\u003e\n#include \u0026lt;iostream\u003e\n#include \u0026lt;vector\u003e\n#include \u0026lt;array\u003e\n#include \u0026lt;unordered_map\u003e\n#include \u0026lt;string\u003e\n#include \u0026lt;cmath\u003e\n\n#include \u0022cgnslib.h\u0022\n\n#include \u0022meshReaderLib/include/readMeshBase.hpp\u0022\n#include \u0022meshReaderLib/include/types.hpp\u0022\n\nclass MESHREADERLIB_EXPORT ReadStructuredMesh : public ReadMeshBase {\npublic:\n  using ZoneType = typename std::vector\u0026lt;std::vector\u0026lt;cgsize_t\u003e\u003e;\n  using CoordinateType = typename std::vector\u0026lt;std::vector\u0026lt;std::vector\u0026lt;std::vector\u0026lt;double\u003e\u003e\u003e\u003e;\n  using IndexType = typename std::array\u0026lt;unsigned, 2\u003e;\n  using InterfaceConnectivityType = typename std::vector\u0026lt;InterfaceConnectivity\u0026lt;IndexType\u003e\u003e;\n  using BoundaryConditionInformationType = typename std::vector\u0026lt;std::vector\u0026lt;BoundaryConditionInformation\u0026lt;IndexType\u003e\u003e\u003e;\n\npublic:\n  ReadStructuredMesh(std::filesystem::path cgnsFilePath);\n  void readMesh() override final;\n\n  const CoordinateType\u0026amp; getCoordinates() const { return _coordinates; }\n  const InterfaceConnectivityType\u0026amp; getInterfaceConnectivity() const { return _interfaceConnectivity; }\n  const BoundaryConditionInformationType\u0026amp; getBoundaryConditions() const { return _boundaryConditions; }\n\nprotected:\n  void readCoorinates() override final;\n  void readInterfaceConnectivity() override final;\n  void readBoundaries() override final;\n\nprivate:\n  CoordinateType _coordinates;\n  InterfaceConnectivityType _interfaceConnectivity;\n  BoundaryConditionInformationType _boundaryConditions;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#pragma\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eonce\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(_WIN32) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__WIN32__) \u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e||\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(__NT__)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(COMPILEDLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #elif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(COMPILELIB)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e  #endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e MESHREADERLIB_EXPORT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;filesystem\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;vector\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;array\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;unordered_map\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;string\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026lt;cmath\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;cgnslib.h\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readMeshBase.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/types.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eZoneType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCoordinateType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003earray\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivityType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eusing\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformationType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformation\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt;\u0026gt;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003epath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecgnsFilePath\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCoordinateType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetCoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _coordinates; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivityType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _interfaceConnectivity; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformationType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _boundaryConditions; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprivate:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  CoordinateType _coordinates;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  InterfaceConnectivityType _interfaceConnectivity;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  BoundaryConditionInformationType _boundaryConditions;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":53,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#pragma once

#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__) || defined(__NT__)
  #if defined(COMPILEDLL)
    #define MESHREADERLIB_EXPORT __declspec(dllexport)
  #elif defined(COMPILELIB)
    #define MESHREADERLIB_EXPORT
  #else
    #define MESHREADERLIB_EXPORT __declspec(dllimport)
  #endif
#else
  #define MESHREADERLIB_EXPORT
#endif

#include &lt;filesystem&gt;
#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;array&gt;
#include &lt;unordered_map&gt;
#include &lt;string&gt;
#include &lt;cmath&gt;

#include &quot;cgnslib.h&quot;

#include &quot;meshReaderLib/include/readMeshBase.hpp&quot;
#include &quot;meshReaderLib/include/types.hpp&quot;

class MESHREADERLIB_EXPORT ReadStructuredMesh : public ReadMeshBase {
public:
  using ZoneType = typename std::vector&lt;std::vector&lt;cgsize_t&gt;&gt;;
  using CoordinateType = typename std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt;&gt;;
  using IndexType = typename std::array&lt;unsigned, 2&gt;;
  using InterfaceConnectivityType = typename std::vector&lt;InterfaceConnectivity&lt;IndexType&gt;&gt;;
  using BoundaryConditionInformationType = typename std::vector&lt;std::vector&lt;BoundaryConditionInformation&lt;IndexType&gt;&gt;&gt;;

public:
  ReadStructuredMesh(std::filesystem::path cgnsFilePath);
  void readMesh() override final;

  const CoordinateType&amp; getCoordinates() const { return _coordinates; }
  const InterfaceConnectivityType&amp; getInterfaceConnectivity() const { return _interfaceConnectivity; }
  const BoundaryConditionInformationType&amp; getBoundaryConditions() const { return _boundaryConditions; }

protected:
  void readCoorinates() override final;
  void readInterfaceConnectivity() override final;
  void readBoundaries() override final;

private:
  CoordinateType _coordinates;
  InterfaceConnectivityType _interfaceConnectivity;
  BoundaryConditionInformationType _boundaryConditions;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#pragma</span><span style="color: #569CD6"> </span><span style="color: #9CDCFE">once</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(_WIN32) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__WIN32__) </span><span style="color: #D4D4D4">||</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(__NT__)</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">#if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(COMPILEDLL)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">  #elif</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defined</span><span style="color: #D4D4D4">(COMPILELIB)</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">  #else</span></span>
<span class="line"><span style="color: #569CD6">    </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">  #endif</span></span>
<span class="line"><span style="color: #C586C0">#else</span></span>
<span class="line"><span style="color: #569CD6">  </span><span style="color: #C586C0">#define</span><span style="color: #569CD6"> MESHREADERLIB_EXPORT</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;filesystem&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;vector&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;array&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;unordered_map&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;string&gt;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&lt;cmath&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;cgnslib.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readMeshBase.hpp&quot;</span></span>
<span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/types.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ZoneType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt;&gt;;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">CoordinateType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt;&gt;&gt;&gt;;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">array</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">&gt;;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">InterfaceConnectivityType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">InterfaceConnectivity</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;&gt;;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">using</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BoundaryConditionInformationType</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">BoundaryConditionInformation</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;&gt;&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ReadStructuredMesh</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">path</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">cgnsFilePath</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">CoordinateType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCoordinates</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _coordinates; }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">InterfaceConnectivityType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInterfaceConnectivity</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _interfaceConnectivity; }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BoundaryConditionInformationType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getBoundaryConditions</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _boundaryConditions; }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">private:</span></span>
<span class="line"><span style="color: #D4D4D4">  CoordinateType _coordinates;</span></span>
<span class="line"><span style="color: #D4D4D4">  InterfaceConnectivityType _interfaceConnectivity;</span></span>
<span class="line"><span style="color: #D4D4D4">  BoundaryConditionInformationType _boundaryConditions;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-preprocessor-directives">Preprocessor directives</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Lines 1-13 are identical to the interface of the base class. We mentioned in the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">base class article</a>, that this is only required for Windows, really, and only if we are targeting dynamic libraries. If all we wanted to do is build a static library, that boilerplate code can go. Now we get here into some programming issue, in that we have just repeated ourselves (i.e. we have copied and pasted code from the base class into this class). This isn't great. In reality, you would want to put this into one central place, which is typically the header include file, so in our case, that would be the <code>meshReaderLib/meshReader.hpp</code> file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Take a look at the header include file of the CGNS library, for example, i.e. <code>cgnslib.h</code>, which we include on line 23. If you open that file (e.g. <code>C:\libraries\include\cgnslib.h</code> if you kept the same library installation path as me), then you'll find the following lines somewhere around line 70 (which may change with future releases):</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#ifndef CGNSDLL\n# ifdef _WIN32\n#  if defined(BUILD_DLL)\n#    define CGNSDLL __declspec(dllexport)\n#  elif defined(USE_DLL)\n#    define CGNSDLL __declspec(dllimport)\n#  else\n#    define CGNSDLL\n#  endif\n# else\n#  define CGNSDLL\n# endif\n#endif","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#ifndef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e CGNSDLL\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e# ifdef\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e _WIN32\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  if\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e(BUILD_DLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e CGNSDLL __declspec(dllexport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  elif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003edefined\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(USE_DLL)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e CGNSDLL __declspec(dllimport)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#    define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e CGNSDLL\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e# else\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#  define\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e CGNSDLL\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e# endif\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#endif\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":13,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#ifndef CGNSDLL
# ifdef _WIN32
#  if defined(BUILD_DLL)
#    define CGNSDLL __declspec(dllexport)
#  elif defined(USE_DLL)
#    define CGNSDLL __declspec(dllimport)
#  else
#    define CGNSDLL
#  endif
# else
#  define CGNSDLL
# endif
#endif" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#ifndef</span><span style="color: #569CD6"> CGNSDLL</span></span>
<span class="line"><span style="color: #C586C0"># ifdef</span><span style="color: #569CD6"> _WIN32</span></span>
<span class="line"><span style="color: #C586C0">#  if</span><span style="color: #569CD6"> </span><span style="color: #C586C0">defined</span><span style="color: #569CD6">(BUILD_DLL)</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> CGNSDLL __declspec(dllexport)</span></span>
<span class="line"><span style="color: #C586C0">#  elif</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defined</span><span style="color: #D4D4D4">(USE_DLL)</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> CGNSDLL __declspec(dllimport)</span></span>
<span class="line"><span style="color: #C586C0">#  else</span></span>
<span class="line"><span style="color: #C586C0">#    define</span><span style="color: #569CD6"> CGNSDLL</span></span>
<span class="line"><span style="color: #C586C0">#  endif</span></span>
<span class="line"><span style="color: #C586C0"># else</span></span>
<span class="line"><span style="color: #C586C0">#  define</span><span style="color: #569CD6"> CGNSDLL</span></span>
<span class="line"><span style="color: #C586C0"># endif</span></span>
<span class="line"><span style="color: #C586C0">#endif</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>This looks very familiar, doesn't it? The CGNS library handles this a bit differently than our current library (there is an additional <code>if</code> statement, i.e. lines 1 to 13), but the essence is the same. If you then go further down the <code>cgnslib.h</code> file, you'll find the functions declaration for reading zone information (as an example), of which two selected functions look like this:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"CGNSDLL int cg_nzones(int fn, int B, int *nzones);\nCGNSDLL int cg_zone_read(int fn, int B, int Z, char *zonename, cgsize_t *size);","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eCGNSDLL \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nzones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e fn, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e B, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e *nzones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003eCGNSDLL \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_zone_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e fn, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e B, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e Z, \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e *zonename, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e *size);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="CGNSDLL int cg_nzones(int fn, int B, int *nzones);
CGNSDLL int cg_zone_read(int fn, int B, int Z, char *zonename, cgsize_t *size);" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #D4D4D4">CGNSDLL </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">cg_nzones</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> fn, </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> B, </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> *nzones);</span></span>
<span class="line"><span style="color: #D4D4D4">CGNSDLL </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">cg_zone_read</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> fn, </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> B, </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> Z, </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> *zonename, </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> *size);</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>You'll see that all functions now start with <code>CGNSDLL</code> and so will either have <code>__declspec(dllexport)</code> or <code>__declspec(dllimport)</code> in front of them (for dynamic libraries on Windows) or an empty string for any other case. In our case, we simply have to modify the class name, i.e. we have</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"class MESHREADERLIB_EXPORT ReadStructuredMesh : public ReadMeshBase","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eclass\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadMeshBase\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="class MESHREADERLIB_EXPORT ReadStructuredMesh : public ReadMeshBase" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadMeshBase</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Now, all functions inside the class will have the correct <code>__declspec</code> directive set and we don't have to prepend any of the function names inside the class with the <code>MESHREADERLIB_EXPORT </code>preprocessor directive. We discussed the <code>__declspec</code> directives in more depth in the article on <a href="https://cfd.university/learn/how-to-compiler-write-and-use-cfd-libraries-in-c/how-to-write-a-cfd-library-compiling-and-testing" target="_blank" rel="noopener" title="">compiling the linear algebra library</a> in the previous series, so have a look if you need a refresher.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-types-and-interface">Specified types</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In the header file, we define a few types on lines 30-34, that we use to define variables on lines 50-52. I just noticed as well that we still have the <code>ZoneType</code> on line 30, this one should have been deleted (it has moved to the base class). The <code>CoordinateType</code> is a 4-dimensional <code>std::vector</code>, the first index goes over all zones, the second and third over all points in the x and y direction, and the fourth index contains the x and y coordinate. If we had 3D mesh reading, we would need to make this a 5D vector. We could have also made the last argument a <code>std::array&lt;double, 2&gt;</code>, since in this case it is not changing, but it would not make much of a difference here.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We define an <code>IndexType</code> on line 32 of type <code>std::array&lt;double, 2&gt;</code>, i.e. this index type tells us that if we want to index any point in the 2D mesh, we need two indices, which in CFD terminology would be the <code>i, j</code> index. We use this index type as a template argument on the next two lines when we construct the <code>InterfaceConnectivityType</code> and the <code>BoundaryConditionInformationType</code>. These, in turn, make use of the <code>InterfaceConnectivity</code> and <code>BoundaryConditionInformation struct</code> which we defined in the base class header file. For example, the <code>InterfaceConnectivity</code> struct had this form:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"template\u0026lt;typename IndexType\u003e\nstruct MESHREADERLIB_EXPORT InterfaceConnectivity {\n  std::array\u0026lt;int, 2\u003e zones;\n  std::vector\u0026lt;IndexType\u003e ownerIndex;\n  std::vector\u0026lt;IndexType\u003e neighbourIndex;\n};","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etemplate\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003etypename\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eIndexType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003estruct\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e MESHREADERLIB_EXPORT \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::array\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; zones;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; ownerIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;IndexType\u0026gt; neighbourIndex;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="template&lt;typename IndexType&gt;
struct MESHREADERLIB_EXPORT InterfaceConnectivity {
  std::array&lt;int, 2&gt; zones;
  std::vector&lt;IndexType&gt; ownerIndex;
  std::vector&lt;IndexType&gt; neighbourIndex;
};" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">template</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">typename</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">IndexType</span><span style="color: #D4D4D4">&gt;</span></span>
<span class="line"><span style="color: #569CD6">struct</span><span style="color: #D4D4D4"> MESHREADERLIB_EXPORT </span><span style="color: #4EC9B0">InterfaceConnectivity</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::array&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">&gt; zones;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; ownerIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;IndexType&gt; neighbourIndex;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>It is templated on the <code>IndexType</code>. In the <code>ReadStructuredMesh</code> class, we define the <code>IndexType</code> on line 32, use it on line 33 to instantiate a version of the <code>InterfaceConnectivity struct</code>, which means that when we create the <code>_interfaceConnectivity</code> variable of type <code>InterfaceConnectivityType</code> on line 51, we can now store <code>i, j</code> index pairs for the <code>ownerIndex</code> and <code>neighbourIndex</code> as we go through all points in the interface (hence the IndexType being used within a <code>std::vector</code>).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>InterfaceConnectivityType</code> is stored in a 1D <code>std::vector</code>, while the <code>BoundaryConditionInformationType</code> is stored in a 2D <code>std::vector</code>. This has to do with how interfaces and boundaries are stored. Interfaces are stored in a global sense for structured grids (at least this is how Pointwise is generating the CGNS file, other mesh readers may store interfaces per zone, which is possible, and for unstructured grids, this is what Pointwise is doing, nothing we can do about). So, we read all interfaces and store them in the 1D <code>std::vector</code> we have defined.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Boundary conditions are available per zone, even if the boundary conditions are stored as a family under the base node. We read boundary conditions per zone and only if the name and type are stored under a family node, do we read that and then look it up while we do the boundary condition reading. The base class has already <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">read any family-type boundary conditions</a> and made them available for us, so if that is the case, we can simply ask for the information from the base class. But since boundary information is available per zone, we store the information in a 2D <code>std::vector</code> (i.e. the first index is over zones, and the second index is over all boundary conditions in that zone). </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-function-declarations">Function declarations</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's look at the function declarations next, there are only a few. I have copied them below so we don't have to keep scrolling.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"public:\n  ReadStructuredMesh(std::filesystem::path cgnsFilePath);\n  void readMesh() override final;\n\n  const CoordinateType\u0026amp; getCoordinates() const { return _coordinates; }\n  const InterfaceConnectivityType\u0026amp; getInterfaceConnectivity() const { return _interfaceConnectivity; }\n  const BoundaryConditionInformationType\u0026amp; getBoundaryConditions() const { return _boundaryConditions; }\n\nprotected:\n  void readCoorinates() override final;\n  void readInterfaceConnectivity() override final;\n  void readBoundaries() override final;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003epublic:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path cgnsFilePath);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCoordinateType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetCoordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _coordinates; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eInterfaceConnectivityType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _interfaceConnectivity; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBoundaryConditionInformationType\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e { \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003ereturn\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e _boundaryConditions; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eprotected:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eoverride\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003efinal\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":12,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="public:
  ReadStructuredMesh(std::filesystem::path cgnsFilePath);
  void readMesh() override final;

  const CoordinateType&amp; getCoordinates() const { return _coordinates; }
  const InterfaceConnectivityType&amp; getInterfaceConnectivity() const { return _interfaceConnectivity; }
  const BoundaryConditionInformationType&amp; getBoundaryConditions() const { return _boundaryConditions; }

protected:
  void readCoorinates() override final;
  void readInterfaceConnectivity() override final;
  void readBoundaries() override final;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">public:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">ReadStructuredMesh</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path cgnsFilePath);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">CoordinateType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getCoordinates</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _coordinates; }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">InterfaceConnectivityType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInterfaceConnectivity</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _interfaceConnectivity; }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">BoundaryConditionInformationType</span><span style="color: #569CD6">&amp;</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getBoundaryConditions</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> _boundaryConditions; }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">protected:</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">() </span><span style="color: #569CD6">override</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4">;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We define the constructor with the filename as an argument and we start to override all virtual functions from the base class. As a result, once all pure virtual functions are overridden, we can instantiate an object from this class, which we saw already when we modified the <code>main.cpp</code> tester function. The <code>readMesh()</code> function, in particular, is defined in the <code>public</code> area of the class, whereas all the other pure virtual functions, e.g. <code>readCoorinates()</code>, <code>readInterfaceConnectivity()</code>, and <code>readBoundaries()</code>, are defined in the <code>protected</code> area and thus only internal class methods can call these functions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then we have some controversial functions. The primary aim of a class is to implement some logic (hidden from the user, e.g. here read a mesh from a CGNS file) and then expose the end product to the user (e.g. here we want users to be able to access things like the coordinate, interface, and boundary condition arrays). We typically use so-called getter functions that allow users to get information from the class, and these functions typically start with the word get. We have 3 such functions on lines 5-7 above, but these were not defined in the base class.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Typically, you want to define all getters in the base class and then make sure that each derived class implements them. In this case, you can make sure that if a user requests some data, each class will implement that getter function and will return some data. In our case, we want to return data for either a structured or an unstructured grid. The data we will return will have a different type (mainly the <code>IndexType</code> is going to change, unstructured grids store indices in 1D arrays, i.e. they only store the index of a vertex). We could address this issue with templates at the expense of readability.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>There is one more complication, though. The structured and unstructured grids return different information. The structured grid only exposes information for the coordinate, interface and boundary conditions. The unstructured grid provides the same information and additionally some element connectivity data. So we couldn't define all getter functions in the base class, as there is no connectivity to return (we'll look into that in more detail in the next article). So even if we introduced templates to store getters in the base class, we would still have to define additional getter functions in the derived class.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I have decided that for readability purposes, it is better to just define all getters in each derived class. If I didn't care about documenting this class or I could expect that anyone reading my classes are all C++ experts, then I would probably find a more elegant solution with templates. Be aware that this is not a clean design but one which will help us understand our class better (hopefully).</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading" id="aioseo-implementing-the-interface">Implementing the interface</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let us now turn to the source file and look at how the above-mentioned classes are implemented on a structured grid.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-constructor">Constructor</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The constructor is rather straightforward, we first include the header file of the class definition for the <code>ReadStructuredMesh</code> on line 1, and then we simply call the constructor and pass the filename, which we receive as a constructor argument, directly to the constructor of the base class, which here is the <code>ReadMeshBase</code> class. We pass the filename to the base class as it is the base class which is storing the filename.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"#include \u0022meshReaderLib/include/readStructuredMesh.hpp\u0022\n\nReadStructuredMesh::ReadStructuredMesh(std::filesystem::path cgnsFilePath) : ReadMeshBase(cgnsFilePath) { }","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e#include\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;meshReaderLib/include/readStructuredMesh.hpp\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003efilesystem\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::path cgnsFilePath) : \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eReadMeshBase\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(cgnsFilePath) { }\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="#include &quot;meshReaderLib/include/readStructuredMesh.hpp&quot;

ReadStructuredMesh::ReadStructuredMesh(std::filesystem::path cgnsFilePath) : ReadMeshBase(cgnsFilePath) { }" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">#include</span><span style="color: #569CD6"> </span><span style="color: #CE9178">&quot;meshReaderLib/include/readStructuredMesh.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">ReadStructuredMesh</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">filesystem</span><span style="color: #D4D4D4">::path cgnsFilePath) : </span><span style="color: #DCDCAA">ReadMeshBase</span><span style="color: #D4D4D4">(cgnsFilePath) { }</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-implementing-the-readmesh-and-getter-functions">Implementing the readMesh() function</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Next, let's look at the <code>readMesh()</code> function. The implementation is shown below.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadStructuredMesh::readMesh() {\n  readZones(CGNS_ENUMV(Structured));\n  readCoorinates();\n  readInterfaceConnectivity();\n  readBoundaries();\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadZones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCGNS_ENUMV\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(Structured));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":6,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadStructuredMesh::readMesh() {
  readZones(CGNS_ENUMV(Structured));
  readCoorinates();
  readInterfaceConnectivity();
  readBoundaries();
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readMesh</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readZones</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">CGNS_ENUMV</span><span style="color: #D4D4D4">(Structured));</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The first thing we do is to read the zones. The argument we pass to the function is an enum, which tells the function that we expect the zones to be of type <code>Structured</code> and not <code>Unstructured</code>. We discussed the <code>readZones()</code> function in the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">previous article</a>, which is implemented in the base class. We then simply call all the virtual functions that we are overwriting and implementing in this class. These definitions are given in the following. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-coordinates-from-cgns-file">Reading coordinates from a CGNS file</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We start with the read coordinate function. The code definition is given below, and we will, as usual, discuss the implementation afterwards.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadStructuredMesh::readCoorinates() {\n  DataType_t type; char coordname[128];\n  int numberOfDimensions = _zoneSizesMax[0].size();\n\n  // resize the coordinates array, we store one per zone for both x and y\n  _coordinates.resize(_numberOfZones);\n  \n  for (int zone = 0; zone \u0026lt; _numberOfZones; ++zone) {\n    // set the number of max vertices for x and y. Coordinate reading will require this data structure later.\n    cgsize_t maxVertices[2] = { _zoneSizesMax[zone][COORDINATE::X], _zoneSizesMax[zone][COORDINATE::Y] };\n    cgsize_t minVertices[2] = { _zoneSizesMin[zone][COORDINATE::X], _zoneSizesMin[zone][COORDINATE::Y] };\n\n    // based on the max vertices, resize the coordinates array for both x and y\n    _coordinates[zone].resize(maxVertices[COORDINATE::X]);\n    for (int i = 0; i \u0026lt; maxVertices[0]; ++i) {\n      _coordinates[zone][i].resize(maxVertices[COORDINATE::Y]);\n      for (int j = 0; j \u0026lt; maxVertices[1]; ++j) {\n        _coordinates[zone][i][j].resize(numberOfDimensions);\n      }\n    }\n\n    // loop over each direction, e.g. x and y (numberOfDimensions should be 2)\n    for (int dimension = 0; dimension \u0026lt; numberOfDimensions; ++dimension) {\n      // get the coordinates information, mainly the type and name. The type is either single or double preciosion and\n      // the coordname is a SIDS-compliant identification, e.g. 'CoordinateX' and 'CoordinateY'      \n      if (cg_coord_info(_fileIndex, 1, zone + 1, dimension + 1, \u0026amp;type, coordname)) cg_error_exit();\n\n      // temporary (1D) coordinate array to store coordinates in. 2D std::vectors do no guarantee contiguous memory \n      // layout, thus we need to first read in all coordinates into a 1D array and then map that to a 2D array \n      std::vector\u0026lt;double\u003e temp(maxVertices[COORDINATE::X] * maxVertices[COORDINATE::Y]);      \n      if (cg_coord_read(_fileIndex, 1, zone + 1, coordname, type, minVertices, maxVertices, \u0026amp;temp[0])) cg_error_exit();\n\n      // now map temporary (1D) coordinate array to 2D coordinate array\n      for (int vertex = 0; vertex \u0026lt; maxVertices[COORDINATE::X] * maxVertices[COORDINATE::Y]; ++vertex) {\n        unsigned i = vertex % maxVertices[0];\n        unsigned j = vertex / maxVertices[1];\n        _coordinates[zone][i][j][dimension] = temp[vertex];\n      }\n    }\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadCoorinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eDataType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e type; \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ecoordname\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfDimensions = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // resize the coordinates array, we store one per zone for both x and y\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_coordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zone = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; zone \u0026lt; _numberOfZones; ++zone) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // set the number of max vertices for x and y. Coordinate reading will require this data structure later.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] = { \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X], \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eminVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] = { \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X], \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMin\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // based on the max vertices, resize the coordinates array for both x and y\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_coordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; i \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]; ++i) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_coordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][i].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e j = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; j \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]; ++j) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_coordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][i][j].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfDimensions);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // loop over each direction, e.g. x and y (numberOfDimensions should be 2)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e dimension = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; dimension \u0026lt; numberOfDimensions; ++dimension) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // get the coordinates information, mainly the type and name. The type is either single or double preciosion and\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // the coordname is a SIDS-compliant identification, e.g. \u0026#39;CoordinateX\u0026#39; and \u0026#39;CoordinateY\u0026#39;      \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_coord_info\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, dimension + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;type, coordname)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // temporary (1D) coordinate array to store coordinates in. 2D std::vectors do no guarantee contiguous memory \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // layout, thus we need to first read in all coordinates into a 1D array and then map that to a 2D array \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003edouble\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etemp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] * \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y]);      \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_coord_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, coordname, type, minVertices, maxVertices, \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etemp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e])) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // now map temporary (1D) coordinate array to 2D coordinate array\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e vertex = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; vertex \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] * \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y]; ++vertex) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e i = vertex % \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e j = vertex / \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003emaxVertices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_coordinates\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][i][j][dimension] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etemp\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[vertex];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":41,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadStructuredMesh::readCoorinates() {
  DataType_t type; char coordname[128];
  int numberOfDimensions = _zoneSizesMax[0].size();

  // resize the coordinates array, we store one per zone for both x and y
  _coordinates.resize(_numberOfZones);
  
  for (int zone = 0; zone &lt; _numberOfZones; ++zone) {
    // set the number of max vertices for x and y. Coordinate reading will require this data structure later.
    cgsize_t maxVertices[2] = { _zoneSizesMax[zone][COORDINATE::X], _zoneSizesMax[zone][COORDINATE::Y] };
    cgsize_t minVertices[2] = { _zoneSizesMin[zone][COORDINATE::X], _zoneSizesMin[zone][COORDINATE::Y] };

    // based on the max vertices, resize the coordinates array for both x and y
    _coordinates[zone].resize(maxVertices[COORDINATE::X]);
    for (int i = 0; i &lt; maxVertices[0]; ++i) {
      _coordinates[zone][i].resize(maxVertices[COORDINATE::Y]);
      for (int j = 0; j &lt; maxVertices[1]; ++j) {
        _coordinates[zone][i][j].resize(numberOfDimensions);
      }
    }

    // loop over each direction, e.g. x and y (numberOfDimensions should be 2)
    for (int dimension = 0; dimension &lt; numberOfDimensions; ++dimension) {
      // get the coordinates information, mainly the type and name. The type is either single or double preciosion and
      // the coordname is a SIDS-compliant identification, e.g. 'CoordinateX' and 'CoordinateY'      
      if (cg_coord_info(_fileIndex, 1, zone + 1, dimension + 1, &amp;type, coordname)) cg_error_exit();

      // temporary (1D) coordinate array to store coordinates in. 2D std::vectors do no guarantee contiguous memory 
      // layout, thus we need to first read in all coordinates into a 1D array and then map that to a 2D array 
      std::vector&lt;double&gt; temp(maxVertices[COORDINATE::X] * maxVertices[COORDINATE::Y]);      
      if (cg_coord_read(_fileIndex, 1, zone + 1, coordname, type, minVertices, maxVertices, &amp;temp[0])) cg_error_exit();

      // now map temporary (1D) coordinate array to 2D coordinate array
      for (int vertex = 0; vertex &lt; maxVertices[COORDINATE::X] * maxVertices[COORDINATE::Y]; ++vertex) {
        unsigned i = vertex % maxVertices[0];
        unsigned j = vertex / maxVertices[1];
        _coordinates[zone][i][j][dimension] = temp[vertex];
      }
    }
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readCoorinates</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">DataType_t</span><span style="color: #D4D4D4"> type; </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">coordname</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfDimensions = </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">].</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // resize the coordinates array, we store one per zone for both x and y</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_coordinates</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> zone = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; zone &lt; _numberOfZones; ++zone) {</span></span>
<span class="line"><span style="color: #6A9955">    // set the number of max vertices for x and y. Coordinate reading will require this data structure later.</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] = { </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X], </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[zone][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] };</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">minVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] = { </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X], </span><span style="color: #9CDCFE">_zoneSizesMin</span><span style="color: #D4D4D4">[zone][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // based on the max vertices, resize the coordinates array for both x and y</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_coordinates</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X]);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> i = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; i &lt; </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]; ++i) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_coordinates</span><span style="color: #D4D4D4">[zone][i].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y]);</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> j = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; j &lt; </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]; ++j) {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_coordinates</span><span style="color: #D4D4D4">[zone][i][j].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfDimensions);</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // loop over each direction, e.g. x and y (numberOfDimensions should be 2)</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> dimension = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; dimension &lt; numberOfDimensions; ++dimension) {</span></span>
<span class="line"><span style="color: #6A9955">      // get the coordinates information, mainly the type and name. The type is either single or double preciosion and</span></span>
<span class="line"><span style="color: #6A9955">      // the coordname is a SIDS-compliant identification, e.g. &#39;CoordinateX&#39; and &#39;CoordinateY&#39;      </span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_coord_info</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, dimension + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;type, coordname)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // temporary (1D) coordinate array to store coordinates in. 2D std::vectors do no guarantee contiguous memory </span></span>
<span class="line"><span style="color: #6A9955">      // layout, thus we need to first read in all coordinates into a 1D array and then map that to a 2D array </span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;</span><span style="color: #569CD6">double</span><span style="color: #D4D4D4">&gt; </span><span style="color: #DCDCAA">temp</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] * </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y]);      </span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_coord_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, coordname, type, minVertices, maxVertices, &amp;</span><span style="color: #9CDCFE">temp</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">])) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // now map temporary (1D) coordinate array to 2D coordinate array</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> vertex = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; vertex &lt; </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] * </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y]; ++vertex) {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> i = vertex % </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> j = vertex / </span><span style="color: #9CDCFE">maxVertices</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_coordinates</span><span style="color: #D4D4D4">[zone][i][j][dimension] = </span><span style="color: #9CDCFE">temp</span><span style="color: #D4D4D4">[vertex];</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>After defining a few variables on line 2, we seek the number of dimensions on line 3. We could have hard-coded this information here to 2, as it is a 2D mesh reading class, but we can also look into the <code>_zoneSizesMax</code> or <code>_zoneSizesMin</code> array, as they store the maximum and minimum index in each coordinate direction for a structured grid. For 2D, we have 2 indices to store the maximum number of points in the x and y direction, and so we get the number of dimensions in this way on line 3.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 6, we resize the coordinate array for the number of zones as we want to store all of them in the same array. We then loop over all zones on line 8 and start resizing the second and third dimensions of the coordinate array based on the maximum number of vertices in the x and y directions. Remember, this information is available for each zone, and we read that information in the base class when we were reading the zones.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then loop over each dimension on line 23 and start reading the coordinates for each direction (here x and y). We first read coordinate information on line 26 which mainly provides us with the precision of the stored coordinates, i.e. either single- or double-precision. In C++ this maps to either a <code>float</code> or <code>double</code> type, respectively. Notice that we have to provide here the file index, base index, zone index and now also the coordinate index (or dimension, e.g. 1 for x and 2 for y) to the <code>cg_coord_info()</code> function call.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>coordname</code> variable should return a name for the coordinate which is standardised, i.e. it should be either <code>"CoordinateX"</code> or <code>"CoordinateY"</code> depending on which coordinate we read. If the name is anything else, it is not a SIDS-compliant CGNS file. If we already know that the coordinates are stored as either single or double precision, than we can skip the function call on line 26 and go directly to lines 30-31.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We attempt to read the coordinates now on line 31. We have one problem. The CGNS library is written in C, so it can only work with C data types. We can still use C++ <code>std::vector</code> and then get the underlying raw C data structure (in the end, all the C++ data types store data with primitive C style types and arrays) but our coordinate vector is defined as a 4D <code>std::vector</code>. While a 1D <code>std::vector</code> is contiguous in space, a 4D vector isn't, and so we can't use this array here directly and have to create a new, temporary 1D <code>std::vector</code> to read the coordinates into, which we do on line 30.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Using cg_coord_read() on line 31, we can read the coordinate information, which expects a file index and zone index as usual, and then further the data type (single- or double-precision), coordinate name (<code>CoordinateX</code> or <code>CoordinateY</code>), the minimum and maximum vertex to read, and, finally, the 1D coordinate array itself.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Let's assume we have a zone where we have 5 vertices in the x direction and 3 in the y direction. Then, the temporary coordinate array that we defined on line 30, which has a size of <code>number of vertices in x * number of vertices in y</code>, i.e. 15 in this example, will have all the x or y coordinates stored in a 1D array (depending on which coordinate we read on line 31). We now need to map this 1D array back into a 2D array and store it in our 4D global coordinate array.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We do this on lines 34-38. We loop over all the vertices in the 1D array and then calculate what the corresponding indices are for the 2D array. The <code>i</code> index is calculated as <code>unsigned i = vertex % maxVertices[0];</code>. <code>maxVertices[0]</code> is the maximum number of vertices in the x direction, in this example 5. The modulo operator % is a division but will return the remainder of the division. A good explanation of the modulo operator can be found on <a href="https://stackoverflow.com/questions/17524673/understanding-the-modulus-operator" target="_blank" rel="noopener" title="">StackOverflow</a>. So, in our example, <code>i</code> would be calculated as a series of <code>0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For the <code>j</code> direction, we have <code>unsigned j = vertex / maxVertices[1];</code>. Since maxVertices[1], i.e. the maximum number of vertices in the y direction, in our example 3, is an integer, integer division rules apply here. Integer division works by dividing the number as if we are dividing two floating point numbers and then rounding the result down. For example, <code>1/2</code> is <code>0.5</code>, rounding it down is <code>0</code>. <code>9/10</code> is <code>0.9</code>, but this is still <code>0</code> after rounding it down. So, for the <code>j</code> index, we will get values of <code>0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2</code> in our example.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thus, the 2D mapping on lines 34-38 allows us to store the temporary 1D array with all the coordinates in our 4D array by finding the correct <code>i</code> and <code>j</code> indices first.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-interface-connectivity-information-from-cgns-file">Reading interface connectivity for multi-block structured grids from a CGNS file</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have to break this part up into two pieces, as I want to discuss first why we have to read the interface and what information is available, as well as how we can read it with CGNS, as there are several possibilities. Afterwards, we'll look at the mesh reading itself.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-what-interface-connectivity-information">What interface connectivity information do we need and what does CGNS offer?</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>et's remind ourselves what we are trying to achieve in this case, for which we need to look at our structured grid again. The figure below shows the structured grid itself, with all vertex pairs <code>i,j</code> for both zones and also the corresponding boundary conditions for the east, west, north, and south boundary (which we will use in the next section):</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2650,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://cfd.university/wp-content/uploads/2024/01/structured_grid_details-1024x642.png" alt="" class="wp-image-2650"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Between the two zones, i.e. the black and the red grid, we have an interface. If we loop over our mesh, then we will need information from our neighbouring cells to construct derivatives. For example, a simple finite difference discretisation for [katex]\partial^2 u/\partial x^2[/katex] may be written as [katex]\partial u/\partial x\approx (u_{i+1,j}-2u_{i,j}+u_{i-1,j})/(\Delta x)^2[/katex]. If we are on the back grid at index <code>5,3</code>, then we [katex]u_{i-1,j}=u_{4,3}^{zone1}[/katex], [katex]u_{i,j}=u_{5,3}^{zone1}[/katex], and [katex]u_{i+1,j}=u_{2,3}^{zone2}[/katex], i.e. the first two values can be read from zone 1, but the last value for [katex]u[/katex] needs to come from zone 2. Once we know which index on zone 2 the index pair of <code>5,3</code> on zone 1 is connected to, (in this case, 1,3 in zone 2), we can find <code>i+1,j</code>, which in this case is the index pair <code>2,3</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This is what the interface will provide us. We see that on the interface, we have vertices that are part of both the black and red grid. Thus, we will have a set of <code>i,j</code> indices both for the black and red grid that index the same vertex. This connection between the indices is what the interface will provide us, so that once we calculate gradients and request information from neighbouring cells, we have a way to obtain this.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The CGNS <a href="https://cgns.github.io/standard/MLL/api/c_api.html#grid-connectivity" target="_blank" rel="noopener" title="">mid-level library</a> defines 4 general types of connectivity: <em>1-to-1</em>, <em>general</em>, <em>periodic</em>, and <em>overset holes</em>. Yes, we've found it, the periodic boundary condition is hidden here, under connectivity, not boundary conditions. In our case, we have a 1-to-1 connectivity (each vertex in the black grid as a corresponding vertex in the red grid, or, we have a conformal connection). For the 1-to-1 connectivity type, there are 5 different functions defined:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><code>cg_n1to1_global()</code>: Get the total number of 1-to-1 interfaces in a database</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>cg_1to1_read_global()</code>: Read data for all 1-to-1 interfaces in a database</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>cg_1to1_write()</code>: Write 1-to-1 connectivity data for a zone</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>cg_n1to1()</code>: Get the number of 1-to-1 interfaces in a zone</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>cg_1to1_read()</code>: Read 1-to-1 connectivity data for a zone</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>You see that there are two options here, either we have the interface written for each zone, in which case we loop over all zones and then read interface information with <code>cg_1to1_read()</code>, or, all information is stored globally, i.e. under the base node and not under each zone node, in which case we have to read all connectivity information with <code>cg_1to1_read_global()</code>. Which connectivity information is available to us depends on the grid generation software.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What I have done here is to call <code>cg_n1to1_global()</code> first and then loop over all zones and call <code>cg_n1to1()</code> afterwards. Then I looked at which of these calls was giving me a total interface of 1. In this case, Pointwise (my mesh generation software) stored interfaces as global interfaces, so I have to use <code>cg_1to1_read_global()</code> to get all connectivity. This is somewhat annoying, as I would have preferred to store it under each zone, but this is what we have to do.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>before we get into the code, I noticed now that I did not implement a <a href="https://www.martinfowler.com/ieeeSoftware/failFast.pdf" target="_blank" rel="noopener" title="">fail-fast</a> strategy in this case, if you want to make the following code more robust, you should also loop over all cells and <code>assert</code> that there are no interface connectivity stored under a zone (because we are not reading it). I would implement it as well, but can't generate a mesh file that produces an interface under each zone, so I wouldn't be able to test the implementation.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-cgns-implementation-of-reading-global-interface-connectivity-information">CGNS implementation of reading global interface connectivity information.</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>With this out of the way, let's have a look at the code, which is a bit longer, and then discuss it afterwards.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadStructuredMesh::readInterfaceConnectivity() {\n  int numberOfInterfaces;\n\n  // read the number of interfaces in the mesh\n  if (cg_n1to1_global(_fileIndex, 1, \u0026amp;numberOfInterfaces)) cg_error_exit();\n  \n  // allocate temporary memory. This is required to ensure memory layout is contiguous\n  char **interfaceName = new char*[numberOfInterfaces];\n  char **zoneName = new char*[numberOfInterfaces];\n  char **donorName = new char*[numberOfInterfaces];\n  cgsize_t **owner = new cgsize_t*[numberOfInterfaces];\n  cgsize_t **neighbour = new cgsize_t*[numberOfInterfaces];\n  int **transform = new int*[numberOfInterfaces];\n\n  int numberOfDimensions = _zoneSizesMax[0].size();\n  for (int interface = 0; interface \u0026lt; numberOfInterfaces; ++interface) {\n    interfaceName[interface] = new char[128];\n    zoneName[interface] = new char[128];\n    donorName[interface] = new char[128];\n    owner[interface] = new cgsize_t[2 * numberOfDimensions];\n    neighbour[interface] = new cgsize_t[2 * numberOfDimensions];\n    transform[interface] = new int[numberOfDimensions];\n  }\n  \n  // read all connectivity (interface) information all at once\n  if (cg_1to1_read_global(_fileIndex, 1, interfaceName, zoneName, donorName, owner, neighbour, transform))\n    cg_error_exit();\n\n  _interfaceConnectivity.resize(numberOfInterfaces);\n  for (int interface = 0; interface \u0026lt; numberOfInterfaces; ++interface) {\n    // store zone index of the interface owner and neighbour \n    _interfaceConnectivity[interface].zones[INTERFACE::OWNER] = _zoneNamesMap[std::string(zoneName[0])];\n    _interfaceConnectivity[interface].zones[INTERFACE::NEIGHBOUR] = _zoneNamesMap[std::string(donorName[0])];\n\n    // construct (temporary) 2x2 transformation matrix based on information read from the interface. Details about the\n    // transformation matrix can be found here: https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform\n    std::vector\u0026lt;std::vector\u0026lt;int\u003e\u003e tMatrix(numberOfDimensions, std::vector\u0026lt;int\u003e(numberOfDimensions));\n    for (int dimension = 0; dimension \u0026lt; numberOfDimensions; ++dimension) {\n      auto value = transform[interface][dimension];\n      tMatrix[std::abs(value) - 1][dimension] = (value \u003e 0) ? 1 : ((value \u0026lt; 0) ? -1 : 0);\n    }\n    \n    // number of vertices in the interface alogn the x and y direction\n    unsigned numberOfIndicesX = std::abs(owner[interface][2] - owner[interface][0]);\n    unsigned numberOfIndicesY = std::abs(owner[interface][3] - owner[interface][1]);\n    unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);\n\n    // a map of indices, mapping i,j indices from the owning zone to the i,j indices of the neighbouring zone\n    _interfaceConnectivity[interface].ownerIndex.resize(numberOfIndices);\n    _interfaceConnectivity[interface].neighbourIndex.resize(numberOfIndices);\n\n    for (unsigned index = 0; index \u0026lt; numberOfIndices; ++index) {\n      const unsigned ownerStartX = owner[interface][COORDINATE::X] - 1;\n      const unsigned ownerStartY = owner[interface][COORDINATE::Y] - 1;\n      const unsigned neighbourStartX = neighbour[interface][COORDINATE::X] - 1;\n      const unsigned neighbourStartY = neighbour[interface][COORDINATE::Y] - 1;\n\n      const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;\n      const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;\n\n      unsigned ownerIndexX = ownerStartX + indexX;\n      unsigned ownerIndexY = ownerStartY + indexY;\n\n      // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See\n      // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation\n      unsigned neighbourIndexX = tMatrix[0][0] * indexX + tMatrix[0][1] * indexY + neighbourStartX;\n      unsigned neighbourIndexY = tMatrix[1][0] * indexX + tMatrix[1][1] * indexY + neighbourStartY;\n\n      // write connectivty information to interface connectivity structure\n      _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::X] = ownerIndexX;\n      _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::Y] = ownerIndexY;\n      _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::X] = neighbourIndexX;\n      _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::Y] = neighbourIndexY;\n    }\n  }\n\n  // deallocate memory to avoid memory leakage\n  for (int interface = 0; interface \u0026lt; numberOfInterfaces; ++interface) {\n    delete [] interfaceName[interface];\n    delete [] zoneName[interface];\n    delete [] donorName[interface];\n    delete [] owner[interface];\n    delete [] neighbour[interface];\n    delete [] transform[interface];\n  }\n  delete [] interfaceName;\n  delete [] zoneName;\n  delete [] donorName;\n  delete [] owner;\n  delete [] neighbour;\n  delete [] transform;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadInterfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfInterfaces;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // read the number of interfaces in the mesh\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_n1to1_global\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfInterfaces)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // allocate temporary memory. This is required to ensure memory layout is contiguous\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **interfaceName = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **zoneName = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **donorName = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **owner = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **neighbour = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e **transform = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e*[numberOfInterfaces];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfDimensions = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneSizesMax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003esize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e interface = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; interface \u0026lt; numberOfInterfaces; ++interface) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003einterfaceName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003edonorName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e * numberOfDimensions];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e * numberOfDimensions];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etransform\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface] = \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003enew\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[numberOfDimensions];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // read all connectivity (interface) information all at once\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_1to1_read_global\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, interfaceName, zoneName, donorName, owner, neighbour, transform))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfInterfaces);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e interface = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; interface \u0026lt; numberOfInterfaces; ++interface) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // store zone index of the interface owner and neighbour \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eINTERFACE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::OWNER] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneNamesMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e])];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezones\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eINTERFACE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::NEIGHBOUR] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_zoneNamesMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003estring\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003edonorName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e])];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // construct (temporary) 2x2 transformation matrix based on information read from the interface. Details about the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // transformation matrix can be found here: https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::vector\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfDimensions, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;(numberOfDimensions));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e dimension = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; dimension \u0026lt; numberOfDimensions; ++dimension) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e value = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etransform\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][dimension];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(value) - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][dimension] = (value \u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : ((value \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) ? -\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // number of vertices in the interface alogn the x and y direction\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesX = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesY = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndices  = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndicesX + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, numberOfIndicesY + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // a map of indices, mapping i,j indices from the owning zone to the i,j indices of the neighbouring zone\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eownerIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndices);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbourIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndices);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e index = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; index \u0026lt; numberOfIndices; ++index) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerStartX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerStartY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourStartX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourStartY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexX = numberOfIndicesX == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexY = numberOfIndicesY == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexX = ownerStartX + indexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexY = ownerStartY + indexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexX + \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexY + neighbourStartX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexX + \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexY + neighbourStartY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // write connectivty information to interface connectivity structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eownerIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = ownerIndexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eownerIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = ownerIndexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbourIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = neighbourIndexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbourIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = neighbourIndexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // deallocate memory to avoid memory leakage\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e interface = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; interface \u0026lt; numberOfInterfaces; ++interface) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003einterfaceName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003ezoneName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003edonorName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etransform\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e interfaceName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zoneName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e donorName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e owner;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbour;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003edelete\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003e[]\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e transform;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":92,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadStructuredMesh::readInterfaceConnectivity() {
  int numberOfInterfaces;

  // read the number of interfaces in the mesh
  if (cg_n1to1_global(_fileIndex, 1, &amp;numberOfInterfaces)) cg_error_exit();
  
  // allocate temporary memory. This is required to ensure memory layout is contiguous
  char **interfaceName = new char*[numberOfInterfaces];
  char **zoneName = new char*[numberOfInterfaces];
  char **donorName = new char*[numberOfInterfaces];
  cgsize_t **owner = new cgsize_t*[numberOfInterfaces];
  cgsize_t **neighbour = new cgsize_t*[numberOfInterfaces];
  int **transform = new int*[numberOfInterfaces];

  int numberOfDimensions = _zoneSizesMax[0].size();
  for (int interface = 0; interface &lt; numberOfInterfaces; ++interface) {
    interfaceName[interface] = new char[128];
    zoneName[interface] = new char[128];
    donorName[interface] = new char[128];
    owner[interface] = new cgsize_t[2 * numberOfDimensions];
    neighbour[interface] = new cgsize_t[2 * numberOfDimensions];
    transform[interface] = new int[numberOfDimensions];
  }
  
  // read all connectivity (interface) information all at once
  if (cg_1to1_read_global(_fileIndex, 1, interfaceName, zoneName, donorName, owner, neighbour, transform))
    cg_error_exit();

  _interfaceConnectivity.resize(numberOfInterfaces);
  for (int interface = 0; interface &lt; numberOfInterfaces; ++interface) {
    // store zone index of the interface owner and neighbour 
    _interfaceConnectivity[interface].zones[INTERFACE::OWNER] = _zoneNamesMap[std::string(zoneName[0])];
    _interfaceConnectivity[interface].zones[INTERFACE::NEIGHBOUR] = _zoneNamesMap[std::string(donorName[0])];

    // construct (temporary) 2x2 transformation matrix based on information read from the interface. Details about the
    // transformation matrix can be found here: https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform
    std::vector&lt;std::vector&lt;int&gt;&gt; tMatrix(numberOfDimensions, std::vector&lt;int&gt;(numberOfDimensions));
    for (int dimension = 0; dimension &lt; numberOfDimensions; ++dimension) {
      auto value = transform[interface][dimension];
      tMatrix[std::abs(value) - 1][dimension] = (value &gt; 0) ? 1 : ((value &lt; 0) ? -1 : 0);
    }
    
    // number of vertices in the interface alogn the x and y direction
    unsigned numberOfIndicesX = std::abs(owner[interface][2] - owner[interface][0]);
    unsigned numberOfIndicesY = std::abs(owner[interface][3] - owner[interface][1]);
    unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);

    // a map of indices, mapping i,j indices from the owning zone to the i,j indices of the neighbouring zone
    _interfaceConnectivity[interface].ownerIndex.resize(numberOfIndices);
    _interfaceConnectivity[interface].neighbourIndex.resize(numberOfIndices);

    for (unsigned index = 0; index &lt; numberOfIndices; ++index) {
      const unsigned ownerStartX = owner[interface][COORDINATE::X] - 1;
      const unsigned ownerStartY = owner[interface][COORDINATE::Y] - 1;
      const unsigned neighbourStartX = neighbour[interface][COORDINATE::X] - 1;
      const unsigned neighbourStartY = neighbour[interface][COORDINATE::Y] - 1;

      const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;
      const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;

      unsigned ownerIndexX = ownerStartX + indexX;
      unsigned ownerIndexY = ownerStartY + indexY;

      // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See
      // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation
      unsigned neighbourIndexX = tMatrix[0][0] * indexX + tMatrix[0][1] * indexY + neighbourStartX;
      unsigned neighbourIndexY = tMatrix[1][0] * indexX + tMatrix[1][1] * indexY + neighbourStartY;

      // write connectivty information to interface connectivity structure
      _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::X] = ownerIndexX;
      _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::Y] = ownerIndexY;
      _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::X] = neighbourIndexX;
      _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::Y] = neighbourIndexY;
    }
  }

  // deallocate memory to avoid memory leakage
  for (int interface = 0; interface &lt; numberOfInterfaces; ++interface) {
    delete [] interfaceName[interface];
    delete [] zoneName[interface];
    delete [] donorName[interface];
    delete [] owner[interface];
    delete [] neighbour[interface];
    delete [] transform[interface];
  }
  delete [] interfaceName;
  delete [] zoneName;
  delete [] donorName;
  delete [] owner;
  delete [] neighbour;
  delete [] transform;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readInterfaceConnectivity</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfInterfaces;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // read the number of interfaces in the mesh</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_n1to1_global</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfInterfaces)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // allocate temporary memory. This is required to ensure memory layout is contiguous</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> **interfaceName = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> **zoneName = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> **donorName = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> **owner = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> **neighbour = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> **transform = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">*[numberOfInterfaces];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfDimensions = </span><span style="color: #9CDCFE">_zoneSizesMax</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">].</span><span style="color: #DCDCAA">size</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> interface = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; interface &lt; numberOfInterfaces; ++interface) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">interfaceName</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">zoneName</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">donorName</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> * numberOfDimensions];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> * numberOfDimensions];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">[interface] = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">[numberOfDimensions];</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #6A9955">  // read all connectivity (interface) information all at once</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_1to1_read_global</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, interfaceName, zoneName, donorName, owner, neighbour, transform))</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfInterfaces);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> interface = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; interface &lt; numberOfInterfaces; ++interface) {</span></span>
<span class="line"><span style="color: #6A9955">    // store zone index of the interface owner and neighbour </span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">zones</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">INTERFACE</span><span style="color: #D4D4D4">::OWNER] = </span><span style="color: #9CDCFE">_zoneNamesMap</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">zoneName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">])];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">zones</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">INTERFACE</span><span style="color: #D4D4D4">::NEIGHBOUR] = </span><span style="color: #9CDCFE">_zoneNamesMap</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">string</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">donorName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">])];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // construct (temporary) 2x2 transformation matrix based on information read from the interface. Details about the</span></span>
<span class="line"><span style="color: #6A9955">    // transformation matrix can be found here: https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::vector&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">&gt;&gt; </span><span style="color: #DCDCAA">tMatrix</span><span style="color: #D4D4D4">(numberOfDimensions, </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">&gt;(numberOfDimensions));</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> dimension = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; dimension &lt; numberOfDimensions; ++dimension) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> value = </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">[interface][dimension];</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(value) - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][dimension] = (value &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) ? </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> : ((value &lt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) ? -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> : </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">    </span></span>
<span class="line"><span style="color: #6A9955">    // number of vertices in the interface alogn the x and y direction</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesX = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesY = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndices  = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">max</span><span style="color: #D4D4D4">(numberOfIndicesX + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, numberOfIndicesY + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    // a map of indices, mapping i,j indices from the owning zone to the i,j indices of the neighbouring zone</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">ownerIndex</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfIndices);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">neighbourIndex</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfIndices);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> index = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; index &lt; numberOfIndices; ++index) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerStartX = </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerStartY = </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourStartX = </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourStartY = </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexX = numberOfIndicesX == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexY = numberOfIndicesY == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexX = ownerStartX + indexX;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexY = ownerStartY + indexY;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See</span></span>
<span class="line"><span style="color: #6A9955">      // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexX = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] * indexX + </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] * indexY + neighbourStartX;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexY = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] * indexX + </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] * indexY + neighbourStartY;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // write connectivty information to interface connectivity structure</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">ownerIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = ownerIndexX;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">ownerIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = ownerIndexY;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">neighbourIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = neighbourIndexX;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">neighbourIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = neighbourIndexY;</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // deallocate memory to avoid memory leakage</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> interface = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; interface &lt; numberOfInterfaces; ++interface) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">interfaceName</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">zoneName</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">donorName</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">[interface];</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> interfaceName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> zoneName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> donorName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> owner;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> neighbour;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">delete</span><span style="color: #569CD6"> </span><span style="color: #C586C0">[]</span><span style="color: #D4D4D4"> transform;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":6} -->
<h6 class="wp-block-heading" id="aioseo-c-style-array-memory-allocation-for-cgns-functions">C-style array memory allocation for CGNS functions</h6>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>There are two places in the code that we can from the beginning glance over, lines 7-23 and lines 78-91. We spend 30 lines of code here just to allocate and deallocate memory. I hate that it takes that much space and I hate that I have to do it. If you are using the C++ STL containers like a <code>std::vector</code>, and <a href="https://cfd.university/learn/what-every-cfd-developer-needs-to-know-about-c/the-power-of-the-standard-template-library-stl-in-c/" target="_blank" rel="noopener" title="">I have outlined my reasons for why you should do so as well</a>, then this waste of space is just endlessly annoying. But CGNS is written in C, for a good reason (it can be used with a variety of programming languages), in which case primitive data types are important.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So, this memory allocation and deallocation are variables that we need to read the global interface connectivity information. We see here on lines 7-23 that we have to allocate memory for raw 2D pointers using C-style arrays. We have two dimensions here so that we can loop over each interface (first index/dimension) and then for each interface we have to store several entries in an array (second index/dimension), which we will see in the remaining section of the code.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":6} -->
<h6 class="wp-block-heading" id="aioseo-reading-interface-connectivity-information-in-the-interface">Reading interface connectivity information in the interface</h6>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Before that mess of a memory allocation, we have to read the number of interfaces that are globally stored under the base node. We do that on line 5. Since they are under the base node, we only have to provide the file index and base index as an argument (and then receive the number of interfaces as an output). Remember that we asserted before that we only have 1 base, so using here a hard-coded base index of <code>1</code>, as we did in other places, will not break the code.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 26, we can read all interface connectivity information at once, as we have made space (memory allocation) before for all of these variables. Let's look at the arguments in a bit more detail that we get out for each interface:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"cg_1to1_read_global(_fileIndex, 1, interfaceName, zoneName, donorName, owner, neighbour, transform)","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_1to1_read_global\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, interfaceName, zoneName, donorName, owner, neighbour, transform)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":1,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="cg_1to1_read_global(_fileIndex, 1, interfaceName, zoneName, donorName, owner, neighbour, transform)" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">cg_1to1_read_global</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, interfaceName, zoneName, donorName, owner, neighbour, transform)</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The inputs are again the file index, base index (<code>1</code>), and then we have a few outputs. We get the interface name, zone and donor name. In CGNS's terminology, whenever we have an owner/neighbour situation (like for an interface, where there will be two interfaces), the neighbour zone/grid/etc. will always be identified as the <em>donor</em>. So when we say zone and donor name, we mean the names of the zones from the owning and neighbouring (or left and right, top and bottom, front and back, etc.) grid.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We only get the names of the zones, but not the actual zone indices, which would be far easier, hence we set up a zone name to zone index map during the zone reading in the base class. If you need a reminder, look at the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">zone reading in the base class</a> implementation.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The owner and neighbour arrays store the actual <code>i,j</code> indices for both zones which is the interface information we are after. Though, we will only use one of them and then calculate the other, for reasons we will see shortly. We'll need the transform for this as well, which provides a compact transformation matrix, that tells us how the two zones are orientated to each other. If they both use locally the same coordinate system as the global coordinate system, then we technically don't need this transformation, but to make sure we can support any type of global interface connection, we have to implement it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We don't actually care about the interface name, but we do want to store the owner and neighbour zone index. This is what we do on lines 32-33 and we make use of the aforementioned zone name to zone index map which we set up previously to get the zone index from a given zone name.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":6} -->
<h6 class="wp-block-heading" id="aioseo-constructing-the-transformation-matrix-for-owner-neighbour">Constructing the transformation matrix for owner-neighbour indices</h6>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Next we look at the transformation, for which we are constructing a temporary matrix. There is a bit of <a href="https://cgns.github.io/standard/SIDS/multizone.html" target="_blank" rel="noopener" title="">background reading required in the SIDS</a> which you should read before continuing here. Otherwise you may get lost as it is not that straightforward.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <code>transform</code> variable that we received from the interface reading (last argument). It stores a compact transformation matrix. In our case, we only have two dimensions, but let's assume that we had a 3D code and a 3D interface, we may have received a <code>transform</code> array with the following three entries <code>transform = [-2, +3, +1]</code>. This is the same example as in the SIDS linked to above. Then, we can construct the full 3x3 transformation matrix as:</p>
<!-- /wp:paragraph -->

<!-- wp:katex/display-block -->
<div class="wp-block-katex-display-block katex-eq" data-katex-display="true"><pre>\begin{bmatrix}0 &amp; 0 &amp; 1 \\ -1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \end{bmatrix}</pre></div>
<!-- /wp:katex/display-block -->

<!-- wp:paragraph -->
<p>So, the number in the <code>transform</code> array tells us which row to index (ignoring the sign), i.e. the first column has a value of <code>-2</code>, which means that we index the second row. The second column has a value of <code>3</code>, meaning we index the third row, etc. Each of these indexed position get a one, all other entries get a zero. The sign within the <code>transform</code> array is then used to determine if it is plus or minus one in the matrix. If all coordinate systems have the same orientation, then we have the identity matrix, i.e. <code>transform = [1, 2, 3]</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The above logic is implemented in the code on lines 37-41, which is copied below to avoid excessive scrolling.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"std::vector\u0026lt;std::vector\u0026lt;int\u003e\u003e tMatrix(numberOfDimensions, std::vector\u0026lt;int\u003e(numberOfDimensions));\nfor (int dimension = 0; dimension \u0026lt; numberOfDimensions; ++dimension) {\n  auto value = transform[interface][dimension];\n  tMatrix[std::abs(value) - 1][dimension] = (value \u003e 0) ? 1 : ((value \u0026lt; 0) ? -1 : 0);\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003enumberOfDimensions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt;(numberOfDimensions));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e dimension = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; dimension \u0026lt; numberOfDimensions; ++dimension) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eauto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e value = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etransform\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][dimension];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(value) - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][dimension] = (value \u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : ((value \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e) ? -\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":5,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="std::vector&lt;std::vector&lt;int&gt;&gt; tMatrix(numberOfDimensions, std::vector&lt;int&gt;(numberOfDimensions));
for (int dimension = 0; dimension &lt; numberOfDimensions; ++dimension) {
  auto value = transform[interface][dimension];
  tMatrix[std::abs(value) - 1][dimension] = (value &gt; 0) ? 1 : ((value &lt; 0) ? -1 : 0);
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">&gt;&gt; </span><span style="color: #DCDCAA">tMatrix</span><span style="color: #D4D4D4">(</span><span style="color: #4EC9B0">numberOfDimensions</span><span style="color: #D4D4D4">, </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">&gt;(numberOfDimensions));</span></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> dimension = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; dimension &lt; numberOfDimensions; ++dimension) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">auto</span><span style="color: #D4D4D4"> value = </span><span style="color: #9CDCFE">transform</span><span style="color: #D4D4D4">[interface][dimension];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(value) - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][dimension] = (value &gt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) ? </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> : ((value &lt; </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">) ? -</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4"> : </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we create a 2x2 matrix called <code>tMatrix</code>. We loop over all dimensions (which we could have also called columns, i.e. we are looping over all columns here) and then we store a temporary value which is just the value from the <code>transform</code> array (to make the next line more readable). On line 4 above, we index the matrix with the same logic described above, i.e. the row is given by the value in the transform array, and we take the absolute value. Since C++ is <code>0</code>-based, we have to subtract <code>1</code>. Then we simply check if the value is larger or smaller than 0, and write <code>+1</code> or <code>-1</code> accordingly.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If the above shorthand if/else syntax looks confusing, have a look at <a href="https://www.learncpp.com/cpp-tutorial/the-conditional-operator/" target="_blank" rel="noopener" title="">learncpp</a> and their write-up, as always, they have a rather good explanation of the topic.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":6} -->
<h6 class="wp-block-heading" id="aioseo-calculate-the-number-of-indices-in-the-interface">Calculate the number of indices in the interface</h6>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Lines 44-46 determine the number of vertices that we have in the interface. This is repeated below for convenience:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"unsigned numberOfIndicesX = std::abs(owner[interface][2] - owner[interface][0]);\nunsigned numberOfIndicesY = std::abs(owner[interface][3] - owner[interface][1]);\nunsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesX = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesY = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e3\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndices  = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndicesX + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, numberOfIndicesY + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":3,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="unsigned numberOfIndicesX = std::abs(owner[interface][2] - owner[interface][0]);
unsigned numberOfIndicesY = std::abs(owner[interface][3] - owner[interface][1]);
unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesX = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesY = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndices  = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">max</span><span style="color: #D4D4D4">(numberOfIndicesX + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, numberOfIndicesY + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Both the variables <code>owner</code> and <code>neighbour</code>, which we read on line 26 in the <code>cg_1to1_read_global()</code> mid-level library call, have 4 entries, as seen on lines 20-21, where we allocated twice the number of dimensions (the number of dimensions is 2 due to a 2D mesh). The values stored in these arrays are the start and end indices in the interfaces on both the owning and neighbouring zones. The structure of the array is <code>[start_i, start_j, end_i, end_j]</code>. Thus, if we want to know how many vertices there are in the x (<code>i</code>) direction, we have to calculate <code>end_i-start_i</code>, and, <code>end_j-start_j</code> in the y (<code>j</code>) direction, respectively. This is done on lines 1-2 above.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Since we are on a structured grid, at the interface, one of these indices will be zero, as either the <code>i</code> or <code>j</code> coordinate will be constant. Looking back at our structured grid example above, we have a constant value for the x coordinate and thus <code>i</code>=constant. For the index pairs shown above in the structured grid, we have <code>start_i=5</code>, <code>start_j=1</code>, <code>end_i=5</code>, <code>end_j=5</code>. We start our indexing again with 1, as CGNS files use Fortran-based indexing rather than zero-based C-style indexing. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Using these numbers, we have <code>numberOfIndicesX = 0</code> and <code>numberOfIndicesY = 4</code> on lines 1-2 above. But, since we know there are 5 vertices in the interface, we have to add 1 to each of these values, which we do on line 3. Line 3 is then also checking which value is the largest, i.e. one of them will always be 1 and the other will always be the number of vertices/indices in the interface, which we store in the <code>numberOfIndices</code> variable on line 3. Knowing the number of vertices, allows us to allocate memory in our <code>_interfaceConnectivity</code> variable on lines 49-50 that will store all <code>i,j</code> index pairs in the interface.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":6} -->
<h6 class="wp-block-heading" id="aioseo-constructing-ij-index-pairs-of-owner-neighbour-vertices-using-the-transformation-matrix">Constructing i,j index pairs of owner/neighbour vertices using the transformation matrix</h6>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We have now the number of indices for which we need to generate pairs of <code>i,j</code> indices for both the owning and neighbouring zones, and this is what is done on lines 52-74 above. I have again copied it below so we avoid scrolling back and forth.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"for (unsigned index = 0; index \u0026lt; numberOfIndices; ++index) {\n  const unsigned ownerStartX = owner[interface][COORDINATE::X] - 1;\n  const unsigned ownerStartY = owner[interface][COORDINATE::Y] - 1;\n  const unsigned neighbourStartX = neighbour[interface][COORDINATE::X] - 1;\n  const unsigned neighbourStartY = neighbour[interface][COORDINATE::Y] - 1;\n\n  const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;\n  const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;\n\n  unsigned ownerIndexX = ownerStartX + indexX;\n  unsigned ownerIndexY = ownerStartY + indexY;\n\n  // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See\n  // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation\n  unsigned neighbourIndexX = tMatrix[0][0] * indexX + tMatrix[0][1] * indexY + neighbourStartX;\n  unsigned neighbourIndexY = tMatrix[1][0] * indexX + tMatrix[1][1] * indexY + neighbourStartY;\n\n  // write connectivty information to interface connectivity structure\n  _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::X] = ownerIndexX;\n  _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::Y] = ownerIndexY;\n  _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::X] = neighbourIndexX;\n  _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::Y] = neighbourIndexY;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e index = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; index \u0026lt; numberOfIndices; ++index) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerStartX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerStartY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eowner\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourStartX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourStartY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbour\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexX = numberOfIndicesX == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexY = numberOfIndicesY == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexX = ownerStartX + indexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexY = ownerStartY + indexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexX + \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexY + neighbourStartX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexX + \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexY + neighbourStartY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // write connectivty information to interface connectivity structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eownerIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = ownerIndexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eownerIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = ownerIndexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbourIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = neighbourIndexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_interfaceConnectivity\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[interface].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eneighbourIndex\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = neighbourIndexY;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":23,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="for (unsigned index = 0; index &lt; numberOfIndices; ++index) {
  const unsigned ownerStartX = owner[interface][COORDINATE::X] - 1;
  const unsigned ownerStartY = owner[interface][COORDINATE::Y] - 1;
  const unsigned neighbourStartX = neighbour[interface][COORDINATE::X] - 1;
  const unsigned neighbourStartY = neighbour[interface][COORDINATE::Y] - 1;

  const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;
  const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;

  unsigned ownerIndexX = ownerStartX + indexX;
  unsigned ownerIndexY = ownerStartY + indexY;

  // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See
  // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation
  unsigned neighbourIndexX = tMatrix[0][0] * indexX + tMatrix[0][1] * indexY + neighbourStartX;
  unsigned neighbourIndexY = tMatrix[1][0] * indexX + tMatrix[1][1] * indexY + neighbourStartY;

  // write connectivty information to interface connectivity structure
  _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::X] = ownerIndexX;
  _interfaceConnectivity[interface].ownerIndex[index][COORDINATE::Y] = ownerIndexY;
  _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::X] = neighbourIndexX;
  _interfaceConnectivity[interface].neighbourIndex[index][COORDINATE::Y] = neighbourIndexY;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> index = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; index &lt; numberOfIndices; ++index) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerStartX = </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerStartY = </span><span style="color: #9CDCFE">owner</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourStartX = </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourStartY = </span><span style="color: #9CDCFE">neighbour</span><span style="color: #D4D4D4">[interface][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexX = numberOfIndicesX == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexY = numberOfIndicesY == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexX = ownerStartX + indexX;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexY = ownerStartY + indexY;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // calculate the i, j indices of the neighbour zone with the transformation matrix and owner indices. See</span></span>
<span class="line"><span style="color: #6A9955">  // https://cgns.github.io/CGNS_docs_current/sids/cnct.html#Transform for more information about this equation</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexX = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] * indexX + </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] * indexY + neighbourStartX;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexY = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] * indexX + </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] * indexY + neighbourStartY;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // write connectivty information to interface connectivity structure</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">ownerIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = ownerIndexX;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">ownerIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = ownerIndexY;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">neighbourIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = neighbourIndexX;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_interfaceConnectivity</span><span style="color: #D4D4D4">[interface].</span><span style="color: #9CDCFE">neighbourIndex</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = neighbourIndexY;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We first identify the starting index in x and y (i.e. <code>i</code>, and <code>j</code>) on lines 2-5. We determine if the index is increasing in the x or y direction on lines 7-8. If the number of indices in the x direction is zero, then we leave the <code>indexX</code> variable set to zero, otherwise, if it is not zero, then we set it equal to the index, which is the loop variable specified on line 1 in the <code>for</code> loop. This essentially just checks if we are looping along the <code>i</code> or <code>j</code> direction in the interface.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Next, we have to set and compute the index pairs of <code>i,j</code> values that allow us to index vertices on the interface for both the owning and neighbouring zones. We set the owner x and y indices on lines 10-11 and then compute the corresponding <code>i,j</code> index pair for the neighbour zone on lines 15-16. This step may seem confusing and I would encourage you to read the <a href="https://cgns.github.io/standard/SIDS/multizone.html" target="_blank" rel="noopener" title="">documentation on the transformation</a> in the SIDS again. But let's consider a special case, which should make this calculation easier to understand.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I mentioned previously when we constructed the transformation matrix that, if all zones have the same local coordinate system, then we have a transformation matrix that is the identity matrix. If we have the identity matrix, then all the off-diagonal components are zero and lines 15-16 above would reduce to</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"unsigned neighbourIndexX = tMatrix[0][0] * indexX + neighbourStartX;\nunsigned neighbourIndexY = tMatrix[1][1] * indexY + neighbourStartY;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexX = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexX + neighbourStartX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexY = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003etMatrix\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] * indexY + neighbourStartY;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="unsigned neighbourIndexX = tMatrix[0][0] * indexX + neighbourStartX;
unsigned neighbourIndexY = tMatrix[1][1] * indexY + neighbourStartY;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexX = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] * indexX + neighbourStartX;</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexY = </span><span style="color: #9CDCFE">tMatrix</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] * indexY + neighbourStartY;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Keeping further in mind that the values inside the transformation matrix are either positive or negative one (and, in this case, they are positive one since we have the identity matrix, i.e. not transformation), then we can further simplify the above to:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"unsigned neighbourIndexX = indexX + neighbourStartX;\nunsigned neighbourIndexY = indexY + neighbourStartY;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexX = indexX + neighbourStartX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e neighbourIndexY = indexY + neighbourStartY;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="unsigned neighbourIndexX = indexX + neighbourStartX;
unsigned neighbourIndexY = indexY + neighbourStartY;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexX = indexX + neighbourStartX;</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> neighbourIndexY = indexY + neighbourStartY;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Comparing this with the way we set the owner zone indices (lines 10-11):</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"unsigned ownerIndexX = ownerStartX + indexX;\nunsigned ownerIndexY = ownerStartY + indexY;","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexX = ownerStartX + indexX;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ownerIndexY = ownerStartY + indexY;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":2,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="unsigned ownerIndexX = ownerStartX + indexX;
unsigned ownerIndexY = ownerStartY + indexY;" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexX = ownerStartX + indexX;</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> ownerIndexY = ownerStartY + indexY;</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>The order is different, but we see that if there is no transformation between the two different zones, then we essentially just take the start index in <code>i</code> and <code>j</code>, and then we add the loop index <code>indexX</code> and <code>indexY</code> to it in both cases. If you have a look at the SIDS linked above, you will find an example where you have two non-matching coordinate systems for two different zones, in which case the transformation is required.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Finally, on lines 19-22 we store now all the <code>i,j</code> index pairs for both the owning and neighbouring zones in the interface, at which point we have gathered all the information in the interface that we want to store.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading" id="aioseo-reading-boundary-conditions-from-cgns-file">Reading boundary conditions from a CGNS file</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Let's look again at the detailed drawing of our structured grid and try to establish what we want to achieve here.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":2650,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="http://cfd.university/wp-content/uploads/2024/01/structured_grid_details-1024x642.png" alt="" class="wp-image-2650"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We see that we have 4 different boundary conditions for the east (outlet), west (inlet), north (symmetry), and south (wall) boundary on this grid. Both the north and south boundary is split among the two zones. We want to read now for each zone what the boundary condition is. We expect, for a 2D mesh, that we have 4 boundary conditions per zone. This number is reduced if we have interfaces as well. In this case, both structured zones have 1 interface, so we expect to read 3 boundary conditions per interface.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The full boundary condition reading is given below. We will break this code up into separate parts and then discuss the various aspects of the code in the following discussion.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"void ReadStructuredMesh::readBoundaries() {\n  _boundaryConditions.resize(_numberOfZones);\n  for (int zone = 0; zone \u0026lt; _numberOfZones; ++zone) {\n    // get the number of boundary conditions for the current zone\n    int numberOfBoundaries;\n    if (cg_nbocos(_fileIndex, 1, zone + 1, \u0026amp;numberOfBoundaries)) cg_error_exit();\n    _boundaryConditions[zone].resize(numberOfBoundaries);\n\n    for (int boundary = 0; boundary \u0026lt; numberOfBoundaries; ++boundary) {\n      // temporary boundary condition information;\n      char boundaryName[128]; BCType_t boundaryType; PointSetType_t pointSetType; cgsize_t numberOfPointsInBoundary;\n      int normalIndex, numberOfDataset, normalList; cgsize_t normalListSize; DataType_t normalDataType;\n\n      // read boundary condition information\n      if (cg_boco_info(_fileIndex, 1, zone + 1, boundary + 1, boundaryName, \u0026amp;boundaryType, \u0026amp;pointSetType,\n        \u0026amp;numberOfPointsInBoundary, \u0026amp;normalIndex, \u0026amp;normalListSize, \u0026amp;normalDataType, \u0026amp;numberOfDataset)) cg_error_exit();\n\n      assert(pointSetType == PointRange \u0026amp;\u0026amp; \u0022Expected to read a start and end location for boundary conditions only\u0022);\n\n      // start and end location for boundary conditions in i, j index\n      cgsize_t boundaryPoints[2][2]; \n\n      // read boundary condition start and end location\n      if (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, boundaryPoints[0], \u0026amp;normalList)) cg_error_exit();\n\n      // number of vertices in the interface along the x and y direction\n      unsigned numberOfIndicesX = std::abs(boundaryPoints[1][0] - boundaryPoints[0][0]);\n      unsigned numberOfIndicesY = std::abs(boundaryPoints[1][1] - boundaryPoints[0][1]);\n      unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);\n      _boundaryConditions[zone][boundary].indices.resize(numberOfIndices);\n\n      // get all indices along current boundary condition and store them in boundary structure. Reconstructed based on\n      // the start and end location of the current boundary.\n      for (unsigned index = 0; index \u0026lt; numberOfIndices; ++index) {\n        const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;\n        const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;\n        _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[0][COORDINATE::X] + indexX - 1;\n        _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[0][COORDINATE::Y] + indexY - 1;\n      }\n      \n      // Writing the boundary name and type to the boundary structure. We need to check if we need to get this\n      // information from a family or if we can read this directly.\n      if (boundaryType == CGNS_ENUMV(FamilySpecified)) {\n        // go to the current boundary node within the ZoneBC_t node, which must be present for each zone\n        if (cg_goto(_fileIndex, 1, \u0022Zone_t\u0022, zone + 1, \u0022ZoneBC_t\u0022, 1, \u0022BC_t\u0022, boundary + 1,\u0022end\u0022)) cg_error_exit();\n      \n        // once we have navigated to the boundary node, read the family name, this will be checked against the family\n        // names we read previously. From the family name, we can get the boundary condition type through the map we set\n        // up earlier.\n        char familyName[128];\n        if (cg_famname_read(familyName)) cg_error_exit();\n\n        // store boundary condition name and type in the boundary condition structure\n        _boundaryConditions[zone][boundary].boundaryName = familyName;\n        _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(_boundaryConditionMap[familyName]);\n      } else {\n        // store boundary condition name and type in the boundary condition structure\n        _boundaryConditions[zone][boundary].boundaryName = boundaryName;\n        _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(boundaryType);\n      }\n    }\n  }\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003evoid\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eReadStructuredMesh\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ereadBoundaries\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_numberOfZones);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e zone = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; zone \u0026lt; _numberOfZones; ++zone) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e    // get the number of boundary conditions for the current zone\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfBoundaries;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_nbocos\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;numberOfBoundaries)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone].\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfBoundaries);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e boundary = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; boundary \u0026lt; numberOfBoundaries; ++boundary) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // temporary boundary condition information;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eBCType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e boundaryType; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ePointSetType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e pointSetType; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfPointsInBoundary;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eint\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e normalIndex, numberOfDataset, normalList; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e normalListSize; \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eDataType_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e normalDataType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // read boundary condition information\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_boco_info\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundaryName, \u0026amp;boundaryType, \u0026amp;pointSetType,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u0026amp;numberOfPointsInBoundary, \u0026amp;normalIndex, \u0026amp;normalListSize, \u0026amp;normalDataType, \u0026amp;numberOfDataset)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(pointSetType == PointRange \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Expected to read a start and end location for boundary conditions only\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // start and end location for boundary conditions in i, j index\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]; \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // read boundary condition start and end location\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_boco_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e], \u0026amp;normalList)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // number of vertices in the interface along the x and y direction\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesX = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesY = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndices  = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndicesX + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, numberOfIndicesY + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndices);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // get all indices along current boundary condition and store them in boundary structure. Reconstructed based on\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // the start and end location of the current boundary.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e index = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; index \u0026lt; numberOfIndices; ++index) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexX = numberOfIndicesX == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexY = numberOfIndicesY == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] + indexX - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] + indexY - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // Writing the boundary name and type to the boundary structure. We need to check if we need to get this\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e      // information from a family or if we can read this directly.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (boundaryType == \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCGNS_ENUMV\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(FamilySpecified)) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // go to the current boundary node within the ZoneBC_t node, which must be present for each zone\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_goto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Zone_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;ZoneBC_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;BC_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;end\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // once we have navigated to the boundary node, read the family name, this will be checked against the family\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // names we read previously. From the family name, we can get the boundary condition type through the map we set\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // up earlier.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_famname_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(familyName)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // store boundary condition name and type in the boundary condition structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = familyName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditionMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[familyName]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      } \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e        // store boundary condition name and type in the boundary condition structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = boundaryName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e        \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(boundaryType);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":63,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="void ReadStructuredMesh::readBoundaries() {
  _boundaryConditions.resize(_numberOfZones);
  for (int zone = 0; zone &lt; _numberOfZones; ++zone) {
    // get the number of boundary conditions for the current zone
    int numberOfBoundaries;
    if (cg_nbocos(_fileIndex, 1, zone + 1, &amp;numberOfBoundaries)) cg_error_exit();
    _boundaryConditions[zone].resize(numberOfBoundaries);

    for (int boundary = 0; boundary &lt; numberOfBoundaries; ++boundary) {
      // temporary boundary condition information;
      char boundaryName[128]; BCType_t boundaryType; PointSetType_t pointSetType; cgsize_t numberOfPointsInBoundary;
      int normalIndex, numberOfDataset, normalList; cgsize_t normalListSize; DataType_t normalDataType;

      // read boundary condition information
      if (cg_boco_info(_fileIndex, 1, zone + 1, boundary + 1, boundaryName, &amp;boundaryType, &amp;pointSetType,
        &amp;numberOfPointsInBoundary, &amp;normalIndex, &amp;normalListSize, &amp;normalDataType, &amp;numberOfDataset)) cg_error_exit();

      assert(pointSetType == PointRange &amp;&amp; &quot;Expected to read a start and end location for boundary conditions only&quot;);

      // start and end location for boundary conditions in i, j index
      cgsize_t boundaryPoints[2][2]; 

      // read boundary condition start and end location
      if (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, boundaryPoints[0], &amp;normalList)) cg_error_exit();

      // number of vertices in the interface along the x and y direction
      unsigned numberOfIndicesX = std::abs(boundaryPoints[1][0] - boundaryPoints[0][0]);
      unsigned numberOfIndicesY = std::abs(boundaryPoints[1][1] - boundaryPoints[0][1]);
      unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);
      _boundaryConditions[zone][boundary].indices.resize(numberOfIndices);

      // get all indices along current boundary condition and store them in boundary structure. Reconstructed based on
      // the start and end location of the current boundary.
      for (unsigned index = 0; index &lt; numberOfIndices; ++index) {
        const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;
        const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;
        _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[0][COORDINATE::X] + indexX - 1;
        _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[0][COORDINATE::Y] + indexY - 1;
      }
      
      // Writing the boundary name and type to the boundary structure. We need to check if we need to get this
      // information from a family or if we can read this directly.
      if (boundaryType == CGNS_ENUMV(FamilySpecified)) {
        // go to the current boundary node within the ZoneBC_t node, which must be present for each zone
        if (cg_goto(_fileIndex, 1, &quot;Zone_t&quot;, zone + 1, &quot;ZoneBC_t&quot;, 1, &quot;BC_t&quot;, boundary + 1,&quot;end&quot;)) cg_error_exit();
      
        // once we have navigated to the boundary node, read the family name, this will be checked against the family
        // names we read previously. From the family name, we can get the boundary condition type through the map we set
        // up earlier.
        char familyName[128];
        if (cg_famname_read(familyName)) cg_error_exit();

        // store boundary condition name and type in the boundary condition structure
        _boundaryConditions[zone][boundary].boundaryName = familyName;
        _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(_boundaryConditionMap[familyName]);
      } else {
        // store boundary condition name and type in the boundary condition structure
        _boundaryConditions[zone][boundary].boundaryName = boundaryName;
        _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(boundaryType);
      }
    }
  }
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">void</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ReadStructuredMesh</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">readBoundaries</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(_numberOfZones);</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> zone = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; zone &lt; _numberOfZones; ++zone) {</span></span>
<span class="line"><span style="color: #6A9955">    // get the number of boundary conditions for the current zone</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> numberOfBoundaries;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_nbocos</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;numberOfBoundaries)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone].</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfBoundaries);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> boundary = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; boundary &lt; numberOfBoundaries; ++boundary) {</span></span>
<span class="line"><span style="color: #6A9955">      // temporary boundary condition information;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">boundaryName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">]; </span><span style="color: #4EC9B0">BCType_t</span><span style="color: #D4D4D4"> boundaryType; </span><span style="color: #4EC9B0">PointSetType_t</span><span style="color: #D4D4D4"> pointSetType; </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> numberOfPointsInBoundary;</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4"> normalIndex, numberOfDataset, normalList; </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> normalListSize; </span><span style="color: #4EC9B0">DataType_t</span><span style="color: #D4D4D4"> normalDataType;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // read boundary condition information</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_boco_info</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, boundaryName, &amp;boundaryType, &amp;pointSetType,</span></span>
<span class="line"><span style="color: #D4D4D4">        &amp;numberOfPointsInBoundary, &amp;normalIndex, &amp;normalListSize, &amp;normalDataType, &amp;numberOfDataset)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(pointSetType == PointRange &amp;&amp; </span><span style="color: #CE9178">&quot;Expected to read a start and end location for boundary conditions only&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // start and end location for boundary conditions in i, j index</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">]; </span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // read boundary condition start and end location</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_boco_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">], &amp;normalList)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // number of vertices in the interface along the x and y direction</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesX = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesY = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndices  = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">max</span><span style="color: #D4D4D4">(numberOfIndicesX + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, numberOfIndicesY + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfIndices);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">      // get all indices along current boundary condition and store them in boundary structure. Reconstructed based on</span></span>
<span class="line"><span style="color: #6A9955">      // the start and end location of the current boundary.</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> index = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; index &lt; numberOfIndices; ++index) {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexX = numberOfIndicesX == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexY = numberOfIndicesY == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] + indexX - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] + indexY - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">      </span></span>
<span class="line"><span style="color: #6A9955">      // Writing the boundary name and type to the boundary structure. We need to check if we need to get this</span></span>
<span class="line"><span style="color: #6A9955">      // information from a family or if we can read this directly.</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (boundaryType == </span><span style="color: #DCDCAA">CGNS_ENUMV</span><span style="color: #D4D4D4">(FamilySpecified)) {</span></span>
<span class="line"><span style="color: #6A9955">        // go to the current boundary node within the ZoneBC_t node, which must be present for each zone</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_goto</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;Zone_t&quot;</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;ZoneBC_t&quot;</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;BC_t&quot;</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">&quot;end&quot;</span><span style="color: #D4D4D4">)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">      </span></span>
<span class="line"><span style="color: #6A9955">        // once we have navigated to the boundary node, read the family name, this will be checked against the family</span></span>
<span class="line"><span style="color: #6A9955">        // names we read previously. From the family name, we can get the boundary condition type through the map we set</span></span>
<span class="line"><span style="color: #6A9955">        // up earlier.</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_famname_read</span><span style="color: #D4D4D4">(familyName)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">        // store boundary condition name and type in the boundary condition structure</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryName</span><span style="color: #D4D4D4"> = familyName;</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryType</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_boundaryConditionMap</span><span style="color: #D4D4D4">[familyName]);</span></span>
<span class="line"><span style="color: #D4D4D4">      } </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #6A9955">        // store boundary condition name and type in the boundary condition structure</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryName</span><span style="color: #D4D4D4"> = boundaryName;</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryType</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(boundaryType);</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-reading-boundary-condition-information">Reading the boundary condition information</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>By the time we read the boundary conditions, we know how many zones we have, and we want to store the boundary conditions for each zone separately. So we first make space for as many zones as we have on line 2 and then loop over all zones on line 2.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Lines 5-7 reads the number of boundary conditions per zone. Remember, that number should be between 0-4, depending on how many interfaces we have. If we have only a single zone, then we would expect to have exactly 4 boundary conditions. We could add these as additional assertions into the code, but I guess I have thought of this too late. But feel free to modify your code.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 9, we loop over all boundaries in this zone and then define some variables on lines 11-12 that we need to read boundary conditions from the corresponding CGNS mid-level library functions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Line 15 reads some general information about the current boundary. Notice that we index the first base, <code>zone+1</code> and now also <code>boundary+1</code>, which we defined on line 9 as the <code>for</code> loop variable. In particular, we are interested here <code>boundaryName</code>, <code>boundaryType</code>, and <code>pointSetType</code>. The name is what we gave during mesh generation and lets us identify the boundary later if we want to separate between boundaries. The type is one of the 21 different CGNS boundary conditions, and the point set type is either of type point range or point list (other possibilities exist but these are the most common choices).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A point list will give us all the <code>i,j</code> indices that are attached to a certain boundary, and a point range will give us the start and end point in the boundary, similar to what we saw for the interface (where we also only received the start and end indices and had to construct the indices in-between ourselves).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The remaining variables are of no interest to us. You may surprised to see that we don't care about the <code>numberOfPointsInBoundary</code>, this is because for a point range, this value will always be 2 (i.e. we have a start and end location (2 entries)). If we receive a point list instead, this variable would return the number of indices in the boundary. In this case, Pointwise returns the boundaries as a point list.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-reading-boundary">Constructing i,j index pairs for each boundary condition</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On lines 18-39, we need to construct now the <code>i,j</code> index pairs for each boundary condition and store that in our boundary condition <code>struct</code>. These lines are repeated below for convenience.</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"assert(pointSetType == PointRange \u0026amp;\u0026amp; \u0022Expected to read a start and end location for boundary conditions only\u0022);\n\n// start and end location for boundary conditions in i, j index\ncgsize_t boundaryPoints[2][2]; \n\n// read boundary condition start and end location\nif (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, boundaryPoints[0], \u0026amp;normalList)) cg_error_exit();\n\n// number of vertices in the interface along the x and y direction\nunsigned numberOfIndicesX = std::abs(boundaryPoints[1][0] - boundaryPoints[0][0]);\nunsigned numberOfIndicesY = std::abs(boundaryPoints[1][1] - boundaryPoints[0][1]);\nunsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);\n_boundaryConditions[zone][boundary].indices.resize(numberOfIndices);\n\n// get all indices along current boundary condition and store them in boundary structure. Reconstructed based on\n// the start and end location of the current boundary.\nfor (unsigned index = 0; index \u0026lt; numberOfIndices; ++index) {\n  const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;\n  const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;\n  _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[0][COORDINATE::X] + indexX - 1;\n  _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[0][COORDINATE::Y] + indexY - 1;\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(pointSetType == PointRange \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Expected to read a start and end location for boundary conditions only\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// start and end location for boundary conditions in i, j index\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]; \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// read boundary condition start and end location\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_boco_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e], \u0026amp;normalList)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// number of vertices in the interface along the x and y direction\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesX = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndicesY = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eabs\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e] - \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e numberOfIndices  = \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003emax\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndicesX + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, numberOfIndicesY + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e.\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eresize\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(numberOfIndices);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// get all indices along current boundary condition and store them in boundary structure. Reconstructed based on\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// the start and end location of the current boundary.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e index = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; index \u0026lt; numberOfIndices; ++index) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexX = numberOfIndicesX == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003econst\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e indexY = numberOfIndicesY == \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e ? \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e : index;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] + indexX - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] + indexY - \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":22,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="assert(pointSetType == PointRange &amp;&amp; &quot;Expected to read a start and end location for boundary conditions only&quot;);

// start and end location for boundary conditions in i, j index
cgsize_t boundaryPoints[2][2]; 

// read boundary condition start and end location
if (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, boundaryPoints[0], &amp;normalList)) cg_error_exit();

// number of vertices in the interface along the x and y direction
unsigned numberOfIndicesX = std::abs(boundaryPoints[1][0] - boundaryPoints[0][0]);
unsigned numberOfIndicesY = std::abs(boundaryPoints[1][1] - boundaryPoints[0][1]);
unsigned numberOfIndices  = std::max(numberOfIndicesX + 1, numberOfIndicesY + 1);
_boundaryConditions[zone][boundary].indices.resize(numberOfIndices);

// get all indices along current boundary condition and store them in boundary structure. Reconstructed based on
// the start and end location of the current boundary.
for (unsigned index = 0; index &lt; numberOfIndices; ++index) {
  const unsigned indexX = numberOfIndicesX == 0 ? 0 : index;
  const unsigned indexY = numberOfIndicesY == 0 ? 0 : index;
  _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[0][COORDINATE::X] + indexX - 1;
  _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[0][COORDINATE::Y] + indexY - 1;
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(pointSetType == PointRange &amp;&amp; </span><span style="color: #CE9178">&quot;Expected to read a start and end location for boundary conditions only&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// start and end location for boundary conditions in i, j index</span></span>
<span class="line"><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4">]; </span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// read boundary condition start and end location</span></span>
<span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_boco_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">], &amp;normalList)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// number of vertices in the interface along the x and y direction</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesX = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndicesY = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">abs</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">] - </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">]);</span></span>
<span class="line"><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> numberOfIndices  = </span><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #DCDCAA">max</span><span style="color: #D4D4D4">(numberOfIndicesX + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, numberOfIndicesY + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resize</span><span style="color: #D4D4D4">(numberOfIndices);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// get all indices along current boundary condition and store them in boundary structure. Reconstructed based on</span></span>
<span class="line"><span style="color: #6A9955">// the start and end location of the current boundary.</span></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> index = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; index &lt; numberOfIndices; ++index) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexX = numberOfIndicesX == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> indexY = numberOfIndicesY == </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> ? </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4"> : index;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] + indexX - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] + indexY - </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>Since we expect a point range (start and end indices) rather than a point list (all indices), we first assert that we will indeed receive the boundary information as a point range and not a point list. This is done on line 1. We then set up a <code>boundaryPoints</code> array on line 4 where we store the start and end locations for the <code>i</code> and <code>j</code> direction. We read this information on line 7 (we can again ignore here the remaining arguments, in this case just the <code>normalList</code>).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Similar to how we found the number of vertices along an interface, we are now using the same technique to find the number of indices/vertices for each boundary condition on lines 10-12. We find the total number of indices (vertices) on line 12 using the same comparison we used earlier for the interface. On line 13, we allocate space for all index pairs <code>i,j</code> for the current boundary and then on lines 17-22 first construct the <code>i,j</code> index (lines 18-19) and then store it inside the boundary condition variable on lines 20-21.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The logic on lines 18-19 follows exactly the same logic that we used during the interface <code>i,j</code> index pair creation; we check if the indices should increase in the <code>i</code> or <code>j</code> direction and then add only increase the index along either the <code>i</code> or <code>j</code> direction.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-extending-the-boundary-condition-reading-for-point-lists">Extending the boundary condition reading for point lists</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>For completeness, if your mesh generator returns a point list instead, then your code simplifies significantly. Without testing the code below (as pointwise does not return a point list), you would simplify the code to</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"assert(pointSetType == PointList \u0026amp;\u0026amp; \u0022Expected to read all i,j index pairs\u0022);\n\nstd::vector\u0026lt;cgsize_t\u003e boundaryPoints(2 * numberOfPointsInBoundary);\n\n// read boundary condition with point list information\nif (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, \u0026amp;boundaryPoints[0], \u0026amp;normalList)) cg_error_exit();\n\n// map 1D array of boundary points to 2D i,j index pair\nfor (unsigned index = 0; index \u0026lt; 2 * numberOfPointsInBoundary; ++++index) {\n  _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[index + COORDINATE::X];\n  _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[index + COORDINATE::Y];\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eassert\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(pointSetType == PointList \u0026amp;\u0026amp; \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Expected to read all i,j index pairs\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003estd\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003evector\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003ecgsize_t\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e\u0026gt; \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003e*\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003enumberOfPointsInBoundary\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// read boundary condition with point list information\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_boco_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u0026amp;\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e], \u0026amp;normalList)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// map 1D array of boundary points to 2D i,j index pair\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003efor\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003eunsigned\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e index = \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e0\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e; index \u0026lt; \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e2\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e * numberOfPointsInBoundary; ++++index) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index + \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::X];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eindices\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index][\u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y] = \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryPoints\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[index + \u003c/span\u003e\u003cspan style=\u0022color: #4EC9B0\u0022\u003eCOORDINATE\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e::Y];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":12,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="assert(pointSetType == PointList &amp;&amp; &quot;Expected to read all i,j index pairs&quot;);

std::vector&lt;cgsize_t&gt; boundaryPoints(2 * numberOfPointsInBoundary);

// read boundary condition with point list information
if (cg_boco_read(_fileIndex, 1, zone + 1, boundary + 1, &amp;boundaryPoints[0], &amp;normalList)) cg_error_exit();

// map 1D array of boundary points to 2D i,j index pair
for (unsigned index = 0; index &lt; 2 * numberOfPointsInBoundary; ++++index) {
  _boundaryConditions[zone][boundary].indices[index][COORDINATE::X] = boundaryPoints[index + COORDINATE::X];
  _boundaryConditions[zone][boundary].indices[index][COORDINATE::Y] = boundaryPoints[index + COORDINATE::Y];
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #DCDCAA">assert</span><span style="color: #D4D4D4">(pointSetType == PointList &amp;&amp; </span><span style="color: #CE9178">&quot;Expected to read all i,j index pairs&quot;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">std</span><span style="color: #D4D4D4">::</span><span style="color: #4EC9B0">vector</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">cgsize_t</span><span style="color: #D4D4D4">&gt; </span><span style="color: #DCDCAA">boundaryPoints</span><span style="color: #D4D4D4">(</span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">*</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">numberOfPointsInBoundary</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// read boundary condition with point list information</span></span>
<span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_boco_read</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, &amp;</span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">], &amp;normalList)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// map 1D array of boundary points to 2D i,j index pair</span></span>
<span class="line"><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">unsigned</span><span style="color: #D4D4D4"> index = </span><span style="color: #B5CEA8">0</span><span style="color: #D4D4D4">; index &lt; </span><span style="color: #B5CEA8">2</span><span style="color: #D4D4D4"> * numberOfPointsInBoundary; ++++index) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[index + </span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::X];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">indices</span><span style="color: #D4D4D4">[index][</span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y] = </span><span style="color: #9CDCFE">boundaryPoints</span><span style="color: #D4D4D4">[index + </span><span style="color: #4EC9B0">COORDINATE</span><span style="color: #D4D4D4">::Y];</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>First, we assert that we have a point list instead of a point range, and then we set up a 1D <code>std::vector</code> that will read all <code>i,j</code> pairs into a 1D array and then we loop over all vertices in the boundary. I am assuming here that the <code>numberOfPointsInBoundary</code> variable will return the number of vertices in a boundary (in our case 5, for example, for each boundary). If that is the case, then we need to loop over twice as many entries, as we have both <code>i</code> and <code>j</code> stored. This is done on line 9 and we also have to increase the loop counter by 2, instead of 1, hence <code>++++index</code> and not <code>++index</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Remember that <code>COORDINATE::X=0</code> and <code>COORDINATE::Y=1</code>, so when we index into the <code>boundaryPoints</code> on lines 10-11, where index will always increase by (i.e. we have <code>index=[0, 2, 4, 6, ...]</code>), we can index the <code>i</code> and <code>j</code> coordinates in the 1D <code>boundaryPoints</code> array using this notation.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading" id="aioseo-storing-boundary-condition-name-and-type">Storing boundary condition name and type</h5>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Finally, we want to store the boundary name and type in our boundary condition variable. This is done on lines 41-60 in the above-shown implementation and repeated again below for convenience:</p>
<!-- /wp:paragraph -->

<!-- wp:kevinbatdorf/code-block-pro {"code":"// Writing the boundary name and type to the boundary structure. We need to check if we need to get this\n// information from a family or if we can read this directly.\nif (boundaryType == CGNS_ENUMV(FamilySpecified)) {\n  // go to the current boundary node within the ZoneBC_t node, which must be present for each zone\n  if (cg_goto(_fileIndex, 1, \u0022Zone_t\u0022, zone + 1, \u0022ZoneBC_t\u0022, 1, \u0022BC_t\u0022, boundary + 1,\u0022end\u0022)) cg_error_exit();\n\n  // once we have navigated to the boundary node, read the family name, this will be checked against the family\n  // names we read previously. From the family name, we can get the boundary condition type through the map we set\n  // up earlier.\n  char familyName[128];\n  if (cg_famname_read(familyName)) cg_error_exit();\n\n  // store boundary condition name and type in the boundary condition structure\n  _boundaryConditions[zone][boundary].boundaryName = familyName;\n  _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(_boundaryConditionMap[familyName]);\n} else {\n  // store boundary condition name and type in the boundary condition structure\n  _boundaryConditions[zone][boundary].boundaryName = boundaryName;\n  _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(boundaryType);\n}","codeHTML":"\u003cpre class=\u0022shiki dark-plus\u0022 style=\u0022background-color: #1E1E1E\u0022 tabindex=\u00220\u0022\u003e\u003ccode\u003e\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// Writing the boundary name and type to the boundary structure. We need to check if we need to get this\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e// information from a family or if we can read this directly.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (boundaryType == \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003eCGNS_ENUMV\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(FamilySpecified)) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // go to the current boundary node within the ZoneBC_t node, which must be present for each zone\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_goto\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(_fileIndex, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;Zone_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, zone + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;ZoneBC_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, \u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;BC_t\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e, boundary + \u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e1\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e,\u003c/span\u003e\u003cspan style=\u0022color: #CE9178\u0022\u003e\u0026quot;end\u0026quot;\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // once we have navigated to the boundary node, read the family name, this will be checked against the family\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // names we read previously. From the family name, we can get the boundary condition type through the map we set\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // up earlier.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #569CD6\u0022\u003echar\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003efamilyName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[\u003c/span\u003e\u003cspan style=\u0022color: #B5CEA8\u0022\u003e128\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eif\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e (\u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_famname_read\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(familyName)) \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003ecg_error_exit\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // store boundary condition name and type in the boundary condition structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = familyName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditionMap\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[familyName]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e} \u003c/span\u003e\u003cspan style=\u0022color: #C586C0\u0022\u003eelse\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #6A9955\u0022\u003e  // store boundary condition name and type in the boundary condition structure\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryName\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = boundaryName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e  \u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003e_boundaryConditions\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e[zone][boundary].\u003c/span\u003e\u003cspan style=\u0022color: #9CDCFE\u0022\u003eboundaryType\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e = \u003c/span\u003e\u003cspan style=\u0022color: #DCDCAA\u0022\u003egetBoundaryConditionID\u003c/span\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e(boundaryType);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\u0022line\u0022\u003e\u003cspan style=\u0022color: #D4D4D4\u0022\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","language":"cpp","theme":"dark-plus","bgColor":"#1E1E1E","textColor":"#D4D4D4","fontSize":".875rem","fontFamily":"Code-Pro-JetBrains-Mono","lineHeight":"1.25rem","clampFonts":false,"lineNumbers":true,"headerType":"none","disablePadding":false,"footerType":"none","enableMaxHeight":false,"seeMoreType":"","seeMoreString":"","seeMoreAfterLine":"","seeMoreTransition":false,"highestLineNumber":20,"highlightingHover":false,"lineHighlightColor":"rgba(234, 191, 191, 0.2)","copyButton":true,"copyButtonType":"heroicons","useTabs":false} -->
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#D4D4D4;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span role="button" tabindex="0" data-code="// Writing the boundary name and type to the boundary structure. We need to check if we need to get this
// information from a family or if we can read this directly.
if (boundaryType == CGNS_ENUMV(FamilySpecified)) {
  // go to the current boundary node within the ZoneBC_t node, which must be present for each zone
  if (cg_goto(_fileIndex, 1, &quot;Zone_t&quot;, zone + 1, &quot;ZoneBC_t&quot;, 1, &quot;BC_t&quot;, boundary + 1,&quot;end&quot;)) cg_error_exit();

  // once we have navigated to the boundary node, read the family name, this will be checked against the family
  // names we read previously. From the family name, we can get the boundary condition type through the map we set
  // up earlier.
  char familyName[128];
  if (cg_famname_read(familyName)) cg_error_exit();

  // store boundary condition name and type in the boundary condition structure
  _boundaryConditions[zone][boundary].boundaryName = familyName;
  _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(_boundaryConditionMap[familyName]);
} else {
  // store boundary condition name and type in the boundary condition structure
  _boundaryConditions[zone][boundary].boundaryName = boundaryName;
  _boundaryConditions[zone][boundary].boundaryType = getBoundaryConditionID(boundaryType);
}" style="color:#D4D4D4;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #6A9955">// Writing the boundary name and type to the boundary structure. We need to check if we need to get this</span></span>
<span class="line"><span style="color: #6A9955">// information from a family or if we can read this directly.</span></span>
<span class="line"><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (boundaryType == </span><span style="color: #DCDCAA">CGNS_ENUMV</span><span style="color: #D4D4D4">(FamilySpecified)) {</span></span>
<span class="line"><span style="color: #6A9955">  // go to the current boundary node within the ZoneBC_t node, which must be present for each zone</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_goto</span><span style="color: #D4D4D4">(_fileIndex, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;Zone_t&quot;</span><span style="color: #D4D4D4">, zone + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;ZoneBC_t&quot;</span><span style="color: #D4D4D4">, </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&quot;BC_t&quot;</span><span style="color: #D4D4D4">, boundary + </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">&quot;end&quot;</span><span style="color: #D4D4D4">)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // once we have navigated to the boundary node, read the family name, this will be checked against the family</span></span>
<span class="line"><span style="color: #6A9955">  // names we read previously. From the family name, we can get the boundary condition type through the map we set</span></span>
<span class="line"><span style="color: #6A9955">  // up earlier.</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">char</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">familyName</span><span style="color: #D4D4D4">[</span><span style="color: #B5CEA8">128</span><span style="color: #D4D4D4">];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">cg_famname_read</span><span style="color: #D4D4D4">(familyName)) </span><span style="color: #DCDCAA">cg_error_exit</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">  // store boundary condition name and type in the boundary condition structure</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryName</span><span style="color: #D4D4D4"> = familyName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryType</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">_boundaryConditionMap</span><span style="color: #D4D4D4">[familyName]);</span></span>
<span class="line"><span style="color: #D4D4D4">} </span><span style="color: #C586C0">else</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #6A9955">  // store boundary condition name and type in the boundary condition structure</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryName</span><span style="color: #D4D4D4"> = boundaryName;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">_boundaryConditions</span><span style="color: #D4D4D4">[zone][boundary].</span><span style="color: #9CDCFE">boundaryType</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">getBoundaryConditionID</span><span style="color: #D4D4D4">(boundaryType);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span></code></pre></div>
<!-- /wp:kevinbatdorf/code-block-pro -->

<!-- wp:paragraph -->
<p>We first check if the boundary condition is stored under a family node or the boundary node within the zone. If the boundary type, read before with the <code>cg_boco_info()</code> function, is of type <code>FamilySpecified</code>, then we know that we have to go to the family node and read the boundary information from there. This is what we check on line 3.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If it is stored under a family, then we have to use the <code>cg_goto()</code> function, which allows us to index a specific node directly. It is similar like changing a directory in your file system, we go to a specific folder and then afterwards we can do some specific operations just in that folder. So in this case, we navigate to the first base, the current zone (<code>zone + 1</code>) and for the current zone we go to the first boundary node (there should just be one, i.e. all boundary information should be stored under a single <code>ZoneBC_t</code> node per zone. In this boundary node, we go to the current boundary condition, which is indexed with <code>boundary + 1</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Each call to <code>cg_goto()</code> has to end with the string <code>"end"</code> to signal that we have reached our desired location. And, if you are wondering how you can find out the type of each node, these are given in the <a href="https://cgns.github.io/standard/MLL/api/c_api.html" target="_blank" rel="noopener" title="">mid-level library</a> documentation, the <a href="https://cgns.github.io/standard/SIDS/CGNS_SIDS.html" target="_blank" rel="noopener" title="">SIDS</a>, and, if you prefer the lazy approach (I do), then you can also ask the CGNS file to tell you the type of each node by running <code>cgnslist</code> as we have seen in our article on <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-inspect-structured-and-unstructured-grids-using-cgns" target="_blank" rel="noopener" title="">inspecting structured and unstructured grids</a>. You will need to run <code>cgnslist</code> with the <code>-a</code> flag, i.e. <code>cgnslist -a meshFile.cgns</code>. Then, you will not just get the structure of the file but for each node you also get the type of the node. Use that to construct your <code>cg_goto()</code> path.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once we have found the correct node in the CGNS file, we can start reading the information that is available in this particular node. We do that on line 11, where we read the family name that is storing the corresponding boundary conditions. Using the family boundary condition lookup table that we have created in the base class (see the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">previous article</a>), we can query what boundary condition should be used for the current family name.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On line 14, we store the family name, which is the boundary condition name we specified in the mesh generator, and then we store the boundary condition type, which we first have to get from our boundary condition lookup table (mentioned above, i.e we map a family name to a boundary condition as discussed in the previous article) and then we further map the corresponding CGNS boundary condition (of which there are 21) to one of the 4 boundary conditions that we currently support with our mesh reading.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Should the boundary condition be available directly under the boundary condition node, instead of under the family node, then we can use the read boundary name and boundary condition directly (which we obtained earlier when we called the <code>cg_boco_info()</code> function). This information is then directly stored in our boundary condition variable, as shown on lines 18-19. We have to, again, map one of the 21 CGNS-defined boundary conditions to one of 4 that we have defined in our mesh reading classes. The <code>getBoundaryConditionID()</code> is defined in the base class and was discussed in the <a href="https://cfd.university/learn/the-complete-guide-to-structured-and-unstructured-mesh-reading-using-cgns/how-to-set-up-a-simple-cgns-based-mesh-reading-library" target="_blank" rel="noopener" title="">previous article</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading" id="aioseo-summary">Summary</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>And there you have it, if you arrived at this point and feel comfortable with the write-up above, then you should now be in a good position to read a structured grid from a CGNS file. There are a few things that you could add here, for example, adding ghost cells if your structured solver requires them, but Pointwise does not offer support for writing these (as far as I am aware) so we skipped this part.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I hope you have obtained a good understanding and some intuition for how to interact with the mid-level library of the CGNS library. We always make calls to the library using a set of indices, where we specify which node in the CGNS file we want to read, and receive some information back, that we can then either directly store or further process into data that is useful to us, as we saw in the case of reconstructing <code>i,j</code> index pairs in the interface and on boundaries.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In the next article, we will tackle the topic of reading an unstructured grid. There are many similarities so if you understood this article, understanding unstructured mesh reading will not get much more complicated. The complication only arises when we are using the unstructured grid in a CFD solver, where the discretisation becomes a bit more involved, but this is a topic best saved for another time.</p>
<!-- /wp:paragraph -->